(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[800],{41363:()=>{window._iconfont_svg_string_3580659='<svg><symbol id="l7-icon-area1" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.064889 219.136l38.798223 466.261333a113.777778 113.777778 0 1 1-133.518223 145.237334H279.210667a113.777778 113.777778 0 1 1-60.302223-137.272889L697.856 227.555556A113.777778 113.777778 0 0 1 796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m577.592889-534.072889L269.198222 796.444444c4.152889 7.168 7.509333 14.791111 10.012445 22.812445h465.578666a114.119111 114.119111 0 0 1 65.479111-71.224889l-38.798222-466.261333a112.924444 112.924444 0 0 1-23.210666-7.964445zM796.444444 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-area" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.008 219.136l38.855112 466.261333a113.777778 113.777778 0 0 1-16.497778 224.540445L853.333333 967.111111a113.777778 113.777778 0 0 1-108.544-79.644444H279.210667a113.834667 113.834667 0 0 1-100.067556 79.36L170.666667 967.111111a113.777778 113.777778 0 0 1-17.066667-226.304l30.492444-351.175111a113.777778 113.777778 0 0 1 34.986667-218.680889L227.555556 170.666667a113.777778 113.777778 0 0 1 99.896888 59.221333l355.84-71.395556a113.777778 113.777778 0 0 1 104.675556-101.262222L796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m526.051555-582.314666L340.650667 296.903111a113.891556 113.891556 0 0 1-88.462223 98.645333l-30.947555 355.84c27.477333 13.653333 48.64 38.115556 58.026667 67.754667h465.521777a114.119111 114.119111 0 0 1 65.536-71.168l-38.855111-466.261333a113.948444 113.948444 0 0 1-74.752-56.206222zM227.555556 238.933333a45.511111 45.511111 0 1 0 0 91.022223 45.511111 45.511111 0 0 0 0-91.022223z m568.888888-113.777777a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-delete" viewBox="0 0 1024 1024"><path d="M705.422222 85.333333a34.133333 34.133333 0 0 1 34.133334 34.133334V227.555556h136.533333a34.133333 34.133333 0 0 1 0 68.266666h-25.543111l-24.348445 610.076445a34.133333 34.133333 0 0 1-34.133333 32.768H231.936a34.133333 34.133333 0 0 1-34.076444-32.768L173.340444 295.822222H147.911111a34.133333 34.133333 0 1 1 0-68.266666H284.444444V119.466667a34.133333 34.133333 0 0 1 34.133334-34.133334h386.844444zM241.720889 295.822222l22.983111 574.577778h494.535111l23.04-574.577778H241.720889zM671.288889 153.6H352.711111V227.555556h318.577778V153.6z"  ></path></symbol><symbol id="l7-icon-color" viewBox="0 0 1024 1024"><path d="M512 56.888889c9.841778 0 19.626667 0.341333 29.354667 0.910222 69.176889 4.437333 119.068444 62.577778 124.302222 131.072l0.455111 9.386667c0.739556 44.600889 15.303111 84.935111 44.999111 114.631111 27.022222 27.022222 62.805333 41.528889 102.570667 44.430222l12.060444 0.568889c72.476444 1.194667 135.793778 52.451556 140.458667 124.757333 1.137778 18.261333 1.251556 36.807111 0.170667 55.637334-13.198222 233.585778-211.399111 424.220444-445.326223 428.714666L512 967.111111a455.111111 455.111111 0 0 1-455.054222-464.156444c4.551111-233.927111 195.185778-432.128 428.771555-445.326223C494.535111 57.116444 503.296 56.888889 512 56.888889z m0 68.266667a385.706667 385.706667 0 0 0-22.414222 0.625777C291.726222 136.988444 129.080889 305.948444 125.155556 504.263111c-4.152889 212.366222 163.100444 387.185778 372.508444 394.353778l13.425778 0.227555 8.533333-0.113777c198.371556-3.811556 367.331556-166.456889 378.538667-364.373334a396.174222 396.174222 0 0 0-0.170667-47.331555c-1.991111-31.232-29.127111-56.604444-67.128889-60.472889l-8.248889-0.455111-14.051555-0.682667c-56.547556-4.209778-107.406222-25.884444-145.806222-64.284444-38.855111-38.798222-60.416-90.225778-64.284445-145.749334l-0.910222-21.333333c-2.901333-38.001778-28.785778-66.048-60.302222-68.096A433.891556 433.891556 0 0 0 512 125.155556zM438.044444 682.666667a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m-170.666666-227.555556a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m142.222222-227.555555a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z"  ></path></symbol><symbol id="l7-icon-base-map" viewBox="0 0 1024 1024"><path d="M923.761778 115.029333A34.133333 34.133333 0 0 1 967.111111 147.911111v624.128a34.133333 34.133333 0 0 1-22.186667 32.028445l-278.755555 103.992888a34.133333 34.133333 0 0 1-23.665778 0.056889L381.724444 812.714667a34.133333 34.133333 0 0 0-23.665777 0.113777L102.968889 908.060444a34.133333 34.133333 0 0 1-45.738667-26.965333L56.888889 876.088889V251.960889a34.133333 34.133333 0 0 1 22.186667-32.028445l278.755555-103.992888a34.133333 34.133333 0 0 1 20.992-0.967112l266.183111 72.988445a34.133333 34.133333 0 0 0 18.204445 0zM403.911111 192.625778v555.576889l216.177778 79.075555V251.960889l-216.177778-59.335111z m-68.266667 4.380444L125.155556 275.569778v551.310222l210.432-78.506667V197.006222zM898.844444 192.853333l-210.545777 58.936889v575.089778l210.545777-78.563556V192.853333z"  ></path></symbol><symbol id="l7-icon-dot" viewBox="0 0 1024 1024"><path d="M341.333333 739.555556a113.777778 113.777778 0 0 1 8.533334 227.271111L341.333333 967.111111a113.777778 113.777778 0 0 1-8.533333-227.271111L341.333333 739.555556z m0 68.266666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM910.222222 341.333333a113.777778 113.777778 0 0 1 8.533334 227.271111L910.222222 568.888889a113.777778 113.777778 0 0 1-8.533333-227.271111L910.222222 341.333333z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM227.555556 56.888889a113.777778 113.777778 0 0 1 8.533333 227.271111L227.555556 284.444444a113.777778 113.777778 0 0 1-8.533334-227.271111L227.555556 56.888889z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-display" viewBox="0 0 1024 1024"><path d="M512 170.666667c284.444444 0 455.111111 227.555556 455.111111 341.333333s-170.666667 341.333333-455.111111 341.333333-455.111111-227.555556-455.111111-341.333333 170.666667-341.333333 455.111111-341.333333z m0 68.266666C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 110.762667 178.574222 273.066667 386.844444 273.066667s386.844444-162.304 386.844444-273.066667c0-110.762667-178.574222-273.066667-386.844444-273.066667zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-enlarge" viewBox="0 0 1024 1024"><path d="M546.133333 147.911111l-0.056889 329.955556H876.088889a34.133333 34.133333 0 0 1 0 68.266666H546.076444v329.955556a34.133333 34.133333 0 0 1-68.266666 0V546.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h329.898667V147.911111a34.133333 34.133333 0 0 1 68.266666 0z"  ></path></symbol><symbol id="l7-icon-export-picture" viewBox="0 0 1024 1024"><path d="M883.873684 161.684211a32.336842 32.336842 0 0 1 32.336842 32.336842v582.063158a32.336842 32.336842 0 0 1-32.336842 32.336842H86.231579a32.336842 32.336842 0 0 1-32.336842-32.336842V194.021053a32.336842 32.336842 0 0 1 32.336842-32.336842h797.642105z m-32.336842 64.673684H118.568421v517.389473h170.792421a32.175158 32.175158 0 0 1 0.431158-0.646736l3.772632-4.473264 330.320842-330.374736a32.336842 32.336842 0 0 1 38.588631-5.389474l4.473263 3.018105 184.589474 147.725474V226.357895z m-202.428631 248.131368L379.850105 743.747368H851.536842v-107.304421l-202.428631-161.953684zM323.368421 323.368421a107.789474 107.789474 0 1 1 0 215.578947 107.789474 107.789474 0 0 1 0-215.578947z m0 64.673684a43.115789 43.115789 0 1 0 0 86.231579 43.115789 43.115789 0 0 0 0-86.231579z"  ></path></symbol><symbol id="l7-icon-exit-fullscreen" viewBox="0 0 1024 1024"><path d="M841.955556 591.644444a34.133333 34.133333 0 0 1 5.518222 67.811556l-5.518222 0.455111h-133.745778l192 192.056889a34.133333 34.133333 0 0 1-38.343111 55.182222l-5.176889-2.958222-4.721778-3.982222L659.911111 708.266667V841.955556a34.133333 34.133333 0 0 1-28.615111 33.678222L625.777778 876.088889a34.133333 34.133333 0 0 1-33.678222-28.615111L591.644444 841.955556V625.777778a34.133333 34.133333 0 0 1 28.615112-33.678222L625.777778 591.644444h216.177778z m-443.733334 0a34.133333 34.133333 0 0 1 33.678222 28.615112L432.355556 625.777778v216.177778a34.133333 34.133333 0 0 1-67.811556 5.518222L364.088889 841.955556v-133.745778l-192.056889 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L315.847111 659.911111H182.044444a34.133333 34.133333 0 0 1-33.678222-28.615111L147.911111 625.777778a34.133333 34.133333 0 0 1 28.615111-33.678222L182.044444 591.644444H398.222222zM167.310222 119.808l4.721778 3.982222L364.088889 315.847111V182.044444a34.133333 34.133333 0 0 1 28.615111-33.678222L398.222222 147.911111a34.133333 34.133333 0 0 1 33.678222 28.615111L432.355556 182.044444V398.222222a34.133333 34.133333 0 0 1-28.615112 33.678222L398.222222 432.355556H182.044444a34.133333 34.133333 0 0 1-5.518222-67.811556L182.044444 364.088889h133.802667L123.790222 172.032a34.133333 34.133333 0 0 1 43.52-52.224z m732.899556 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L708.266667 364.088889H841.955556a34.133333 34.133333 0 0 1 33.678222 28.615111L876.088889 398.222222a34.133333 34.133333 0 0 1-28.615111 33.678222L841.955556 432.355556H625.777778a34.133333 34.133333 0 0 1-33.678222-28.615112L591.644444 398.222222V182.044444a34.133333 34.133333 0 0 1 67.811556-5.518222l0.455111 5.518222v133.802667l192.056889-192.056889a34.133333 34.133333 0 0 1 48.241778 0z"  ></path></symbol><symbol id="l7-icon-line" viewBox="0 0 1024 1024"><path d="M853.333333 56.888889a113.777778 113.777778 0 0 1 8.533334 227.271111L853.333333 284.444444c-19.000889 0-36.864-4.664889-52.622222-12.856888l-529.123555 529.066666a113.777778 113.777778 0 0 1-92.387556 166.115556L170.666667 967.111111a113.777778 113.777778 0 0 1-8.533334-227.271111L170.666667 739.555556c19.000889 0 36.864 4.664889 52.622222 12.856888l529.123555-529.066666a113.777778 113.777778 0 0 1 92.387556-166.115556L853.333333 56.888889zM170.666667 807.822222a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m682.666666-682.666666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-layer" viewBox="0 0 1024 1024"><path d="M767.089778 625.777778l180.167111 82.773333a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730667-420.977778 193.422222a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422222a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730667L256.853333 625.777778l81.749334 37.546666L172.771556 739.555556 512 895.374222 851.171556 739.555556l-165.831112-76.231112 81.749334-37.546666z m0-227.555556l180.167111 82.773334a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730666-420.977778 193.422223a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422223a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730666L256.853333 398.222222l81.749334 37.546667-165.831111 76.174222L512 667.818667l339.171556-155.875556-165.831112-76.174222L767.089778 398.222222zM497.720889 60.017778a34.133333 34.133333 0 0 1 28.558222 0l420.977778 193.422222a34.133333 34.133333 0 0 1 0 62.008889l-420.977778 193.422222a34.133333 34.133333 0 0 1-28.558222 0l-420.977778-193.422222a34.133333 34.133333 0 0 1 0-62.008889zM512 128.568889L172.771556 284.387556 512 440.263111l339.171556-155.875555L512 128.568889z"  ></path></symbol><symbol id="l7-icon-narrow" viewBox="0 0 1024 1024"><path d="M910.222222 512a34.133333 34.133333 0 0 1-34.133333 34.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h728.177778a34.133333 34.133333 0 0 1 34.133333 34.133333z"  ></path></symbol><symbol id="l7-icon-fullscreen" viewBox="0 0 1024 1024"><path d="M645.176889 597.674667l4.721778 3.982222L841.955556 793.6l0.056888-133.688889a34.133333 34.133333 0 0 1 28.615112-33.678222L876.088889 625.777778a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 659.911111v216.177778a34.133333 34.133333 0 0 1-28.615111 33.678222L876.088889 910.222222h-216.177778a34.133333 34.133333 0 0 1-5.518222-67.811555l5.518222-0.455111h133.745778l-192-192.056889a34.133333 34.133333 0 0 1 43.52-52.224z m-222.833778 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L230.286222 841.955556H364.088889a34.133333 34.133333 0 0 1 33.678222 28.615111L398.222222 876.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L364.088889 910.222222H147.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 876.088889v-216.177778a34.133333 34.133333 0 0 1 67.811555-5.518222l0.455111 5.518222-0.056888 133.745778 192.113777-192a34.133333 34.133333 0 0 1 48.241778 0zM364.088889 113.777778a34.133333 34.133333 0 0 1 5.518222 67.811555L364.088889 182.044444H230.343111l192 192.056889a34.133333 34.133333 0 0 1-43.52 52.224l-4.721778-3.982222-192.113777-192.056889L182.044444 364.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L147.911111 398.222222a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 364.088889V147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L147.911111 113.777778h216.177778z m512 0a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 147.911111v216.177778a34.133333 34.133333 0 0 1-67.811555 5.518222L841.955556 364.088889l-0.056889-133.745778-192 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L793.6 182.044444H659.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L625.777778 147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L659.911111 113.777778h216.177778z"  ></path></symbol><symbol id="l7-icon-hide" viewBox="0 0 1024 1024"><path d="M875.52 87.836444a34.133333 34.133333 0 0 1 7.281778 43.121778l-3.527111 5.006222-682.666667 796.444445a34.133333 34.133333 0 0 1-55.409778-39.367111l3.527111-5.006222 97.166223-113.379556C123.164444 697.969778 56.888889 582.940444 56.888889 512c0-113.777778 170.666667-341.333333 455.111111-341.333333a496.64 496.64 0 0 1 208.952889 45.112889l106.439111-124.188445a34.133333 34.133333 0 0 1 48.128-3.754667z m-38.684444 202.524445C921.031111 362.951111 967.111111 452.835556 967.111111 512c0 113.777778-170.666667 341.333333-455.111111 341.333333-50.631111 0-97.678222-7.224889-140.8-19.740444l50.232889-58.595556A417.393778 417.393778 0 0 0 512 785.066667c208.270222 0 386.844444-162.304 386.844444-273.066667 0-52.849778-40.675556-117.418667-105.813333-170.496l43.804445-51.2zM512 238.933333C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 66.787556 64.853333 152.291556 162.133333 209.692444L377.173333 616.675556a170.666667 170.666667 0 0 1 217.713778-253.895112l78.620445-91.704888A432.924444 432.924444 0 0 0 512 238.933333z m166.684444 236.088889a170.666667 170.666667 0 0 1-177.664 207.303111l177.607112-207.303111zM512 409.6a102.4 102.4 0 0 0-88.746667 153.486222L548.864 416.426667A102.172444 102.172444 0 0 0 512 409.6z"  ></path></symbol><symbol id="l7-icon-rectangle" viewBox="0 0 1024 1024"><path d="M170.666667 56.888889a113.777778 113.777778 0 0 1 108.544 79.644444H853.333333a34.133333 34.133333 0 0 1 33.678223 28.615111L887.466667 170.666667v574.122666a113.777778 113.777778 0 1 1-142.677334 142.734223L170.666667 887.466667a34.133333 34.133333 0 0 1-33.678223-28.615111L136.533333 853.333333V279.210667A113.777778 113.777778 0 0 1 170.666667 56.888889z m682.666666 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-34.133333-603.022222H279.210667a114.062222 114.062222 0 0 1-74.353778 74.410667L204.8 819.2h539.989333a114.062222 114.062222 0 0 1 74.410667-74.410667V204.8zM170.666667 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-ranging" viewBox="0 0 1024 1024"><path d="M723.171556 50.403556l250.424888 250.424888a31.061333 31.061333 0 0 1 0 43.918223L344.746667 973.596444a31.061333 31.061333 0 0 1-43.918223 0L50.403556 723.171556a31.061333 31.061333 0 0 1 0-43.918223L679.253333 50.403556a31.061333 31.061333 0 0 1 43.918223 0z m-21.959112 74.524444l-39.765333 39.822222 98.986667 98.872889a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222 62.179556 62.122667a34.133333 34.133333 0 0 1-44.088889 51.882667L563.2 387.242667 501.077333 325.063111 437.191111 388.949333l98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222L387.242667 563.2a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.584-62.122667-62.179556-63.886222 63.886222 98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-39.765333 39.822222 197.802667 197.745778 576.284444-576.284444-197.802667-197.745778z"  ></path></symbol><symbol id="l7-icon-reposition" viewBox="0 0 1024 1024"><path d="M512 56.888889a34.133333 34.133333 0 0 1 34.133333 34.133333v24.177778A398.336 398.336 0 0 1 908.856889 477.866667h24.177778a34.133333 34.133333 0 0 1 0 68.266666h-24.177778A398.336 398.336 0 0 1 546.133333 908.856889L546.133333 932.977778a34.133333 34.133333 0 0 1-68.266666 0v-24.177778A398.336 398.336 0 0 1 115.2 546.133333L91.022222 546.133333a34.133333 34.133333 0 1 1 0-68.266666h24.177778A398.336 398.336 0 0 1 477.866667 115.2V91.022222A34.133333 34.133333 0 0 1 512 56.888889z m34.190222 126.862222L546.133333 193.422222a34.133333 34.133333 0 1 1-68.266666 0v-9.671111A330.069333 330.069333 0 0 0 183.751111 477.866667h9.671111a34.133333 34.133333 0 1 1 0 68.266666l-9.671111 0.056889A330.069333 330.069333 0 0 0 477.866667 840.248889V830.577778a34.133333 34.133333 0 0 1 68.266666 0l0.056889 9.671111A330.069333 330.069333 0 0 0 840.248889 546.133333L830.577778 546.133333a34.133333 34.133333 0 0 1 0-68.266666h9.671111A330.069333 330.069333 0 0 0 546.133333 183.751111zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-round" viewBox="0 0 1024 1024"><path d="M512 56.888889a455.111111 455.111111 0 0 1 391.395556 687.502222 113.777778 113.777778 0 0 1-159.061334 158.890667A455.111111 455.111111 0 0 1 120.604444 279.608889 113.777778 113.777778 0 0 1 279.608889 120.604444 452.835556 452.835556 0 0 1 512 56.888889z m0 68.266667a384.910222 384.910222 0 0 0-191.715556 50.744888A113.777778 113.777778 0 0 1 175.957333 320.284444a386.844444 386.844444 0 0 0 527.815111 527.758223 113.777778 113.777778 0 0 1 144.270223-144.440889A386.844444 386.844444 0 0 0 512 125.155556z m299.406222 640.739555a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM212.593778 167.082667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-guanbi" viewBox="0 0 1024 1024"><path d="M576 512l277.333333 277.333333-64 64-277.333333-277.333333L234.666667 853.333333 170.666667 789.333333l277.333333-277.333333L170.666667 234.666667 234.666667 170.666667l277.333333 277.333333L789.333333 170.666667 853.333333 234.666667 576 512z"  ></path></symbol></svg>',function(e){try{var t=(t=document.getElementsByTagName("script"))[t.length-1],r=t.getAttribute("data-injectcss"),t=t.getAttribute("data-disable-injectsvg");if(!t){var n,i,o,a,s,l=function(e,t){t.parentNode.insertBefore(e,t)};if(r&&!e.__iconfont__svg__cssinject__){e.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(e){console&&console.log(e)}}n=function(){var t,r=document.createElement("div");r.innerHTML=e._iconfont_svg_string_3580659,(r=r.getElementsByTagName("svg")[0])&&(r.setAttribute("aria-hidden","true"),r.style.position="absolute",r.style.width=0,r.style.height=0,r.style.overflow="hidden",(t=document.body).firstChild?l(r,t.firstChild):t.appendChild(r))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(n,0):(i=function(){document.removeEventListener("DOMContentLoaded",i,!1),n()},document.addEventListener("DOMContentLoaded",i,!1)):document.attachEvent&&(o=n,a=e.document,s=!1,function e(){try{a.documentElement.doScroll("left")}catch(t){return void setTimeout(e,50)}u()}(),a.onreadystatechange=function(){"complete"==a.readyState&&(a.onreadystatechange=null,u())})}function u(){s||(s=!0,o())}}catch(e){}}(window)},54289:()=>{},63632:(e,t,r)=>{"use strict";r.d(t,{S6:()=>pf,U6:()=>fK,pH:()=>lD,Z5:()=>mv});var n,i,o,a,s,l,u,c={},h={},d=e=>h[e],p=(e,t)=>{h[e]=t},f=e=>c[e],g=(e,t)=>{c[e]=t},m={},v={};function y(e){return Function("d","return {"+e.map(function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'}).join(",")+"}")}function _(e){var t=Object.create(null),r=[];return e.forEach(function(e){for(var n in e)n in t||r.push(t[n]=n)}),r}function b(e,t){var r=e+"",n=r.length;return n<t?Array(t-n+1).join(0)+r:r}var x=function(e){var t=RegExp('[",\n\r]');function r(e,t){var r,n=[],i=e.length,o=0,a=0,s=i<=0,l=!1;function u(){if(s)return v;if(l)return l=!1,m;var t,r,n=o;if(34===e.charCodeAt(n)){for(;o++<i&&34!==e.charCodeAt(o)||34===e.charCodeAt(++o););return(t=o)>=i?s=!0:10===(r=e.charCodeAt(o++))?l=!0:13===r&&(l=!0,10===e.charCodeAt(o)&&++o),e.slice(n+1,t-1).replace(/""/g,'"')}for(;o<i;){if(10===(r=e.charCodeAt(t=o++)))l=!0;else if(13===r)l=!0,10===e.charCodeAt(o)&&++o;else if(44!==r)continue;return e.slice(n,t)}return s=!0,e.slice(n,i)}for(10===e.charCodeAt(i-1)&&--i,13===e.charCodeAt(i-1)&&--i;(r=u())!==v;){for(var c=[];r!==m&&r!==v;)c.push(r),r=u();t&&null==(c=t(c,a++))||n.push(c)}return n}function n(e,t){return e.map(function(e){return t.map(function(t){return o(e[t])}).join(",")})}function i(t){return t.map(o).join(e)}function o(e){var r,n,i,o,a,s;return null==e?"":e instanceof Date?(n=(r=e).getUTCHours(),i=r.getUTCMinutes(),o=r.getUTCSeconds(),a=r.getUTCMilliseconds(),isNaN(r)?"Invalid Date":((s=r.getUTCFullYear())<0?"-"+b(-s,6):s>9999?"+"+b(s,6):b(s,4))+"-"+b(r.getUTCMonth()+1,2)+"-"+b(r.getUTCDate(),2)+(a?"T"+b(n,2)+":"+b(i,2)+":"+b(o,2)+"."+b(a,3)+"Z":o?"T"+b(n,2)+":"+b(i,2)+":"+b(o,2)+"Z":i||n?"T"+b(n,2)+":"+b(i,2)+"Z":"")):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var n,i,o=r(e,function(e,r){var o;if(n)return n(e,r-1);i=e,n=t?(o=y(e),function(r,n){return t(o(r),n,e)}):y(e)});return o.columns=i||[],o},parseRows:r,format:function(t,r){return null==r&&(r=_(t)),[r.map(o).join(e)].concat(n(t,r)).join("\n")},formatBody:function(e,t){return null==t&&(t=_(e)),n(e,t).join("\n")},formatRows:function(e){return e.map(i).join("\n")},formatRow:i,formatValue:o}}(","),S=x.parse;x.parseRows,x.format,x.formatBody,x.formatRows,x.formatRow,x.formatValue;function A(e,t,r){void 0===r&&(r={});var n={type:"Feature"};return(0===r.id||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=t||{},n.geometry=e,n}function E(e,t,r){void 0===r&&(r={});for(var n=0;n<e.length;n++){var i=e[n];if(i.length<4)throw Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var o=0;o<i[i.length-1].length;o++)if(i[i.length-1][o]!==i[0][o])throw Error("First and last Position are not equivalent.")}return A({type:"Polygon",coordinates:e},t,r)}function T(e){if(Array.isArray(e))return e;if("Feature"===e.type){if(null!==e.geometry)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function C(e){return"Feature"===e.type?e.geometry:e}function w(e,t){!function(e,t){var r,n,i,o,a,s,l,u,c,h,d=0,p="FeatureCollection"===e.type,f="Feature"===e.type,g=p?e.features.length:1;for(r=0;r<g;r++){for(i=0,s=p?e.features[r].geometry:f?e.geometry:e,u=p?e.features[r].properties:f?e.properties:{},c=p?e.features[r].bbox:f?e.bbox:void 0,h=p?e.features[r].id:f?e.id:void 0,a=(l=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1;i<a;i++){if(null===(o=l?s.geometries[i]:s)){if(!1===t(null,d,u,c,h))return!1;continue}switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(o,d,u,c,h))return!1;break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(!1===t(o.geometries[n],d,u,c,h))return!1;break;default:throw Error("Unknown Geometry Type")}}d++}}(e,function(e,r,n,i,o){var a,s=null===e?null:e.type;switch(s){case null:case"Point":case"LineString":case"Polygon":if(!1===t(A(e,n,{bbox:i,id:o}),r,0))return!1;return}switch(s){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var l=0;l<e.coordinates.length;l++)if(!1===t(A({type:a,coordinates:e.coordinates[l]},n),r,l))return!1})}var L={REGISTERED_PROTOCOLS:{}},M=Object.defineProperty,O=Object.defineProperties,I=Object.getOwnPropertyDescriptors,P=Object.getOwnPropertySymbols,R=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable,N=(e,t,r)=>t in e?M(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,D=(e,t)=>{for(var r in t||(t={}))R.call(t,r)&&N(e,r,t[r]);if(P)for(var r of P(t))k.call(t,r)&&N(e,r,t[r]);return e},U=(e,t)=>O(e,I(t)),z=e=>L.REGISTERED_PROTOCOLS[e.substring(0,e.indexOf("://"))],B=class extends Error{constructor(e,t,r,n){super(`AJAXError: ${t} (${e}): ${r}`),this.status=e,this.statusText=t,this.url=r,this.body=n}};function F(e,t){let r=new XMLHttpRequest,n=Array.isArray(e.url)?e.url[0]:e.url;for(let t in r.open(e.method||"GET",n,!0),"arrayBuffer"===e.type&&(r.responseType="arraybuffer"),e.headers)e.headers.hasOwnProperty(t)&&r.setRequestHeader(t,e.headers[t]);return"json"===e.type&&(r.responseType="text",r.setRequestHeader("Accept","application/json")),r.withCredentials="include"===e.credentials,r.onerror=()=>{t(Error(r.statusText))},r.onload=()=>{if((r.status>=200&&r.status<300||0===r.status)&&null!==r.response){let n=r.response;if("json"===e.type)try{n=JSON.parse(r.response)}catch(e){return t(e)}t(null,n,r.getResponseHeader("Cache-Control"),r.getResponseHeader("Expires"),r)}else{let e=new Blob([r.response],{type:r.getResponseHeader("Content-Type")});t(new B(r.status,r.statusText,n.toString(),e))}},r.cancel=r.abort,r.send(e.body),r}function j(e,t){return F(e,t)}var V=(e,t)=>(z(e.url)||j)(U(D({},e),{type:"json"}),t),H=(e,t)=>(z(e.url)||j)(U(D({},e),{type:"arrayBuffer"}),t),G=(e,t)=>F(U(D({},e),{method:"GET"}),t),W="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function X(e,t){let r=new window.Image,n=window.URL||window.webkitURL;r.crossOrigin="anonymous",r.onload=()=>{t(null,r),n.revokeObjectURL(r.src),r.onload=null,window.requestAnimationFrame(()=>{r.src=W})},r.onerror=()=>t(Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));let i=new Blob([new Uint8Array(e)],{type:"image/png"});r.src=e.byteLength?n.createObjectURL(i):W}function $(e,t){createImageBitmap(new Blob([new Uint8Array(e)],{type:"image/png"})).then(e=>{t(null,e)}).catch(e=>{t(Error(`Could not load image because of ${e.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}var Z=(e,t,r)=>{let n=(e,n)=>{if(e)t(e);else if(n){let e="function"==typeof createImageBitmap,i=r?r(n):n;e?$(i,t):X(i,t)}};return"json"===e.type?V(e,n):H(e,n)},Y=(e,t)=>{"function"==typeof createImageBitmap?$(e,t):X(e,t)},q=(e=>(e.CENTER="center",e.TOP="top",e["TOP-LEFT"]="top-left",e["TOP-RIGHT"]="top-right",e.BOTTOM="bottom",e["BOTTOM-LEFT"]="bottom-left",e["BOTTOM-RIGHT"]="bottom-right",e.LEFT="left",e.RIGHT="right",e))(q||{}),K={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Q(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function J(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function ee(){}var et="\\s*([+-]?\\d+)\\s*",er="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",en="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ei=/^#([0-9a-f]{3,8})$/,eo=RegExp("^rgb\\("+[et,et,et]+"\\)$"),ea=RegExp("^rgb\\("+[en,en,en]+"\\)$"),es=RegExp("^rgba\\("+[et,et,et,er]+"\\)$"),el=RegExp("^rgba\\("+[en,en,en,er]+"\\)$"),eu=RegExp("^hsl\\("+[er,en,en]+"\\)$"),ec=RegExp("^hsla\\("+[er,en,en,er]+"\\)$"),eh={aliceblue:0xf0f8ff,antiquewhite:0xfaebd7,aqua:65535,aquamarine:8388564,azure:0xf0ffff,beige:0xf5f5dc,bisque:0xffe4c4,black:0,blanchedalmond:0xffebcd,blue:255,blueviolet:9055202,brown:0xa52a2a,burlywood:0xdeb887,cadetblue:6266528,chartreuse:8388352,chocolate:0xd2691e,coral:0xff7f50,cornflowerblue:6591981,cornsilk:0xfff8dc,crimson:0xdc143c,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:0xb8860b,darkgray:0xa9a9a9,darkgreen:25600,darkgrey:0xa9a9a9,darkkhaki:0xbdb76b,darkmagenta:9109643,darkolivegreen:5597999,darkorange:0xff8c00,darkorchid:0x9932cc,darkred:9109504,darksalmon:0xe9967a,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:0xff1493,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:0xb22222,floralwhite:0xfffaf0,forestgreen:2263842,fuchsia:0xff00ff,gainsboro:0xdcdcdc,ghostwhite:0xf8f8ff,gold:0xffd700,goldenrod:0xdaa520,gray:8421504,green:32768,greenyellow:0xadff2f,grey:8421504,honeydew:0xf0fff0,hotpink:0xff69b4,indianred:0xcd5c5c,indigo:4915330,ivory:0xfffff0,khaki:0xf0e68c,lavender:0xe6e6fa,lavenderblush:0xfff0f5,lawngreen:8190976,lemonchiffon:0xfffacd,lightblue:0xadd8e6,lightcoral:0xf08080,lightcyan:0xe0ffff,lightgoldenrodyellow:0xfafad2,lightgray:0xd3d3d3,lightgreen:9498256,lightgrey:0xd3d3d3,lightpink:0xffb6c1,lightsalmon:0xffa07a,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:0xb0c4de,lightyellow:0xffffe0,lime:65280,limegreen:3329330,linen:0xfaf0e6,magenta:0xff00ff,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:0xba55d3,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:0xc71585,midnightblue:1644912,mintcream:0xf5fffa,mistyrose:0xffe4e1,moccasin:0xffe4b5,navajowhite:0xffdead,navy:128,oldlace:0xfdf5e6,olive:8421376,olivedrab:7048739,orange:0xffa500,orangered:0xff4500,orchid:0xda70d6,palegoldenrod:0xeee8aa,palegreen:0x98fb98,paleturquoise:0xafeeee,palevioletred:0xdb7093,papayawhip:0xffefd5,peachpuff:0xffdab9,peru:0xcd853f,pink:0xffc0cb,plum:0xdda0dd,powderblue:0xb0e0e6,purple:8388736,rebeccapurple:6697881,red:0xff0000,rosybrown:0xbc8f8f,royalblue:4286945,saddlebrown:9127187,salmon:0xfa8072,sandybrown:0xf4a460,seagreen:3050327,seashell:0xfff5ee,sienna:0xa0522d,silver:0xc0c0c0,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:0xfffafa,springgreen:65407,steelblue:4620980,tan:0xd2b48c,teal:32896,thistle:0xd8bfd8,tomato:0xff6347,turquoise:4251856,violet:0xee82ee,wheat:0xf5deb3,white:0xffffff,whitesmoke:0xf5f5f5,yellow:0xffff00,yellowgreen:0x9acd32};function ed(){return this.rgb().formatHex()}function ep(){return this.rgb().formatRgb()}function ef(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=ei.exec(e))?(r=t[1].length,t=parseInt(t[1],16),6===r?eg(t):3===r?new ey(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===r?em(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===r?em(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=eo.exec(e))?new ey(t[1],t[2],t[3],1):(t=ea.exec(e))?new ey(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=es.exec(e))?em(t[1],t[2],t[3],t[4]):(t=el.exec(e))?em(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=eu.exec(e))?eS(t[1],t[2]/100,t[3]/100,1):(t=ec.exec(e))?eS(t[1],t[2]/100,t[3]/100,t[4]):eh.hasOwnProperty(e)?eg(eh[e]):"transparent"===e?new ey(NaN,NaN,NaN,0):null}function eg(e){return new ey(e>>16&255,e>>8&255,255&e,1)}function em(e,t,r,n){return n<=0&&(e=t=r=NaN),new ey(e,t,r,n)}function ev(e,t,r,n){var i;return 1==arguments.length?((i=e)instanceof ee||(i=ef(i)),i)?new ey((i=i.rgb()).r,i.g,i.b,i.opacity):new ey:new ey(e,t,r,null==n?1:n)}function ey(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}function e_(){return"#"+ex(this.r)+ex(this.g)+ex(this.b)}function eb(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function ex(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function eS(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new eE(e,t,r,n)}function eA(e){if(e instanceof eE)return new eE(e.h,e.s,e.l,e.opacity);if(e instanceof ee||(e=ef(e)),!e)return new eE;if(e instanceof eE)return e;var t=(e=e.rgb()).r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),o=Math.max(t,r,n),a=NaN,s=o-i,l=(o+i)/2;return s?(a=t===o?(r-n)/s+(r<n)*6:r===o?(n-t)/s+2:(t-r)/s+4,s/=l<.5?o+i:2-o-i,a*=60):s=l>0&&l<1?0:a,new eE(a,s,l,e.opacity)}function eE(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}function eT(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}function eC(e){let t=ef(e),r=[0,0,0,0];return null!=t&&(r[0]=t.r/255,r[1]=t.g/255,r[2]=t.b/255,r[3]=t.opacity),r}function ew(e){let t=e&&e[0];return t+256*(e&&e[1])+65536*(e&&e[2])-1}function eL(e){return[e+1&255,e+1>>8&255,e+1>>8>>8&255]}function eM(e,t){let r=e.createImageData(256,1);for(let e=0;e<r.data.length;e+=4)r.data[e+0]=t[e+0],r.data[e+1]=t[e+1],r.data[e+2]=t[e+2],r.data[e+3]=t[e+3];return r}function eO(e){return(null==e?void 0:e.type)==="cat"?[0,255]:[0,1]}Q(ee,ef,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:ed,formatHex:ed,formatHsl:function(){return eA(this).formatHsl()},formatRgb:ep,toString:ep}),Q(ey,ev,J(ee,{brighter:function(e){return e=null==e?1.4285714285714286:Math.pow(1.4285714285714286,e),new ey(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new ey(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return -.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:e_,formatHex:e_,formatRgb:eb,toString:eb})),Q(eE,function(e,t,r,n){return 1==arguments.length?eA(e):new eE(e,t,r,null==n?1:n)},J(ee,{brighter:function(e){return e=null==e?1.4285714285714286:Math.pow(1.4285714285714286,e),new eE(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new eE(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new ey(eT(e>=240?e-240:e+120,i,n),eT(e,i,n),eT(e<120?e+240:e-120,i,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));var eI=r(89413),eP=r.n(eI),eR=r(32301),ek=r.n(eR),eN=r(91985),eD=r.n(eN),eU=r(91946),ez=r.n(eU),eB=r(35186),eF=r.n(eB),ej=r(97894),eV=r.n(ej),eH=r(1293),eG=r.n(eH),eW=r(39403),eX=r.n(eW),e$=r(54969),eZ=r.n(e$),eY=r(36707),eq=r.n(eY),eK=r(78003),eQ=r.n(eK),eJ=r(87066),e0=r.n(eJ),e1=r(17362),e2=r.n(e1),e3=r(34469),e4=r.n(e3),e5=r(55570),e6=r.n(e5),e7=r(91255),e8=r.n(e7),e9=r(61836),te=r.n(e9),tt=r(71350),tr=r.n(tt),tn=r(35093),ti=r.n(tn),to=r(63370),ta=r.n(to),ts=r(61252),tl=r.n(ts),tu=r(33876),tc=r.n(tu),th={isNil:eG(),merge:e0(),throttle:e6(),isString:eq(),debounce:eD(),pull:e4(),isTypedArray:eQ(),isPlainObject:eZ(),isNumber:eX(),isBoolean:eF(),isEqual:eV(),cloneDeep:ek(),uniq:e8(),clamp:eP(),upperFirst:te(),get:ez(),mergeWith:e2(),isFunction:tr(),isObject:ti(),isUndefined:ta(),camelCase:tl(),uniqueId:tc()},{pull:td}=th;function tp(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function tf(e){return tp(e).split(/\s+/)}function tg(e,t,r){let n=window.document.createElement(e);return t&&(n.className=t||""),r&&r.appendChild(n),n}function tm(e){let t=e.parentNode;t&&t.removeChild(e)}function tv(e,t){if(void 0!==e.classList){let r=tf(t);for(let t=0,n=r.length;t<n;t++)e.classList.add(r[t])}else if(!function(e,t){if(void 0!==e.classList)return e.classList.contains(t);let r=tb(e);return r.length>0&&RegExp("(^|\\s)"+t+"(\\s|$)").test(r)}(e,t)){let r=tb(e);t_(e,(r?r+" ":"")+t)}}function ty(e,t){void 0!==e.classList?tf(t).forEach(t=>{e.classList.remove(t)}):t_(e,tp((" "+tb(e)+" ").replace(" "+t+" "," ")))}function t_(e,t){e instanceof HTMLElement?e.className=t:e.className.baseVal=t}function tb(e){return e instanceof SVGElement&&(e=e.correspondingElement),void 0===e.className.baseVal?e.className:e.className.baseVal}var tx=function(e){var t;let r=null==(t=null==document?void 0:document.documentElement)?void 0:t.style;if(!r)return e[0];for(let t in e)if(e[t]&&e[t]in r)return e[t];return e[0]}(["transform","WebkitTransform"]),tS=1>function(){var e;let t=window.document.querySelector('meta[name="viewport"]');if(!t)return 1;let r=(null==(e=t.content)?void 0:e.split(",")).find(e=>{let[t]=e.split("=");return"initial-scale"===t});return r?1*r.split("=")[1]:1}()?1:window.devicePixelRatio;function tA(e){e.innerHTML=""}"function"==typeof importScripts||(()=>("blob:"===window.location.protocol?window.parent:window).location.href);var tE=null==navigator?void 0:navigator.userAgent;function tT(e){var t=[1/0,1/0,-1/0,-1/0];return function e(t,r,n){if(null!==t)for(var i,o,a,s,l,u,c,h,d=0,p=0,f=t.type,g="FeatureCollection"===f,m="Feature"===f,v=g?t.features.length:1,y=0;y<v;y++){l=(h=!!(c=g?t.features[y].geometry:m?t.geometry:t)&&"GeometryCollection"===c.type)?c.geometries.length:1;for(var _=0;_<l;_++){var b=0,x=0;if(null!==(s=h?c.geometries[_]:c)){u=s.coordinates;var S=s.type;switch(d=n&&("Polygon"===S||"MultiPolygon"===S)?1:0,S){case null:break;case"Point":if(!1===r(u,p,y,b,x))return!1;p++,b++;break;case"LineString":case"MultiPoint":for(i=0;i<u.length;i++){if(!1===r(u[i],p,y,b,x))return!1;p++,"MultiPoint"===S&&b++}"LineString"===S&&b++;break;case"Polygon":case"MultiLineString":for(i=0;i<u.length;i++){for(o=0;o<u[i].length-d;o++){if(!1===r(u[i][o],p,y,b,x))return!1;p++}"MultiLineString"===S&&b++,"Polygon"===S&&x++}"Polygon"===S&&b++;break;case"MultiPolygon":for(i=0;i<u.length;i++){for(o=0,x=0;o<u[i].length;o++){for(a=0;a<u[i][o].length-d;a++){if(!1===r(u[i][o][a],p,y,b,x))return!1;p++}x++}b++}break;case"GeometryCollection":for(i=0;i<s.geometries.length;i++)if(!1===e(s.geometries[i],r,n))return!1;break;default:throw Error("Unknown Geometry Type")}}}}}(e,function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])}),t}function tC(e){return"number"==typeof e}function tw(e){return e-Math.fround(e)}tE.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),tE.indexOf("Android")>-1||tE.indexOf("Adr"),tT.default=tT;var tL=2*Math.PI*6378137/2;function tM(e,t=!0,r={enable:!0,decimal:1}){let n=(e=function(e,t){if(!1===t)return e;let r=function(e){if(null==e)throw Error("lng is required");return(e>180||e<-180)&&((e%=360)>180&&(e=-360+e),e<-180&&(e=360+e),0===e&&(e=0)),e}(e[0]),n=function(e){if(null==e)throw Error("lat is required");return(e>90||e<-90)&&((e%=180)>90&&(e=-180+e),e<-90&&(e=180+e),0===e&&(e=0)),e}(e[1]);return n>85&&(n=85),n<-85&&(n=-85),3===e.length?[r,n,e[2]]:[r,n]}(e,t))[0],i=e[1],o=n*tL/180,a=Math.log(Math.tan((90+i)*Math.PI/360))/(Math.PI/180);return a=a*tL/180,r.enable&&(o=Number(o.toFixed(r.decimal)),a=Number(a.toFixed(r.decimal))),3===e.length?[o,a,e[2]]:[o,a]}function tO(e){let t=Math.max(Math.min(85.0511287798,e[1]),-85.0511287798),r=Math.PI/180,n=e[0]*r,i=t*r;i=Math.log(Math.tan(Math.PI/4+i/2));let o=-.5/Math.PI;return r=.5,[Math.floor(n=0x10000000*(.5/Math.PI*n+.5)),Math.floor(i=0x10000000*(o*i+r))]}function tI(e,t){let r=Math.abs(e[1][1]-e[0][1])*t,n=Math.abs(e[1][0]-e[0][0])*t;return[[e[0][0]-n,e[0][1]-r],[e[1][0]+n,e[1][1]+r]]}function tP(e,t){return e[0][0]<=t[0][0]&&e[0][1]<=t[0][1]&&e[1][0]>=t[1][0]&&e[1][1]>=t[1][1]}function tR(e){return[[e[0],e[1]],[e[2],e[3]]]}function tk(e){if(tC(e[0]))return e;if(tC(e[0][0]))throw Error("当前数据不支持标注");if(tC(e[0][0][0])){let t=0,r=0,n=0;return e.forEach(e=>{e.forEach(e=>{t+=e[0],r+=e[1],n++})}),[t/n,r/n,0]}throw Error("当前数据不支持标注")}var tN=Object.defineProperty,tD=Object.getOwnPropertySymbols,tU=Object.prototype.hasOwnProperty,tz=Object.prototype.propertyIsEnumerable,tB=(e,t,r)=>t in e?tN(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,tF=class{constructor(e=50,t){this.limit=e,this.destroy=t||this.defaultDestroy,this.order=[],this.clear()}clear(){this.order.forEach(e=>{this.delete(e)}),this.cache={},this.order=[]}get(e){let t=this.cache[e];return t&&(this.deleteOrder(e),this.appendOrder(e)),t}set(e,t){this.cache[e]?this.delete(e):Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[e]=t,this.appendOrder(e)}delete(e){let t=this.cache[e];t&&(this.deleteCache(e),this.deleteOrder(e),this.destroy(t,e))}deleteCache(e){delete this.cache[e]}deleteOrder(e){let t=this.order.findIndex(t=>t===e);t>=0&&this.order.splice(t,1)}appendOrder(e){this.order.push(e)}defaultDestroy(e,t){return null}};function tj(e){if(0===e.length)return 0;let t=1*e[0];for(let r=1;r<e.length;r++)t+=1*e[r];return t}var tV={min:function(e){if(0===e.length)throw Error("min requires at least one data point");let t=e[0];for(let r=1;r<e.length;r++)e[r]<t&&(t=e[r]);return 1*t},max:function(e){if(0===e.length)throw Error("max requires at least one data point");let t=e[0];for(let r=1;r<e.length;r++)e[r]>t&&(t=e[r]);return 1*t},mean:function(e){if(0===e.length)throw Error("mean requires at least one data point");return tj(e)/e.length},sum:tj,mode:function(e){if(0===e.length)throw Error("mean requires at least one data point");if(e.length<3)return e[0];e.sort();let t=e[0],r=NaN,n=0,i=1;for(let o=1;o<e.length+1;o++)e[o]!==t?(i>n&&(n=i,r=t),i=1,t=e[o]):i++;return 1*r}};function tH(e,t){return e.map(e=>e[t])}var tG=r(53982),tW=r.n(tG),tX=(e=>(e.Realtime="realtime",e.Overlap="overlap",e.Replace="replace",e))(tX||{}),t$=(e=>(e.Loading="Loading",e.Loaded="Loaded",e.Failure="Failure",e.Cancelled="Cancelled",e))(t$||{});function tZ(e){for(;e;){if(e.isLoaded)return e.properties.state|=2,!0;e=e.parent}return!1}function tY(e){e.children.forEach(e=>{e.isLoaded?e.properties.state|=2:tY(e)})}var tq=[-1/0,-1/0,1/0,1/0],tK={[tX.Realtime]:function(e){e.forEach(e=>{e.isCurrent&&(e.isVisible=e.isLoaded)})},[tX.Overlap]:function(e){e.forEach(e=>{e.properties.state=0}),e.forEach(e=>{e.isCurrent&&!tZ(e)&&tY(e)}),e.forEach(e=>{e.isVisible=!!(2&e.properties.state)})},[tX.Replace]:function(e){e.forEach(e=>{e.properties.state=0}),e.forEach(e=>{e.isCurrent&&tZ(e)}),e.slice().sort((e,t)=>e.z-t.z).forEach(e=>{e.isVisible=!!(2&e.properties.state),e.children.length&&(e.isVisible||1&e.properties.state)?e.children.forEach(e=>{e.properties.state=1}):e.isCurrent&&tY(e)})}},tQ=()=>{};function tJ(e,t,r){return[Math.floor((e+180)/360*Math.pow(2,r)),Math.floor((1-Math.log(Math.tan(t*Math.PI/180)+1/Math.cos(t*Math.PI/180))/Math.PI)/2*Math.pow(2,r))]}function t0(e,t,r){let n=e/Math.pow(2,r)*360-180,i=Math.PI-2*Math.PI*t/Math.pow(2,r);return[n,180/Math.PI*Math.atan(.5*(Math.exp(i)-Math.exp(-i)))]}var t1=(e,t,r)=>{let[n,i]=t0(e,t,r),[o,a]=t0(e+1,t+1,r);return[n,a,o,i]},t2=(e,t,r,n=!0)=>{let i=Math.pow(2,r),o=e;return n&&(o<0?o+=i:o>i-1&&(o%=i)),{warpX:o,warpY:t}},t3=(e,t,r)=>new Promise((n,i)=>{var o=e=>{try{s(r.next(e))}catch(e){i(e)}},a=e=>{try{s(r.throw(e))}catch(e){i(e)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,a);s((r=r.apply(e,t)).next())}),t4=class extends tG.EventEmitter{constructor(e){super(),this.tileSize=256,this.isVisible=!1,this.isCurrent=!1,this.isVisibleChange=!1,this.loadedLayers=0,this.isLayerLoaded=!1,this.isLoad=!1,this.isChildLoad=!1,this.parent=null,this.children=[],this.data=null,this.properties={},this.loadDataId=0;let{x:t,y:r,z:n,tileSize:i,warp:o=!0}=e;this.x=t,this.y=r,this.z=n,this.warp=o||!0,this.tileSize=i}get isLoading(){return this.loadStatus===t$.Loading}get isLoaded(){return this.loadStatus===t$.Loaded}get isFailure(){return this.loadStatus===t$.Failure}setTileLayerLoaded(){this.isLayerLoaded=!0}get isCancelled(){return this.loadStatus===t$.Cancelled}get isDone(){return[t$.Loaded,t$.Cancelled,t$.Failure].includes(this.loadStatus)}get bounds(){return t1(this.x,this.y,this.z)}get bboxPolygon(){let[e,t,r,n]=this.bounds;return function(e,t){void 0===t&&(t={});var r=Number(e[0]),n=Number(e[1]),i=Number(e[2]),o=Number(e[3]);if(6===e.length)throw Error("@turf/bbox-polygon does not support BBox with 6 positions");var a=[r,n],s=[r,o],l=[i,o];return E([[a,[i,n],l,s,a]],t.properties,{bbox:e,id:t.id})}(this.bounds,{properties:{key:this.key,id:this.key,bbox:this.bounds,center:[(r-e)/2,(n-t)/2],meta:`
      ${this.key}
      `}})}get key(){return`${this.x}_${this.y}_${this.z}`}layerLoad(){this.loadedLayers++,this.emit("layerLoaded")}loadData(e){return t3(this,arguments,function*({getData:e,onLoad:t,onError:r}){let n;this.loadDataId++;let i=this.loadDataId;this.isLoading&&this.abortLoad(),this.abortController=new AbortController,this.loadStatus=t$.Loading;let o=null;try{let{x:t,y:r,z:n,bounds:i,tileSize:a,warp:s}=this,{warpX:l,warpY:u}=t2(t,r,n,s),{signal:c}=this.abortController;o=yield e({x:l,y:u,z:n,bounds:i,tileSize:a,signal:c,warp:s},this)}catch(e){n=e}if(i===this.loadDataId&&(!this.isCancelled||o)){if(n||!o){this.loadStatus=t$.Failure,r(n,this);return}this.loadStatus=t$.Loaded,this.data=o,t(this)}})}reloadData(e){this.isLoading&&this.abortLoad(),this.loadData(e)}abortLoad(){this.isLoaded||this.isCancelled||(this.loadStatus=t$.Cancelled,this.abortController.abort(),this.xhrCancel&&this.xhrCancel())}},t5=(e,t)=>{let r=tI(tR(e),t);return[Math.max(r[0][0],-900),Math.max(r[0][1],-85.0511287798065),Math.min(r[1][0],900),Math.min(r[1][1],85.0511287798065)]},t6=(e,t)=>tP(tR(e),tR(t)),t7=Object.defineProperty,t8=Object.defineProperties,t9=Object.getOwnPropertyDescriptors,re=Object.getOwnPropertySymbols,rt=Object.prototype.hasOwnProperty,rr=Object.prototype.propertyIsEnumerable,rn=(e,t,r)=>t in e?t7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ri=(e,t)=>{for(var r in t||(t={}))rt.call(t,r)&&rn(e,r,t[r]);if(re)for(var r of re(t))rr.call(t,r)&&rn(e,r,t[r]);return e},ro=(e,t)=>t8(e,t9(t)),{throttle:ra}=th,rs=(e=>(e.TilesLoadStart="tiles-load-start",e.TileLoaded="tile-loaded",e.TileError="tile-error",e.TileUnload="tile-unload",e.TileUpdate="tile-update",e.TilesLoadFinished="tiles-load-finished",e))(rs||{}),rl=class extends tW(){constructor(e){super(),this.currentTiles=[],this.cacheTiles=new Map,this.throttleUpdate=ra((e,t)=>{this.update(e,t)},16),this.onTileLoad=e=>{this.emit("tile-loaded",e),this.updateTileVisible(),this.loadFinished()},this.onTileError=(e,t)=>{this.emit("tile-error",{error:e,tile:t}),this.updateTileVisible(),this.loadFinished()},this.onTileUnload=e=>{this.emit("tile-unload",e),this.loadFinished()},this.options={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,extent:tq,getTileData:tQ,warp:!0,updateStrategy:tX.Replace},this.updateOptions(e)}get isLoaded(){return this.currentTiles.every(e=>e.isDone)}get tiles(){return Array.from(this.cacheTiles.values()).sort((e,t)=>e.z-t.z)}updateOptions(e){let t=void 0===e.minZoom?this.options.minZoom:Math.ceil(e.minZoom),r=void 0===e.maxZoom?this.options.maxZoom:Math.floor(e.maxZoom);this.options=ro(ri(ri({},this.options),e),{minZoom:t,maxZoom:r})}update(e,t){let r=Math.max(0,Math.ceil(e));if(this.lastViewStates&&this.lastViewStates.zoom===r&&t6(this.lastViewStates.latLonBoundsBuffer,t))return;let n=t5(t,.2);this.lastViewStates={zoom:r,latLonBounds:t,latLonBoundsBuffer:n},this.currentZoom=r;let i=!1,o=this.getTileIndices(r,n).filter(e=>this.options.warp||e.x>=0&&e.x<Math.pow(2,r));this.emit("tiles-load-start"),this.currentTiles=o.map(({x:e,y:t,z:r})=>{let n=this.getTile(e,t,r);return n?((null==n?void 0:n.isFailure)||(null==n?void 0:n.isCancelled))&&n.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}):(n=this.createTile(e,t,r),i=!0),n}),i&&this.resizeCacheTiles(),this.updateTileVisible(),this.pruneRequests()}reloadAll(){for(let[e,t]of this.cacheTiles){if(!this.currentTiles.includes(t)){this.cacheTiles.delete(e),this.onTileUnload(t);return}this.onTileUnload(t),t.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError})}}reloadTileById(e,t,r){let n=this.cacheTiles.get(`${t},${r},${e}`);n&&(this.onTileUnload(n),n.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}))}reloadTileByLnglat(e,t,r){let n=this.getTileByLngLat(e,t,r);n&&this.reloadTileById(n.z,n.x,n.y)}reloadTileByExtent(e,t){this.getTileIndices(t,e).forEach(e=>{this.reloadTileById(e.z,e.x,e.y)})}pruneRequests(){let e=[];for(let t of this.cacheTiles.values())!t.isLoading||t.isCurrent||t.isVisible||e.push(t);for(;e.length>0;)e.shift().abortLoad()}getTileByLngLat(e,t,r){let{zoomOffset:n}=this.options,i=Math.ceil(r)+n,o=tJ(e,t,i);return this.tiles.filter(e=>e.key===`${o[0]}_${o[1]}_${i}`)[0]}getTileExtent(e,t){return this.getTileIndices(t,e)}getTileByZXY(e,t,r){return this.tiles.filter(n=>n.key===`${t}_${r}_${e}`)[0]}clear(){for(let e of this.cacheTiles.values())e.isLoading?e.abortLoad():this.onTileUnload(e);this.lastViewStates=void 0,this.cacheTiles.clear(),this.currentTiles=[]}destroy(){this.clear(),this.removeAllListeners()}updateTileVisible(){let e=this.options.updateStrategy,t=new Map;for(let e of this.cacheTiles.values())t.set(e.key,e.isVisible),e.isCurrent=!1,e.isVisible=!1;for(let e of this.currentTiles)e.isCurrent=!0,e.isVisible=!0;let r=Array.from(this.cacheTiles.values());"function"==typeof e?e(r):tK[e](r);let n=!1;Array.from(this.cacheTiles.values()).forEach(e=>{e.isVisible!==t.get(e.key)?(e.isVisibleChange=!0,n=!0):e.isVisibleChange=!1}),n&&this.emit("tile-update")}getTileIndices(e,t){let{tileSize:r,extent:n,zoomOffset:i}=this.options;return function({zoom:e,latLonBounds:t,maxZoom:r=1/0,minZoom:n=0,zoomOffset:i=0,extent:o=tq}){let a=Math.ceil(e)+i;if(Number.isFinite(n)&&a<n)return[];Number.isFinite(r)&&a>r&&(a=r);let[s,l,u,c]=t,h=[Math.max(s,o[0]),Math.max(l,o[1]),Math.min(u,o[2]),Math.min(c,o[3])],d=[],[p,f]=tJ(h[0],h[1],a),[g,m]=tJ(h[2],h[3],a);for(let e=p;e<=g;e++)for(let t=m;t<=f;t++)d.push({x:e,y:t,z:a});let v=(g+p)/2,y=(f+m)/2,_=(e,t)=>Math.abs(e-v)+Math.abs(t-y);return d.sort((e,t)=>_(e.x,e.y)-_(t.x,t.y)),d}({maxZoom:Math.floor(this.options.maxZoom),minZoom:Math.ceil(this.options.minZoom),zoomOffset:i,tileSize:r,zoom:e,latLonBounds:t,extent:n})}getTileId(e,t,r){return`${e},${t},${r}`}loadFinished(){let e=!this.currentTiles.some(e=>!e.isDone);return e&&this.emit("tiles-load-finished"),e}getTile(e,t,r){let n=this.getTileId(e,t,r);return this.cacheTiles.get(n)}createTile(e,t,r){let n=this.getTileId(e,t,r),i=new t4({x:e,y:t,z:r,tileSize:this.options.tileSize,warp:this.options.warp});return this.cacheTiles.set(n,i),i.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),i}resizeCacheTiles(){let e=5*this.currentTiles.length;if(this.cacheTiles.size>e){for(let[t,r]of this.cacheTiles)if(r.isVisible||this.currentTiles.includes(r)||(this.cacheTiles.delete(t),this.onTileUnload(r)),this.cacheTiles.size<=e)break}this.rebuildTileTree()}rebuildTileTree(){for(let e of this.cacheTiles.values())e.parent=null,e.children.length=0;for(let e of this.cacheTiles.values()){let t=this.getNearestAncestor(e.x,e.y,e.z);e.parent=t,(null==t?void 0:t.children)&&t.children.push(e)}}getNearestAncestor(e,t,r){for(;r>this.options.minZoom;){e=Math.floor(e/2),t=Math.floor(t/2),r-=1;let n=this.getTile(e,t,r);if(n)return n}return null}};function ru(e){let t=[],r=/\{([a-z])-([a-z])\}/.exec(e);if(r){let n;let i=r[1].charCodeAt(0),o=r[2].charCodeAt(0);for(n=i;n<=o;++n)t.push(e.replace(r[0],String.fromCharCode(n)));return t}if(r=/\{(\d+)-(\d+)\}/.exec(e)){let n=parseInt(r[2],10);for(let i=parseInt(r[1],10);i<=n;i++)t.push(e.replace(r[0],i.toString()));return t}return t.push(e),t}function rc(e,t){if(!e||!e.length)throw Error("url is not allowed to be empty");let{x:r,y:n,z:i}=t,o=ru(e),a=Math.abs(r+n)%o.length;return(z(o[a])?`${o[a]}/{z}/{x}/{y}`:o[a]).replace(/\{x\}/g,r.toString()).replace(/\{y\}/g,n.toString()).replace(/\{z\}/g,i.toString()).replace(/\{bbox\}/g,t1(r,n,i).join(",")).replace(/\{-y\}/g,(Math.pow(2,i)-n-1).toString())}function rh(e,t){return null==e?t:e}var rd=r(73834),rp=r.n(rd);function rf(e){return!!Array.isArray(e)&&(0===e.length||"number"==typeof e[0])}function rg(e){let t=Object.isFrozen(e)?th.cloneDeep(e):e;return rp()(t,!0),t}function rm(e,t){return e||[[t[0],t[3]],[t[2],t[3]],[t[2],t[1]],[t[0],t[1]]]}var rv=Object.defineProperty,ry=Object.defineProperties,r_=Object.getOwnPropertyDescriptors,rb=Object.getOwnPropertySymbols,rx=Object.prototype.hasOwnProperty,rS=Object.prototype.propertyIsEnumerable,rA=(e,t,r)=>t in e?rv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,rE=(e,t)=>{for(var r in t||(t={}))rx.call(t,r)&&rA(e,r,t[r]);if(rb)for(var r of rb(t))rS.call(t,r)&&rA(e,r,t[r]);return e},rT=(e,t)=>ry(e,r_(t));function rC(e,t){let{x:r,y:n,x1:i,y1:o,coordinates:a,geometry:s}=t,l=[];if(!Array.isArray(e))return{dataArray:[]};if(s)return e.filter(e=>e[s]&&e[s].type&&e[s].coordinates&&e[s].coordinates.length>0).forEach((e,t)=>{w(rg(e[s]),r=>{let n=T(r),i=rT(rE({},e),{_id:t,coordinates:n});l.push(i)})}),{dataArray:l};for(let t=0;t<e.length;t++){let s=e[t],u=[];if(a){let e="Polygon";Array.isArray(a[0])||(e="Point"),Array.isArray(a[0])&&!Array.isArray(a[0][0])&&(e="LineString"),u=rg({type:e,coordinates:s[a]}).coordinates}else r&&n&&i&&o?u=[[parseFloat(s[r]),parseFloat(s[n])],[parseFloat(s[i]),parseFloat(s[o])]]:r&&n&&(u=[parseFloat(s[r]),parseFloat(s[n])]);let c=rT(rE({},s),{_id:t,coordinates:u});l.push(c)}return{dataArray:l}}var rw=Object.defineProperty,rL=Object.defineProperties,rM=Object.getOwnPropertyDescriptors,rO=Object.getOwnPropertySymbols,rI=Object.prototype.hasOwnProperty,rP=Object.prototype.propertyIsEnumerable,rR=(e,t,r)=>t in e?rw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,rk=(e,t)=>{for(var r in t||(t={}))rI.call(t,r)&&rR(e,r,t[r]);if(rO)for(var r of rO(t))rP.call(t,r)&&rR(e,r,t[r]);return e},rN=(e,t)=>rL(e,rM(t));function rD(e,t,r,n){var i={id:void 0===e?null:e,type:t,geometry:r,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(e){var t=e.geometry,r=e.type;if("Point"===r||"MultiPoint"===r||"LineString"===r)rU(e,t);else if("Polygon"===r||"MultiLineString"===r)for(var n=0;n<t.length;n++)rU(e,t[n]);else if("MultiPolygon"===r)for(n=0;n<t.length;n++)for(var i=0;i<t[n].length;i++)rU(e,t[n][i])}(i),i}function rU(e,t){for(var r=0;r<t.length;r+=3)e.minX=Math.min(e.minX,t[r]),e.minY=Math.min(e.minY,t[r+1]),e.maxX=Math.max(e.maxX,t[r]),e.maxY=Math.max(e.maxY,t[r+1])}function rz(e,t,r,n){if(t.geometry){var i=t.geometry.coordinates,o=t.geometry.type,a=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),s=[],l=t.id;if(r.promoteId?l=t.properties[r.promoteId]:r.generateId&&(l=n||0),"Point"===o)rB(i,s);else if("MultiPoint"===o)for(var u=0;u<i.length;u++)rB(i[u],s);else if("LineString"===o)rF(i,s,a,!1);else if("MultiLineString"===o){if(r.lineMetrics){for(u=0;u<i.length;u++)s=[],rF(i[u],s,a,!1),e.push(rD(l,"LineString",s,t.properties));return}rj(i,s,a,!1)}else if("Polygon"===o)rj(i,s,a,!0);else if("MultiPolygon"===o)for(u=0;u<i.length;u++){var c=[];rj(i[u],c,a,!0),s.push(c)}else if("GeometryCollection"===o){for(u=0;u<t.geometry.geometries.length;u++)rz(e,{id:l,geometry:t.geometry.geometries[u],properties:t.properties},r,n);return}else throw Error("Input data is not a valid GeoJSON object.");e.push(rD(l,o,s,t.properties))}}function rB(e,t){t.push(e[0]/360+.5),t.push(rV(e[1])),t.push(0)}function rF(e,t,r,n){for(var i,o,a=0,s=0;s<e.length;s++){var l=e[s][0]/360+.5,u=rV(e[s][1]);t.push(l),t.push(u),t.push(0),s>0&&(n?a+=(i*u-l*o)/2:a+=Math.sqrt(Math.pow(l-i,2)+Math.pow(u-o,2))),i=l,o=u}var c=t.length-3;t[2]=1,function e(t,r,n,i){for(var o,a=i,s=n-r>>1,l=n-r,u=t[r],c=t[r+1],h=t[n],d=t[n+1],p=r+3;p<n;p+=3){var f=function(e,t,r,n,i,o){var a=i-r,s=o-n;if(0!==a||0!==s){var l=((e-r)*a+(t-n)*s)/(a*a+s*s);l>1?(r=i,n=o):l>0&&(r+=a*l,n+=s*l)}return(a=e-r)*a+(s=t-n)*s}(t[p],t[p+1],u,c,h,d);if(f>a)o=p,a=f;else if(f===a){var g=Math.abs(p-s);g<l&&(o=p,l=g)}}a>i&&(o-r>3&&e(t,r,o,i),t[o+2]=a,n-o>3&&e(t,o,n,i))}(t,0,c,r),t[c+2]=1,t.size=Math.abs(a),t.start=0,t.end=t.size}function rj(e,t,r,n){for(var i=0;i<e.length;i++){var o=[];rF(e[i],o,r,n),t.push(o)}}function rV(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function rH(e,t,r,n,i,o,a,s){if(r/=t,n/=t,o>=r&&a<n)return e;if(a<r||o>=n)return null;for(var l=[],u=0;u<e.length;u++){var c=e[u],h=c.geometry,d=c.type,p=0===i?c.minX:c.minY,f=0===i?c.maxX:c.maxY;if(p>=r&&f<n){l.push(c);continue}if(!(f<r)&&!(p>=n)){var g=[];if("Point"===d||"MultiPoint"===d)!function(e,t,r,n,i){for(var o=0;o<e.length;o+=3){var a=e[o+i];a>=r&&a<=n&&(t.push(e[o]),t.push(e[o+1]),t.push(e[o+2]))}}(h,g,r,n,i);else if("LineString"===d)rG(h,g,r,n,i,!1,s.lineMetrics);else if("MultiLineString"===d)rX(h,g,r,n,i,!1);else if("Polygon"===d)rX(h,g,r,n,i,!0);else if("MultiPolygon"===d)for(var m=0;m<h.length;m++){var v=[];rX(h[m],v,r,n,i,!0),v.length&&g.push(v)}if(g.length){if(s.lineMetrics&&"LineString"===d){for(m=0;m<g.length;m++)l.push(rD(c.id,d,g[m],c.tags));continue}("LineString"===d||"MultiLineString"===d)&&(1===g.length?(d="LineString",g=g[0]):d="MultiLineString"),("Point"===d||"MultiPoint"===d)&&(d=3===g.length?"Point":"MultiPoint"),l.push(rD(c.id,d,g,c.tags))}}}return l.length?l:null}function rG(e,t,r,n,i,o,a){for(var s,l,u=rW(e),c=0===i?rZ:rY,h=e.start,d=0;d<e.length-3;d+=3){var p=e[d],f=e[d+1],g=e[d+2],m=e[d+3],v=e[d+4],y=0===i?p:f,_=0===i?m:v,b=!1;a&&(s=Math.sqrt(Math.pow(p-m,2)+Math.pow(f-v,2))),y<r?_>r&&(l=c(u,p,f,m,v,r),a&&(u.start=h+s*l)):y>n?_<n&&(l=c(u,p,f,m,v,n),a&&(u.start=h+s*l)):r$(u,p,f,g),_<r&&y>=r&&(l=c(u,p,f,m,v,r),b=!0),_>n&&y<=n&&(l=c(u,p,f,m,v,n),b=!0),!o&&b&&(a&&(u.end=h+s*l),t.push(u),u=rW(e)),a&&(h+=s)}var x=e.length-3;p=e[x],f=e[x+1],g=e[x+2],(y=0===i?p:f)>=r&&y<=n&&r$(u,p,f,g),x=u.length-3,o&&x>=3&&(u[x]!==u[0]||u[x+1]!==u[1])&&r$(u,u[0],u[1],u[2]),u.length&&t.push(u)}function rW(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function rX(e,t,r,n,i,o){for(var a=0;a<e.length;a++)rG(e[a],t,r,n,i,o,!1)}function r$(e,t,r,n){e.push(t),e.push(r),e.push(n)}function rZ(e,t,r,n,i,o){var a=(o-t)/(n-t);return e.push(o),e.push(r+(i-r)*a),e.push(1),a}function rY(e,t,r,n,i,o){var a=(o-r)/(i-r);return e.push(t+(n-t)*a),e.push(o),e.push(1),a}function rq(e,t){for(var r=[],n=0;n<e.length;n++){var i,o=e[n],a=o.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)i=rK(o.geometry,t);else if("MultiLineString"===a||"Polygon"===a){i=[];for(var s=0;s<o.geometry.length;s++)i.push(rK(o.geometry[s],t))}else if("MultiPolygon"===a)for(s=0,i=[];s<o.geometry.length;s++){for(var l=[],u=0;u<o.geometry[s].length;u++)l.push(rK(o.geometry[s][u],t));i.push(l)}r.push(rD(o.id,a,i,o.tags))}return r}function rK(e,t){var r=[];r.size=e.size,void 0!==e.start&&(r.start=e.start,r.end=e.end);for(var n=0;n<e.length;n+=3)r.push(e[n]+t,e[n+1],e[n+2]);return r}function rQ(e,t){if(e.transformed)return e;var r,n,i,o=1<<e.z,a=e.x,s=e.y;for(r=0;r<e.features.length;r++){var l=e.features[r],u=l.geometry,c=l.type;if(l.geometry=[],1===c)for(n=0;n<u.length;n+=2)l.geometry.push(rJ(u[n],u[n+1],t,o,a,s));else for(n=0;n<u.length;n++){var h=[];for(i=0;i<u[n].length;i+=2)h.push(rJ(u[n][i],u[n][i+1],t,o,a,s));l.geometry.push(h)}}return e.transformed=!0,e}function rJ(e,t,r,n,i,o){return[Math.round(r*(e*n-i)),Math.round(r*(t*n-o))]}function r0(e,t,r,n,i,o){var a=n*n;if(n>0&&t.size<(i?a:n)){r.numPoints+=t.length/3;return}for(var s=[],l=0;l<t.length;l+=3)(0===n||t[l+2]>a)&&(r.numSimplified++,s.push(t[l]),s.push(t[l+1])),r.numPoints++;i&&function(e,t){for(var r=0,n=0,i=e.length,o=i-2;n<i;o=n,n+=2)r+=(e[n]-e[o])*(e[n+1]+e[o+1]);if(r>0===t)for(n=0,i=e.length;n<i/2;n+=2){var a=e[n],s=e[n+1];e[n]=e[i-2-n],e[n+1]=e[i-1-n],e[i-2-n]=a,e[i-1-n]=s}}(s,o),e.push(s)}function r1(e,t){var r,n,i,o,a,s,l=(t=this.options=function(e,t){for(var r in t)e[r]=t[r];return e}(Object.create(this.options),t)).debug;if(l&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw Error("promoteId and generateId cannot be used together.");var u=function(e,t){var r=[];if("FeatureCollection"===e.type)for(var n=0;n<e.features.length;n++)rz(r,e.features[n],t,n);else"Feature"===e.type?rz(r,e,t):rz(r,{geometry:e},t);return r}(e,t);this.tiles={},this.tileCoords=[],l&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),r=u,i=(n=t).buffer/n.extent,o=r,a=rH(r,1,-1-i,i,0,-1,2,n),s=rH(r,1,1-i,2+i,0,-1,2,n),(a||s)&&(o=rH(r,1,-i,1+i,0,-1,2,n)||[],a&&(o=rq(a,1).concat(o)),s&&(o=o.concat(rq(s,-1)))),(u=o).length&&this.splitTile(u,0,0,0),l&&(u.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function r2(e,t,r){return((1<<e)*r+t)*32+e}r1.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},r1.prototype.splitTile=function(e,t,r,n,i,o,a){for(var s=[e,t,r,n],l=this.options,u=l.debug;s.length;){n=s.pop(),r=s.pop(),t=s.pop(),e=s.pop();var c=1<<t,h=r2(t,r,n),d=this.tiles[h];if(!d&&(u>1&&console.time("creation"),d=this.tiles[h]=function(e,t,r,n,i){for(var o=t===i.maxZoom?0:i.tolerance/((1<<t)*i.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:n,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<e.length;s++){a.numFeatures++,function(e,t,r,n){var i=t.geometry,o=t.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<i.length;s+=3)a.push(i[s]),a.push(i[s+1]),e.numPoints++,e.numSimplified++;else if("LineString"===o)r0(a,i,e,r,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<i.length;s++)r0(a,i[s],e,r,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var l=0;l<i.length;l++){var u=i[l];for(s=0;s<u.length;s++)r0(a,u[s],e,r,!0,0===s)}if(a.length){var c=t.tags||null;if("LineString"===o&&n.lineMetrics){for(var h in c={},t.tags)c[h]=t.tags[h];c.mapbox_clip_start=i.start/i.size,c.mapbox_clip_end=i.end/i.size}var d={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:c};null!==t.id&&(d.id=t.id),e.features.push(d)}}(a,e[s],o,i);var l=e[s].minX,u=e[s].minY,c=e[s].maxX,h=e[s].maxY;l<a.minX&&(a.minX=l),u<a.minY&&(a.minY=u),c>a.maxX&&(a.maxX=c),h>a.maxY&&(a.maxY=h)}return a}(e,t,r,n,l),this.tileCoords.push({z:t,x:r,y:n}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,r,n,d.numFeatures,d.numPoints,d.numSimplified),console.timeEnd("creation"));var p="z"+t;this.stats[p]=(this.stats[p]||0)+1,this.total++}if(d.source=e,i){if(t===l.maxZoom||t===i)continue;var f=1<<i-t;if(r!==Math.floor(o/f)||n!==Math.floor(a/f))continue}else if(t===l.indexMaxZoom||d.numPoints<=l.indexMaxPoints)continue;if(d.source=null,0!==e.length){u>1&&console.time("clipping");var g,m,v,y,_,b,x=.5*l.buffer/l.extent,S=.5-x,A=.5+x,E=1+x;g=m=v=y=null,_=rH(e,c,r-x,r+A,0,d.minX,d.maxX,l),b=rH(e,c,r+S,r+E,0,d.minX,d.maxX,l),e=null,_&&(g=rH(_,c,n-x,n+A,1,d.minY,d.maxY,l),m=rH(_,c,n+S,n+E,1,d.minY,d.maxY,l),_=null),b&&(v=rH(b,c,n-x,n+A,1,d.minY,d.maxY,l),y=rH(b,c,n+S,n+E,1,d.minY,d.maxY,l),b=null),u>1&&console.timeEnd("clipping"),s.push(g||[],t+1,2*r,2*n),s.push(m||[],t+1,2*r,2*n+1),s.push(v||[],t+1,2*r+1,2*n),s.push(y||[],t+1,2*r+1,2*n+1)}}},r1.prototype.getTile=function(e,t,r){var n=this.options,i=n.extent,o=n.debug;if(e<0||e>24)return null;var a=1<<e,s=r2(e,t=(t%a+a)%a,r);if(this.tiles[s])return rQ(this.tiles[s],i);o>1&&console.log("drilling down to z%d-%d-%d",e,t,r);for(var l,u=e,c=t,h=r;!l&&u>0;)u--,c=Math.floor(c/2),h=Math.floor(h/2),l=this.tiles[r2(u,c,h)];return l&&l.source?(o>1&&console.log("found parent tile z%d-%d-%d",u,c,h),o>1&&console.time("drilling down"),this.splitTile(l.source,u,c,h,e,t,r),o>1&&console.timeEnd("drilling down"),this.tiles[s]?rQ(this.tiles[s],i):null):null};var r3=class{constructor(e,t,r,n){this.vectorLayerCache={},this.x=t,this.y=r,this.z=n,this.vectorTile=e}getTileData(e){return e&&this.vectorTile.layers[e]?this.vectorLayerCache[e]?this.vectorLayerCache[e]:this.vectorTile.layers[e].features:[]}getFeatureById(){throw Error("Method not implemented.")}},r4=Object.defineProperty,r5=Object.defineProperties,r6=Object.getOwnPropertyDescriptors,r7=Object.getOwnPropertySymbols,r8=Object.prototype.hasOwnProperty,r9=Object.prototype.propertyIsEnumerable,ne=(e,t,r)=>t in e?r4(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,nt=(e,t)=>{for(var r in t||(t={}))r8.call(t,r)&&ne(e,r,t[r]);if(r7)for(var r of r7(t))r9.call(t,r)&&ne(e,r,t[r]);return e},nr=(e,t)=>r5(e,r6(t)),nn=(e,t,r)=>new Promise((n,i)=>{var o=e=>{try{s(r.next(e))}catch(e){i(e)}},a=e=>{try{s(r.throw(e))}catch(e){i(e)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,a);s((r=r.apply(e,t)).next())}),ni={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0},no=["Unknown","Point","LineString","Polygon"],na=(e,t,r,n)=>nn(void 0,null,function*(){return new Promise(i=>{let o=t.getTile(e.z,e.x,e.y);i(new r3({layers:{defaultLayer:{features:o?o.features.map(e=>(function(e,t,r,n,i){let o,a,s=i.geometry,l=i.type,u=i.tags,c=i.id,h=e*Math.pow(2,n),d=e*t,p=e*r,f=no[l];function g(e){for(let t=0;t<e.length;t++){let r=e[t];if(r[3])break;let n=180-(r[1]+p)*360/h,i=(r[0]+d)*360/h-180,o=360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90;e[t]=[i,o,0,1]}}switch(l){case 1:let m=[];for(o=0;o<s.length;o++)m[o]=s[o][0];g(s=m);break;case 2:for(o=0;o<s.length;o++)g(s[o]);break;case 3:for(o=0,s=function(e){let t,r;let n=e.length;if(n<=1)return[e];let i=[];for(let o=0;o<n;o++){let n=function(e){let t=0;for(let r=0,n=e.length,i=n-1,o,a;r<n;i=r++)o=e[r],t+=((a=e[i]).x-o.x)*(o.y+a.y);return t}(e[o]);0!==n&&(void 0===r&&(r=n<0),r===n<0?(t&&i.push(t),t=[e[o]]):t.push(e[o]))}return t&&i.push(t),i}(s);o<s.length;o++)for(a=0;a<s[o].length;a++)g(s[o][a])}return 1===s.length?s=s[0]:f="Multi"+f,{type:"Feature",geometry:{type:f,coordinates:s},properties:u,id:c,tileOrigin:[0,0],coord:""}})(n,r.x,r.y,r.z,e)):[]}}},e.x,e.y,e.z))})}),ns=Object.defineProperty,nl=Object.defineProperties,nu=Object.getOwnPropertyDescriptors,nc=Object.getOwnPropertySymbols,nh=Object.prototype.hasOwnProperty,nd=Object.prototype.propertyIsEnumerable,np=(e,t,r)=>t in e?ns(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,nf=(e,t)=>{for(var r in t||(t={}))nh.call(t,r)&&np(e,r,t[r]);if(nc)for(var r of nc(t))nd.call(t,r)&&np(e,r,t[r]);return e},ng=(e,t)=>nl(e,nu(t)),nm=Object.defineProperty,nv=Object.defineProperties,ny=Object.getOwnPropertyDescriptors,n_=Object.getOwnPropertySymbols,nb=Object.prototype.hasOwnProperty,nx=Object.prototype.propertyIsEnumerable,nS=(e,t,r)=>t in e?nm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,nA=(e,t)=>{for(var r in t||(t={}))nb.call(t,r)&&nS(e,r,t[r]);if(n_)for(var r of n_(t))nx.call(t,r)&&nS(e,r,t[r]);return e},nE=(e,t)=>nv(e,ny(t)),nT=(e,t,r)=>new Promise((n,i)=>{var o=e=>{try{s(r.next(e))}catch(e){i(e)}},a=e=>{try{s(r.throw(e))}catch(e){i(e)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,a);s((r=r.apply(e,t)).next())}),nC=(e,t,r,n)=>nT(void 0,null,function*(){let i={x:t.x,y:t.y,z:t.z},o=rc(e,i);return new Promise(e=>{n?n(i,(r,n)=>{r||!n?e(new r3({layers:{defaultLayer:{features:[]}}},t.x,t.y,t.z)):e(new r3({layers:{defaultLayer:{features:n.features}}},t.x,t.y,t.z))}):G(nE(nA({},r),{url:o}),(r,n)=>{r||!n?e(new r3({layers:{defaultLayer:{features:[]}}},t.x,t.y,t.z)):e(new r3({layers:{defaultLayer:{features:JSON.parse(n)}}},t.x,t.y,t.z))})})}),nw=r(72184),nL=r(70551),nM=r.n(nL),nO=Object.defineProperty,nI=Object.defineProperties,nP=Object.getOwnPropertyDescriptors,nR=Object.getOwnPropertySymbols,nk=Object.prototype.hasOwnProperty,nN=Object.prototype.propertyIsEnumerable,nD=(e,t,r)=>t in e?nO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,nU=(e,t)=>{for(var r in t||(t={}))nk.call(t,r)&&nD(e,r,t[r]);if(nR)for(var r of nR(t))nN.call(t,r)&&nD(e,r,t[r]);return e},nz=(e,t)=>nI(e,nP(t)),nB=class{constructor(e,t,r,n){this.vectorLayerCache={},this.x=t,this.y=r,this.z=n,this.vectorTile=new nw.VectorTile(new(nM())(e))}getTileData(e){if(!e||!this.vectorTile.layers[e])return[];if(this.vectorLayerCache[e])return this.vectorLayerCache[e];let t=this.vectorTile.layers[e];if(Array.isArray(t.features))return this.vectorLayerCache[e]=t.features,t.features;let r=[];for(let e=0;e<t.length;e++){let n=t.feature(e).toGeoJSON(this.x,this.y,this.z);r.push(nz(nU({},n),{properties:nU({id:n.id},n.properties)}))}return this.vectorLayerCache[e]=r,r}getFeatureById(){throw Error("Method not implemented.")}},nF=Object.defineProperty,nj=Object.defineProperties,nV=Object.getOwnPropertyDescriptors,nH=Object.getOwnPropertySymbols,nG=Object.prototype.hasOwnProperty,nW=Object.prototype.propertyIsEnumerable,nX=(e,t,r)=>t in e?nF(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,n$=(e,t)=>{for(var r in t||(t={}))nG.call(t,r)&&nX(e,r,t[r]);if(nH)for(var r of nH(t))nW.call(t,r)&&nX(e,r,t[r]);return e},nZ=(e,t)=>nj(e,nV(t)),nY=(e,t,r)=>new Promise((n,i)=>{var o=e=>{try{s(r.next(e))}catch(e){i(e)}},a=e=>{try{s(r.throw(e))}catch(e){i(e)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,a);s((r=r.apply(e,t)).next())}),nq={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},nK=(e,t,r,n,i)=>nY(void 0,null,function*(){let o=rc(e,t);return new Promise(e=>{if(i)i({x:r.x,y:r.y,z:r.z},(t,n)=>{t||!n?e(void 0):e(new nB(n,r.x,r.y,r.z))});else{let t=H(nZ(n$({},n),{url:o}),(t,n)=>{t||!n?e(void 0):e(new nB(n,r.x,r.y,r.z))});r.xhrCancel=()=>t.cancel()}})});function nQ(e,t){let{width:r,height:n}=t[0],i=t.map(e=>e.rasterData),o=r*n,a=[],s=JSON.stringify(e);for(let e=0;e<o;e++){let t=JSON.parse(s),r=function e(t,r,n){if(2===t.length&&"band"===t[0]&&"number"==typeof t[1])try{return r[t[1]][n]}catch(e){return console.warn("Raster Data err!"),0}t.map((i,o)=>{if(Array.isArray(i)&&i.length>0){if("band"===i[0])try{t[o]=r[i[1]][n]}catch(e){console.warn("Raster Data err!"),t[o]=0}else e(i,r,n)}})}(t,i,e);if("number"==typeof r)a.push(r);else{let e=function e(t){let r=function(e){let[t,r=-1,n=-1]=e;return void 0===t?(console.warn("Express err!"),["+",0,0]):[t.replace(/\s+/g,""),r,n]}(t),n=r[0],i=r[1],o=r[2];return Array.isArray(i)&&(i=e(t[1])),Array.isArray(o)&&(o=e(t[2])),function(e,t,r){switch(e){case"+":return t+r;case"-":return t-r;case"*":return t*r;case"/":return t/r;case"%":return t%r;case"^":return Math.pow(t,r);case"abs":return Math.abs(t);case"floor":return Math.floor(t);case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"sin":return Math.sin(t);case"cos":return Math.cos(t);case"atan":return -1===r?Math.atan(t):Math.atan2(t,r);case"min":return Math.min(t,r);case"max":return Math.max(t,r);case"log10":return Math.log(t);case"log2":return Math.log2(t);default:return console.warn("Calculate symbol err! Return default 0"),0}}(n,i,o)}(t);a.push(e)}}return a}var nJ={nd:{type:"operation",expression:["/",["-",["band",1],["band",0]],["+",["band",1],["band",0]]]},rgb:{type:"function",method:function(e,t){let r=e[0].rasterData,n=e[1].rasterData,i=e[2].rasterData,o=[],[a,s]=(null==t?void 0:t.countCut)||[2,98],l=(null==t?void 0:t.RMinMax)||n0(r,a,s),u=(null==t?void 0:t.GMinMax)||n0(n,a,s),c=(null==t?void 0:t.BMinMax)||n0(i,a,s);for(let e=0;e<r.length;e++)o.push(Math.max(0,r[e]-l[0])),o.push(Math.max(0,n[e]-u[0])),o.push(Math.max(0,i[e]-c[0]));return{rasterData:o,rMinMax:l,gMinMax:u,bMinMax:c}}}};function n0(e,t,r){let n=e.slice().sort((e,t)=>e-t),i=n.length;return[n[Math.ceil(i*t/100)],n[Math.ceil(i*r/100)]]}var n1=Object.defineProperty,n2=Object.defineProperties,n3=Object.getOwnPropertyDescriptors,n4=Object.getOwnPropertySymbols,n5=Object.prototype.hasOwnProperty,n6=Object.prototype.propertyIsEnumerable,n7=(e,t,r)=>t in e?n1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,n8=(e,t)=>{for(var r in t||(t={}))n5.call(t,r)&&n7(e,r,t[r]);if(n4)for(var r of n4(t))n6.call(t,r)&&n7(e,r,t[r]);return e},n9=(e,t)=>n2(e,n3(t)),ie=(e,t,r)=>new Promise((n,i)=>{var o=e=>{try{s(r.next(e))}catch(e){i(e)}},a=e=>{try{s(r.throw(e))}catch(e){i(e)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,a);s((r=r.apply(e,t)).next())});function it(e,t,r){return ie(this,null,function*(){let n;if(0===e.length)return{rasterData:[0],width:1,heigh:1};let i=yield Promise.all(e.map(({data:e,bands:r=[0]})=>t(e,r))),o=[];i.forEach(e=>{Array.isArray(e)?o.push(...e):o.push(e)});let{width:a,height:s}=o[0];switch(typeof r){case"function":n=r(o);break;case"object":n=Array.isArray(r)?{rasterData:nQ(r,o)}:function(e,t){var r,n;let i=nJ[e.type];return"function"===i.type?i.method(t,null==e?void 0:e.options):"operation"===i.type?"rgb"===e.type?(r=i.expression,n=t,void 0===r.r&&console.warn("Channel R lost in Operation! Use band[0] to fill!"),void 0===r.g&&console.warn("Channel G lost in Operation! Use band[0] to fill!"),void 0===r.b&&console.warn("Channel B lost in Operation! Use band[0] to fill!"),[nQ(r.r||["band",0],n),nQ(r.g||["band",0],n),nQ(r.b||["band",0],n)]):{rasterData:nQ(i.expression,t)}:void 0}(r,o);break;default:n={rasterData:o[0].rasterData}}return n9(n8({},n),{width:a,height:s})})}function ir(e,t,r,n){return ie(this,null,function*(){n(null,{data:yield it(e,t,r)})})}function ii(e){return(ii="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function io(e){var t=function(e,t){if("object"!=ii(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ii(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ii(t)?t:t+""}function ia(e,t,r){return(t=io(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function is(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function il(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?is(Object(r),!0).forEach(function(t){ia(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):is(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let iu=function(e){return e.Normal="normal",e.PostProcessing="post-processing",e}({}),ic=function(e){return e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.MAX_EXT=32776]="MAX_EXT",e[e.MIN_EXT=32775]="MIN_EXT",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.CULL_FACE=2884]="CULL_FACE",e[e.BLEND=3042]="BLEND",e[e.DITHER=3024]="DITHER",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.RED=6403]="RED",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.TEXTURE1=33985]="TEXTURE1",e[e.TEXTURE2=33986]="TEXTURE2",e[e.TEXTURE3=33987]="TEXTURE3",e[e.TEXTURE4=33988]="TEXTURE4",e[e.TEXTURE5=33989]="TEXTURE5",e[e.TEXTURE6=33990]="TEXTURE6",e[e.TEXTURE7=33991]="TEXTURE7",e[e.TEXTURE8=33992]="TEXTURE8",e[e.TEXTURE9=33993]="TEXTURE9",e[e.TEXTURE10=33994]="TEXTURE10",e[e.TEXTURE11=33995]="TEXTURE11",e[e.TEXTURE12=33996]="TEXTURE12",e[e.TEXTURE13=33997]="TEXTURE13",e[e.TEXTURE14=33998]="TEXTURE14",e[e.TEXTURE15=33999]="TEXTURE15",e[e.TEXTURE16=34e3]="TEXTURE16",e[e.TEXTURE17=34001]="TEXTURE17",e[e.TEXTURE18=34002]="TEXTURE18",e[e.TEXTURE19=34003]="TEXTURE19",e[e.TEXTURE20=34004]="TEXTURE20",e[e.TEXTURE21=34005]="TEXTURE21",e[e.TEXTURE22=34006]="TEXTURE22",e[e.TEXTURE23=34007]="TEXTURE23",e[e.TEXTURE24=34008]="TEXTURE24",e[e.TEXTURE25=34009]="TEXTURE25",e[e.TEXTURE26=34010]="TEXTURE26",e[e.TEXTURE27=34011]="TEXTURE27",e[e.TEXTURE28=34012]="TEXTURE28",e[e.TEXTURE29=34013]="TEXTURE29",e[e.TEXTURE30=34014]="TEXTURE30",e[e.TEXTURE31=34015]="TEXTURE31",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e}({}),{camelCase:ih,isNil:id,upperFirst:ip}=th;class ig{constructor(){ia(this,"shaderModuleService",void 0),ia(this,"rendererService",void 0),ia(this,"config",void 0),ia(this,"quad","attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}"),ia(this,"enabled",!0),ia(this,"renderToScreen",!1),ia(this,"model",void 0),ia(this,"name",void 0),ia(this,"optionsToUpdate",{})}getName(){return this.name}setName(e){this.name=e}getType(){return iu.PostProcessing}init(e,t){this.config=t,this.rendererService=e.getContainer().rendererService,this.shaderModuleService=e.getContainer().shaderModuleService;let{createAttribute:r,createBuffer:n,createModel:i}=this.rendererService,{vs:o,fs:a,uniforms:s}=this.setupShaders();this.model=i({vs:o,fs:a,attributes:{a_Position:r({buffer:n({data:[-4,-4,4,-4,0,4],type:ic.FLOAT}),size:2})},uniforms:il(il({u_Texture:null},s),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:"copy"===this.getName()}})}render(e,t){let r=e.multiPassRenderer.getPostProcessor(),{useFramebuffer:n,getViewportSize:i,clear:o}=this.rendererService,{width:a,height:s}=i();n(this.renderToScreen?null:r.getWriteFBO(),()=>{o({framebuffer:r.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0});let e=il({u_BloomFinal:0,u_Texture:r.getReadFBO(),u_ViewportSize:[a,s]},this.convertOptionsToUniforms(this.optionsToUpdate));t&&(e.u_BloomFinal=1,e.u_Texture2=t),this.model.draw({uniforms:e})})}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}setRenderToScreen(e){this.renderToScreen=e}updateOptions(e){this.optionsToUpdate=il(il({},this.optionsToUpdate),e)}setupShaders(){throw Error("Method not implemented.")}convertOptionsToUniforms(e){let t={};return Object.keys(e).forEach(r=>{id(e[r])||(t[`u_${ip(ih(r))}`]=e[r])}),t}}let im=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function iv(e,t=!1){let r={};return{content:e=e.replace(im,(e,n,i)=>{let o=i.split(":"),a=o[0].trim(),s="";switch(o.length>1&&(s=o[1].trim()),n){case"bool":s="true"===s;break;case"float":case"int":s=Number(s);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":s=s?s.replace("[","").replace("]","").split(",").reduce((e,t)=>(e.push(Number(t.trim())),e),[]):Array(function(e){let t=0;switch(e){case"vec2":case"ivec2":t=2;break;case"vec3":case"ivec3":t=3;break;case"vec4":case"ivec4":case"mat2":t=4;break;case"mat3":t=9;break;case"mat4":t=16}return t}(n)).fill(0)}return r[a]=s,`${t?"uniform ":""}${n} ${a};
`}),uniforms:r}}function iy(e){let{content:t,uniforms:r}=iv(e,!0);return{content:t=t.replace(/(\s*uniform\s*.*\s*){((?:\s*.*\s*)*?)};/g,(e,t,n)=>{let{content:i,uniforms:o}=iv(n=n.trim().replace(/^.*$/gm,e=>`uniform ${e}`));return Object.assign(r,o),`${t}{
${i}
};`}),uniforms:r}}function i_(e){let t={};return e.replace(im,(e,r,n)=>{let i=n.trim();return t[i]?"":(t[i]=!0,`uniform ${r} ${i};
`)})}let{clamp:ib}=th,ix={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"},iS=function(e){return e.TOPRIGHT="topright",e.TOPLEFT="topleft",e.BOTTOMRIGHT="bottomright",e.BOTTOMLEFT="bottomleft",e.TOPCENTER="topcenter",e.BOTTOMCENTER="bottomcenter",e.LEFTCENTER="leftcenter",e.RIGHTCENTER="rightcenter",e.LEFTTOP="lefttop",e.RIGHTTOP="righttop",e.LEFTBOTTOM="leftbottom",e.RIGHTBOTTOM="rightbottom",e}({}),iA=function(e){return e[e.LNGLAT=1]="LNGLAT",e[e.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",e[e.VECTOR_TILE=3]="VECTOR_TILE",e[e.IDENTITY=4]="IDENTITY",e[e.METER_OFFSET=5]="METER_OFFSET",e}({}),iE={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter"};var iT={LayerInitStart:"layerInitStart",LayerInitEnd:"layerInitEnd",SourceInitStart:"sourceInitStart",SourceInitEnd:"sourceInitEnd",ScaleInitStart:"scaleInitStart",ScaleInitEnd:"scaleInitEnd",MappingStart:"mappingStart",MappingEnd:"mappingEnd",BuildModelStart:"buildModelStart",BuildModelEnd:"buildModelEnd"};let iC=function(e){return e.Hover="hover",e.Click="click",e.Select="select",e.Active="active",e.Drag="drag",e}({}),iw=function(e){return e.normal="normal",e.additive="additive",e.subtractive="subtractive",e.min="min",e.max="max",e.none="none",e}({}),iL=function(e){return e.MULTIPLE="MULTIPLE",e.SINGLE="SINGLE",e}({}),iM=function(e){return e.AND="and",e.OR="or",e}({}),iO=function(e){return e.INIT="init",e.UPDATE="update",e}({}),iI=function(e){return e.LINEAR="linear",e.SEQUENTIAL="sequential",e.POWER="power",e.LOG="log",e.IDENTITY="identity",e.TIME="time",e.QUANTILE="quantile",e.QUANTIZE="quantize",e.THRESHOLD="threshold",e.CAT="cat",e.DIVERGING="diverging",e.CUSTOM="threshold",e}({}),iP=function(e){return e.CONSTANT="constant",e.VARIABLE="variable",e}({}),iR=function(e){return e[e.Attribute=0]="Attribute",e[e.InstancedAttribute=1]="InstancedAttribute",e[e.Uniform=2]="Uniform",e}({}),ik=["mapload","mapchange","mapAfterFrameChange"];var iN=r(57197),iD=r.n(iN);function iU(e,t,r){for(let n of t){let{icon:t,xOffset:i}=n;e[t.id]=il(il({},t),{},{x:i,y:r,image:t.image,width:t.width,height:t.height})}}function iz(e){return Math.pow(2,Math.ceil(Math.log2(e)))}let iB=function(){let e=[];for(let t=32;t<128;t++)e.push(String.fromCharCode(t));return e}();function iF(e,t,r,n){e.font=`${n} ${r}px ${t}`,e.fillStyle="black",e.textBaseline="middle"}function ij(e,t){for(let r=0;r<e.length;r++)t.data[4*r+3]=e[r]}class iV extends tG.EventEmitter{constructor(...e){super(...e),ia(this,"fontAtlas",void 0),ia(this,"iconFontMap",void 0),ia(this,"iconFontGlyphs",{}),ia(this,"fontOptions",void 0),ia(this,"key",void 0),ia(this,"cache",new tF(3))}get scale(){return 1}get canvas(){let e=this.cache.get(this.key);return e&&e.data}get mapping(){let e=this.cache.get(this.key);return e&&e.mapping||{}}getCanvasByKey(e){let t=this.cache.get(e);return t&&t.data}getMappingByKey(e){let t=this.cache.get(e);return t&&t.mapping||{}}init(){this.cache.clear(),this.fontOptions={fontFamily:"sans-serif",fontWeight:"normal",characterSet:iB,fontSize:24,buffer:3,sdf:!0,cutoff:.25,radius:8,iconfont:!1},this.key="",this.iconFontMap=new Map}addIconGlyphs(e){e.forEach(e=>{this.iconFontGlyphs[e.name]=e.unicode})}addIconFont(e,t){this.iconFontMap.set(e,t)}getIconFontKey(e){return this.iconFontMap.get(e)||e}getGlyph(e){return this.iconFontGlyphs[e]?String.fromCharCode(parseInt(this.iconFontGlyphs[e],16)):""}setFontOptions(e){this.fontOptions=il(il({},this.fontOptions),e),this.key=this.getKey();let t=this.getNewChars(this.key,this.fontOptions.characterSet),r=this.cache.get(this.key);if(r&&0===t.length)return;let n=this.generateFontAtlas(this.key,t,r);this.fontAtlas=n,this.cache.set(this.key,n)}addFontFace(e,t){let r=document.createElement("style");r.type="text/css",r.innerText=`
        @font-face{
            font-family: '${e}';
            src: url('${t}') format('woff2'),
            url('${t}') format('woff'),
            url('${t}') format('truetype');
        }`,r.onload=()=>{if(document.fonts)try{document.fonts.load(`24px ${e}`,"L7text"),document.fonts.ready.then(()=>{this.emit("fontloaded",{fontFamily:e})})}catch(e){console.warn("当前环境不支持 document.fonts !"),console.warn("当前环境不支持 iconfont !"),console.warn(e)}},document.getElementsByTagName("head")[0].appendChild(r)}destroy(){this.cache.clear(),this.iconFontMap.clear()}generateFontAtlas(e,t,r){let{fontFamily:n,fontWeight:i,fontSize:o,buffer:a,sdf:s,radius:l,cutoff:u,iconfont:c}=this.fontOptions,h=r&&r.data;h||((h=window.document.createElement("canvas")).width=1024);let d=h.getContext("2d",{willReadFrequently:!0});iF(d,n,o,i);let{mapping:p,canvasHeight:f,xOffset:g,yOffset:m}=function({characterSet:e,getFontWidth:t,fontHeight:r,buffer:n,maxCanvasWidth:i,mapping:o={},xOffset:a=0,yOffset:s=0}){let l=0,u=a;Array.from(e).forEach((e,r)=>{if(!o[e]){let n=t(e,r);u+30>i&&(u=0,l++),o[e]={x:u,y:s+30*l,width:30,height:30,advance:n},u+=30}});let c=r+2*n;return{mapping:o,xOffset:u,yOffset:s+l*c,canvasHeight:iz(s+(l+1)*c)}}(il({getFontWidth:e=>d.measureText(e).width,fontHeight:1*o,buffer:a,characterSet:t,maxCanvasWidth:1024},r&&{mapping:r.mapping,xOffset:r.xOffset,yOffset:r.yOffset})),v=d.getImageData(0,0,h.width,h.height);if(h.height=f,d.putImageData(v,0,0),iF(d,n,o,i),s){let e=new(iD())(o,a,l,u,n,i),r=d.getImageData(0,0,e.size,e.size);for(let n of t){if(c){let t=String.fromCharCode(parseInt(n.replace("&#x","").replace(";",""),16));ij(e.draw(t),r)}else ij(e.draw(n),r);d.putImageData(r,p[n].x,p[n].y)}}else for(let e of t)d.fillText(e,p[e].x,p[e].y+1*o);return{xOffset:g,yOffset:m,mapping:p,data:h,width:h.width,height:h.height}}getKey(){let{fontFamily:e,fontWeight:t}=this.fontOptions;return`${e}_${t}`}getNewChars(e,t){let r=this.cache.get(e);if(!r)return t;let n=[],i=new Set(Object.keys(r.mapping));return new Set(t).forEach(e=>{i.has(e)||n.push(e)}),n}}function iH(e,t,r,n,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function iG(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){iH(o,n,i,a,s,"next",e)}function s(e){iH(o,n,i,a,s,"throw",e)}a(void 0)})}}class iW extends tG.EventEmitter{constructor(...e){super(...e),ia(this,"canvasHeight",128),ia(this,"texture",void 0),ia(this,"canvas",void 0),ia(this,"iconData",void 0),ia(this,"iconMap",void 0),ia(this,"ctx",void 0),ia(this,"loadingImageCount",0)}isLoading(){return 0===this.loadingImageCount}init(){this.iconData=[],this.iconMap={},this.canvas=window.document.createElement("canvas"),this.canvas.width=128,this.canvas.height=128,this.ctx=this.canvas.getContext("2d")}addImage(e,t){var r=this;return iG(function*(){let n=new Image;r.loadingImageCount++,r.hasImage(e)?console.warn("Image Id already exists"):r.iconData.push({id:e,size:64}),r.updateIconMap(),n=yield r.loadImage(t);let i=r.iconData.find(t=>t.id===e);i&&(i.image=n,i.width=n.width,i.height=n.height),r.update()})()}addImageMini(e,t,r){let n=r.getSceneConfig().canvas,i=n.createImage();if(this.loadingImageCount++,this.hasImage(e))throw Error("Image Id already exists");this.iconData.push({id:e,size:64}),this.updateIconMap(),this.loadImageMini(t,n).then(t=>{i=t;let r=this.iconData.find(t=>t.id===e);r&&(r.image=i,r.width=i.width,r.height=i.height),this.update()})}getTexture(){return this.texture}getIconMap(){return this.iconMap}getCanvas(){return this.canvas}hasImage(e){return this.iconMap.hasOwnProperty(e)}removeImage(e){this.hasImage(e)&&(this.iconData=this.iconData.filter(t=>t.id!==e),delete this.iconMap[e],this.update())}destroy(){this.removeAllListeners("imageUpdate"),this.iconData=[],this.iconMap={}}loadImage(e){return new Promise((t,r)=>{if(e instanceof HTMLImageElement){t(e);return}let n=new Image;n.crossOrigin="anonymous",n.onload=()=>{t(n)},n.onerror=()=>{r(Error("Could not load image at "+e))},n.src=e instanceof File?URL.createObjectURL(e):e})}update(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,0===this.loadingImageCount&&this.emit("imageUpdate")}updateIconAtlas(){this.canvas.width=1024,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(e=>{let{x:t,y:r,image:n,width:i=64,height:o=64}=this.iconMap[e],a=Math.max(i,o)/64,s=o/a,l=i/a;n&&this.ctx.drawImage(n,t+(64-l)/2,r+(64-s)/2,l,s)})}updateIconMap(){let{mapping:e,canvasHeight:t}=function(e,t,r){let n=0,i=0,o=0,a=[],s={};for(let t of e)if(!s[t.id]){let{size:e}=t;n+e+3>1024&&(iU(s,a,i),n=0,i=o+i+3,o=0,a=[]),a.push({icon:t,xOffset:n}),n=n+e+3,o=Math.max(o,e)}return a.length>0&&iU(s,a,i),{mapping:s,canvasHeight:iz(o+i+t)}}(this.iconData,3,0);this.iconMap=e,this.canvasHeight=t}loadImageMini(e,t){return new Promise((r,n)=>{let i=t.createImage();i.crossOrigin="anonymous",i.onload=()=>{r(i)},i.onerror=()=>{n(Error("Could not load image at "+e))},i.src=e})}}var iX="undefined"!=typeof Float32Array?Float32Array:Array;function i$(){var e=new iX(16);return iX!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function iZ(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],d=t[10],p=t[11],f=t[12],g=t[13],m=t[14],v=t[15],y=r*s-n*a,_=r*l-i*a,b=r*u-o*a,x=n*l-i*s,S=n*u-o*s,A=i*u-o*l,E=c*g-h*f,T=c*m-d*f,C=c*v-p*f,w=h*m-d*g,L=h*v-p*g,M=d*v-p*m,O=y*M-_*L+b*w+x*C-S*T+A*E;return O?(O=1/O,e[0]=(s*M-l*L+u*w)*O,e[1]=(i*L-n*M-o*w)*O,e[2]=(g*A-m*S+v*x)*O,e[3]=(d*S-h*A-p*x)*O,e[4]=(l*C-a*M-u*T)*O,e[5]=(r*M-i*C+o*T)*O,e[6]=(m*b-f*A-v*_)*O,e[7]=(c*A-d*b+p*_)*O,e[8]=(a*L-s*C+u*E)*O,e[9]=(n*C-r*L-o*E)*O,e[10]=(f*S-g*b+v*y)*O,e[11]=(h*b-c*S-p*y)*O,e[12]=(s*T-a*w-l*E)*O,e[13]=(r*w-n*T+i*E)*O,e[14]=(g*_-f*x-m*y)*O,e[15]=(c*x-h*_+d*y)*O,e):null}function iY(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],d=t[9],p=t[10],f=t[11],g=t[12],m=t[13],v=t[14],y=t[15],_=r[0],b=r[1],x=r[2],S=r[3];return e[0]=_*n+b*s+x*h+S*g,e[1]=_*i+b*l+x*d+S*m,e[2]=_*o+b*u+x*p+S*v,e[3]=_*a+b*c+x*f+S*y,_=r[4],b=r[5],x=r[6],S=r[7],e[4]=_*n+b*s+x*h+S*g,e[5]=_*i+b*l+x*d+S*m,e[6]=_*o+b*u+x*p+S*v,e[7]=_*a+b*c+x*f+S*y,_=r[8],b=r[9],x=r[10],S=r[11],e[8]=_*n+b*s+x*h+S*g,e[9]=_*i+b*l+x*d+S*m,e[10]=_*o+b*u+x*p+S*v,e[11]=_*a+b*c+x*f+S*y,_=r[12],b=r[13],x=r[14],S=r[15],e[12]=_*n+b*s+x*h+S*g,e[13]=_*i+b*l+x*d+S*m,e[14]=_*o+b*u+x*p+S*v,e[15]=_*a+b*c+x*f+S*y,e}function iq(e,t,r){var n,i,o,a,s,l,u,c,h,d,p,f,g=r[0],m=r[1],v=r[2];return t===e?(e[12]=t[0]*g+t[4]*m+t[8]*v+t[12],e[13]=t[1]*g+t[5]*m+t[9]*v+t[13],e[14]=t[2]*g+t[6]*m+t[10]*v+t[14],e[15]=t[3]*g+t[7]*m+t[11]*v+t[15]):(n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],d=t[9],p=t[10],f=t[11],e[0]=n,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=l,e[6]=u,e[7]=c,e[8]=h,e[9]=d,e[10]=p,e[11]=f,e[12]=n*g+s*m+h*v+t[12],e[13]=i*g+l*m+d*v+t[13],e[14]=o*g+u*m+p*v+t[14],e[15]=a*g+c*m+f*v+t[15]),e}function iK(e,t,r){var n=r[0],i=r[1],o=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function iQ(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[4],a=t[5],s=t[6],l=t[7],u=t[8],c=t[9],h=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+u*n,e[5]=a*i+c*n,e[6]=s*i+h*n,e[7]=l*i+d*n,e[8]=u*i-o*n,e[9]=c*i-a*n,e[10]=h*i-s*n,e[11]=d*i-l*n,e}function iJ(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[0],a=t[1],s=t[2],l=t[3],u=t[8],c=t[9],h=t[10],d=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-u*n,e[1]=a*i-c*n,e[2]=s*i-h*n,e[3]=l*i-d*n,e[8]=o*n+u*i,e[9]=a*n+c*i,e[10]=s*n+h*i,e[11]=l*n+d*i,e}function i0(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[0],a=t[1],s=t[2],l=t[3],u=t[4],c=t[5],h=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+u*n,e[1]=a*i+c*n,e[2]=s*i+h*n,e[3]=l*i+d*n,e[4]=u*i-o*n,e[5]=c*i-a*n,e[6]=h*i-s*n,e[7]=d*i-l*n,e}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var i1=function(e,t,r,n,i){var o,a=1/Math.tan(t/2);return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(o=1/(n-i),e[10]=(i+n)*o,e[14]=2*i*n*o):(e[10]=-1,e[14]=-2*n),e};function i2(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],p=e[11],f=e[12],g=e[13],m=e[14],v=e[15],y=t[0],_=t[1],b=t[2],x=t[3],S=t[4],A=t[5],E=t[6],T=t[7],C=t[8],w=t[9],L=t[10],M=t[11],O=t[12],I=t[13],P=t[14],R=t[15];return Math.abs(r-y)<=1e-6*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(n-_)<=1e-6*Math.max(1,Math.abs(n),Math.abs(_))&&Math.abs(i-b)<=1e-6*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(o-x)<=1e-6*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(a-S)<=1e-6*Math.max(1,Math.abs(a),Math.abs(S))&&Math.abs(s-A)<=1e-6*Math.max(1,Math.abs(s),Math.abs(A))&&Math.abs(l-E)<=1e-6*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(u-T)<=1e-6*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(c-C)<=1e-6*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(h-w)<=1e-6*Math.max(1,Math.abs(h),Math.abs(w))&&Math.abs(d-L)<=1e-6*Math.max(1,Math.abs(d),Math.abs(L))&&Math.abs(p-M)<=1e-6*Math.max(1,Math.abs(p),Math.abs(M))&&Math.abs(f-O)<=1e-6*Math.max(1,Math.abs(f),Math.abs(O))&&Math.abs(g-I)<=1e-6*Math.max(1,Math.abs(g),Math.abs(I))&&Math.abs(m-P)<=1e-6*Math.max(1,Math.abs(m),Math.abs(P))&&Math.abs(v-R)<=1e-6*Math.max(1,Math.abs(v),Math.abs(R))}class i3{constructor(){ia(this,"viewport",void 0),ia(this,"overridedViewProjectionMatrix",void 0),ia(this,"viewMatrixInverse",void 0),ia(this,"cameraPosition",void 0)}init(){}update(e){this.viewport=e,this.viewMatrixInverse=i$(),iZ(this.viewMatrixInverse,e.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}getProjectionMatrix(){return this.viewport.getProjectionMatrix()}getModelMatrix(){return this.viewport.getModelMatrix()}getViewMatrix(){return this.viewport.getViewMatrix()}getViewMatrixUncentered(){return this.viewport.getViewMatrixUncentered()}getViewProjectionMatrixUncentered(){return this.viewport.getViewProjectionMatrixUncentered()}getViewProjectionMatrix(){return this.overridedViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}getZoom(){return this.viewport.getZoom()}getZoomScale(){return this.viewport.getZoomScale()}getCenter(){let[e,t]=this.viewport.getCenter();return[e,t]}getFocalDistance(){return this.viewport.getFocalDistance()}getCameraPosition(){return this.cameraPosition}projectFlat(e,t){return this.viewport.projectFlat(e,t)}setViewProjectionMatrix(e){this.overridedViewProjectionMatrix=e}}let i4={topleft:"column",topright:"column",bottomright:"column",bottomleft:"column",leftcenter:"column",rightcenter:"column",topcenter:"row",bottomcenter:"row",lefttop:"row",righttop:"row",leftbottom:"row",rightbottom:"row"};class i5{constructor(){ia(this,"container",void 0),ia(this,"controlCorners",void 0),ia(this,"controlContainer",void 0),ia(this,"scene",void 0),ia(this,"mapsService",void 0),ia(this,"controls",[]),ia(this,"unAddControls",[])}init(e,t){this.container=e.container,this.scene=t,this.mapsService=t.mapService,this.initControlPos()}addControl(e,t){t.mapService.map?(e.addTo(this.scene),this.controls.push(e)):this.unAddControls.push(e)}getControlByName(e){return this.controls.find(t=>t.controlOption.name===e)}removeControl(e){let t=this.controls.indexOf(e);return t>-1&&this.controls.splice(t,1),e.remove(),this}addControls(){this.unAddControls.forEach(e=>{e.addTo(this.scene),this.controls.push(e)}),this.unAddControls=[]}destroy(){for(let e of this.controls)e.remove();this.controls=[],this.clearControlPos()}initControlPos(){let e=this.controlCorners={},t=this.controlContainer=tg("div","l7-control-container",this.container);Object.values(iS).forEach(r=>{!function(r=[]){let n=r.map(e=>"l7-"+e).join(" ");e[r.filter(e=>!["row","column"].includes(e)).join("")]=tg("div",n,t)}([...r.replace(/^(top|bottom|left|right|center)/,"$1-").split("-"),i4[r]])}),this.checkCornerOverlap()}clearControlPos(){for(let e in this.controlCorners)this.controlCorners[e]&&tm(this.controlCorners[e]);this.controlContainer&&tm(this.controlContainer)}checkCornerOverlap(){let e=window.MutationObserver;if(e)for(let t of Object.keys(this.controlCorners)){let r=t.match(/^(top|bottom)(left|right)$/);if(r){let[,t,n]=r,i=this.controlCorners[`${t}${n}`];new e(([{target:e}])=>{i&&(i.style[t]=e.clientHeight+"px")}).observe(this.controlCorners[`${n}${t}`],{childList:!0,attributes:!0})}}}}class i6{constructor(){ia(this,"container",void 0),ia(this,"scene",void 0),ia(this,"mapsService",void 0),ia(this,"markers",[]),ia(this,"markerLayers",[]),ia(this,"unAddMarkers",[]),ia(this,"unAddMarkerLayers",[])}addMarkerLayer(e){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(e),e.addTo(this.scene)):this.unAddMarkerLayers.push(e)}removeMarkerLayer(e){e.destroy(),this.markerLayers.indexOf(e);let t=this.markerLayers.indexOf(e);t>-1&&this.markerLayers.splice(t,1)}addMarker(e){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(e),e.addTo(this.scene)):this.unAddMarkers.push(e)}addMarkers(){this.unAddMarkers.forEach(e=>{e.addTo(this.scene),this.markers.push(e)}),this.unAddMarkers=[]}addMarkerLayers(){this.unAddMarkerLayers.forEach(e=>{this.markerLayers.push(e),e.addTo(this.scene)}),this.unAddMarkers=[]}removeMarker(e){e.remove(),this.markers.indexOf(e);let t=this.markers.indexOf(e);t>-1&&this.markers.splice(t,1)}removeAllMarkers(){this.destroy()}init(e){this.scene=e,this.mapsService=e.mapService}destroy(){this.markers.forEach(e=>{e.remove()}),this.markers=[],this.markerLayers.forEach(e=>{e.destroy()}),this.markerLayers=[]}removeMakerLayerMarker(e){e.destroy()}}class i7{constructor(){ia(this,"scene",void 0),ia(this,"mapsService",void 0),ia(this,"popups",[]),ia(this,"unAddPopups",[])}get isMarkerReady(){return this.mapsService.map&&this.mapsService.getMarkerContainer()}removePopup(e){null!=e&&e.isOpen()&&e.remove();let t=this.popups.indexOf(e);t>-1&&this.popups.splice(t,1);let r=this.unAddPopups.indexOf(e);r>-1&&this.unAddPopups.splice(r,1)}destroy(){this.popups.forEach(e=>e.remove())}addPopup(e){e&&e.getOptions().autoClose&&[...this.popups,...this.unAddPopups].forEach(e=>{e.getOptions().autoClose&&this.removePopup(e)}),this.isMarkerReady?(e.addTo(this.scene),this.popups.push(e)):this.unAddPopups.push(e),e.on("close",()=>{this.removePopup(e)})}initPopup(){this.unAddPopups.length&&this.unAddPopups.forEach(e=>{this.addPopup(e),this.unAddPopups=[]})}init(e){this.scene=e,this.mapsService=e.mapService}}let i8={MapToken:"您正在使用 Demo 测试 Token, 生产环境务必自行注册 Token 确保服务稳定 高德地图申请地址 https://lbs.amap.com/api/javascript-api/guide/abc/prepare  Mapbox地图申请地址 https://docs.mapbox.com/help/glossary/access-token/",SDK:"请确认引入了mapbox-gl api且在L7之前引入"},{merge:i9}=th,oe={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,stencil:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},ot={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",maskLayers:[],enableMask:!0,maskOperation:iM.AND,pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",activeMix:0,selectColor:"blue",selectMix:0,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0};class or{constructor(){ia(this,"sceneConfigCache",{}),ia(this,"layerConfigCache",{}),ia(this,"layerAttributeConfigCache",{})}getSceneConfig(e){return this.sceneConfigCache[e]}getSceneWarninfo(e){return i8[e]}setSceneConfig(e,t){this.sceneConfigCache[e]=il(il({},oe),t)}getLayerConfig(e){return this.layerConfigCache[e]}setLayerConfig(e,t,r){this.layerConfigCache[t]=il({},i9({},this.sceneConfigCache[e],ot,r))}getAttributeConfig(e){return this.layerAttributeConfigCache[e]}setAttributeConfig(e,t){this.layerAttributeConfigCache[e]=il(il({},this.layerAttributeConfigCache[e]),t)}clean(){this.sceneConfigCache={},this.layerConfigCache={}}}function on(){var e=new iX(4);return iX!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function oi(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*a,e[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*a,e[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*a,e[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*a,e}on();let oo=Math.PI/180;function oa({latitude:e=0,zoom:t=0,scale:r,highPrecision:n=!1,flipY:i=!1}){let o={},a=512*(r=void 0!==r?r:Math.pow(2,t)),s=Math.cos(e*oo),l=a/360,u=l/s,c=a/4003e4/s;if(o.pixelsPerMeter=[c,-c,c],o.metersPerPixel=[1/c,-1/c,1/c],o.pixelsPerDegree=[l,-u,c],o.degreesPerPixel=[1/l,-1/u,1/c],n){let t=oo*Math.tan(e*oo)/s,r=l*t/2,n=a/4003e4*t,h=n/u*c;o.pixelsPerDegree2=[0,-r,n],o.pixelsPerMeter2=[h,0,h],i&&(o.pixelsPerDegree2[1]=-o.pixelsPerDegree2[1],o.pixelsPerMeter2[1]=-o.pixelsPerMeter2[1])}return i&&(o.pixelsPerMeter[1]=-o.pixelsPerMeter[1],o.metersPerPixel[1]=-o.metersPerPixel[1],o.pixelsPerDegree[1]=-o.pixelsPerDegree[1],o.degreesPerPixel[1]=-o.degreesPerPixel[1]),o}let os=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];class ol{constructor(e){ia(this,"needRefresh",!0),ia(this,"coordinateSystem",void 0),ia(this,"viewportCenter",void 0),ia(this,"viewportCenterProjection",void 0),ia(this,"pixelsPerDegree",void 0),ia(this,"pixelsPerDegree2",void 0),ia(this,"pixelsPerMeter",void 0),this.cameraService=e}refresh(e){let t=this.cameraService.getZoom(),r=e||this.cameraService.getCenter(),{pixelsPerMeter:n,pixelsPerDegree:i}=oa({latitude:r[1],zoom:t});this.viewportCenter=r,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=n,this.pixelsPerDegree=i,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===iA.LNGLAT?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===iA.LNGLAT_OFFSET&&this.calculateLnglatOffset(r,t),this.needRefresh=!1}getCoordinateSystem(){return this.coordinateSystem}setCoordinateSystem(e){this.coordinateSystem=e}getViewportCenter(){return this.viewportCenter}getViewportCenterProjection(){return this.viewportCenterProjection}getPixelsPerDegree(){return this.pixelsPerDegree}getPixelsPerDegree2(){return this.pixelsPerDegree2}getPixelsPerMeter(){return this.pixelsPerMeter}calculateLnglatOffset(e,t,r,n){let{pixelsPerMeter:i,pixelsPerDegree:o,pixelsPerDegree2:a}=oa({latitude:e[1],zoom:t,scale:r,flipY:n,highPrecision:!0}),s=this.cameraService.getViewMatrix(),l=this.cameraService.getProjectionMatrix(),u=iY([],l,s),c=this.cameraService.projectFlat([Math.fround(e[0]),Math.fround(e[1])],Math.pow(2,t));this.viewportCenterProjection=oi([],[c[0],c[1],0,1],u),u=iY([],l,s=this.cameraService.getViewMatrixUncentered()||s),u=iY([],u,os),this.cameraService.setViewProjectionMatrix(u),this.pixelsPerMeter=i,this.pixelsPerDegree=o,this.pixelsPerDegree2=a}}class ou extends tG.EventEmitter{constructor(...e){super(...e),ia(this,"renderMap",new Map),ia(this,"enable",!1),ia(this,"renderEnable",!1),ia(this,"cacheLogs",{})}setEnable(e){this.enable=!!e}log(e,t){if(!this.enable)return;let r=e.split("."),n=null;r.forEach((e,i)=>{null!==n?(n[e]||(n[e]={}),i!==r.length-1&&(n=n[e])):(this.cacheLogs[e]||(this.cacheLogs[e]={}),i!==r.length-1&&(n=this.cacheLogs[e])),i===r.length-1&&(n[e]=il(il({time:Date.now()},n[e]),t))})}getLog(e){switch(typeof e){case"string":return this.cacheLogs[e];case"object":return e.map(e=>this.cacheLogs[e]).filter(e=>void 0!==e);case"undefined":return this.cacheLogs}}removeLog(e){delete this.cacheLogs[e]}generateRenderUid(){return this.renderEnable?"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}):""}renderDebug(e){this.renderEnable=e}renderStart(e){if(!this.renderEnable||!this.enable)return;let t=this.renderMap.get(e)||{};this.renderMap.set(e,il(il({},t),{},{renderUid:e,renderStart:Date.now()}))}renderEnd(e){if(!this.renderEnable||!this.enable)return;let t=this.renderMap.get(e);if(t){let r=t.renderStart,n=Date.now();this.emit("renderEnd",il(il({},t),{},{renderEnd:n,renderDuration:n-r})),this.renderMap.delete(e)}}destroy(){this.cacheLogs=null,this.renderMap.clear()}}var oc=r(98385),oh=r.n(oc);let od={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancel"};class op extends tW(){get mapService(){return this.container.mapService}constructor(e){super(),ia(this,"indragging",!1),ia(this,"hammertime",void 0),ia(this,"lastClickTime",0),ia(this,"lastClickXY",[-1,-1]),ia(this,"clickTimer",void 0),ia(this,"$containter",void 0),ia(this,"onDrag",e=>{let t=this.interactionEvent(e);t.type=od[t.type],"dragging"===t.type?this.indragging=!0:this.indragging=!1,this.emit(iC.Drag,t)}),ia(this,"onHammer",e=>{e.srcEvent.stopPropagation();let t=this.interactionEvent(e);this.emit(iC.Hover,t)}),ia(this,"onTouch",e=>{let t=e.touches[0];this.onHover({clientX:t.clientX,clientY:t.clientY,type:"touchstart"})}),ia(this,"onTouchEnd",e=>{if(e.changedTouches.length>0){let t=e.changedTouches[0];this.onHover({clientX:t.clientX,clientY:t.clientY,type:"touchend"})}}),ia(this,"onTouchMove",e=>{let t=e.changedTouches[0];this.onHover({clientX:t.clientX,clientY:t.clientY,type:"touchmove"})}),ia(this,"onHover",e=>{let{clientX:t,clientY:r}=e,n=t,i=r,o=e.type,a=this.mapService.getMapContainer();if(a){let{top:e,left:t}=a.getBoundingClientRect();n=n-t-a.clientLeft,i=i-e-a.clientTop}let s=this.mapService.containerToLngLat([n,i]);if("click"===o||"touch"===o){this.isDoubleTap(n,i,s);return}"click"!==o&&"dblclick"!==o&&this.emit(iC.Hover,{x:n,y:i,lngLat:s,type:o,target:e})}),this.container=e}init(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}destroy(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(iC.Hover)}triggerHover({x:e,y:t}){this.emit(iC.Hover,{x:e,y:t})}triggerSelect(e){this.emit(iC.Select,{featureId:e})}triggerActive(e){this.emit(iC.Active,{featureId:e})}addEventListenerOnMap(){let e=this.mapService.getMapContainer();if(e){let t=new(oh()).Manager(e);t.add(new(oh()).Tap({event:"dblclick",taps:2})),t.add(new(oh()).Tap({event:"click"})),t.add(new(oh()).Pan({threshold:0,pointers:0})),t.add(new(oh()).Press({})),t.on("dblclick click",this.onHammer),t.on("panstart panmove panend pancancel",this.onDrag),e.addEventListener("touchstart",this.onTouch),e.addEventListener("touchend",this.onTouchEnd),e.addEventListener("mousemove",this.onHover),e.addEventListener("touchmove",this.onTouchMove),e.addEventListener("mousedown",this.onHover,!0),e.addEventListener("mouseup",this.onHover),e.addEventListener("contextmenu",this.onHover),this.hammertime=t}}removeEventListenerOnMap(){let e=this.mapService.getMapContainer();e&&(e.removeEventListener("mousemove",this.onHover),this.hammertime.off("dblclick click",this.onHammer),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),e.removeEventListener("touchstart",this.onTouch),e.removeEventListener("touchend",this.onTouchEnd),e.removeEventListener("mousedown",this.onHover),e.removeEventListener("mouseup",this.onHover),e.removeEventListener("contextmenu",this.onHover))}interactionEvent(e){let t,r;let{type:n,pointerType:i}=e;"touch"===i?(r=Math.floor(e.pointers[0].clientY),t=Math.floor(e.pointers[0].clientX)):(r=Math.floor(e.srcEvent.y),t=Math.floor(e.srcEvent.x));let o=this.mapService.getMapContainer();if(o){let{top:e,left:n}=o.getBoundingClientRect();t-=n,r-=e}let a=this.mapService.containerToLngLat([t,r]);return{x:t,y:r,lngLat:a,type:n,target:e.srcEvent}}isDoubleTap(e,t,r){let n=new Date().getTime(),i="click";n-this.lastClickTime<400&&10>Math.abs(this.lastClickXY[0]-e)&&10>Math.abs(this.lastClickXY[1]-t)?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),i="dblclick",this.emit(iC.Hover,{x:e,y:t,lngLat:r,type:i})):(this.lastClickTime=n,this.lastClickXY=[e,t],this.clickTimer=setTimeout(()=>{i="click",this.emit(iC.Hover,{x:e,y:t,lngLat:r,type:i})},400))}}let of=0,og=function(e){return e[e.SAMPLED=0]="SAMPLED",e[e.RENDER_TARGET=1]="RENDER_TARGET",e}({});class om{constructor(e){var t=this;ia(this,"pickedColors",void 0),ia(this,"pickedTileLayers",[]),ia(this,"pickingFBO",void 0),ia(this,"width",0),ia(this,"height",0),ia(this,"alreadyInPicking",!1),ia(this,"pickBufferScale",1),ia(this,"pickFromPickingFBO",function(){var e=iG(function*(e,{x:r,y:n,lngLat:i,type:o,target:a}){let s;let l=!1,{readPixels:u,readPixelsAsync:c,getViewportSize:h,queryVerdorInfo:d}=t.rendererService,{width:p,height:f}=h(),{enableHighlight:g,enableSelect:m}=e.getLayerConfig(),v=r*tS,y=n*tS;if(v>p-1*tS||v<0||y>f-1*tS||y<0)return!1;if(s="WebGPU"===d()?yield c({x:Math.floor(v/t.pickBufferScale),y:Math.floor((f-(n+1)*tS)/t.pickBufferScale),width:1,height:1,data:new Uint8Array(4),framebuffer:t.pickingFBO}):u({x:Math.floor(v/t.pickBufferScale),y:Math.floor((f-(n+1)*tS)/t.pickBufferScale),width:1,height:1,data:new Uint8Array(4),framebuffer:t.pickingFBO}),t.pickedColors=s,0!==s[0]||0!==s[1]||0!==s[2]){let u=ew(s),c=e.layerPickService.getFeatureById(u);u!==e.getCurrentPickId()&&"mousemove"===o&&(o="mouseenter");let h={x:r,y:n,type:o,lngLat:i,featureId:u,feature:c,target:a};c&&(l=!0,e.setCurrentPickId(u),t.triggerHoverOnLayer(e,h))}else{let s={x:r,y:n,lngLat:i,type:null!==e.getCurrentPickId()&&"mousemove"===o?"mouseout":"un"+o,featureId:null,target:a,feature:null};t.triggerHoverOnLayer(e,il(il({},s),{},{type:"unpick"})),t.triggerHoverOnLayer(e,s),e.setCurrentPickId(null)}if(g&&e.layerPickService.highlightPickedFeature(s),m&&"click"===o&&(null==s?void 0:s.toString())!==[0,0,0,0].toString()){let t=ew(s);null===e.getCurrentSelectedId()||t!==e.getCurrentSelectedId()?(e.layerPickService.selectFeature(s),e.setCurrentSelectedId(t)):(e.layerPickService.selectFeature(new Uint8Array([0,0,0,0])),e.setCurrentSelectedId(null))}return l});return function(t,r){return e.apply(this,arguments)}}()),this.container=e}get mapService(){return this.container.mapService}get rendererService(){return this.container.rendererService}get configService(){return this.container.globalConfigService}get interactionService(){return this.container.interactionService}get layerService(){return this.container.layerService}init(e){let{createTexture2D:t,createFramebuffer:r,getViewportSize:n}=this.rendererService,{width:i,height:o}=n();this.pickBufferScale=this.configService.getSceneConfig(e).pickBufferScale||1;let a=t({width:i=Math.round(i/this.pickBufferScale),height:o=Math.round(o/this.pickBufferScale),usage:og.RENDER_TARGET,label:"Picking Texture"});this.pickingFBO=r({color:a,depth:!0,width:i,height:o}),this.interactionService.on(iC.Hover,this.pickingAllLayer.bind(this))}boxPickLayer(e,t,r){var n=this;return iG(function*(){let{useFramebufferAsync:i,clear:o}=n.rendererService;n.resizePickingFBO(),e.hooks.beforePickingEncode.call(),yield i(n.pickingFBO,iG(function*(){o({framebuffer:n.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),e.renderModels({ispick:!0})})),e.hooks.afterPickingEncode.call(),r((yield n.pickBox(e,t)))})()}pickBox(e,t){var r=this;return iG(function*(){let[n,i,o,a]=t.map(e=>Math.floor((e<0?0:e)*tS/r.pickBufferScale)),{readPixelsAsync:s,getViewportSize:l}=r.rendererService,{width:u,height:c}=l();if(n>(u-1)*tS/r.pickBufferScale||o<0||i>(c-1)*tS/r.pickBufferScale||a<0)return[];let h=Math.min(u/r.pickBufferScale,o)-n,d=Math.min(c/r.pickBufferScale,a)-i,p=yield s({x:n,y:Math.floor(c/r.pickBufferScale-(a+1)),width:h,height:d,data:new Uint8Array(h*d*4),framebuffer:r.pickingFBO}),f=[],g={};for(let t=0;t<p.length/4;t+=1){let r=ew(p.slice(4*t,4*t+4));if(-1!==r&&!g[r]){let t=e.layerPickService.getFeatureById(r);f.push(il(il({},t),{},{pickedFeatureIdx:r})),g[r]=!0}}return f})()}handleCursor(e,t){let{cursor:r="",cursorEnabled:n}=e.getLayerConfig();if(n){let e="amap"===this.mapService.getType()?this.mapService.getMapContainer():this.mapService.getMarkerContainer(),n=null==e?void 0:e.style.getPropertyValue("cursor");"unmousemove"===t&&""!==n?null==e||e.style.setProperty("cursor",""):"mousemove"===t&&(null==e||e.style.setProperty("cursor",r))}}destroy(){this.pickingFBO.destroy(),this.pickingFBO=null}pickingAllLayer(e){var t=this;return iG(function*(){t.layerService.needPick(e.type)&&t.isPickingAllLayer()&&(t.alreadyInPicking=!0,yield t.pickingLayers(e),t.layerService.renderLayers(),t.alreadyInPicking=!1)})()}isPickingAllLayer(){return!this.alreadyInPicking&&!this.layerService.alreadyInRendering&&!this.interactionService.indragging&&!!this.layerService.getShaderPickStat()}resizePickingFBO(){let{getViewportSize:e}=this.rendererService,{width:t,height:r}=e();(this.width!==t||this.height!==r)&&(this.pickingFBO.resize({width:Math.round(t/this.pickBufferScale),height:Math.round(r/this.pickBufferScale)}),this.width=t,this.height=r)}pickingLayers(e){var t=this;return iG(function*(){let{clear:r,useFramebufferAsync:n}=t.rendererService;for(let i of(t.resizePickingFBO(),t.layerService.getRenderList().filter(t=>t.needPick(e.type)).reverse())){yield n(t.pickingFBO,iG(function*(){r({framebuffer:t.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),i.layerPickService.pickRender(e)}));let o=yield t.pickFromPickingFBO(i,e);if(t.layerService.pickedLayerId=o?+i.id:-1,o&&!i.getLayerConfig().enablePropagation)break}})()}triggerHoverOnLayer(e,t){(function(e){var t,r,n;let i=!0;if((null==e||null===(t=e.target)||void 0===t?void 0:t.target)instanceof HTMLElement){let t=null==e||null===(r=e.target)||void 0===r?void 0:r.target;for(;t;){let e=Array.from(t.classList);if(e.includes("l7-marker")||e.includes("l7-popup")){i=!1;break}t=null===(n=t)||void 0===n?void 0:n.parentElement}}return i})(t)&&(this.handleCursor(e,t.type),e.emit(t.type,t))}}class ov{constructor(e=!0){ia(this,"autoStart",void 0),ia(this,"startTime",0),ia(this,"oldTime",0),ia(this,"running",!1),ia(this,"elapsedTime",0),this.autoStart=e}start(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}let{throttle:oy}=th;class o_ extends tG.EventEmitter{get renderService(){return this.container.rendererService}get mapService(){return this.container.mapService}get debugService(){return this.container.debugService}constructor(e){super(),ia(this,"pickedLayerId",-1),ia(this,"clock",new ov),ia(this,"alreadyInRendering",!1),ia(this,"layers",[]),ia(this,"layerList",[]),ia(this,"layerRenderID",void 0),ia(this,"sceneInited",!1),ia(this,"animateInstanceCount",0),ia(this,"shaderPicking",!0),ia(this,"enableRender",!0),ia(this,"reRender",oy(()=>{this.renderLayers()},32)),ia(this,"throttleRenderLayers",oy(()=>{this.renderLayers()},16)),this.container=e}needPick(e){return this.updateLayerRenderList(),this.layerList.some(t=>t.needPick(e))}add(e){this.layers.push(e),this.sceneInited&&e.init().then(()=>{this.renderLayers()})}addMask(e){this.sceneInited&&e.init().then(()=>{this.renderLayers()})}initLayers(){var e=this;return iG(function*(){var t;e.sceneInited=!0,e.layers.forEach((t=iG(function*(t){t.startInit||(yield t.init(),e.updateLayerRenderList())}),function(e){return t.apply(this,arguments)}))})()}getSceneInited(){return this.sceneInited}getRenderList(){return this.layerList}getLayers(){return this.layers}getLayer(e){return this.layers.find(t=>t.id===e)}getLayerByName(e){return this.layers.find(t=>t.name===e)}remove(e,t){var r=this;return iG(function*(){t?t.layerChildren=t.layerChildren.filter(t=>t!==e):r.layers=r.layers.filter(t=>t!==e),e.destroy(),r.reRender(),r.emit("layerChange",r.layers)})()}removeAllLayers(){var e=this;return iG(function*(){e.destroy(),e.reRender()})()}setEnableRender(e){this.enableRender=e}renderLayers(){var e=this;return iG(function*(){if(e.alreadyInRendering||!e.enableRender)return;e.updateLayerRenderList();let t=e.debugService.generateRenderUid();for(let r of(e.debugService.renderStart(t),e.alreadyInRendering=!0,e.clear(),e.layerList))r.prerender();for(let t of(e.renderService.beginFrame(),e.layerList)){let{enableMask:r}=t.getLayerConfig();t.masks.filter(e=>e.inited).length>0&&r&&e.renderMask(t.masks),t.getLayerConfig().enableMultiPassRenderer?yield t.renderMultiPass():t.render()}e.renderService.endFrame(),e.debugService.renderEnd(t),e.alreadyInRendering=!1})()}renderMask(e){let t=0;this.renderService.clear({stencil:0,depth:1,framebuffer:null});let r=e.length>1?iL.MULTIPLE:iL.SINGLE;for(let n of e)n.render({isStencil:!0,stencilType:r,stencilIndex:t++})}beforeRenderData(e){var t=this;return iG(function*(){(yield e.hooks.beforeRenderData.promise())&&t.renderLayers()})()}renderTileLayerMask(e){let t=0,{enableMask:r=!0}=e.getLayerConfig(),n=e.tileMask?1:0,i=e.masks.filter(e=>e.inited),o=(n+=r?i.length:1)>1?iL.MULTIPLE:iL.SINGLE;if((e.tileMask||i.length&&r)&&this.renderService.clear({stencil:0,depth:1,framebuffer:null}),i.length&&r)for(let e of i)e.render({isStencil:!0,stencilType:o,stencilIndex:t++});e.tileMask&&e.tileMask.render({isStencil:!0,stencilType:o,stencilIndex:t++,stencilOperation:iM.OR})}renderTileLayer(e){var t=this;return iG(function*(){t.renderTileLayerMask(e),e.getLayerConfig().enableMultiPassRenderer?yield e.renderMultiPass():yield e.render()})()}updateLayerRenderList(){this.layerList=[],this.layers.filter(e=>e.inited).filter(e=>e.isVisible()).sort((e,t)=>e.zIndex-t.zIndex).forEach(e=>{this.layerList.push(e)})}destroy(){this.layers.forEach(e=>{e.destroy()}),this.layers=[],this.layerList=[],this.emit("layerChange",this.layers)}startAnimate(){0==this.animateInstanceCount++&&(this.clock.start(),this.runRender())}stopAnimate(){0==--this.animateInstanceCount&&(this.stopRender(),this.clock.stop())}getOESTextureFloat(){return this.renderService.extensionObject.OES_texture_float}enableShaderPick(){this.shaderPicking=!0}disableShaderPick(){this.shaderPicking=!1}getShaderPickStat(){return this.shaderPicking}clear(){let e=eC(this.mapService.bgColor);this.renderService.clear({color:e,depth:1,stencil:0,framebuffer:null})}runRender(){this.renderLayers(),this.layerRenderID=window.requestAnimationFrame(this.runRender.bind(this))}stopRender(){window.cancelAnimationFrame(this.layerRenderID)}}var ob=r(46364);function ox(e,t){if(null==e)return{};var r,n,i=(0,ob.A)(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.includes(r)||({}).propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}let{isNil:oS}=th;class oA{constructor(e){ia(this,"name",void 0),ia(this,"type",void 0),ia(this,"scale",void 0),ia(this,"descriptor",void 0),ia(this,"featureBufferLayout",[]),ia(this,"needRescale",!1),ia(this,"needRemapping",!1),ia(this,"needRegenerateVertices",!1),ia(this,"featureRange",{startIndex:0,endIndex:1/0}),ia(this,"vertexAttribute",void 0),ia(this,"defaultCallback",e=>{if(0===e.length){var t;return(null===(t=this.scale)||void 0===t?void 0:t.defaultValues)||[]}return e.map((e,t)=>{var r;return(null===(r=this.scale)||void 0===r?void 0:r.scalers[t].func)(e)})}),this.setProps(e)}setProps(e){Object.assign(this,e)}mapping(e){var t,r;if(null!==(t=this.scale)&&void 0!==t&&t.callback){let t=null===(r=this.scale)||void 0===r?void 0:r.callback(...e);if(!oS(t))return[t]}return this.defaultCallback(e)}resetDescriptor(){this.descriptor&&(this.descriptor.buffer.data=[])}}let oE=["buffer","update","name"],oT=["buffer","update","name"],oC={[ic.FLOAT]:4,[ic.UNSIGNED_BYTE]:1,[ic.UNSIGNED_SHORT]:2};class ow{constructor(e){ia(this,"attributesAndIndices",void 0),ia(this,"attributes",[]),ia(this,"triangulation",void 0),ia(this,"featureLayout",{sizePerElement:0,elements:[]}),this.rendererService=e}registerStyleAttribute(e){let t=this.getLayerStyleAttribute(e.name||"");return t?t.setProps(e):(t=new oA(e),this.attributes.push(t)),t}unRegisterStyleAttribute(e){let t=this.attributes.findIndex(t=>t.name===e);t>-1&&this.attributes.splice(t,1)}updateScaleAttribute(e){this.attributes.forEach(t=>{var r;let n=t.name,i=null===(r=t.scale)||void 0===r?void 0:r.field;(e[n]||i&&e[i])&&(t.needRescale=!0,t.needRemapping=!0,t.needRegenerateVertices=!0)})}updateStyleAttribute(e,t,r){let n=this.getLayerStyleAttribute(e);n||(n=this.registerStyleAttribute(il(il({},t),{},{name:e})));let{scale:i}=t;i&&n&&(n.scale=i,n.needRescale=!0,n.needRemapping=!0,n.needRegenerateVertices=!0,r&&r.featureRange&&(n.featureRange=r.featureRange))}getLayerStyleAttributes(){return this.attributes}getLayerStyleAttribute(e){return this.attributes.find(t=>t.name===e)}getLayerAttributeScale(e){var t;let r=this.getLayerStyleAttribute(e),n=null==r||null===(t=r.scale)||void 0===t?void 0:t.scalers;return n&&n[0]?n[0].func:null}updateAttributeByFeatureRange(e,t,r=0,n,i){let o=this.attributes.find(t=>t.name===e);if(o&&o.descriptor){let{descriptor:a}=o,{update:s,buffer:l,size:u=0}=a,c=oC[l.type||ic.FLOAT];if(s){let{elements:a,sizePerElement:l}=this.featureLayout,h=a.slice(r,n);if(!h.length)return;let{offset:d}=h[0],p=h.map(({featureIdx:e,vertices:r,normals:n},i)=>{let o=r.length/l,a=[];for(let u=0;u<o;u++){let o=n?n.slice(3*u,3*u+3):[];a.push(...s(t[e],e,r.slice(u*l,u*l+l),i,o))}return a}).flat();o.vertexAttribute.updateBuffer({data:p,offset:d*u*c}),null==i||i.emit(`legend:${e}`,i.getLegend(e))}}}createAttributesAndIndices(e,t,r,n){this.featureLayout={sizePerElement:0,elements:[]},t&&(this.triangulation=t);let i=this.attributes.map(e=>(e.resetDescriptor(),e.descriptor)),o=0,a=0,s=[],l=3;e.forEach((e,t)=>{let{indices:n,vertices:u,normals:c,size:h,indexes:d,count:p}=this.triangulation(e,r);"number"==typeof p&&(a+=p),n.forEach(e=>{s.push(e+o)}),l=h;let f=u.length/h;this.featureLayout.sizePerElement=l,this.featureLayout.elements.push({featureIdx:t,vertices:u,normals:c,offset:o}),o+=f;for(let r=0;r<f;r++){let n=(null==c?void 0:c.slice(3*r,3*r+3))||[],o=u.slice(r*h,r*h+h),a=0;d&&void 0!==d[r]&&(a=d[r]),i.forEach((i,s)=>{i&&i.update&&i.buffer.data.push(...i.update(e,t,o,r,n,a))})}});let{createAttribute:u,createBuffer:c,createElements:h}=this.rendererService,d={};i.forEach((e,t)=>{if(e){let{buffer:r,update:n,name:i}=e,o=ox(e,oE),a=u(il({buffer:c(r)},o));d[e.name||""]=a,this.attributes[t].vertexAttribute=a}});let p=h({data:s,type:ic.UNSIGNED_INT,count:s.length});return this.attributesAndIndices={attributes:d,elements:p,count:a},Object.values(this.attributes).filter(e=>e.scale).forEach(e=>{let t=e.name;null==n||n.emit(`legend:${t}`,n.getLegend(t))}),this.attributesAndIndices}createAttributes(e,t){this.featureLayout={sizePerElement:0,elements:[]},t&&(this.triangulation=t);let r=this.attributes.map(e=>(e.resetDescriptor(),e.descriptor)),n=0,i=[],o=3;e.forEach((e,t)=>{let{indices:a,vertices:s,normals:l,size:u,indexes:c}=this.triangulation(e);a.forEach(e=>{i.push(e+n)}),o=u;let h=s.length/u;this.featureLayout.sizePerElement=o,this.featureLayout.elements.push({featureIdx:t,vertices:s,normals:l,offset:n}),n+=h;for(let n=0;n<h;n++){let i=(null==l?void 0:l.slice(3*n,3*n+3))||[],o=s.slice(n*u,n*u+u),a=0;c&&void 0!==c[n]&&(a=c[n]),r.forEach((r,s)=>{r&&r.update&&r.buffer.data.push(...r.update(e,t,o,n,i,a))})}});let{createAttribute:a,createBuffer:s}=this.rendererService,l={};return r.forEach((e,t)=>{if(e){let{buffer:r,update:n,name:i}=e,o=ox(e,oT),u=a(il({buffer:s(r)},o));l[e.name||""]=u,this.attributes[t].vertexAttribute=u}}),{attributes:l}}clearAllAttributes(){var e;this.attributes.forEach(e=>{e.vertexAttribute&&e.vertexAttribute.destroy()}),null===(e=this.attributesAndIndices)||void 0===e||e.elements.destroy(),this.attributes=[]}}var oL=r(23953);function oM(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})}function oO(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function oI(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a}function oP(e,t,r){if(r||2==arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}function oR(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ok={exports:{}},oN={exports:{}},oD={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e&&"number"==typeof e.length&&e.length>=0&&e.length%1==0},e.exports=t.default}(oD,oD.exports);var oU={},oz={exports:{}},oB={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];var n=t.pop();return e.call(this,t,n)}},e.exports=t.default}(oB,oB.exports);var oF={};Object.defineProperty(oF,"__esModule",{value:!0}),oF.fallback=oG,oF.wrap=oW;var oj=oF.hasQueueMicrotask="function"==typeof queueMicrotask&&queueMicrotask,oV=oF.hasSetImmediate="function"==typeof setImmediate&&setImmediate,oH=oF.hasNextTick="object"==typeof oL&&"function"==typeof oL.nextTick;function oG(e){setTimeout(e,0)}function oW(e){return function(t){for(var r=[],n=arguments.length-1;n-- >0;)r[n]=arguments[n+1];return e(function(){return t.apply(void 0,r)})}}n=oj?queueMicrotask:oV?setImmediate:oH?oL.nextTick:oG,oF.default=oW(n),function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,oU.isAsync)(e)?function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];var n=t.pop();return o(e.apply(this,t),n)}:(0,r.default)(function(t,r){var n;try{n=e.apply(this,t)}catch(e){return r(e)}if(n&&"function"==typeof n.then)return o(n,r);r(null,n)})};var r=i(oB.exports),n=i(oF);function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){return e.then(function(e){a(t,null,e)},function(e){a(t,e&&e.message?e:Error(e))})}function a(e,t,r){try{e(t,r)}catch(e){(0,n.default)(function(e){throw e},e)}}e.exports=t.default}(oz,oz.exports),Object.defineProperty(oU,"__esModule",{value:!0}),oU.isAsyncIterable=oU.isAsyncGenerator=oU.isAsync=void 0;var oX=function(e){return e&&e.__esModule?e:{default:e}}(oz.exports);function o$(e){return"AsyncFunction"===e[Symbol.toStringTag]}oU.default=function(e){if("function"!=typeof e)throw Error("expected a function");return o$(e)?(0,oX.default)(e):e},oU.isAsync=o$,oU.isAsyncGenerator=function(e){return"AsyncGenerator"===e[Symbol.toStringTag]},oU.isAsyncIterable=function(e){return"function"==typeof e[Symbol.asyncIterator]};var oZ={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(void 0===t&&(t=e.length),!t)throw Error("arity is undefined");return function(){for(var r=this,n=[],i=arguments.length;i--;)n[i]=arguments[i];return"function"==typeof n[t-1]?e.apply(this,n):new Promise(function(i,o){n[t-1]=function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];if(e)return o(e);i(t.length>1?t:t[0])},e.apply(r,n)})}},e.exports=t.default}(oZ,oZ.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(oD.exports),n=o(oU),i=o(oZ.exports);function o(e){return e&&e.__esModule?e:{default:e}}t.default=(0,i.default)(function(e,t,i){var o=(0,r.default)(t)?[]:{};e(t,function(e,t,r){(0,n.default)(e)(function(e){for(var n=[],i=arguments.length-1;i-- >0;)n[i]=arguments[i+1];n.length<2&&(n=n[0]),o[t]=n,r(e)})},function(e){return i(e,o)})},3),e.exports=t.default}(oN,oN.exports);var oY={exports:{}},oq={exports:{}},oK={exports:{}},oQ={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){function t(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];if(null!==e){var n=e;e=null,n.apply(this,t)}}return Object.assign(t,e),t},e.exports=t.default}(oQ,oQ.exports);var oJ={exports:{}},o0={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e[Symbol.iterator]&&e[Symbol.iterator]()},e.exports=t.default}(o0,o0.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if((0,r.default)(e))return t=-1,i=e.length,function(){return++t<i?{value:e[t],key:t}:null};var t,i,o,a,s,l,u=(0,n.default)(e);return u?(o=-1,function(){var e=u.next();return e.done?null:(o++,{value:e.value,key:o})}):(a=e?Object.keys(e):[],s=-1,l=a.length,function t(){var r=a[++s];return"__proto__"===r?t():s<l?{value:e[r],key:r}:null})};var r=i(oD.exports),n=i(o0.exports);function i(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default}(oJ,oJ.exports);var o1={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];if(null===e)throw Error("Callback was already called.");var n=e;e=null,n.apply(this,t)}},e.exports=t.default}(o1,o1.exports);var o2={exports:{}},o3={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={},e.exports=t.default}(o3,o3.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r,i){var o=!1,a=!1,s=!1,l=0,u=0;function c(){l>=t||s||o||(s=!0,e.next().then(function(e){var t=e.value,n=e.done;if(!a&&!o){if(s=!1,n){o=!0,l<=0&&i(null);return}l++,r(t,u,h),u++,c()}}).catch(d))}function h(e,t){if(l-=1,!a){if(e)return d(e);if(!1===e){o=!0,a=!0;return}if(t===n.default||o&&l<=0)return o=!0,i(null);c()}}function d(e){a||(s=!1,o=!0,i(e))}c()};var r,n=(r=o3.exports)&&r.__esModule?r:{default:r};e.exports=t.default}(o2,o2.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=s(oQ.exports),n=s(oJ.exports),i=s(o1.exports),o=s(o2.exports),a=s(o3.exports);function s(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){return function(t,s,l){if(l=(0,r.default)(l),e<=0)throw RangeError("concurrency limit cannot be less than 1");if(!t)return l(null);if((0,oU.isAsyncGenerator)(t))return(0,o.default)(t,e,s,l);if((0,oU.isAsyncIterable)(t))return(0,o.default)(t[Symbol.asyncIterator](),e,s,l);var u=(0,n.default)(t),c=!1,h=!1,d=0,p=!1;function f(e,t){if(!h){if(d-=1,e)c=!0,l(e);else if(!1===e)c=!0,h=!0;else{if(t===a.default||c&&d<=0)return c=!0,l(null);p||g()}}}function g(){for(p=!0;d<e&&!c;){var t=u();if(null===t){c=!0,d<=0&&l(null);return}d+=1,s(t.value,t.key,(0,i.default)(f))}p=!1}g()}},e.exports=t.default}(oK,oK.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=o(oK.exports),n=o(oU),i=o(oZ.exports);function o(e){return e&&e.__esModule?e:{default:e}}t.default=(0,i.default)(function(e,t,i,o){return(0,r.default)(t)(e,(0,n.default)(i),o)},4),e.exports=t.default}(oq,oq.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=i(oq.exports),n=i(oZ.exports);function i(e){return e&&e.__esModule?e:{default:e}}t.default=(0,n.default)(function(e,t,n){return(0,r.default)(e,1,t,n)},3),e.exports=t.default}(oY,oY.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,r.default)(n.default,e,t)};var r=i(oN.exports),n=i(oY.exports);function i(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default}(ok,ok.exports);var o4=oR(ok.exports),o5=function(){function e(){this.args=[],this.tasks=[]}return e.prototype.call=function(){for(var e=arguments,t=[],r=0;r<arguments.length;r++)t[r]=e[r];return this.args=t,o4(this.tasks)},e.prototype.tap=function(e,t){var r=this;this.tasks.push(function(n){t.apply(void 0,oP([],oI(r.args),!1)),n(null,e)})},e}(),o6={exports:{}},o7={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=u(oD.exports),n=u(o3.exports),i=u(oq.exports),o=u(oQ.exports),a=u(o1.exports),s=u(oU),l=u(oZ.exports);function u(e){return e&&e.__esModule?e:{default:e}}t.default=(0,l.default)(function(e,t,l){return((0,r.default)(e)?function(e,t,r){r=(0,o.default)(r);var i=0,s=0,l=e.length,u=!1;function c(e,t){!1===e&&(u=!0),!0!==u&&(e?r(e):(++s===l||t===n.default)&&r(null))}for(0===l&&r(null);i<l;i++)t(e[i],i,(0,a.default)(c))}:function(e,t,r){return(0,i.default)(e,1/0,t,r)})(e,(0,s.default)(t),l)},3),e.exports=t.default}(o7,o7.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,n.default)(r.default,e,t)};var r=i(o7.exports),n=i(oN.exports);function i(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default}(o6,o6.exports);var o8=oR(o6.exports);!function(){function e(){this.tasks=[]}e.prototype.promise=function(){return o8(this.tasks)},e.prototype.tapPromise=function(e,t){var r=this;this.tasks.push(function(n){return oM(r,void 0,void 0,function(){return oO(this,function(r){switch(r.label){case 0:return[4,t()];case 1:return r.sent(),n(null,e),[2]}})})})}}();var o9={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=a(oQ.exports),n=a(o1.exports),i=a(oU),o=a(oZ.exports);function a(e){return e&&e.__esModule?e:{default:e}}t.default=(0,o.default)(function(e,t){if(t=(0,r.default)(t),!Array.isArray(e))return t(Error("First argument to waterfall must be an array of functions"));if(!e.length)return t();var o=0;function a(t){(0,i.default)(e[o++]).apply(void 0,t.concat([(0,n.default)(s)]))}function s(r){for(var n=[],i=arguments.length-1;i-- >0;)n[i]=arguments[i+1];if(!1!==r){if(r||o===e.length)return t.apply(void 0,[r].concat(n));a(n)}}a([])}),e.exports=t.default}(o9,o9.exports);var ae=oR(o9.exports);!function(){function e(){this.tasks=[]}e.prototype.call=function(){return ae(this.tasks)},e.prototype.tap=function(e,t){0===this.tasks.length?this.tasks.push(function(e){var r=t();e(!!r&&null,r)}):this.tasks.push(function(r,n){n(!!t.apply(void 0,oP([],oI(r),!1))&&null,e)})}}();var at=function(){function e(){this.tasks=[]}return e.prototype.call=function(){return o4(this.tasks)},e.prototype.tap=function(e,t){this.tasks.push(function(r){r(t(),e)})},e}(),ar=function(){function e(){this.args=[],this.tasks=[]}return e.prototype.promise=function(){for(var e=arguments,t=[],r=0;r<arguments.length;r++)t[r]=e[r];return this.args=t,o4(this.tasks)},e.prototype.tapPromise=function(e,t){var r=this;this.tasks.push(function(n){return oM(r,void 0,void 0,function(){return oO(this,function(r){switch(r.label){case 0:return[4,t.apply(void 0,oP([],oI(this.args),!1))];case 1:return r.sent(),n(null,e),[2]}})})})},e}(),an=function(){function e(){this.args=[],this.tasks=[]}return e.prototype.promise=function(){for(var e=arguments,t=[],r=0;r<arguments.length;r++)t[r]=e[r];return this.args=t,o4(this.tasks)},e.prototype.tapPromise=function(e,t){var r=this;this.tasks.push(function(n){return oM(r,void 0,void 0,function(){return oO(this,function(r){switch(r.label){case 0:return[4,t.apply(void 0,oP([],oI(this.args),!1))];case 1:return n(r.sent(),e),[2]}})})})},e}(),ai=function(){function e(){this.tasks=[]}return e.prototype.promise=function(){return ae(this.tasks)},e.prototype.tapPromise=function(e,t){0===this.tasks.length?this.tasks.push(function(e){t().then(function(t){e(null,t)})}):this.tasks.push(function(e,r){t(e).then(function(e){r(null,e)})})},e}(),ao=r(82809),aa=r.n(ao);class as extends tG.EventEmitter{get iconService(){return this.container.iconService}get fontService(){return this.container.fontService}get controlService(){return this.container.controlService}get configService(){return this.container.globalConfigService}get map(){return this.container.mapService}get coordinateSystemService(){return this.container.coordinateSystemService}get rendererService(){return this.container.rendererService}get layerService(){return this.container.layerService}get debugService(){return this.container.debugService}get cameraService(){return this.container.cameraService}get interactionService(){return this.container.interactionService}get pickingService(){return this.container.pickingService}get shaderModuleService(){return this.container.shaderModuleService}get markerService(){return this.container.markerService}get popupService(){return this.container.popupService}constructor(e){super(),ia(this,"destroyed",!1),ia(this,"loaded",!1),ia(this,"id",void 0),ia(this,"inited",!1),ia(this,"rendering",!1),ia(this,"$container",void 0),ia(this,"canvas",void 0),ia(this,"markerContainer",void 0),ia(this,"resizeDetector",void 0),ia(this,"hooks",void 0),ia(this,"handleWindowResized",()=>{this.emit("resize"),this.$container&&(this.initContainer(),this.coordinateSystemService.needRefresh=!0,this.render())}),ia(this,"handleMapCameraChanged",e=>{this.cameraService.update(e),this.render()}),this.container=e,this.hooks={init:new ar},this.id=e.id}init(e){var t=this;this.configService.setSceneConfig(this.id,e),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",()=>this.render()),this.fontService.init(),this.hooks.init.tapPromise("initMap",iG(function*(){t.debugService.log("map.mapInitStart",{type:t.map.version}),yield new Promise(e=>{t.map.onCameraChanged(r=>{t.cameraService.init(),t.cameraService.update(r),e()}),t.map.init()}),t.map.onCameraChanged(t.handleMapCameraChanged),t.map.addMarkerContainer(),t.markerService.addMarkers(),t.markerService.addMarkerLayers(),t.popupService.initPopup(),t.interactionService.init(),t.interactionService.on(iC.Drag,t.addSceneEvent.bind(t))})),this.hooks.init.tapPromise("initRenderer",iG(function*(){var r,n;let i=(null===(r=t.map)||void 0===r?void 0:r.getOverlayContainer())||void 0;if(i?t.$container=i:t.$container=function(e){let t=e;if("string"==typeof e&&(t=document.getElementById(e)),t){let e=document.createElement("div");return e.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,e.id=`l7-scene-${of++}`,e.classList.add("l7-scene"),t.appendChild(e),e}return null}(t.configService.getSceneConfig(t.id).id||""),t.$container){let{canvas:r}=e;t.canvas=r||tg("canvas","",t.$container),t.setCanvas(),yield t.rendererService.init(t.canvas,t.configService.getSceneConfig(t.id),e.gl),t.registerContextLost(),t.initContainer(),t.resizeDetector=aa()({strategy:"scroll"}),t.resizeDetector.listenTo(t.$container,t.handleWindowResized),window.matchMedia&&(null===(n=window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)"))||void 0===n||n.addListener(t.handleWindowResized.bind("screen")))}else console.error("容器 id 不存在");t.pickingService.init(t.id)})),this.render()}registerContextLost(){let e=this.rendererService.getCanvas();e&&e.addEventListener("webglcontextlost",()=>this.emit("webglcontextlost"))}addLayer(e){this.layerService.sceneService=this,this.layerService.add(e)}addMask(e){this.layerService.sceneService=this,this.layerService.addMask(e)}render(){var e=this;return iG(function*(){e.rendering||e.destroyed||(e.rendering=!0,e.inited?(yield e.layerService.initLayers(),yield e.layerService.renderLayers()):(yield e.hooks.init.promise(),e.destroyed&&e.destroy(),yield e.layerService.initLayers(),e.layerService.renderLayers(),e.controlService.addControls(),e.loaded=!0,e.emit("loaded"),e.inited=!0),e.rendering=!1)})()}addFontFace(e,t){this.fontService.addFontFace(e,t)}getSceneContainer(){return this.$container}exportPng(e){var t=this;return iG(function*(){var r;let n=null===(r=t.$container)||void 0===r?void 0:r.getElementsByTagName("canvas")[0];return yield t.render(),"jpg"===e?null==n?void 0:n.toDataURL("image/jpeg"):null==n?void 0:n.toDataURL("image/png")})()}getSceneConfig(){return this.configService.getSceneConfig(this.id)}getPointSizeRange(){return this.rendererService.getPointSizeRange()}addMarkerContainer(){let e=this.$container.parentElement;null!==e&&(this.markerContainer=tg("div","l7-marker-container",e))}getMarkerContainer(){return this.markerContainer}destroy(){var e;if(!this.inited){this.destroyed=!0;return}this.resizeDetector.removeListener(this.$container,this.handleWindowResized),this.pickingService.destroy(),this.layerService.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.fontService.destroy(),this.iconService.destroy(),this.removeAllListeners(),this.inited=!1,this.map.destroy(),setTimeout(()=>{var e;null===(e=this.$container)||void 0===e||e.removeChild(this.canvas),this.canvas=null,this.rendererService.destroy()}),null===(e=this.$container)||void 0===e||null===(e=e.parentNode)||void 0===e||e.removeChild(this.$container),this.emit("destroy")}initContainer(){var e,t;let r=(null===(e=this.$container)||void 0===e?void 0:e.clientWidth)||400,n=(null===(t=this.$container)||void 0===t?void 0:t.clientHeight)||300,i=this.canvas;i&&(i.width=r*tS,i.height=n*tS),this.rendererService.viewport({x:0,y:0,width:tS*r,height:tS*n})}setCanvas(){var e,t;let r=(null===(e=this.$container)||void 0===e?void 0:e.clientWidth)||400,n=(null===(t=this.$container)||void 0===t?void 0:t.clientHeight)||300,i=this.canvas;i.width=r*tS,i.height=n*tS,i.style.width="100%",i.style.height="100%"}addSceneEvent(e){this.emit(e.type,e)}}let{uniq:al}=th,au="#define PI 3.14159265359",ac="layout(std140) uniform PickingUniforms {\n  vec4 u_HighlightColor;\n  vec4 u_SelectColor;\n  vec3 u_PickingColor;\n  float u_PickingStage;\n  vec3 u_CurrentSelectedId;\n  float u_PickingThreshold;\n  float u_PickingBuffer;\n  float u_shaderPick;\n  float u_activeMix;\n};",ah='#define TILE_SIZE (512.0)\n#define PI (3.1415926536)\n#define WORLD_SCALE (TILE_SIZE / (PI * 2.0))\n#define EARTH_CIRCUMFERENCE (40.03e6)\n\n#define COORDINATE_SYSTEM_LNGLAT (1.0) // mapbox\n#define COORDINATE_SYSTEM_LNGLAT_OFFSET (2.0) // mapbox offset\n#define COORDINATE_SYSTEM_VECTOR_TILE (3.0)\n#define COORDINATE_SYSTEM_IDENTITY (4.0)\n#define COORDINATE_SYSTEM_METER_OFFSET (5.0)\n\n#pragma include "scene_uniforms"\n\nconst vec2 ZERO_64_XY_LOW = vec2(0.0, 0.0);\n\n// web mercator coords -> world coords\nvec2 project_mercator(vec2 lnglat) {\n  float x = lnglat.x;\n  return vec2(radians(x) + PI, PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5)));\n}\n\nfloat project_scale(float meters) {\n  return meters * u_PixelsPerMeter.z;\n}\n\n// offset coords -> world coords\nvec4 project_offset(vec4 offset) {\n  float dy = offset.y;\n  dy = clamp(dy, -1.0, 1.0);\n  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;\n  return vec4(offset.xyz * pixels_per_unit, offset.w);\n}\n\nvec3 project_normal(vec3 normal) {\n  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);\n  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);\n}\n\nvec3 project_offset_normal(vec3 vector) {\n  if (\n    u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 &&\n      u_CoordinateSystem > COORDINATE_SYSTEM_LNGLAT - 0.01 ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n  ) {\n    // normals generated by the polygon tesselator are in lnglat offsets instead of meters\n    return normalize(vector * u_PixelsPerDegree);\n  }\n  return project_normal(vector);\n}\n\nvec4 project_position(vec4 position, vec2 position64xyLow) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    float X = position.x - u_ViewportCenter.x;\n    float Y = position.y - u_ViewportCenter.y;\n    return project_offset(\n      vec4(X + position64xyLow.x, Y + position64xyLow.y, position.z, position.w)\n    );\n  }\n  if (\n    u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 &&\n    u_CoordinateSystem > COORDINATE_SYSTEM_LNGLAT - 0.01\n  ) {\n    return vec4(\n      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,\n      project_scale(position.z),\n      position.w\n    );\n  }\n\n  return position;\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_XY_LOW);\n}\n\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;\n  return offset * u_FocalDistance;\n}\n\n// 适配纹理贴图的等像素大小\nfloat project_pixel_texture(float pixel) {\n  // mapbox zoom > 12\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    return pixel * pow(0.5, u_Zoom) * u_FocalDistance;\n  }\n\n  return pixel * 2.0 * u_FocalDistance;\n}\n\n// 在不论什么底图下需要统一处理的时候使用\nfloat project_float_pixel(float pixel) {\n  if (\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n  ) {\n    // mapbox 坐标系下，为了和 Web 墨卡托坐标系统一，zoom 默认减1\n    return pixel * pow(2.0, 19.0 - u_Zoom) * u_FocalDistance;\n  }\n\n  return pixel * u_FocalDistance;\n}\n\n// Project meter into the unit of pixel which used in the camera world space\nfloat project_float_meter(float meter) {\n  if (\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n  ) {\n    // Since the zoom level uniform is updated by mapservice and it\'s alread been subtracted by 1\n    // Not sure if we are supposed to do that again\n    return meter;\n  } else {\n    return project_float_pixel(meter);\n  }\n\n  // TODO: change the following code to make adaptations for amap\n  // return u_FocalDistance * TILE_SIZE * pow(2.0, u_Zoom) * meter / EARTH_CIRCUMFERENCE;\n\n}\n\nfloat project_pixel(float pixel) {\n  return pixel * u_FocalDistance;\n}\n\nvec2 project_pixel(vec2 pixel) {\n  return pixel * -1.0 * u_FocalDistance;\n}\n\nvec3 project_pixel(vec3 pixel) {\n  return pixel * -1.0 * u_FocalDistance;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  if (\n    u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n  ) {\n    // Needs to be divided with project_uCommonUnitsPerMeter\n    position.w *= u_PixelsPerMeter.z;\n  }\n\n  return viewProjectionMatrix * position + center;\n}\n\n// Projects from common space coordinates to clip space\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(\n    position,\n    u_ViewProjectionMatrix,\n    u_ViewportCenterProjection\n  );\n}\n\nvec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {\n  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);\n\n  if (\n    u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n  ) {\n    // Needs to be divided with project_uCommonUnitsPerMeter\n    pos.w = pos.w / u_PixelsPerMeter.z;\n  }\n  return pos;\n}\n\nbool isEqual(float a, float b) {\n  return a < b + 0.001 && a > b - 0.001;\n}\n\n',ad="layout(std140) uniform SceneUniforms {\n  mat4 u_ViewMatrix;\n  mat4 u_ProjectionMatrix;\n  mat4 u_ViewProjectionMatrix;\n  mat4 u_ModelMatrix;\n  vec4 u_ViewportCenterProjection;\n  vec3 u_PixelsPerDegree;\n  float u_Zoom;\n  vec3 u_PixelsPerDegree2;\n  float u_ZoomScale;\n  vec3 u_PixelsPerMeter;\n  float u_CoordinateSystem;\n  vec3 u_CameraPosition;\n  float u_DevicePixelRatio;\n  vec2 u_ViewportCenter;\n  vec2 u_ViewportSize;\n  float u_FocalDistance;\n};\n",ap=/precision\s+(high|low|medium)p\s+float/,af="#ifdef GL_FRAGMENT_PRECISION_HIGH\n precision highp float;\n #else\n precision mediump float;\n#endif\n",ag=/#pragma include (["^+"]?["[a-zA-Z_0-9](.*)"]*?)/g,am=/void\s+main\s*\([^)]*\)\s*\{\n?/;class av{constructor(){ia(this,"moduleCache",{}),ia(this,"rawContentCache",{})}registerBuiltinModules(){this.destroy(),this.registerModule("common",{vs:au,fs:au}),this.registerModule("decode",{vs:"#define SHIFT_RIGHT17 1.0 / 131072.0\n#define SHIFT_RIGHT18 1.0 / 262144.0\n#define SHIFT_RIGHT19 1.0 / 524288.0\n#define SHIFT_RIGHT20 1.0 / 1048576.0\n#define SHIFT_RIGHT21 1.0 / 2097152.0\n#define SHIFT_RIGHT22 1.0 / 4194304.0\n#define SHIFT_RIGHT23 1.0 / 8388608.0\n#define SHIFT_RIGHT24 1.0 / 16777216.0\n\n#define SHIFT_LEFT17 131072.0\n#define SHIFT_LEFT18 262144.0\n#define SHIFT_LEFT19 524288.0\n#define SHIFT_LEFT20 1048576.0\n#define SHIFT_LEFT21 2097152.0\n#define SHIFT_LEFT22 4194304.0\n#define SHIFT_LEFT23 8388608.0\n#define SHIFT_LEFT24 16777216.0\n\nvec2 unpack_float(float packedValue) {\n  int packedIntValue = int(packedValue);\n  int v0 = packedIntValue / 256;\n  return vec2(v0, packedIntValue - v0 * 256);\n}\n\nvec4 decode_color(vec2 encodedColor) {\n  return vec4(\n    unpack_float(encodedColor[0]) / 255.0,\n    unpack_float(encodedColor[1]) / 255.0\n  );\n}\n",fs:""}),this.registerModule("scene_uniforms",{vs:ad,fs:ad}),this.registerModule("picking_uniforms",{vs:ac,fs:ac}),this.registerModule("projection",{vs:ah,fs:ah}),this.registerModule("project",{vs:"\n#define E 2.718281828459045\nvec2 ProjectFlat(vec2 lnglat){\n  float maxs=85.0511287798;\n  float lat=max(min(maxs,lnglat.y),-maxs);\n  float scale= 268435456.;\n  float d=PI/180.;\n  float x=lnglat.x*d;\n  float y=lat*d;\n  y=log(tan((PI/4.)+(y/2.)));\n\n  float a=.5/PI,\n  b=.5,\n  c=-.5/PI;\n  d=.5;\n  x=scale*(a*x+b);\n  y=scale*(c*y+d);\n  return vec2(x,y);\n}\n\nvec2 unProjectFlat(vec2 px){\n  float a=.5/PI;\n  float b=.5;\n  float c=-.5/PI;\n  float d=.5;\n  float scale = 268435456.;\n  float x=(px.x/scale-b)/a;\n  float y=(px.y/scale-d)/c;\n  y=(atan(pow(E,y))-(PI/4.))*2.;\n  d=PI/180.;\n  float lat=y/d;\n  float lng=x/d;\n  return vec2(lng,lat);\n}\n\nfloat pixelDistance(vec2 from, vec2 to) {\n vec2 a1 = ProjectFlat(from);\n vec2 b1 = ProjectFlat(to);\n return distance(a1, b1);\n}\n\n// gaode2.0\nvec2 customProject(vec2 lnglat) { // 经纬度 => 平面坐标\n  float t = lnglat.x;\n  float e = lnglat.y;\n  float Sm = 180.0 / PI;\n  float Tm = 6378137.0;\n  float Rm = PI / 180.0;\n  float r = 85.0511287798;\n  e = max(min(r, e), -r);\n  t *= Rm;\n  e *= Rm;\n  e = log(tan(PI / 4.0 + e / 2.0));\n  return vec2(t * Tm, e * Tm);\n}\n\nvec2 unProjCustomCoord(vec2 point) { // 平面坐标 => 经纬度\n  float Sm = 57.29577951308232; //180 / Math.PI\n  float Tm = 6378137.0;\n  float t = point.x;\n  float e = point.y;\n  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);\n}\n\n\nfloat customPixelDistance(vec2 from, vec2 to) {\n vec2 a1 = ProjectFlat(from);\n vec2 b1 = ProjectFlat(to);\n return distance(a1, b1);\n}",fs:""}),this.registerModule("sdf_2d",{vs:"",fs:"/**\n * 2D signed distance field functions\n * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm\n */\n\nfloat ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }\n\nfloat sdCircle(vec2 p, float r) {\n  return length(p) - r;\n}\n\nfloat sdEquilateralTriangle(vec2 p) {\n  float k = sqrt(3.0);\n  p.x = abs(p.x) - 1.0;\n  p.y = p.y + 1.0/k;\n  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;\n  p.x -= clamp( p.x, -2.0, 0.0 );\n  return -length(p)*sign(p.y);\n}\n\nfloat sdBox(vec2 p, vec2 b) {\n  vec2 d = abs(p)-b;\n  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);\n}\n\nfloat sdPentagon(vec2 p, float r) {\n  vec3 k = vec3(0.809016994,0.587785252,0.726542528);\n  p.x = abs(p.x);\n  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);\n  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);\n  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdHexagon(vec2 p, float r) {\n  vec3 k = vec3(-0.866025404,0.5,0.577350269);\n  p = abs(p);\n  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;\n  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdOctogon(vec2 p, float r) {\n  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );\n  p = abs(p);\n  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);\n  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);\n  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdHexagram(vec2 p, float r) {\n  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);\n  p = abs(p);\n  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;\n  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;\n  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdRhombus(vec2 p, vec2 b) {\n  vec2 q = abs(p);\n  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);\n  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );\n  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );\n}\n\nfloat sdVesica(vec2 p, float r, float d) {\n  p = abs(p);\n  float b = sqrt(r*r-d*d); // can delay this sqrt\n  return ((p.y-b)*d>p.x*b)\n          ? length(p-vec2(0.0,b))\n          : length(p-vec2(-d,0.0))-r;\n}\n"}),this.registerModule("lighting",{vs:"// Blinn-Phong model\n// apply lighting in vertex shader instead of fragment shader\n// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting\nuniform float u_Ambient : 1.0;\nuniform float u_Diffuse : 1.0;\nuniform float u_Specular : 1.0;\nuniform int u_NumOfDirectionalLights : 1;\nuniform int u_NumOfSpotLights : 0;\n\n#define SHININESS 32.0\n#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3\n#define MAX_NUM_OF_SPOT_LIGHTS 3\n\nstruct DirectionalLight {\n  vec3 direction;\n  vec3 ambient;\n  vec3 diffuse;\n  vec3 specular;\n};\n\nstruct SpotLight {\n  vec3 position;\n  vec3 direction;\n  vec3 ambient;\n  vec3 diffuse;\n  vec3 specular;\n  float constant;\n  float linear;\n  float quadratic;\n  float angle;\n  float blur;\n  float exponent;\n};\n\nuniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];\nuniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];\n\nvec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {\n  vec3 lightDir = normalize(light.direction);\n  // diffuse shading\n  float diff = max(dot(normal, lightDir), 0.0);\n  // Blinn-Phong specular shading\n  vec3 halfwayDir = normalize(lightDir + viewDir);\n  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);\n\n  vec3 ambient = light.ambient * u_Ambient;\n  vec3 diffuse = light.diffuse * diff * u_Diffuse;\n  vec3 specular = light.specular * spec * u_Specular;\n\n  return ambient + diffuse + specular;\n}\n\n\nvec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {\n  vec3 weight = vec3(0.0);\n  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {\n    if (i >= u_NumOfDirectionalLights) {\n      break;\n    }\n    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);\n  }\n  return weight;\n}\n",fs:""}),this.registerModule("light",{vs:"#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\n\nfloat calc_lighting(vec4 pos) {\n\n    vec3 worldPos = vec3(pos * u_ModelMatrix);\n\n    vec3 worldNormal = a_Normal;\n      // //cal light weight\n    vec3 viewDir = normalize(u_CameraPosition - worldPos);\n\n    vec3 lightDir = normalize(vec3(1, -10.5, 12));\n\n    vec3 halfDir = normalize(viewDir+lightDir);\n      // //lambert\n    float lambert = dot(worldNormal, lightDir);\n        //specular\n    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);\n        //sum to light weight\n    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;\n\n    return lightWeight;\n}\n",fs:""}),this.registerModule("picking",{vs:'layout(location = ATTRIBUTE_LOCATION_PICKING_COLOR) in vec3 a_PickingColor;\nout vec4 v_PickingResult;\n\n#pragma include "picking_uniforms"\n\n#define PICKING_NONE 0.0\n#define PICKING_ENCODE 1.0\n#define PICKING_HIGHLIGHT 2.0\n#define COLOR_SCALE 1. / 255.\n\n#define NORMAL 0.0\n#define HIGHLIGHT 1.0\n#define SELECT 2.0\n\nbool isVertexPicked(vec3 vertexColor) {\n  return distance(vertexColor,u_PickingColor.rgb) < 0.01;\n}\n\n// 判断当前点是否已经被 select 选中\nbool isVertexSelected(vec3 vertexColor) {\n  return distance(vertexColor,u_CurrentSelectedId.rgb) < 0.01;\n}\n\nvoid setPickingColor(vec3 pickingColor) {\n  if(u_shaderPick < 0.5) {\n    return;\n  }\n  // compares only in highlight stage\n\n  if(u_PickingStage == PICKING_HIGHLIGHT) {\n    if(isVertexPicked(pickingColor)) {\n       v_PickingResult = vec4(pickingColor.rgb * COLOR_SCALE,HIGHLIGHT);\n       return;\n    }\n    if(isVertexSelected(pickingColor)) {\n     v_PickingResult = vec4(u_CurrentSelectedId.rgb * COLOR_SCALE,SELECT);\n      return;\n    }\n\n  } else {\n      v_PickingResult= vec4(pickingColor.rgb * COLOR_SCALE,NORMAL);\n      return;\n  }\n\n  // // v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && (isVertexPicked(pickingColor) || isVertexPicked(u_CurrentSelectedId)));\n\n  // // Stores the picking color so that the fragment shader can render it during picking\n  // v_PickingResult.rgb = pickingColor * COLOR_SCALE;\n}\n\nfloat setPickingSize(float x) {\n   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;\n}\n\nfloat setPickingOrder(float z) {\n   bool selected = bool(v_PickingResult.a);\n   return selected ? z + 1. : 0.;\n}\n',fs:'\nin vec4 v_PickingResult;\n\n#pragma include "picking_uniforms"\n\n#define PICKING_NONE 0.0\n#define PICKING_ENCODE 1.0\n#define PICKING_HIGHLIGHT 2.0\n#define COLOR_SCALE 1. / 255.\n\n#define HIGHLIGHT 1.0\n#define SELECT 2.0\n\n/*\n * Returns highlight color if this item is selected.\n */\nvec4 filterHighlightColor(vec4 color, float weight) {\n  float activeType = v_PickingResult.a;\n  if(activeType > 0.0) {\n    vec4 highLightColor =  activeType > 1.5 ? u_SelectColor : u_HighlightColor;\n    highLightColor = highLightColor * COLOR_SCALE;\n    float highLightAlpha = highLightColor.a;\n    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));\n    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);\n    return vec4(mix(resultRGB * weight, color.rgb, u_activeMix), color.a);\n  }\n  else {\n    return color;\n  }\n\n  \n}\n\n/*\n * Returns picking color if picking enabled else unmodified argument.\n */\nvec4 filterPickingColor(vec4 color) {\n  vec3 pickingColor = v_PickingResult.rgb;\n  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {\n    discard;\n  }\n  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;\n}\n\n/*\n * Returns picking color if picking is enabled if not\n * highlight color if this item is selected, otherwise unmodified argument.\n */\nvec4 filterColor(vec4 color) {\n  // 过滤多余的 shader 计算\n  // return color;\n  if(u_shaderPick < 0.5) {\n    return color; // 暂时去除 直接取消计算在选中时拖拽地图会有问题\n  } else {\n    return filterPickingColor(filterHighlightColor(color, 1.0));\n  }\n  \n}\n\nvec4 filterColorAlpha(vec4 color, float alpha) {\n  // 过滤多余的 shader 计算\n  // return color;\n  if(u_shaderPick < 0.5) {\n    return color; // 暂时去除 直接取消计算在选中时拖拽地图会有问题\n  } else {\n    return filterPickingColor(filterHighlightColor(color, alpha));\n  }\n}\n\n'}),this.registerModule("rotation_2d",{vs:"vec2 rotate_matrix(vec2 v, float a) {\n    float b = a / 180.0 * 3.1415926535897932384626433832795;\n    float s = sin(b);\n    float c = cos(b);\n    mat2 m = mat2(c, s, -s, c);\n    return m * v;\n}",fs:""})}registerModule(e,t){t.vs=t.vs.replace(/\r\n/g,"\n"),t.fs=t.fs.replace(/\r\n/g,"\n");let{vs:r,fs:n,uniforms:i,defines:o,inject:a}=t,{content:s,uniforms:l}=iy(r),{content:u,uniforms:c}=iy(n);this.rawContentCache[e]={fs:u,defines:o,inject:a,uniforms:il(il(il({},l),c),i),vs:s}}getModule(e){let t=this.rawContentCache[e].vs,r=this.rawContentCache[e].fs,{defines:n={},inject:i={}}=this.rawContentCache[e],o={};i["vs:#decl"]&&(t=i["vs:#decl"]+t,o=iy(i["vs:#decl"]).uniforms),i["vs:#main-start"]&&(t=t.replace(am,e=>e+i["vs:#main-start"])),i["fs:#decl"]&&(r=i["fs:#decl"]+r),t=Object.keys(n).reduce((e,t)=>e+`#define ${t.toUpperCase()} ${n[t]}
`,"\n")+t;let{content:a,includeList:s}=this.processModule(t,[],"vs"),{content:l,includeList:u}=this.processModule(r,[],"fs"),c=al(s.concat(u).concat(e)).reduce((e,t)=>il(il({},e),this.rawContentCache[t].uniforms),il({},o)),h=(ap.test(l)?"":af)+a,d=(ap.test(l)?"":af)+l;return this.moduleCache[e]={vs:h.trim(),fs:d.trim(),uniforms:c},this.moduleCache[e]}destroy(){this.moduleCache={},this.rawContentCache={}}processModule(e,t,r){return{content:e.replace(ag,(e,n)=>{let i=n.split(" ")[0].replace(/"/g,"");if(t.indexOf(i)>-1)return"";let o=this.rawContentCache[i][r];t.push(i);let{content:a}=this.processModule(o,t,r);return a}),includeList:t}}}class ay{constructor(){ia(this,"shaderModuleService",void 0),ia(this,"rendererService",void 0),ia(this,"cameraService",void 0),ia(this,"mapService",void 0),ia(this,"interactionService",void 0),ia(this,"layerService",void 0),ia(this,"config",void 0)}getName(){return""}getType(){return iu.Normal}init(e,t){this.config=t,this.rendererService=e.getContainer().rendererService,this.cameraService=e.getContainer().cameraService,this.mapService=e.getContainer().mapService,this.interactionService=e.getContainer().interactionService,this.layerService=e.getContainer().layerService,this.shaderModuleService=e.getContainer().shaderModuleService}render(e){}}class a_ extends ay{getName(){return"clear"}init(e,t){super.init(e,t)}render(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}class ab{constructor(e){ia(this,"passes",[]),ia(this,"layer",void 0),ia(this,"renderFlag",void 0),ia(this,"width",0),ia(this,"height",0),this.postProcessor=e}setLayer(e){this.layer=e}setRenderFlag(e){this.renderFlag=e}getRenderFlag(){return this.renderFlag}getPostProcessor(){return this.postProcessor}render(){var e=this;return iG(function*(){for(let t of e.passes)yield t.render(e.layer);yield e.postProcessor.render(e.layer)})()}resize(e,t){(this.width!==e||this.height!==t)&&(this.postProcessor.resize(e,t),this.width=e,this.height=t)}add(e,t){e.getType()===iu.PostProcessing?this.postProcessor.add(e,this.layer,t):(e.init(this.layer,t),this.passes.push(e))}insert(e,t,r){e.init(this.layer,t),this.passes.splice(r,0,e)}destroy(){this.passes.length=0}}class ax extends ay{constructor(...e){var t;super(...e),t=this,ia(this,"pickingFBO",void 0),ia(this,"layer",void 0),ia(this,"width",0),ia(this,"height",0),ia(this,"alreadyInRendering",!1),ia(this,"pickFromPickingFBO",({x:e,y:r,lngLat:n,type:i})=>{let o;if(!this.layer.isVisible()||!this.layer.needPick(i))return;let{getViewportSize:a,readPixelsAsync:s,useFramebuffer:l}=this.rendererService,{width:u,height:c}=a(),{enableHighlight:h,enableSelect:d}=this.layer.getLayerConfig(),p=e*tS,f=r*tS;p>u||p<0||f>c||f<0||l(this.pickingFBO,iG(function*(){if(0!==(o=yield s({x:Math.round(p),y:Math.round(c-(r+1)*tS),width:1,height:1,data:new Uint8Array(4),framebuffer:t.pickingFBO}))[0]||0!==o[1]||0!==o[2]){let a=ew(o),s=t.layer.getSource().getFeatureById(a);s&&(t.layer.setCurrentPickId(a),t.triggerHoverOnLayer({x:e,y:r,type:i,lngLat:n,featureId:a,feature:s}))}else{let o={x:e,y:r,lngLat:n,type:null===t.layer.getCurrentPickId()?"un"+i:"mouseout",featureId:null,feature:null};t.triggerHoverOnLayer(il(il({},o),{},{type:"unpick"})),t.triggerHoverOnLayer(o),t.layer.setCurrentPickId(null)}h&&t.highlightPickedFeature(o),d&&"click"===i&&(null==o?void 0:o.toString())!==[0,0,0,0].toString()&&t.selectFeature(o)}))})}getType(){return iu.Normal}getName(){return"pixelPicking"}init(e,t){super.init(e,t),this.layer=e;let{createTexture2D:r,createFramebuffer:n,getViewportSize:i}=this.rendererService,{width:o,height:a}=i(),s=r({width:o,height:a,wrapS:ic.CLAMP_TO_EDGE,wrapT:ic.CLAMP_TO_EDGE,label:"Picking Texture"});this.pickingFBO=n({color:s}),this.interactionService.on(iC.Hover,this.pickFromPickingFBO),this.interactionService.on(iC.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(iC.Active,this.highlightFeatureHandle.bind(this))}render(e){if(this.alreadyInRendering)return;let{getViewportSize:t,useFramebuffer:r,clear:n}=this.rendererService,{width:i,height:o}=t();this.alreadyInRendering=!0,(this.width!==i||this.height!==o)&&(this.pickingFBO.resize({width:i,height:o}),this.width=i,this.height=o),r(this.pickingFBO,()=>{n({framebuffer:this.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});let t=this.layer.multiPassRenderer.getRenderFlag();this.layer.multiPassRenderer.setRenderFlag(!1),e.hooks.beforePickingEncode.call(),e.render(),e.hooks.afterPickingEncode.call(),this.layer.multiPassRenderer.setRenderFlag(t),this.alreadyInRendering=!1})}triggerHoverOnLayer(e){this.layer.emit(e.type,e)}highlightPickedFeature(e){let[t,r,n]=e;this.layer.hooks.beforeHighlight.call([t,r,n]),this.layerService.renderLayers()}selectFeature(e){let[t,r,n]=e;this.layer.hooks.beforeSelect.call([t,r,n]),this.layerService.renderLayers()}selectFeatureHandle({featureId:e}){let t=eL(e);this.selectFeature(new Uint8Array(t))}highlightFeatureHandle({featureId:e}){let t=eL(e);this.highlightPickedFeature(new Uint8Array(t))}}class aS{constructor(e){ia(this,"passes",[]),ia(this,"readFBO",void 0),ia(this,"writeFBO",void 0),this.rendererService=e,this.init()}getReadFBO(){return this.readFBO}getWriteFBO(){return this.writeFBO}getCurrentFBOTex(){let{getViewportSize:e,createTexture2D:t}=this.rendererService,{width:r,height:n}=e();return t({x:0,y:0,width:r,height:n,copy:!0})}getReadFBOTex(){var e=this;let{useFramebuffer:t}=this.rendererService;return new Promise(r=>{t(this.readFBO,iG(function*(){r(e.getCurrentFBOTex())}))})}renderBloomPass(e,t){var r=this;return iG(function*(){let n=yield r.getReadFBOTex(),i=0;for(;i<4;)yield t.render(e,n),r.swap(),i++})()}render(e){var t=this;return iG(function*(){for(let r=0;r<t.passes.length;r++){let n=t.passes[r];n.setRenderToScreen(t.isLastEnabledPass(r)),"bloom"===n.getName()?yield t.renderBloomPass(e,n):(yield n.render(e),r!==t.passes.length-1&&t.swap())}})()}resize(e,t){this.readFBO.resize({width:e,height:t}),this.writeFBO.resize({width:e,height:t})}add(e,t,r){e.init(t,r),this.passes.push(e)}insert(e,t,r,n){e.init(r,n),this.passes.splice(t,0,e)}getPostProcessingPassByName(e){return this.passes.find(t=>t.getName()===e)}init(){let{createFramebuffer:e,createTexture2D:t}=this.rendererService;this.readFBO=e({color:t({width:1,height:1,wrapS:ic.CLAMP_TO_EDGE,wrapT:ic.CLAMP_TO_EDGE,usage:og.RENDER_TARGET})}),this.writeFBO=e({color:t({width:1,height:1,wrapS:ic.CLAMP_TO_EDGE,wrapT:ic.CLAMP_TO_EDGE,usage:og.RENDER_TARGET})})}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].isEnabled())return!1;return!0}swap(){let e=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=e}}class aA extends ay{getType(){return iu.Normal}getName(){return"render"}init(e,t){super.init(e,t)}render(e){let{useFramebuffer:t,clear:r}=this.rendererService,n=e.multiPassRenderer.getPostProcessor().getReadFBO();t(n,()=>{r({color:[0,0,0,0],depth:1,stencil:0,framebuffer:n}),e.multiPassRenderer.setRenderFlag(!1),e.models.forEach(t=>{t.draw({uniforms:e.layerModel.getUninforms()})}),e.multiPassRenderer.setRenderFlag(!0)})}}let{isNil:aE}=th;class aT extends ig{setupShaders(){this.shaderModuleService.registerModule("blur-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform float u_BloomFinal: 0.0;\nuniform sampler2D u_Texture;\nuniform sampler2D u_Texture2;\n\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform float u_radius: 5.0;\nuniform float u_intensity: 0.3;\nuniform float u_baseRadio: 0.5;\n\n// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.3846153846) * direction;\n  vec2 off2 = vec2(3.2307692308) * direction;\n  color += texture2D(image, uv) * 0.2270270270;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n  return color;\n}\n\nfloat luminance(vec4 color) {\n  return  0.2125 * color.r + 0.7154 * color.g + 0.0721 * color.b;\n}\n\nvoid main() {\n  // vec4 baseColor = texture2D(u_Texture, v_UV);\n\n  float r = sqrt(u_radius);\n\n  vec4 c1 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(u_radius, 0.0));\n  // c1 *= luminance(c1);\n  vec4 c2 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(0.0, u_radius));\n  // c2 *= luminance(c2);\n  vec4 c3 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, r));\n  // c3 *= luminance(c3);\n  vec4 c4 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, -r));\n  // c4 *= luminance(c4);\n  vec4 inbloomColor = (c1 + c2 + c3 + c4) * 0.25;\n\n  // float lum = luminance(inbloomColor);\n  // inbloomColor.rgb *= lum;\n\n  if(u_BloomFinal > 0.0) {\n    vec4 baseColor = texture2D(u_Texture2, v_UV);\n    float baselum = luminance(baseColor);\n    gl_FragColor = mix(inbloomColor, baseColor, u_baseRadio);\n    if(baselum <= 0.2) {\n      gl_FragColor = inbloomColor * u_intensity;\n    }\n  } else {\n    gl_FragColor = inbloomColor;\n  }\n}"});let{vs:e,fs:t,uniforms:r}=this.shaderModuleService.getModule("blur-pass"),{width:n,height:i}=this.rendererService.getViewportSize();return{vs:e,fs:t,uniforms:il(il({},r),{},{u_ViewportSize:[n,i]})}}convertOptionsToUniforms(e){let t={};return aE(e.bloomRadius)||(t.u_radius=e.bloomRadius),aE(e.bloomIntensity)||(t.u_intensity=e.bloomIntensity),aE(e.bloomBaseRadio)||(t.u_baseRadio=e.bloomBaseRadio),t}}let{isNil:aC}=th;class aw extends ig{setupShaders(){this.shaderModuleService.registerModule("blur-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_BlurDir: [1.0, 0.0];\n\n// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.3846153846) * direction;\n  vec2 off2 = vec2(3.2307692308) * direction;\n  color += texture2D(image, uv) * 0.2270270270;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);\n}"});let{vs:e,fs:t,uniforms:r}=this.shaderModuleService.getModule("blur-pass"),{width:n,height:i}=this.rendererService.getViewportSize();return{vs:e,fs:t,uniforms:il(il({},r),{},{u_ViewportSize:[n,i]})}}convertOptionsToUniforms(e){let t={};return aC(e.blurRadius)||(t.u_BlurDir=[e.blurRadius,0]),t}}let{isNil:aL}=th;class aM extends ig{setupShaders(){this.shaderModuleService.registerModule("blur-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_BlurDir: [1.0, 0.0];\n\n// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.3846153846) * direction;\n  vec2 off2 = vec2(3.2307692308) * direction;\n  color += texture2D(image, uv) * 0.2270270270;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);\n}"});let{vs:e,fs:t,uniforms:r}=this.shaderModuleService.getModule("blur-pass"),{width:n,height:i}=this.rendererService.getViewportSize();return{vs:e,fs:t,uniforms:il(il({},r),{},{u_ViewportSize:[n,i]})}}convertOptionsToUniforms(e){let t={};return aL(e.blurRadius)||(t.u_BlurDir=[0,e.blurRadius]),t}}class aO extends ig{setupShaders(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:'varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_Center : [0.5, 0.5];\nuniform float u_Angle : 0;\nuniform float u_Size : 8;\n\n#pragma include "common"\n\nfloat scale = PI / u_Size;\n\nfloat pattern(float u_Angle, vec2 texSize, vec2 texCoord) {\n  float s = sin(u_Angle), c = cos(u_Angle);\n  vec2 tex = texCoord * texSize - u_Center * texSize;\n  vec2 point = vec2(\n    c * tex.x - s * tex.y,\n    s * tex.x + c * tex.y\n  ) * scale;\n  return (sin(point.x) * sin(point.y)) * 4.0;\n}\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js\nvec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  vec3 cmy = 1.0 - color.rgb;\n  float k = min(cmy.x, min(cmy.y, cmy.z));\n  cmy = (cmy - k) / (1.0 - k);\n  cmy = clamp(\n    cmy * 10.0 - 3.0 + vec3(\n      pattern(u_Angle + 0.26179, texSize, texCoord),\n      pattern(u_Angle + 1.30899, texSize, texCoord),\n      pattern(u_Angle, texSize, texCoord)\n    ),\n    0.0,\n    1.0\n  );\n  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);\n  return vec4(1.0 - cmy - k, color.a);\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);\n}'});let{vs:e,fs:t,uniforms:r}=this.shaderModuleService.getModule("colorhalftone-pass"),{width:n,height:i}=this.rendererService.getViewportSize();return{vs:e,fs:t,uniforms:il(il({},r),{},{u_ViewportSize:[n,i]})}}}class aI extends ig{setupShaders(){return this.shaderModuleService.registerModule("copy-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n}"}),this.shaderModuleService.getModule("copy-pass")}}class aP extends ig{setupShaders(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_Center : [0.5, 0.5];\nuniform float u_Scale : 10;\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js\nvec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;\n  tex.y /= 0.866025404;\n  tex.x -= tex.y * 0.5;\n  vec2 a;\n  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {\n    a = vec2(floor(tex.x), floor(tex.y));\n  }\n  else a = vec2(ceil(tex.x), ceil(tex.y));\n  vec2 b = vec2(ceil(tex.x), floor(tex.y));\n  vec2 c = vec2(floor(tex.x), ceil(tex.y));\n  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);\n  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);\n  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);\n  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);\n  float alen = length(TEX - A);\n  float blen = length(TEX - B);\n  float clen = length(TEX - C);\n  vec2 choice;\n  if (alen < blen) {\n    if (alen < clen) choice = a;\n    else choice = c;\n  } else {\n    if (blen < clen) choice = b;\n    else choice = c;\n  }\n  choice.x += choice.y * 0.5;\n  choice.y *= 0.866025404;\n  choice *= u_Scale / texSize;\n  return texture2D(texture, choice + u_Center);\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);\n}"});let{vs:e,fs:t,uniforms:r}=this.shaderModuleService.getModule("hexagonalpixelate-pass"),{width:n,height:i}=this.rendererService.getViewportSize();return{vs:e,fs:t,uniforms:il(il({},r),{},{u_ViewportSize:[n,i]})}}}class aR extends ig{setupShaders(){this.shaderModuleService.registerModule("ink-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform float u_Strength : 0.6;\n\nvec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 dx = vec2(1.0 / texSize.x, 0.0);\n  vec2 dy = vec2(0.0, 1.0 / texSize.y);\n  vec4 color = texture2D(texture, texCoord);\n  float bigTotal = 0.0;\n  float smallTotal = 0.0;\n  vec3 bigAverage = vec3(0.0);\n  vec3 smallAverage = vec3(0.0);\n  for (float x = -2.0; x <= 2.0; x += 1.0) {\n    for (float y = -2.0; y <= 2.0; y += 1.0) {\n      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;\n      bigAverage += sample;\n      bigTotal += 1.0;\n      if (abs(x) + abs(y) < 2.0) {\n        smallAverage += sample;\n        smallTotal += 1.0;\n      }\n    }\n  }\n  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);\n  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;\n  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);\n}"});let{vs:e,fs:t,uniforms:r}=this.shaderModuleService.getModule("ink-pass"),{width:n,height:i}=this.rendererService.getViewportSize();return{vs:e,fs:t,uniforms:il(il({},r),{},{u_ViewportSize:[n,i]})}}}class ak extends ig{setupShaders(){return this.shaderModuleService.registerModule("noise-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform float u_Amount : 0.5;\n\nfloat rand(vec2 co) {\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js\nvec4 noise_filterColor(vec4 color, vec2 texCoord) {\n  float diff = (rand(texCoord) - 0.5) * u_Amount;\n  color.r += diff;\n  color.g += diff;\n  color.b += diff;\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);\n}"}),this.shaderModuleService.getModule("noise-pass")}}class aN extends ig{setupShaders(){return this.shaderModuleService.registerModule("sepia-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nuniform float u_Amount : 0.5;\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js\nvec4 sepia_filterColor(vec4 color) {\n  float r = color.r;\n  float g = color.g;\n  float b = color.b;\n  color.r =\n    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));\n  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));\n  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = sepia_filterColor(gl_FragColor);\n}"}),this.shaderModuleService.getModule("sepia-pass")}}let aD=new or,aU=0;function az(e){let t=il({},e);return t.postProcessor=new aS(t.rendererService),t.multiPassRenderer=new ab(t.postProcessor),t.styleAttributeService=new ow(t.rendererService),t}let aB=["loaded","fontloaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"],aF=function(e){return e.IMAGE="image",e.CUSTOMIMAGE="customImage",e.ARRAYBUFFER="arraybuffer",e.RGB="rgb",e.TERRAINRGB="terrainRGB",e.CUSTOMRGB="customRGB",e.CUSTOMARRAYBUFFER="customArrayBuffer",e.CUSTOMTERRAINRGB="customTerrainRGB",e}({});var aj=(e,t,r)=>new Promise((n,i)=>{var o=e=>{try{s(r.next(e))}catch(e){i(e)}},a=e=>{try{s(r.throw(e))}catch(e){i(e)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,a);s((r=r.apply(e,t)).next())}),aV=(e,t,r,n)=>aj(void 0,null,function*(){return new Promise((i,o)=>{t({x:e.x,y:e.y,z:e.z},(e,t)=>{if(e||0===t.length){o(e);return}t&&ir([{data:t,bands:[0]}],r,n,(e,t)=>{e?o(e):t&&i(t)})})})}),aH=(e,t)=>aj(void 0,null,function*(){return new Promise((r,n)=>{t({x:e.x,y:e.y,z:e.z},(e,t)=>{if(e||!t){n(e);return}t instanceof ArrayBuffer?Y(t,(e,t)=>{e&&n(e),r(t)}):t instanceof HTMLImageElement?r(t):n(e)})})});function aG(e,t){e.xhrCancel=()=>{t.map(e=>{e.abort()})}}var aW=Object.defineProperty,aX=Object.defineProperties,a$=Object.getOwnPropertyDescriptors,aZ=Object.getOwnPropertySymbols,aY=Object.prototype.hasOwnProperty,aq=Object.prototype.propertyIsEnumerable,aK=(e,t,r)=>t in e?aW(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,aQ=(e,t)=>{for(var r in t||(t={}))aY.call(t,r)&&aK(e,r,t[r]);if(aZ)for(var r of aZ(t))aq.call(t,r)&&aK(e,r,t[r]);return e},aJ=(e,t)=>aX(e,a$(t)),a0=(e,t,r)=>new Promise((n,i)=>{var o=e=>{try{s(r.next(e))}catch(e){i(e)}},a=e=>{try{s(r.throw(e))}catch(e){i(e)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,a);s((r=r.apply(e,t)).next())}),a1=(e,t,r,n,i)=>a0(void 0,null,function*(){var o;let a="string"==typeof(o=t.url)?[{url:o,bands:[0]}]:"string"==typeof o[0]?o.map(e=>({url:e,bands:[0]})):o;if(a.length>1){let{rasterFiles:o,xhrList:s,errList:l}=yield function(e,t){return a0(this,null,function*(){let r=[],n=[],i=[];for(let o=0;o<e.length;o++){let a=e[o],s=aJ(aQ({},t),{url:a.url}),l=a.bands,{err:u,data:c,xhr:h}=yield function(e){return new Promise((t,r)=>{F(e,(e,n,i,o,a)=>{e?r({err:e,data:null,xhr:a}):t({err:null,data:n,cacheControl:i,expires:o,xhr:a})})})}(aJ(aQ({},s),{type:"arrayBuffer"}));u&&i.push(u),n.push(h),r.push({data:c,bands:l})}return{rasterFiles:r,xhrList:n,errList:i}})}(a,t);if(aG(e,s),l.length>0){r(l,null);return}ir(o,n,i,r)}else aG(e,[H(t,(e,t)=>{e?r(e):t&&ir([{data:t,bands:a[0].bands}],n,i,r)})])}),a2=Object.defineProperty,a3=Object.defineProperties,a4=Object.getOwnPropertyDescriptors,a5=Object.getOwnPropertySymbols,a6=Object.prototype.hasOwnProperty,a7=Object.prototype.propertyIsEnumerable,a8=(e,t,r)=>t in e?a2(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,a9=(e,t)=>{for(var r in t||(t={}))a6.call(t,r)&&a8(e,r,t[r]);if(a5)for(var r of a5(t))a7.call(t,r)&&a8(e,r,t[r]);return e},se=(e,t)=>a3(e,a4(t)),st=(e,t,r)=>new Promise((n,i)=>{var o=e=>{try{s(r.next(e))}catch(e){i(e)}},a=e=>{try{s(r.throw(e))}catch(e){i(e)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,a);s((r=r.apply(e,t)).next())}),sr=(e,t,r,n)=>st(void 0,null,function*(){let{format:i=si,operation:o,requestParameters:a={}}=n,s=se(a9({},a),{url:Array.isArray(e)?"string"==typeof e[0]?e.map(e=>rc(e,t)):e.map(e=>({url:rc(e.url,t),bands:e.bands||[0]})):rc(e,t)});return new Promise((e,t)=>{a1(r,s,(r,n)=>{r?t(r):n&&e(n)},i,o)})}),sn=(e,t,r,n)=>st(void 0,null,function*(){let i;let o=Array.isArray(e)?e[0]:e;return i=n.wmtsOptions?((null==n?void 0:n.getURLFromTemplate)||function(e,t){let{x:r,y:n,z:i,layer:o,version:a="1.0.0",style:s="default",format:l,service:u="WMTS",tileMatrixset:c}=t,h=ru(e),d=Math.abs(r+n)%h.length;return`${h[d]}&SERVICE=${u}&REQUEST=GetTile&VERSION=${a}&LAYER=${o}&STYLE=${s}&TILEMATRIXSET=${c}&FORMAT=${l}&TILECOL=${r}&TILEROW=${n}&TILEMATRIX=${i}`})(o,a9(a9({},t),n.wmtsOptions)):((null==n?void 0:n.getURLFromTemplate)||rc)(o,t),new Promise((e,t)=>{var o;let a=Z(se(a9({},null==n?void 0:n.requestParameters),{url:i,type:(null==(o=null==n?void 0:n.requestParameters)?void 0:o.type)||"arrayBuffer"}),(r,n)=>{r?t(r):n&&e(n)},n.transformResponse);r.xhrCancel=()=>a.cancel()})}),si=()=>({rasterData:new Uint8Array([0]),width:1,height:1}),so=Object.defineProperty,sa=Object.defineProperties,ss=Object.getOwnPropertyDescriptors,sl=Object.getOwnPropertySymbols,su=Object.prototype.hasOwnProperty,sc=Object.prototype.propertyIsEnumerable,sh=(e,t,r)=>t in e?so(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,sd=(e,t)=>{for(var r in t||(t={}))su.call(t,r)&&sh(e,r,t[r]);if(sl)for(var r of sl(t))sc.call(t,r)&&sh(e,r,t[r]);return e},sp=(e,t)=>sa(e,ss(t)),sf={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0};aF.ARRAYBUFFER,aF.RGB;var sg=Object.defineProperty,sm=Object.defineProperties,sv=Object.getOwnPropertyDescriptors,sy=Object.getOwnPropertySymbols,s_=Object.prototype.hasOwnProperty,sb=Object.prototype.propertyIsEnumerable,sx=(e,t,r)=>t in e?sg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,sS=(e,t)=>{for(var r in t||(t={}))s_.call(t,r)&&sx(e,r,t[r]);if(sy)for(var r of sy(t))sb.call(t,r)&&sx(e,r,t[r]);return e},sA=(e,t)=>sm(e,sv(t)),sE=(e,t)=>{var r={};for(var n in e)s_.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&sy)for(var n of sy(e))0>t.indexOf(n)&&sb.call(e,n)&&(r[n]=e[n]);return r},sT=Object.defineProperty,sC=Object.defineProperties,sw=Object.getOwnPropertyDescriptors,sL=Object.getOwnPropertySymbols,sM=Object.prototype.hasOwnProperty,sO=Object.prototype.propertyIsEnumerable,sI=(e,t,r)=>t in e?sT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,sP=(e,t)=>{for(var r in t||(t={}))sM.call(t,r)&&sI(e,r,t[r]);if(sL)for(var r of sL(t))sO.call(t,r)&&sI(e,r,t[r]);return e},sR=(e,t)=>sC(e,sw(t)),sk=(e,t)=>{var r={};for(var n in e)sM.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&sL)for(var n of sL(e))0>t.indexOf(n)&&sO.call(e,n)&&(r[n]=e[n]);return r},sN=Object.defineProperty,sD=Object.defineProperties,sU=Object.getOwnPropertyDescriptors,sz=Object.getOwnPropertySymbols,sB=Object.prototype.hasOwnProperty,sF=Object.prototype.propertyIsEnumerable,sj=(e,t,r)=>t in e?sN(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,sV=(e,t)=>{for(var r in t||(t={}))sB.call(t,r)&&sj(e,r,t[r]);if(sz)for(var r of sz(t))sF.call(t,r)&&sj(e,r,t[r]);return e},sH=(e,t)=>sD(e,sU(t)),sG=(e,t)=>{var r={};for(var n in e)sB.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&sz)for(var n of sz(e))0>t.indexOf(n)&&sF.call(e,n)&&(r[n]=e[n]);return r},sW=Object.defineProperty,sX=Object.defineProperties,s$=Object.getOwnPropertyDescriptors,sZ=Object.getOwnPropertySymbols,sY=Object.prototype.hasOwnProperty,sq=Object.prototype.propertyIsEnumerable,sK=(e,t,r)=>t in e?sW(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,sQ=(e,t)=>{for(var r in t||(t={}))sY.call(t,r)&&sK(e,r,t[r]);if(sZ)for(var r of sZ(t))sq.call(t,r)&&sK(e,r,t[r]);return e},sJ=(e,t)=>sX(e,s$(t)),s0=(e,t,r)=>new Promise((n,i)=>{var o=e=>{try{s(r.next(e))}catch(e){i(e)}},a=e=>{try{s(r.throw(e))}catch(e){i(e)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,a);s((r=r.apply(e,t)).next())}),s1={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0},s2=e=>s0(void 0,null,function*(){return new Promise(t=>{let[r,n,i,o]=e.bounds;t({layers:{testTile:{features:[{type:"Feature",properties:{key:e.x+"/"+e.y+"/"+e.z,x:(r+i)/2,y:(n+o)/2},geometry:{type:"LineString",coordinates:[[i,o],[i,n],[r,n],[r,n]]}}]}}})})}),s3=r(43464),s4=r.n(s3),s5=Object.defineProperty,s6=Object.getOwnPropertySymbols,s7=Object.prototype.hasOwnProperty,s8=Object.prototype.propertyIsEnumerable,s9=(e,t,r)=>t in e?s5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,le=(e,t)=>{for(var r in t||(t={}))s7.call(t,r)&&s9(e,r,t[r]);if(s6)for(var r of s6(t))s8.call(t,r)&&s9(e,r,t[r]);return e};function lt(e,t){let{radius:r=40,maxZoom:n=18,minZoom:i=0,zoom:o=2}=t;if(e.pointIndex){let t=e.pointIndex.getClusters(e.extent,Math.floor(o));return e.dataArray=t.map((e,t)=>le({coordinates:e.geometry.coordinates,_id:t+1},e.properties)),e}let a=new(s4())({radius:r,minZoom:i,maxZoom:n}),s={features:[]};return s.features=e.dataArray.map(e=>({type:"Feature",geometry:{type:"Point",coordinates:e.coordinates},properties:le({},e)})),a.load(s.features),a}function lr(e){let t;if(0===e.length)return 0;let r=e[0],n=0;for(let i=1;i<e.length;i++)t=r+1*e[i],Math.abs(r)>=Math.abs(e[i])?n+=r-t+e[i]:n+=e[i]-t+r,r=t;return r+1*n}var ln={min:function(e){if(0===e.length)throw Error("min requires at least one data point");let t=e[0];for(let r=1;r<e.length;r++)e[r]<t&&(t=e[r]);return t},max:function(e){if(0===e.length)throw Error("max requires at least one data point");let t=e[0];for(let r=1;r<e.length;r++)e[r]>t&&(t=e[r]);return t},mean:function(e){if(0===e.length)throw Error("mean requires at least one data point");return lr(e)/e.length},sum:lr},li=Object.defineProperty,lo=Object.getOwnPropertySymbols,la=Object.prototype.hasOwnProperty,ls=Object.prototype.propertyIsEnumerable,ll=(e,t,r)=>t in e?li(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,lu=(e,t)=>{for(var r in t||(t={}))la.call(t,r)&&ll(e,r,t[r]);if(lo)for(var r of lo(t))ls.call(t,r)&&ll(e,r,t[r]);return e},lc=(e,t,r)=>new Promise((n,i)=>{var o=e=>{try{s(r.next(e))}catch(e){i(e)}},a=e=>{try{s(r.throw(e))}catch(e){i(e)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,a);s((r=r.apply(e,t)).next())}),{cloneDeep:lh,isFunction:ld,isString:lp,mergeWith:lf}=th;function lg(e,t){if(Array.isArray(t))return t}var lm=class extends tG.EventEmitter{constructor(e,t){super(),this.type="source",this.isTile=!1,this.inited=!1,this.hooks={init:new o5},this.parser={type:"geojson"},this.transforms=[],this.cluster=!1,this.clusterOptions={enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"},this.invalidExtent=!1,this.dataArrayChanged=!1,this.cfg={autoRender:!0},this.originData=e,this.initCfg(t),this.init().then(()=>{this.inited=!0,this.emit("update",{type:"inited"})})}getSourceCfg(){return this.cfg}getClusters(e){return this.clusterIndex.getClusters(this.caculClusterExtent(2),e)}getClustersLeaves(e){return this.clusterIndex.getLeaves(e,1/0)}getParserType(){return this.parser.type}updateClusterData(e){let{method:t="sum",field:r}=this.clusterOptions,n=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(e));this.clusterOptions.zoom=e,n.forEach(e=>{e.id||(e.properties.point_count=1)}),(r||ld(t))&&(n=n.map(e=>{let n=e.id;if(n){let i;let o=this.clusterIndex.getLeaves(n,1/0).map(e=>e.properties);if(lp(t)&&r){let e=o.map(e=>1*e[r]);i=ln[t](e)}ld(t)&&(i=t(o)),e.properties.stat=i}else e.properties.point_count=1;return e})),this.data=d("geojson")({type:"FeatureCollection",features:n}),this.executeTrans()}getFeatureById(e){let{type:t="geojson",geometry:r}=this.parser;if("geojson"!==t||this.cluster)return"json"===t&&r?this.data.dataArray.find(t=>t._id===e):e<this.data.dataArray.length?this.data.dataArray[e]:"null";{let t=lh(e<this.originData.features.length?this.originData.features[e]:"null");if((null==t?void 0:t.properties)&&(0!==this.transforms.length||this.dataArrayChanged)){let r=this.data.dataArray.find(t=>t._id===e);t.properties=r}return t}}updateFeaturePropertiesById(e,t){this.data.dataArray=this.data.dataArray.map(r=>r._id===e?lu(lu({},r),t):r),this.dataArrayChanged=!0,this.emit("update",{type:"update"})}getFeatureId(e,t){let r=this.data.dataArray.find(r=>r[e]===t);return null==r?void 0:r._id}setData(e,t){this.originData=e,this.dataArrayChanged=!1,this.initCfg(t),this.init().then(()=>{this.emit("update",{type:"update"})})}reloadAllTile(){var e;null==(e=this.tileset)||e.reloadAll()}reloadTilebyId(e,t,r){var n;null==(n=this.tileset)||n.reloadTileById(e,t,r)}reloadTileByLnglat(e,t,r){var n;null==(n=this.tileset)||n.reloadTileByLnglat(e,t,r)}getTileExtent(e,t){var r;return null==(r=this.tileset)?void 0:r.getTileExtent(e,t)}getTileByZXY(e,t,r){var n;return null==(n=this.tileset)?void 0:n.getTileByZXY(e,t,r)}reloadTileByExtent(e,t){var r;null==(r=this.tileset)||r.reloadTileByExtent(e,t)}destroy(){var e;this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null,null==(e=this.tileset)||e.destroy()}processData(){return lc(this,null,function*(){return new Promise((e,t)=>{try{this.excuteParser(),this.initCluster(),this.executeTrans(),e({})}catch(e){t(e)}})})}initCfg(e){this.cfg=lf(this.cfg,e,lg);let t=this.cfg;t&&(t.parser&&(this.parser=t.parser),t.transforms&&(this.transforms=t.transforms),this.cluster=t.cluster||!1,t.clusterOptions&&(this.cluster=!0,this.clusterOptions=lu(lu({},this.clusterOptions),t.clusterOptions)))}init(){return lc(this,null,function*(){this.inited=!1,yield this.processData(),this.inited=!0})}excuteParser(){let e=this.parser,t=d(e.type||"geojson");this.data=t(this.originData,e),this.tileset=this.initTileset(),e.cancelExtent||(this.extent=function(e){let t=[1/0,1/0,-1/0,-1/0];return e.forEach(e=>{let{coordinates:r}=e;(function e(t,r){return Array.isArray(r[0])?r.forEach(r=>{e(t,r)}):(t[0]>r[0]&&(t[0]=r[0]),t[1]>r[1]&&(t[1]=r[1]),t[2]<r[0]&&(t[2]=r[0]),t[3]<r[1]&&(t[3]=r[1])),t})(t,r)}),t}(this.data.dataArray),this.setCenter(this.extent),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3])}setCenter(e){this.center=[(e[0]+e[2])/2,(e[1]+e[3])/2],(isNaN(this.center[0])||isNaN(this.center[1]))&&(this.center=[108.92361111111111,34.54083333333333])}initTileset(){let{tilesetOptions:e}=this.data;return e?(this.isTile=!0,this.tileset)?(this.tileset.updateOptions(e),this.tileset):new rl(lu({},e)):void 0}executeTrans(){this.transforms.forEach(e=>{let{type:t}=e,r=f(t)(this.data,e);Object.assign(this.data,r)})}initCluster(){if(!this.cluster)return;let e=this.clusterOptions||{};this.clusterIndex=lt(this.data,e)}caculClusterExtent(e){let t=[[-1/0,-1/0],[1/0,1/0]];return this.invalidExtent||(t=tI(tR(this.extent),e)),t[0].concat(t[1])}},lv=Math.PI/3,ly=[0,lv,2*lv,3*lv,4*lv,5*lv];function l_(e){return e[0]}function lb(e){return e[1]}var lx=Object.defineProperty,lS=Object.defineProperties,lA=Object.getOwnPropertyDescriptors,lE=Object.getOwnPropertySymbols,lT=Object.prototype.hasOwnProperty,lC=Object.prototype.propertyIsEnumerable,lw=(e,t,r)=>t in e?lx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,lL=(e,t)=>{for(var r in t||(t={}))lT.call(t,r)&&lw(e,r,t[r]);if(lE)for(var r of lE(t))lC.call(t,r)&&lw(e,r,t[r]);return e},lM=(e,t)=>lS(e,lA(t)),lO=Object.defineProperty,lI=Object.getOwnPropertySymbols,lP=Object.prototype.hasOwnProperty,lR=Object.prototype.propertyIsEnumerable,lk=(e,t,r)=>t in e?lO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,lN=(e,t)=>{for(var r in t||(t={}))lP.call(t,r)&&lk(e,r,t[r]);if(lI)for(var r of lI(t))lR.call(t,r)&&lk(e,r,t[r]);return e};r(54289),p("rasterTile",function(e,t={}){if(Array.isArray(e)&&0===e.length||!Array.isArray(e)&&"string"!=typeof e)throw Error("tile server url is error");let{extent:r=[1/0,1/0,-1/0,-1/0],coordinates:n}=t,i=(null==t?void 0:t.dataType)||aF.IMAGE;i===aF.RGB&&(i=aF.ARRAYBUFFER);let o=sp(sd(sd({},sf),t),{getTileData:(r,n)=>{switch(i){case aF.IMAGE:return sn(e,r,n,t);case aF.CUSTOMIMAGE:case aF.CUSTOMTERRAINRGB:return aH(n,null==t?void 0:t.getCustomData);case aF.ARRAYBUFFER:return sr(e,r,n,t);case aF.CUSTOMARRAYBUFFER:case aF.CUSTOMRGB:return aV(n,null==t?void 0:t.getCustomData,(null==t?void 0:t.format)||si,null==t?void 0:t.operation);default:return sn(e,r,n,t)}}});return{data:e,dataArray:[{_id:1,coordinates:rm(n,r)}],tilesetOptions:o,isTile:!0}}),p("mvt",function(e,t){let r=Array.isArray(e)?e[0]:e,n=nZ(n$(n$({},nq),t),{getTileData:(e,n)=>nK(r,e,n,null==t?void 0:t.requestParameters,null==t?void 0:t.getCustomData)});return{data:r,dataArray:[],tilesetOptions:n,isTile:!0}}),p("geojsonvt",function(e,t){let r=function(e){let t={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!0,debug:0};return void 0===e||void 0===e.geojsonvtOptions?t:nt(nt({},t),e.geojsonvtOptions)}(t),n=r.extent||4096,i=new r1(e,r);return{data:e,dataArray:[],tilesetOptions:nr(nt(nt({},ni),t),{getTileData:(e,t)=>na(t,i,e,n)}),isTile:!0}}),p("testTile",function(e,t){return{data:e,dataArray:[],tilesetOptions:sJ(sQ(sQ({},s1),t),{getTileData:e=>s2(e)}),isTile:!0}}),p("geojson",function(e,t){let r=[],n={};return e.features?(e.features=e.features.filter(e=>{let t=e.geometry;return null!=e&&t&&t.type&&t.coordinates&&t.coordinates.length>0}),0===(e=rg(e)).features.length)?{dataArray:[],featureKeys:n}:(w(e,(e,n)=>{var i;let o=void 0===(i=null==t?void 0:t.featureId)?null:"number"==typeof(1*e.properties[i])?1*e.properties[i]:e.properties&&e.properties[i]?function(e){let t=e.toString(),r=5381,n=t.length;for(;n;)r=33*r^t.charCodeAt(--n);return r>>>0}(e.properties[i]+"")%1000019:null;null===o&&(o=n);let a=o,s=T(e),l=rN(rk({},e.properties),{coordinates:s,_id:a});r.push(l)}),{dataArray:r,featureKeys:n}):(e.features=[],{dataArray:[]})}),p("jsonTile",function(e,t){return{dataArray:[],tilesetOptions:nE(nA({},t),{getTileData:(r,n)=>nC(e,n,null==t?void 0:t.requestParameters,t.getCustomData)}),isTile:!0}}),p("image",function(e,t){let{extent:r=[121.168,30.2828,121.384,30.4219],coordinates:n,requestParameters:i={}}=t,o=new Promise(t=>{e instanceof HTMLImageElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?t([e]):function(e,t,r){let n=[];if("string"==typeof e)Z(ng(nf({},t),{url:e}),(e,t)=>{t&&(n.push(t),r(n))});else{let i=e.length,o=0;e.forEach(e=>{Z(ng(nf({},t),{url:e}),(e,t)=>{o++,t&&n.push(t),o===i&&r(n)})})}}(e,i,e=>{t(e)})});return{originData:e,images:o,_id:1,dataArray:[{_id:0,coordinates:rm(n,r)}]}}),p("csv",function(e,t){return rC(S(e),t)}),p("json",rC),p("raster",function(e,t){let r,n,i;let{extent:o=[121.168,30.2828,121.384,30.4219],coordinates:a,width:s,height:l,min:u,max:c,format:h,operation:d}=t;return void 0===h||rf(e)?(r=Array.from(e),n=s,i=l):r=it(Array.isArray(e)?e:[e],h,d),{_id:1,dataArray:[{_id:1,data:r,width:n,height:i,min:u,max:c,coordinates:rm(a,o)}]}}),p("rasterRgb",function(e,t){let r;let{extent:n,coordinates:i,min:o,max:a,width:s,height:l,format:u,operation:c}=t,h=sG(t,["extent","coordinates","min","max","width","height","format","operation"]);r=void 0===u||rf(e)?Array.from(e):it(Array.isArray(e)?e:[e],u,c);let d=rm(i,n);return{_id:1,dataArray:[sH(sV({_id:1,data:r,width:s,height:l},h),{min:o,max:a,coordinates:d})]}}),p("rgb",function(e,t){let{extent:r,coordinates:n,width:i,height:o}=t,a=sk(t,["extent","coordinates","width","height"]);e.length<3&&console.warn("RGB解析需要三个波段的数据");let[s,l,u]=a.bands||[0,1,2],c=[e[s],e[l],e[u]],h=[],[d,p]=(null==a?void 0:a.countCut)||[2,98],f=(null==a?void 0:a.RMinMax)||n0(c[0],d,p),g=(null==a?void 0:a.GMinMax)||n0(c[1],d,p),m=(null==a?void 0:a.BMinMax)||n0(c[2],d,p);for(let e=0;e<c[0].length;e++)h.push(Math.max(0,c[0][e]-f[0])),h.push(Math.max(0,c[1][e]-g[0])),h.push(Math.max(0,c[2][e]-m[0]));let v=rm(n,r);return{_id:1,dataArray:[sR(sP({_id:1,data:h,width:i,height:o,rMinMax:f,gMinMax:g,bMinMax:m},a),{coordinates:v})]}}),p("ndi",function(e,t){let{extent:r=[121.168,30.2828,121.384,30.4219],coordinates:n,width:i,height:o}=t,a=sE(t,["extent","coordinates","width","height"]);e.length<2&&console.warn("RGB解析需要2个波段的数据");let[s,l]=a.bands||[0,1],u=[e[s],e[l]],c=[];for(let e=0;e<u[0].length;e++)c.push((u[1][e]-u[0][e])/(u[1][e]+u[0][e]));let h=rm(n,r);return{_id:1,dataArray:[sA(sS({_id:1,data:c,width:i,height:o},a),{coordinates:h})]}}),g("cluster",lt),g("filter",function(e,t){let{callback:r}=t;return r&&(e.dataArray=e.dataArray.filter(r)),e}),g("join",function(e,t){let{sourceField:r,targetField:n,data:i}=t,o={};return i.forEach(e=>{o[e[r]]=e}),e.dataArray=e.dataArray.map(e=>{let t=e[n];return lN(lN({},e),o[t])}),e}),g("map",function(e,t){let{callback:r}=t;return r&&(e.dataArray=e.dataArray.map(r)),e}),g("grid",function(e,t){let r=e.dataArray,{size:n=10}=t,i=n/(2*Math.PI*6378e3)*0x10000000/2,{gridHash:o,gridOffset:a}=function(e,t){let r,n=1/0,i=-1/0;for(let t of e)Number.isFinite(r=t.coordinates[1])&&(n=r<n?r:n,i=r>i?r:i);let o={yOffset:t/6378e3*(180/Math.PI),xOffset:t/6378e3*(180/Math.PI)/Math.cos((n+i)/2*Math.PI/180)};if(o.xOffset<=0||o.yOffset<=0)return{gridHash:{},gridOffset:o};let a={};for(let t of e){let e=t.coordinates[1],r=t.coordinates[0];if(Number.isFinite(e)&&Number.isFinite(r)){let n=Math.floor((e+90)/o.yOffset),i=Math.floor((r+180)/o.xOffset),s=`${n}-${i}`;a[s]=a[s]||{count:0,points:[]},a[s].count+=1,a[s].points.push(t)}}return{gridHash:a,gridOffset:o}}(r,n);return{yOffset:i,xOffset:i,radius:i,type:"grid",dataArray:Object.keys(o).reduce((e,r,n)=>{let i=r.split("-"),s=parseInt(i[0],10),l=parseInt(i[1],10),u={};if(t.field&&t.method){let e=tH(o[r].points,t.field);u[t.method]=tV[t.method](e)}return Object.assign(u,{_id:n,coordinates:tO([-180+a.xOffset*(l+.5),-90+a.yOffset*(s+.5)]),rawData:o[r].points,count:o[r].count}),e.push(u),e},[])}}),g("hexagon",function(e,t){let r=e.dataArray,{size:n=10,method:i="sum"}=t,o=n/(2*Math.PI*6378e3)*0x10000000/2,a=r.map(e=>{let[t,r]=tO(e.coordinates);return lM(lL({},e),{coordinates:[t,r]})});return{dataArray:(function(){var e,t,r,n=0,i=0,o=1,a=1,s=l_,l=lb;function u(e){var n,i={},o=[],a=e.length;for(n=0;n<a;++n)if(!(isNaN(c=+s.call(null,u=e[n],n,e))||isNaN(h=+l.call(null,u,n,e)))){var u,c,h,d=Math.round(h/=r),p=Math.round(c=c/t-(1&d)/2),f=h-d;if(3*Math.abs(f)>1){var g=c-p,m=p+(c<p?-1:1)/2,v=d+(h<d?-1:1),y=c-m,_=h-v;g*g+f*f>y*y+_*_&&(p=m+(1&d?1:-1)/2,d=v)}var b=p+"-"+d,x=i[b];x?x.push(u):(o.push(x=i[b]=[u]),x.x=(p+(1&d)/2)*t,x.y=d*r)}return o}function c(e){var t=0,r=0;return ly.map(function(n){var i=Math.sin(n)*e,o=-Math.cos(n)*e,a=i-t,s=o-r;return t=i,r=o,[a,s]})}return u.hexagon=function(t){return"m"+c(null==t?e:+t).join("l")+"z"},u.centers=function(){for(var s=[],l=Math.round(i/r),u=Math.round(n/t),c=l*r;c<a+e;c+=r,++l)for(var h=u*t+(1&l)*t/2;h<o+t/2;h+=t)s.push([h,c]);return s},u.mesh=function(){var t=c(e).slice(0,4).join("l");return u.centers().map(function(e){return"M"+e+"m"+t}).join("")},u.x=function(e){return arguments.length?(s=e,u):s},u.y=function(e){return arguments.length?(l=e,u):l},u.radius=function(n){return arguments.length?(t=2*(e=+n)*Math.sin(lv),r=1.5*e,u):e},u.size=function(e){return arguments.length?(n=i=0,o=+e[0],a=+e[1],u):[o-n,a-i]},u.extent=function(e){return arguments.length?(n=+e[0][0],i=+e[0][1],o=+e[1][0],a=+e[1][1],u):[[n,i],[o,a]]},u.radius(1)})().radius(o).x(e=>e.coordinates[0]).y(e=>e.coordinates[1])(a).map((e,r)=>{if(t.field&&i){let r=tH(e,t.field);e[i]=tV[i](r)}return{[t.method]:e[i],count:e.length,rawData:e,coordinates:[e.x,e.y],_id:r}}),radius:o,xOffset:o,yOffset:o,type:"hexagon"}});class lD extends tG.EventEmitter{getMarkerLayerContainerSize(){}constructor(e){super(),ia(this,"markerOption",void 0),ia(this,"popup",void 0),ia(this,"mapsService",void 0),ia(this,"lngLat",void 0),ia(this,"scene",void 0),ia(this,"added",!1),ia(this,"preLngLat",{lng:0,lat:0}),ia(this,"onMarkerDragStart",e=>{let t=this.mapsService.getContainer();if(!t)return;this.mapsService.setMapStatus({dragEnable:!1,zoomEnable:!1});let{left:r,top:n}=t.getClientRects()[0],{x:i,y:o}=e;this.preLngLat=this.mapsService.containerToLngLat([i-r,o-n]),this.mapsService.on("mousemove",this.onMarkerDragMove),document.addEventListener("mouseup",this.onMarkerDragEnd),this.emit("dragstart",this.lngLat)}),ia(this,"onMarkerDragMove",e=>{let t=e.lngLat||e.lnglat,{lng:r,lat:n}=this.preLngLat,{lng:i,lat:o}=t,a={lng:this.lngLat.lng+i-r,lat:this.lngLat.lat+o-n};this.setLnglat(a),this.preLngLat=t,this.emit("dragging",a)}),ia(this,"onMarkerDragEnd",()=>{this.mapsService.setMapStatus({dragEnable:!0,zoomEnable:!0}),this.mapsService.off("mousemove",this.onMarkerDragMove),document.removeEventListener("mouseup",this.onMarkerDragEnd),this.emit("dragend",this.lngLat)}),ia(this,"eventHandle",e=>{this.polyfillEvent(e),this.emit(e.type,{target:e,data:this.markerOption.extData,lngLat:this.lngLat})}),ia(this,"touchStartTime",void 0),this.markerOption=il(il({},this.getDefault()),e),function(e,t){e.forEach(e=>{t[e]&&(t[e]=t[e].bind(t))})}(["update","onMove","onMapClick","updatePositionWhenZoom"],this),this.init()}getDefault(){return{element:void 0,anchor:q.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1,overflowHide:!0}}addTo(e){this.scene=e,this.mapsService=e.mapService;let{element:t}=this.markerOption;return this.mapsService.getMarkerContainer().appendChild(t),this.registerMarkerEvent(t),this.mapsService.on("camerachange",this.update),this.update(),this.updateDraggable(),this.added=!0,this.emit("added"),this}remove(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("camerachange",this.update)),this.unRegisterMarkerEvent(),this.removeAllListeners();let{element:e}=this.markerOption;return e&&tm(e),this.popup&&this.popup.remove(),this}setLnglat(e){return this.lngLat=e,Array.isArray(e)&&(this.lngLat={lng:e[0],lat:e[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}getLnglat(){return this.lngLat}getElement(){return this.markerOption.element}setElement(e){if(!this.added)return this.once("added",()=>{this.setElement(e)}),this;let{element:t}=this.markerOption;return t&&tm(t),this.markerOption.element=e,this.init(),this.mapsService.getMarkerContainer().appendChild(e),this.registerMarkerEvent(e),this.updateDraggable(),this.update(),this}openPopup(){if(!this.added)return this.once("added",()=>{this.openPopup()}),this;let e=this.popup;return e&&(e.isOpen()||e.addTo(this.scene)),this}closePopup(){this.added||this.once("added",()=>{this.closePopup()});let e=this.popup;return e&&e.remove(),this}setPopup(e){return this.popup=e,this.lngLat&&this.popup.setLnglat(this.lngLat),this}togglePopup(){let e=this.popup;return e&&(e.isOpen()?e.remove():e.addTo(this.scene)),this}getPopup(){return this.popup}getOffset(){return this.markerOption.offsets}setDraggable(e){this.markerOption.draggable=e,this.updateDraggable()}getDraggable(){return this.markerOption.draggable}getExtData(){return this.markerOption.extData}setExtData(e){this.markerOption.extData=e}update(){var e;if(!this.mapsService)return;let{element:t,anchor:r}=this.markerOption;this.updatePosition(),e=`${K[r]}`,t.style[tx]=e}updatePositionWhenZoom(e){if(!this.mapsService)return;let{element:t,offsets:r}=this.markerOption,{lng:n,lat:i}=this.lngLat;if(t){t.style.display="block",t.style.whiteSpace="nowrap";let{containerHeight:o,containerWidth:a,bounds:s}=this.getMarkerLayerContainerSize()||this.getCurrentContainerSize();if(!s)return;let l=e.map,u=e.center,c=e.zoom,h=l.DE(this.lngLat,c,u);if(h.x=Math.round(h.x+r[0]),h.y=Math.round(h.y-r[1]),Math.abs(s[0][0])>180||Math.abs(s[1][0])>180){if(h.x>a){let e=this.mapsService.lngLatToContainer([n-360,i]);h.x=e.x}if(h.x<0){let e=this.mapsService.lngLatToContainer([n+360,i]);h.x=e.x}}(h.x>a||h.x<0||h.y>o||h.y<0)&&(t.style.display="none"),t.style.left=h.x+"px",t.style.top=h.y+"px",t.style.transition="left 0.25s cubic-bezier(0,0,0.25,1), top 0.25s cubic-bezier(0,0,0.25,1)"}}onMapClick(e){let{element:t}=this.markerOption;this.popup&&t&&this.togglePopup()}getCurrentContainerSize(){let e=this.mapsService.getContainer();return{containerHeight:(null==e?void 0:e.scrollHeight)||0,containerWidth:(null==e?void 0:e.scrollWidth)||0,bounds:this.mapsService.getBounds()}}updateDraggable(){let{element:e}=this.markerOption;null==e||e.removeEventListener("mousedown",this.onMarkerDragStart),this.mapsService.off("mousemove",this.onMarkerDragMove),document.removeEventListener("mouseup",this.onMarkerDragEnd),this.markerOption.draggable&&(null==e||e.addEventListener("mousedown",this.onMarkerDragStart))}updatePosition(){if(!this.mapsService)return;let{element:e,offsets:t}=this.markerOption,{lng:r,lat:n}=this.lngLat,i=this.mapsService.lngLatToContainer([r,n]);if(e){e.style.display="block",e.style.whiteSpace="nowrap";let{containerHeight:o,containerWidth:a,bounds:s}=this.getMarkerLayerContainerSize()||this.getCurrentContainerSize();if(!s)return;if(Math.abs(s[0][0])>180||Math.abs(s[1][0])>180){if(i.x>a){let e=this.mapsService.lngLatToContainer([r-360,n]);i.x=e.x}if(i.x<0){let e=this.mapsService.lngLatToContainer([r+360,n]);i.x=e.x}}this.markerOption.overflowHide&&(i.x>a||i.x<0||i.y>o||i.y<0)&&(e.style.display="none"),e.style.left=i.x+t[0]+"px",e.style.top=i.y-t[1]+"px"}}init(){let{element:e}=this.markerOption,{color:t,anchor:r}=this.markerOption;if(!e){e=tg("div"),this.markerOption.element=e;let r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttributeNS(null,"display","block"),r.setAttributeNS(null,"height","48px"),r.setAttributeNS(null,"width","48px"),r.setAttributeNS(null,"viewBox","0 0 1024 1024");let n=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),n.setAttributeNS(null,"fill",t),r.appendChild(n),e.appendChild(r)}tv(e,"l7-marker"),Object.keys(this.markerOption.style||{}).forEach(t=>{var r,n;let i=(null===(r=this.markerOption)||void 0===r?void 0:r.style)&&(null===(n=this.markerOption)||void 0===n?void 0:n.style[t]);e&&(e.style[t]=i)}),function(e,t,r){let n=e.classList;for(let e in K)K.hasOwnProperty(e)&&n.remove(`l7-${r}-anchor-${e}`);n.add(`l7-${r}-anchor-${t}`)}(e,r,"marker")}registerMarkerEvent(e){e.addEventListener("click",this.onMapClick),e.addEventListener("mousemove",this.eventHandle),e.addEventListener("click",this.eventHandle),e.addEventListener("mousedown",this.eventHandle),e.addEventListener("mouseup",this.eventHandle),e.addEventListener("dblclick",this.eventHandle),e.addEventListener("contextmenu",this.eventHandle),e.addEventListener("mouseover",this.eventHandle),e.addEventListener("mouseout",this.eventHandle),e.addEventListener("touchstart",this.eventHandle),e.addEventListener("touchend",this.eventHandle)}unRegisterMarkerEvent(){let e=this.getElement();e.removeEventListener("click",this.onMapClick),e.removeEventListener("mousemove",this.eventHandle),e.removeEventListener("click",this.eventHandle),e.removeEventListener("mousedown",this.eventHandle),e.removeEventListener("mouseup",this.eventHandle),e.removeEventListener("dblclick",this.eventHandle),e.removeEventListener("contextmenu",this.eventHandle),e.removeEventListener("mouseover",this.eventHandle),e.removeEventListener("mouseout",this.eventHandle),e.removeEventListener("touchstart",this.eventHandle),e.removeEventListener("touchend",this.eventHandle)}polyfillEvent(e){this.mapsService&&"amap"===this.mapsService.getType()&&!function(){let e=!0;for(let t of["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"])if(tE.indexOf(t)>0){e=!1;break}return e}()&&("touchstart"===e.type&&(this.touchStartTime=Date.now()),"touchend"===e.type&&Date.now()-this.touchStartTime<300&&this.emit("click",{target:e,data:this.markerOption.extData,lngLat:this.lngLat}))}addDragHandler(e){return null}onUp(e){throw Error("Method not implemented.")}}let{merge:lU}=th;r(41363);class lz extends tW(){constructor(e){super(),ia(this,"controlOption",void 0),ia(this,"container",void 0),ia(this,"isShow",void 0),ia(this,"sceneContainer",void 0),ia(this,"scene",void 0),ia(this,"mapsService",void 0),ia(this,"renderService",void 0),ia(this,"layerService",void 0),ia(this,"controlService",void 0),ia(this,"configService",void 0),lz.controlCount++,this.controlOption=il(il({},this.getDefault(e)),e||{})}getOptions(){return this.controlOption}setOptions(e){let t=this.getDefault(e);Object.entries(e).forEach(([r,n])=>{void 0===n&&(e[r]=t[r])}),"position"in e&&this.setPosition(e.position),"className"in e&&this.setClassName(e.className),"style"in e&&this.setStyle(e.style),this.controlOption=il(il({},this.controlOption),e)}addTo(e){this.mapsService=e.mapService,this.renderService=e.rendererService,this.layerService=e.layerService,this.controlService=e.controlService,this.configService=e.globalConfigService,this.scene=e.sceneService,this.sceneContainer=e,this.isShow=!0,this.container=this.onAdd(),tv(this.container,"l7-control");let{className:t,style:r}=this.controlOption;return t&&this.setClassName(t),r&&this.setStyle(r),this.insertContainer(),this.emit("add",this),this}remove(){if(!this.mapsService)return this;tm(this.container),this.onRemove(),this.emit("remove",this)}onAdd(){return tg("div")}onRemove(){}show(){ty(this.container,"l7-control--hide"),this.isShow=!0,this.emit("show",this)}hide(){tv(this.container,"l7-control--hide"),this.isShow=!1,this.emit("hide",this)}getDefault(e){return{position:iS.TOPRIGHT,name:`${lz.controlCount}`}}getContainer(){return this.container}getIsShow(){return this.isShow}_refocusOnMap(e){if(this.mapsService&&e&&e.screenX>0&&e.screenY>0){let e=this.mapsService.getContainer();null!==e&&e.focus()}}setPosition(e=iS.TOPLEFT){let t=this.controlService;return t&&t.removeControl(this),this.controlOption.position=e,t&&t.addControl(this,this.sceneContainer),this}setClassName(e){let t=this.container,{className:r}=this.controlOption;r&&ty(t,r),e&&tv(t,e)}setStyle(e){let t=this.container;e?t.setAttribute("style",e):t.removeAttribute("style")}insertContainer(){let e=this.controlOption.position,t=this.container;if(e instanceof Element)e.appendChild(t);else{let r=this.controlService.controlCorners[e];["bottomleft","bottomright","righttop","rightbottom"].includes(e)?r.insertBefore(t,r.firstChild):r.appendChild(t)}}checkUpdateOption(e,t){return t.some(t=>t in e)}}ia(lz,"controlCount",0);class lB extends tG.EventEmitter{get buttonRect(){return this.button.getBoundingClientRect()}constructor(e,t){super(),ia(this,"popperDOM",void 0),ia(this,"contentDOM",void 0),ia(this,"button",void 0),ia(this,"option",void 0),ia(this,"isShow",!1),ia(this,"content",void 0),ia(this,"timeout",null),ia(this,"show",()=>(this.isShow||!this.contentDOM.innerHTML||(this.resetPopperPosition(),ty(this.popperDOM,"l7-popper-hide"),this.isShow=!0,this.option.unique&&lB.conflictPopperList.forEach(e=>{e!==this&&e.isShow&&e.hide()}),this.emit("show"),window.addEventListener("pointerdown",this.onPopperUnClick)),this)),ia(this,"hide",()=>(this.isShow&&(tv(this.popperDOM,"l7-popper-hide"),this.isShow=!1,this.emit("hide"),window.removeEventListener("pointerdown",this.onPopperUnClick)),this)),ia(this,"setHideTimeout",()=>{this.timeout||(this.timeout=window.setTimeout(()=>{this.isShow&&(this.hide(),this.timeout=null)},300))}),ia(this,"clearHideTimeout",()=>{this.timeout&&(window.clearTimeout(this.timeout),this.timeout=null)}),ia(this,"onBtnClick",()=>{this.isShow?this.hide():this.show()}),ia(this,"onPopperUnClick",e=>{!function(e,t){var r;let n=Array.isArray(t)?t:[t],i=e;for(;i instanceof Element&&i!==window.document.body;){if(n.find(e=>null==i?void 0:i.matches(e)))return i;i=null!=(r=null==i?void 0:i.parentElement)?r:null}}(e.target,[".l7-button-control",".l7-popper-content"])&&this.hide()}),ia(this,"onBtnMouseLeave",()=>{this.setHideTimeout()}),ia(this,"onBtnMouseMove",()=>{this.clearHideTimeout(),this.isShow||this.show()}),this.button=e,this.option=t,this.init(),t.unique&&lB.conflictPopperList.push(this)}getPopperDOM(){return this.popperDOM}getIsShow(){return this.isShow}getContent(){return this.content}setContent(e){"string"==typeof e?this.contentDOM.innerHTML=e:e instanceof HTMLElement&&(tA(this.contentDOM),this.contentDOM.appendChild(e)),this.content=e}init(){let{trigger:e}=this.option;this.popperDOM=this.createPopper(),"click"===e?this.button.addEventListener("click",this.onBtnClick):(this.button.addEventListener("mousemove",this.onBtnMouseMove),this.button.addEventListener("mouseleave",this.onBtnMouseLeave),this.popperDOM.addEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.addEventListener("mouseleave",this.onBtnMouseLeave))}destroy(){this.button.removeEventListener("click",this.onBtnClick),this.button.removeEventListener("mousemove",this.onBtnMouseMove),this.button.removeEventListener("mousemove",this.onBtnMouseLeave),this.popperDOM.removeEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.removeEventListener("mouseleave",this.onBtnMouseLeave),tm(this.popperDOM)}resetPopperPosition(){let e={},{container:t,offset:r=[0,0],placement:n}=this.option,[i,o]=r,a=this.button.getBoundingClientRect(),s=t.getBoundingClientRect(),{left:l,right:u,top:c,bottom:h}={left:a.left-s.left,top:a.top-s.top,right:s.left+s.width-a.left-a.width,bottom:s.top+s.height-a.top-a.height},d=!1,p=!1;/^(left|right)/.test(n)?(n.includes("left")?e.right=`${a.width+u}px`:n.includes("right")&&(e.left=`${a.width+l}px`),n.includes("start")?e.top=`${c}px`:n.includes("end")?e.bottom=`${h}px`:(e.top=`${c+a.height/2}px`,p=!0,e.transform=`translate(${i}px, calc(${o}px - 50%))`)):/^(top|bottom)/.test(n)&&(n.includes("top")?e.bottom=`${a.height+h}px`:n.includes("bottom")&&(e.top=`${a.height+c}px`),n.includes("start")?e.left=`${l}px`:n.includes("end")?e.right=`${u}px`:(e.left=`${l+a.width/2}px`,d=!0,e.transform=`translate(calc(${i}px - 50%), ${o}px)`)),e.transform=`translate(calc(${i}px - ${d?"50%":"0%"}), calc(${o}px - ${p?"50%":"0%"})`;let f=n.split("-");f.length&&tv(this.popperDOM,f.map(e=>`l7-popper-${e}`).join(" ")),function(e,t){e.setAttribute("style",`${e.style.cssText}${t}`)}(this.popperDOM,Object.entries(e).map(([e,t])=>`${e}: ${t}`).join(";"))}createPopper(){let{container:e,className:t="",content:r}=this.option,n=tg("div",`l7-popper l7-popper-hide ${t}`),i=tg("div","l7-popper-content"),o=tg("div","l7-popper-arrow");return n.appendChild(i),n.appendChild(o),e.appendChild(n),this.popperDOM=n,this.contentDOM=i,r&&this.setContent(r),n}}ia(lB,"conflictPopperList",[]);var lF=function(e){return e.ActiveOptionClassName="l7-select-control-item-active",e.OptionValueAttrKey="data-option-value",e.OptionIndexAttrKey="data-option-index",e}(lF||{});let lj=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],lV=(()=>{if("undefined"==typeof document)return!1;let e=lj[0],t={};for(let r of lj)if((null==r?void 0:r[1])in document){for(let[n,i]of r.entries())t[e[n]]=i;return t}return!1})(),lH={change:lV.fullscreenchange,error:lV.fullscreenerror},lG={request:(e=document.documentElement,t)=>new Promise((r,n)=>{let i=()=>{lG.off("change",i),r()};lG.on("change",i);let o=e[lV.requestFullscreen](t);o instanceof Promise&&o.then(i).catch(n)}),exit:()=>new Promise((e,t)=>{if(!lG.isFullscreen){e();return}let r=()=>{lG.off("change",r),e()};lG.on("change",r);let n=document[lV.exitFullscreen]();n instanceof Promise&&n.then(r).catch(t)}),toggle:(e,t)=>lG.isFullscreen?lG.exit():lG.request(e,t),onchange(e){lG.on("change",e)},onerror(e){lG.on("error",e)},on(e,t){let r=lH[e];r&&document.addEventListener(r,t,!1)},off(e,t){let r=lH[e];r&&document.removeEventListener(r,t,!1)},raw:lV};Object.defineProperties(lG,{isFullscreen:{get:()=>!!document[lV.fullscreenElement]},element:{enumerable:!0,get:()=>{var e;return null!==(e=document[lV.fullscreenElement])&&void 0!==e?e:void 0}},isEnabled:{enumerable:!0,get:()=>!!document[lV.fullscreenEnabled]}}),lV||(lG={isEnabled:!1});class lW extends lz{getDefault(){return{position:iS.BOTTOMLEFT,name:"logo",href:"https://l7.antv.antgroup.com/",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*GRb1TKp4HcMAAAAAAAAAAAAAARQnAQ"}}onAdd(){let e=tg("div","l7-control-logo");return this.setLogoContent(e),e}onRemove(){return null}setOptions(e){super.setOptions(e),this.checkUpdateOption(e,["img","href"])&&(tA(this.container),this.setLogoContent(this.container))}setLogoContent(e){let{href:t,img:r}=this.controlOption,n=tg("img");if(n.setAttribute("src",r),n.setAttribute("aria-label","AntV logo"),!function(e){e.setAttribute("draggable","false")}(n),t){let r=tg("a","l7-control-logo-link");r.target="_blank",r.href=t,r.rel="noopener nofollow",r.setAttribute("rel","noopener nofollow"),r.appendChild(n),e.appendChild(r)}else e.appendChild(n)}}class lX{constructor(){ia(this,"mapService",void 0),ia(this,"fontService",void 0)}apply(e,{styleAttributeService:t,mapService:r,fontService:n}){var i,o=this;this.mapService=r,this.fontService=n,e.hooks.init.tapPromise("DataMappingPlugin",iG(function*(){e.log(iT.MappingStart,iO.INIT),o.generateMaping(e,{styleAttributeService:t}),e.log(iT.MappingEnd,iO.INIT)})),e.hooks.beforeRenderData.tapPromise("DataMappingPlugin",(i=iG(function*(r){if(!r)return r;e.dataState.dataMappingNeedUpdate=!1,e.log(iT.MappingStart,iO.UPDATE);let n=o.generateMaping(e,{styleAttributeService:t});return e.log(iT.MappingEnd,iO.UPDATE),n}),function(e){return i.apply(this,arguments)})),e.hooks.beforeRender.tap("DataMappingPlugin",()=>{let r=e.getSource();if(e.layerModelNeedUpdate||!r||!r.inited)return;let n=t.getLayerStyleAttributes()||[],i=t.getLayerStyleAttribute("filter"),{dataArray:o}=r.data;if(Array.isArray(o)&&0===o.length)return;let a=n.filter(e=>e.needRemapping),s=o;if(null!=i&&i.needRemapping&&null!=i&&i.scale&&(s=o.filter(e=>this.applyAttributeMapping(i,e)[0])),a.length){let t=this.mapping(e,a,s,e.getEncodedData());e.setEncodedData(t)}})}generateMaping(e,{styleAttributeService:t}){let r=t.getLayerStyleAttributes()||[],n=t.getLayerStyleAttribute("filter"),{dataArray:i}=e.getSource().data,o=i;null!=n&&n.scale&&(o=i.filter(e=>this.applyAttributeMapping(n,e)[0])),o=e.processData(o);let a=this.mapping(e,r,o,void 0);return e.setEncodedData(a),e.emit("dataUpdate",null),!0}mapping(e,t,r,n){let i=t.filter(e=>void 0!==e.scale).filter(e=>"filter"!==e.name),o=r.map((e,t)=>{let r=n?n[t]:{},o=il({id:e._id,coordinates:e.coordinates},r);return i.forEach(t=>{let r=this.applyAttributeMapping(t,e);("color"===t.name||"stroke"===t.name)&&(r=r.map(e=>eC(e))),o[t.name]=Array.isArray(r)&&1===r.length?r[0]:r,"shape"===t.name&&(o.shape=this.fontService.getIconFontKey(o[t.name]))}),o});return t.forEach(e=>{e.needRemapping=!1}),this.adjustData2SimpleCoordinates(o),o}adjustData2SimpleCoordinates(e){e.length>0&&"SIMPLE"===this.mapService.version&&e.map(e=>{e.simpleCoordinate||(e.coordinates=this.unProjectCoordinates(e.coordinates),e.simpleCoordinate=!0)})}unProjectCoordinates(e){if("number"==typeof e[0])return this.mapService.simpleMapCoord.unproject(e);if(e[0]&&e[0][0]instanceof Array){let t=[];return e.map(e=>{let r=[];e.map(e=>{r.push(this.mapService.simpleMapCoord.unproject(e))}),t.push(r)}),t}{let t=[];return e.map(e=>{t.push(this.mapService.simpleMapCoord.unproject(e))}),t}}applyAttributeMapping(e,t){var r;if(!e.scale)return[];let n=(null==e||null===(r=e.scale)||void 0===r?void 0:r.scalers)||[],i=[];return n.forEach(({field:r})=>{var n;(t.hasOwnProperty(r)||(null===(n=e.scale)||void 0===n?void 0:n.type)==="variable")&&i.push(t[r])}),e.mapping?e.mapping(i):[]}getArrowPoints(e,t){let r=function(e){var t;let r=(t=[0,0],Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)));return[e[0]/r,e[1]/r]}([t[0]-e[0],t[1]-e[1]]);return[e[0]+1e-4*r[0],e[1]+1e-4*r[1]]}}class l${constructor(){ia(this,"mapService",void 0)}apply(e){var t=this;this.mapService=e.getContainer().mapService,e.hooks.init.tapPromise("DataSourcePlugin",iG(function*(){e.log(iT.SourceInitStart,iO.INIT);let r=e.getSource();if(!r){let{data:t,options:n}=e.sourceOption||e.defaultSourceConfig;r=new lm(t,n),e.setSource(r)}r.inited?(t.updateClusterData(e),e.log(iT.SourceInitEnd,iO.INIT)):yield new Promise(n=>{r.on("update",r=>{"inited"===r.type&&(t.updateClusterData(e),e.log(iT.SourceInitEnd,iO.INIT)),n(null)})})})),e.hooks.beforeRenderData.tapPromise("DataSourcePlugin",iG(function*(){let r=t.updateClusterData(e),n=e.dataState.dataSourceNeedUpdate;return e.dataState.dataSourceNeedUpdate=!1,r||n}))}updateClusterData(e){if(e.isTileLayer||e.tileLayer||!e.getSource())return!1;let t=e.getSource(),r=t.cluster,{zoom:n=0}=t.clusterOptions,i=this.mapService.getZoom()-1,o=e.dataState.dataSourceNeedUpdate;return r&&o&&t.updateClusterData(Math.floor(i)),!!(r&&Math.abs(e.clusterZoom-i)>=1)&&(n!==Math.floor(i)&&t.updateClusterData(Math.floor(i)),e.clusterZoom=i,!0)}}function lZ(e,t){let r,n;if(void 0===t)for(let t of e)null!=t&&(void 0===r?t>=t&&(r=n=t):(r>t&&(r=t),n<t&&(n=t)));else{let i=-1;for(let o of e)null!=(o=t(o,++i,e))&&(void 0===r?o>=o&&(r=n=o):(r>o&&(r=o),n<o&&(n=o)))}return[r,n]}function lY(e,t,r,n,i){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*r+(1+3*e+3*o-3*a)*n+a*i)/6}function lq(e){return function(){return e}}function lK(e,t){var r=t-e;return r?function(t){return e+t*r}:lq(isNaN(e)?t:e)}let lQ=function e(t){var r,n=1==(r=+(r=t))?lK:function(e,t){var n,i,o;return t-e?(n=e,i=t,n=Math.pow(n,o=r),i=Math.pow(i,o)-n,o=1/o,function(e){return Math.pow(n+e*i,o)}):lq(isNaN(e)?t:e)};function i(e,t){var r=n((e=ev(e)).r,(t=ev(t)).r),i=n(e.g,t.g),o=n(e.b,t.b),a=lK(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=o(t),e.opacity=a(t),e+""}}return i.gamma=e,i}(1);function lJ(e){return function(t){var r,n,i=t.length,o=Array(i),a=Array(i),s=Array(i);for(r=0;r<i;++r)n=ev(t[r]),o[r]=n.r||0,a[r]=n.g||0,s[r]=n.b||0;return o=e(o),a=e(a),s=e(s),n.opacity=1,function(e){return n.r=o(e),n.g=a(e),n.b=s(e),n+""}}}var l0=lJ(function(e){var t=e.length-1;return function(r){var n=r<=0?r=0:r>=1?(r=1,t-1):Math.floor(r*t),i=e[n],o=e[n+1],a=n>0?e[n-1]:2*i-o,s=n<t-1?e[n+2]:2*o-i;return lY((r-n/t)*t,a,i,o,s)}});function l1(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function l2(e){var t;return 1===e.length&&(t=e,e=function(e,r){return l1(t(e),r)}),{left:function(t,r,n,i){for(null==n&&(n=0),null==i&&(i=t.length);n<i;){var o=n+i>>>1;0>e(t[o],r)?n=o+1:i=o}return n},right:function(t,r,n,i){for(null==n&&(n=0),null==i&&(i=t.length);n<i;){var o=n+i>>>1;e(t[o],r)>0?i=o:n=o+1}return n}}}lJ(function(e){var t=e.length;return function(r){var n=Math.floor(((r%=1)<0?++r:r)*t),i=e[(n+t-1)%t],o=e[n%t],a=e[(n+1)%t],s=e[(n+2)%t];return lY((r-n/t)*t,i,o,a,s)}});var l3=l2(l1),l4=l3.right;l3.left;var l5=Array.prototype;l5.slice,l5.map;var l6=Math.sqrt(50),l7=Math.sqrt(10),l8=Math.sqrt(2);function l9(e,t,r){var n,i,o,a,s=-1;if(r=+r,(e=+e)==(t=+t)&&r>0)return[e];if((n=t<e)&&(i=e,e=t,t=i),0===(a=ue(e,t,r))||!isFinite(a))return[];if(a>0)for(e=Math.ceil(e/a),o=Array(i=Math.ceil((t=Math.floor(t/a))-e+1));++s<i;)o[s]=(e+s)*a;else for(o=Array(i=Math.ceil((e=Math.floor(e*a))-(t=Math.ceil(t*a))+1));++s<i;)o[s]=(e-s)/a;return n&&o.reverse(),o}function ue(e,t,r){var n=(t-e)/Math.max(0,r),i=Math.floor(Math.log(n)/Math.LN10),o=n/Math.pow(10,i);return i>=0?(o>=l6?10:o>=l7?5:o>=l8?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=l6?10:o>=l7?5:o>=l8?2:1)}function ut(e,t,r){var n=Math.abs(t-e)/Math.max(0,r),i=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),o=n/i;return o>=l6?i*=10:o>=l7?i*=5:o>=l8&&(i*=2),t<e?-i:i}function ur(e){return null===e?NaN:+e}function un(){}function ui(e,t){var r=new un;if(e instanceof un)e.each(function(e,t){r.set(t,e)});else if(Array.isArray(e)){var n,i=-1,o=e.length;if(null==t)for(;++i<o;)r.set(i,e[i]);else for(;++i<o;)r.set(t(n=e[i],i,e),n)}else if(e)for(var a in e)r.set(a,e[a]);return r}function uo(){}un.prototype=ui.prototype={constructor:un,has:function(e){return"$"+e in this},get:function(e){return this["$"+e]},set:function(e,t){return this["$"+e]=t,this},remove:function(e){var t="$"+e;return t in this&&delete this[t]},clear:function(){for(var e in this)"$"===e[0]&&delete this[e]},keys:function(){var e=[];for(var t in this)"$"===t[0]&&e.push(t.slice(1));return e},values:function(){var e=[];for(var t in this)"$"===t[0]&&e.push(this[t]);return e},entries:function(){var e=[];for(var t in this)"$"===t[0]&&e.push({key:t.slice(1),value:this[t]});return e},size:function(){var e=0;for(var t in this)"$"===t[0]&&++e;return e},empty:function(){for(var e in this)if("$"===e[0])return!1;return!0},each:function(e){for(var t in this)"$"===t[0]&&e(this[t],t.slice(1),this)}};var ua=ui.prototype;uo.prototype=(function(e,t){var r=new uo;if(e instanceof uo)e.each(function(e){r.add(e)});else if(e){var n=-1,i=e.length;if(null==t)for(;++n<i;)r.add(e[n]);else for(;++n<i;)r.add(t(e[n],n,e))}return r}).prototype={constructor:uo,has:ua.has,add:function(e){return this["$"+(e+="")]=e,this},remove:ua.remove,clear:ua.clear,values:ua.keys,size:ua.size,empty:ua.empty,each:ua.each};var us=Array.prototype,ul=us.map,uu=us.slice;function uc(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function uh(e,t){switch(arguments.length){case 0:break;case 1:this.interpolator(e);break;default:this.interpolator(t).domain(e)}return this}var ud={name:"implicit"};function up(){var e=ui(),t=[],r=[],n=ud;function i(i){var o=i+"",a=e.get(o);if(!a){if(n!==ud)return n;e.set(o,a=t.push(i))}return r[(a-1)%r.length]}return i.domain=function(r){if(!arguments.length)return t.slice();t=[],e=ui();for(var n,o,a=-1,s=r.length;++a<s;)e.has(o=(n=r[a])+"")||e.set(o,t.push(n));return i},i.range=function(e){return arguments.length?(r=uu.call(e),i):r.slice()},i.unknown=function(e){return arguments.length?(n=e,i):n},i.copy=function(){return up(t,r).unknown(n)},uc.apply(i,arguments),i}function uf(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}var ug=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,um=RegExp(ug.source,"g");function uv(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function uy(e){return+e}var u_=[0,1];function ub(e){return e}function ux(e,t){var r;return(t-=e=+e)?function(r){return(r-e)/t}:(r=isNaN(t)?NaN:.5,function(){return r})}function uS(e){var t,r=e[0],n=e[e.length-1];return r>n&&(t=r,r=n,n=t),function(e){return Math.max(r,Math.min(n,e))}}function uA(e,t,r){var n=e[0],i=e[1],o=t[0],a=t[1];return i<n?(n=ux(i,n),o=r(a,o)):(n=ux(n,i),o=r(o,a)),function(e){return o(n(e))}}function uE(e,t,r){var n=Math.min(e.length,t.length)-1,i=Array(n),o=Array(n),a=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<n;)i[a]=ux(e[a],e[a+1]),o[a]=r(t[a],t[a+1]);return function(t){var r=l4(e,t,1,n)-1;return o[r](i[r](t))}}function uT(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function uC(){var e,t,r,n,i,o,a=u_,s=u_,l=function e(t,r){var n,i,o=typeof r;return null==r||"boolean"===o?lq(r):("number"===o?uf:"string"===o?(i=ef(r))?(r=i,lQ):function(e,t){var r,n,i,o,a,s=ug.lastIndex=um.lastIndex=0,l=-1,u=[],c=[];for(e+="",t+="";(i=ug.exec(e))&&(o=um.exec(t));)(a=o.index)>s&&(a=t.slice(s,a),u[l]?u[l]+=a:u[++l]=a),(i=i[0])===(o=o[0])?u[l]?u[l]+=o:u[++l]=o:(u[++l]=null,c.push({i:l,x:uf(i,o)})),s=um.lastIndex;return s<t.length&&(a=t.slice(s),u[l]?u[l]+=a:u[++l]=a),u.length<2?c[0]?(r=c[0].x,function(e){return r(e)+""}):(n=t,function(){return n}):(t=c.length,function(e){for(var r,n=0;n<t;++n)u[(r=c[n]).i]=r.x(e);return u.join("")})}:r instanceof ef?lQ:r instanceof Date?function(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}:!ArrayBuffer.isView(n=r)||n instanceof DataView?Array.isArray(r)?function(t,r){var n,i=r?r.length:0,o=t?Math.min(i,t.length):0,a=Array(o),s=Array(i);for(n=0;n<o;++n)a[n]=e(t[n],r[n]);for(;n<i;++n)s[n]=r[n];return function(e){for(n=0;n<o;++n)s[n]=a[n](e);return s}}:"function"!=typeof r.valueOf&&"function"!=typeof r.toString||isNaN(r)?function(t,r){var n,i={},o={};for(n in(null===t||"object"!=typeof t)&&(t={}),(null===r||"object"!=typeof r)&&(r={}),r)n in t?i[n]=e(t[n],r[n]):o[n]=r[n];return function(e){for(n in i)o[n]=i[n](e);return o}}:uf:function(e,t){t||(t=[]);var r,n=e?Math.min(t.length,e.length):0,i=t.slice();return function(o){for(r=0;r<n;++r)i[r]=e[r]*(1-o)+t[r]*o;return i}})(t,r)},u=ub;function c(){return n=Math.min(a.length,s.length)>2?uE:uA,i=o=null,h}function h(t){return isNaN(t=+t)?r:(i||(i=n(a.map(e),s,l)))(e(u(t)))}return h.invert=function(r){return u(t((o||(o=n(s,a.map(e),uf)))(r)))},h.domain=function(e){return arguments.length?(a=ul.call(e,uy),u===ub||(u=uS(a)),c()):a.slice()},h.range=function(e){return arguments.length?(s=uu.call(e),c()):s.slice()},h.rangeRound=function(e){return s=uu.call(e),l=uv,c()},h.clamp=function(e){return arguments.length?(u=e?uS(a):ub,h):u!==ub},h.interpolate=function(e){return arguments.length?(l=e,c()):l},h.unknown=function(e){return arguments.length?(r=e,h):r},function(r,n){return e=r,t=n,c()}}var uw=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function uL(e){var t;if(!(t=uw.exec(e)))throw Error("invalid format: "+e);return new uM({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function uM(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function uO(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function uI(e){return(e=uO(Math.abs(e)))?e[1]:NaN}function uP(e,t){var r=uO(e,t);if(!r)return e+"";var n=r[0],i=r[1];return i<0?"0."+Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+Array(i-n.length+2).join("0")}uL.prototype=uM.prototype,uM.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};let uR={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return uP(100*e,t)},r:uP,s:function(e,t){var r=uO(e,t);if(!r)return e+"";var n=r[0],o=r[1],a=o-(i=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,s=n.length;return a===s?n:a>s?n+Array(a-s+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+Array(1-a).join("0")+uO(e,Math.max(0,t+a-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function uk(e){return e}var uN=Array.prototype.map,uD=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function uU(e){var t=e.domain;return e.ticks=function(e){var r=t();return l9(r[0],r[r.length-1],null==e?10:e)},e.tickFormat=function(e,r){var n=t();return function(e,t,r,n){var i,o,l=ut(e,t,r);switch((n=uL(null==n?",f":n)).type){case"s":var u=Math.max(Math.abs(e),Math.abs(t));return null!=n.precision||isNaN(o=Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(uI(u)/3)))-uI(Math.abs(l))))||(n.precision=o),s(n,u);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(o=Math.max(0,uI(Math.abs(Math.max(Math.abs(e),Math.abs(t)))-(i=Math.abs(i=l)))-uI(i))+1)||(n.precision=o-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(o=Math.max(0,-uI(Math.abs(l))))||(n.precision=o-("%"===n.type)*2)}return a(n)}(n[0],n[n.length-1],null==e?10:e,r)},e.nice=function(r){null==r&&(r=10);var n,i=t(),o=0,a=i.length-1,s=i[o],l=i[a];return l<s&&(n=s,s=l,l=n,n=o,o=a,a=n),(n=ue(s,l,r))>0?n=ue(s=Math.floor(s/n)*n,l=Math.ceil(l/n)*n,r):n<0&&(n=ue(s=Math.ceil(s*n)/n,l=Math.floor(l*n)/n,r)),n>0?(i[o]=Math.floor(s/n)*n,i[a]=Math.ceil(l/n)*n,t(i)):n<0&&(i[o]=Math.ceil(s*n)/n,i[a]=Math.floor(l*n)/n,t(i)),e},e}function uz(e,t){e=e.slice();var r,n=0,i=e.length-1,o=e[n],a=e[i];return a<o&&(r=n,n=i,i=r,r=o,o=a,a=r),e[n]=t.floor(o),e[i]=t.ceil(a),e}function uB(e){return Math.log(e)}function uF(e){return Math.exp(e)}function uj(e){return-Math.log(-e)}function uV(e){return-Math.exp(-e)}function uH(e){return isFinite(e)?+("1e"+e):e<0?0:e}function uG(e){return function(t){return-e(-t)}}function uW(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function uX(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function u$(e){return e<0?-e*e:e*e}a=(o=function(e){var t,r,n,o=void 0===e.grouping||void 0===e.thousands?uk:(t=uN.call(e.grouping,Number),r=e.thousands+"",function(e,n){for(var i=e.length,o=[],a=0,s=t[0],l=0;i>0&&s>0&&(l+s+1>n&&(s=Math.max(1,n-l)),o.push(e.substring(i-=s,i+s)),!((l+=s+1)>n));)s=t[a=(a+1)%t.length];return o.reverse().join(r)}),a=void 0===e.currency?"":e.currency[0]+"",s=void 0===e.currency?"":e.currency[1]+"",l=void 0===e.decimal?".":e.decimal+"",u=void 0===e.numerals?uk:(n=uN.call(e.numerals,String),function(e){return e.replace(/[0-9]/g,function(e){return n[+e]})}),c=void 0===e.percent?"%":e.percent+"",h=void 0===e.minus?"-":e.minus+"",d=void 0===e.nan?"NaN":e.nan+"";function p(e){var t=(e=uL(e)).fill,r=e.align,n=e.sign,p=e.symbol,f=e.zero,g=e.width,m=e.comma,v=e.precision,y=e.trim,_=e.type;"n"===_?(m=!0,_="g"):uR[_]||(void 0===v&&(v=12),y=!0,_="g"),(f||"0"===t&&"="===r)&&(f=!0,t="0",r="=");var b="$"===p?a:"#"===p&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",x="$"===p?s:/[%p]/.test(_)?c:"",S=uR[_],A=/[defgprs%]/.test(_);function E(e){var a,s,c,p=b,E=x;if("c"===_)E=S(e)+E,e="";else{var T=(e=+e)<0||1/e<0;if(e=isNaN(e)?d:S(Math.abs(e),v),y&&(e=function(e){e:for(var t,r=e.length,n=1,i=-1;n<r;++n)switch(e[n]){case".":i=t=n;break;case"0":0===i&&(i=n),t=n;break;default:if(!+e[n])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),T&&0==+e&&"+"!==n&&(T=!1),p=(T?"("===n?n:h:"-"===n||"("===n?"":n)+p,E=("s"===_?uD[8+i/3]:"")+E+(T&&"("===n?")":""),A){for(a=-1,s=e.length;++a<s;)if(48>(c=e.charCodeAt(a))||c>57){E=(46===c?l+e.slice(a+1):e.slice(a))+E,e=e.slice(0,a);break}}}m&&!f&&(e=o(e,1/0));var C=p.length+e.length+E.length,w=C<g?Array(g-C+1).join(t):"";switch(m&&f&&(e=o(w+e,w.length?g-E.length:1/0),w=""),r){case"<":e=p+e+E+w;break;case"=":e=p+w+e+E;break;case"^":e=w.slice(0,C=w.length>>1)+p+e+E+w.slice(C);break;default:e=w+p+e+E}return u(e)}return v=void 0===v?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),E.toString=function(){return e+""},E}return{format:p,formatPrefix:function(e,t){var r=p(((e=uL(e)).type="f",e)),n=3*Math.max(-8,Math.min(8,Math.floor(uI(t)/3))),i=Math.pow(10,-n),o=uD[8+n/3];return function(e){return r(i*e)+o}}}}({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"})).format,s=o.formatPrefix;var uZ=new Date,uY=new Date;function uq(e,t,r,n){function i(t){return e(t=0==arguments.length?new Date:new Date(+t)),t}return i.floor=function(t){return e(t=new Date(+t)),t},i.ceil=function(r){return e(r=new Date(r-1)),t(r,1),e(r),r},i.round=function(e){var t=i(e),r=i.ceil(e);return e-t<r-e?t:r},i.offset=function(e,r){return t(e=new Date(+e),null==r?1:Math.floor(r)),e},i.range=function(r,n,o){var a,s=[];if(r=i.ceil(r),o=null==o?1:Math.floor(o),!(r<n)||!(o>0))return s;do s.push(a=new Date(+r)),t(r,o),e(r);while(a<r&&r<n);return s},i.filter=function(r){return uq(function(t){if(t>=t)for(;e(t),!r(t);)t.setTime(t-1)},function(e,n){if(e>=e){if(n<0)for(;++n<=0;)for(;t(e,-1),!r(e););else for(;--n>=0;)for(;t(e,1),!r(e););}})},r&&(i.count=function(t,n){return uZ.setTime(+t),uY.setTime(+n),e(uZ),e(uY),Math.floor(r(uZ,uY))},i.every=function(e){return isFinite(e=Math.floor(e))&&e>0?e>1?i.filter(n?function(t){return n(t)%e==0}:function(t){return i.count(0,t)%e==0}):i:null}),i}var uK=uq(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});uK.every=function(e){return isFinite(e=Math.floor(e))&&e>0?uq(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,r){t.setFullYear(t.getFullYear()+r*e)}):null},uK.range;var uQ=uq(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()});function uJ(e){return uq(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+7*t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*6e4)/6048e5})}uQ.range;var u0=uJ(0),u1=uJ(1),u2=uJ(2),u3=uJ(3),u4=uJ(4),u5=uJ(5),u6=uJ(6);u0.range,u1.range,u2.range,u3.range,u4.range,u5.range,u6.range;var u7=uq(function(e){e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*6e4)/864e5},function(e){return e.getDate()-1});u7.range;var u8=uq(function(e){e.setTime(e-e.getMilliseconds()-1e3*e.getSeconds()-6e4*e.getMinutes())},function(e,t){e.setTime(+e+36e5*t)},function(e,t){return(t-e)/36e5},function(e){return e.getHours()});u8.range;var u9=uq(function(e){e.setTime(e-e.getMilliseconds()-1e3*e.getSeconds())},function(e,t){e.setTime(+e+6e4*t)},function(e,t){return(t-e)/6e4},function(e){return e.getMinutes()});u9.range;var ce=uq(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+1e3*t)},function(e,t){return(t-e)/1e3},function(e){return e.getUTCSeconds()});ce.range;var ct=uq(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});function cr(e){return uq(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+7*t)},function(e,t){return(t-e)/6048e5})}ct.every=function(e){return isFinite(e=Math.floor(e))&&e>0?e>1?uq(function(t){t.setTime(Math.floor(t/e)*e)},function(t,r){t.setTime(+t+r*e)},function(t,r){return(r-t)/e}):ct:null},ct.range;var cn=cr(0),ci=cr(1),co=cr(2),ca=cr(3),cs=cr(4),cl=cr(5),cu=cr(6);cn.range,ci.range,co.range,ca.range,cs.range,cl.range,cu.range;var cc=uq(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/864e5},function(e){return e.getUTCDate()-1});cc.range;var ch=uq(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});function cd(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function cp(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function cf(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}ch.every=function(e){return isFinite(e=Math.floor(e))&&e>0?uq(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,r){t.setUTCFullYear(t.getUTCFullYear()+r*e)}):null},ch.range;var cg={"-":"",_:" ",0:"0"},cm=/^\s*\d+/,cv=/^%/,cy=/[\\^$*+?|[\]().{}]/g;function c_(e,t,r){var n=e<0?"-":"",i=(n?-e:e)+"",o=i.length;return n+(o<r?Array(r-o+1).join(t)+i:i)}function cb(e){return e.replace(cy,"\\$&")}function cx(e){return RegExp("^(?:"+e.map(cb).join("|")+")","i")}function cS(e){for(var t={},r=-1,n=e.length;++r<n;)t[e[r].toLowerCase()]=r;return t}function cA(e,t,r){var n=cm.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function cE(e,t,r){var n=cm.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function cT(e,t,r){var n=cm.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function cC(e,t,r){var n=cm.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function cw(e,t,r){var n=cm.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function cL(e,t,r){var n=cm.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function cM(e,t,r){var n=cm.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function cO(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function cI(e,t,r){var n=cm.exec(t.slice(r,r+1));return n?(e.q=3*n[0]-3,r+n[0].length):-1}function cP(e,t,r){var n=cm.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function cR(e,t,r){var n=cm.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function ck(e,t,r){var n=cm.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function cN(e,t,r){var n=cm.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function cD(e,t,r){var n=cm.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function cU(e,t,r){var n=cm.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function cz(e,t,r){var n=cm.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function cB(e,t,r){var n=cm.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function cF(e,t,r){var n=cv.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function cj(e,t,r){var n=cm.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function cV(e,t,r){var n=cm.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function cH(e,t){return c_(e.getDate(),t,2)}function cG(e,t){return c_(e.getHours(),t,2)}function cW(e,t){return c_(e.getHours()%12||12,t,2)}function cX(e,t){return c_(1+u7.count(uK(e),e),t,3)}function c$(e,t){return c_(e.getMilliseconds(),t,3)}function cZ(e,t){return c$(e,t)+"000"}function cY(e,t){return c_(e.getMonth()+1,t,2)}function cq(e,t){return c_(e.getMinutes(),t,2)}function cK(e,t){return c_(e.getSeconds(),t,2)}function cQ(e){var t=e.getDay();return 0===t?7:t}function cJ(e,t){return c_(u0.count(uK(e)-1,e),t,2)}function c0(e){var t=e.getDay();return t>=4||0===t?u4(e):u4.ceil(e)}function c1(e,t){return e=c0(e),c_(u4.count(uK(e),e)+(4===uK(e).getDay()),t,2)}function c2(e){return e.getDay()}function c3(e,t){return c_(u1.count(uK(e)-1,e),t,2)}function c4(e,t){return c_(e.getFullYear()%100,t,2)}function c5(e,t){return c_((e=c0(e)).getFullYear()%100,t,2)}function c6(e,t){return c_(e.getFullYear()%1e4,t,4)}function c7(e,t){var r=e.getDay();return c_((e=r>=4||0===r?u4(e):u4.ceil(e)).getFullYear()%1e4,t,4)}function c8(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+c_(t/60|0,"0",2)+c_(t%60,"0",2)}function c9(e,t){return c_(e.getUTCDate(),t,2)}function he(e,t){return c_(e.getUTCHours(),t,2)}function ht(e,t){return c_(e.getUTCHours()%12||12,t,2)}function hr(e,t){return c_(1+cc.count(ch(e),e),t,3)}function hn(e,t){return c_(e.getUTCMilliseconds(),t,3)}function hi(e,t){return hn(e,t)+"000"}function ho(e,t){return c_(e.getUTCMonth()+1,t,2)}function ha(e,t){return c_(e.getUTCMinutes(),t,2)}function hs(e,t){return c_(e.getUTCSeconds(),t,2)}function hl(e){var t=e.getUTCDay();return 0===t?7:t}function hu(e,t){return c_(cn.count(ch(e)-1,e),t,2)}function hc(e){var t=e.getUTCDay();return t>=4||0===t?cs(e):cs.ceil(e)}function hh(e,t){return e=hc(e),c_(cs.count(ch(e),e)+(4===ch(e).getUTCDay()),t,2)}function hd(e){return e.getUTCDay()}function hp(e,t){return c_(ci.count(ch(e)-1,e),t,2)}function hf(e,t){return c_(e.getUTCFullYear()%100,t,2)}function hg(e,t){return c_((e=hc(e)).getUTCFullYear()%100,t,2)}function hm(e,t){return c_(e.getUTCFullYear()%1e4,t,4)}function hv(e,t){var r=e.getUTCDay();return c_((e=r>=4||0===r?cs(e):cs.ceil(e)).getUTCFullYear()%1e4,t,4)}function hy(){return"+0000"}function h_(){return"%"}function hb(e){return+e}function hx(e){return Math.floor(+e/1e3)}function hS(e){return new Date(e)}function hA(e){return e instanceof Date?+e:+new Date(+e)}function hE(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}u=(l=function(e){var t=e.dateTime,r=e.date,n=e.time,i=e.periods,o=e.days,a=e.shortDays,s=e.months,l=e.shortMonths,u=cx(i),c=cS(i),h=cx(o),d=cS(o),p=cx(a),f=cS(a),g=cx(s),m=cS(s),v=cx(l),y=cS(l),_={a:function(e){return a[e.getDay()]},A:function(e){return o[e.getDay()]},b:function(e){return l[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:cH,e:cH,f:cZ,g:c5,G:c7,H:cG,I:cW,j:cX,L:c$,m:cY,M:cq,p:function(e){return i[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:hb,s:hx,S:cK,u:cQ,U:cJ,V:c1,w:c2,W:c3,x:null,X:null,y:c4,Y:c6,Z:c8,"%":h_},b={a:function(e){return a[e.getUTCDay()]},A:function(e){return o[e.getUTCDay()]},b:function(e){return l[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:c9,e:c9,f:hi,g:hg,G:hv,H:he,I:ht,j:hr,L:hn,m:ho,M:ha,p:function(e){return i[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:hb,s:hx,S:hs,u:hl,U:hu,V:hh,w:hd,W:hp,x:null,X:null,y:hf,Y:hm,Z:hy,"%":h_},x={a:function(e,t,r){var n=p.exec(t.slice(r));return n?(e.w=f[n[0].toLowerCase()],r+n[0].length):-1},A:function(e,t,r){var n=h.exec(t.slice(r));return n?(e.w=d[n[0].toLowerCase()],r+n[0].length):-1},b:function(e,t,r){var n=v.exec(t.slice(r));return n?(e.m=y[n[0].toLowerCase()],r+n[0].length):-1},B:function(e,t,r){var n=g.exec(t.slice(r));return n?(e.m=m[n[0].toLowerCase()],r+n[0].length):-1},c:function(e,r,n){return E(e,t,r,n)},d:cR,e:cR,f:cB,g:cM,G:cL,H:cN,I:cN,j:ck,L:cz,m:cP,M:cD,p:function(e,t,r){var n=u.exec(t.slice(r));return n?(e.p=c[n[0].toLowerCase()],r+n[0].length):-1},q:cI,Q:cj,s:cV,S:cU,u:cE,U:cT,V:cC,w:cA,W:cw,x:function(e,t,n){return E(e,r,t,n)},X:function(e,t,r){return E(e,n,t,r)},y:cM,Y:cL,Z:cO,"%":cF};function S(e,t){return function(r){var n,i,o,a=[],s=-1,l=0,u=e.length;for(r instanceof Date||(r=new Date(+r));++s<u;)37===e.charCodeAt(s)&&(a.push(e.slice(l,s)),null!=(i=cg[n=e.charAt(++s)])?n=e.charAt(++s):i="e"===n?" ":"0",(o=t[n])&&(n=o(r,i)),a.push(n),l=s+1);return a.push(e.slice(l,s)),a.join("")}}function A(e,t){return function(r){var n,i,o=cf(1900,void 0,1);if(E(o,e,r+="",0)!=r.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(!t||"Z"in o||(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(n=(i=(n=cp(cf(o.y,0,1))).getUTCDay())>4||0===i?ci.ceil(n):ci(n),n=cc.offset(n,(o.V-1)*7),o.y=n.getUTCFullYear(),o.m=n.getUTCMonth(),o.d=n.getUTCDate()+(o.w+6)%7):(n=(i=(n=cd(cf(o.y,0,1))).getDay())>4||0===i?u1.ceil(n):u1(n),n=u7.offset(n,(o.V-1)*7),o.y=n.getFullYear(),o.m=n.getMonth(),o.d=n.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?cp(cf(o.y,0,1)).getUTCDay():cd(cf(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,cp(o)):cd(o)}}function E(e,t,r,n){for(var i,o,a=0,s=t.length,l=r.length;a<s;){if(n>=l)return -1;if(37===(i=t.charCodeAt(a++))){if(!(o=x[(i=t.charAt(a++))in cg?t.charAt(a++):i])||(n=o(e,r,n))<0)return -1}else if(i!=r.charCodeAt(n++))return -1}return n}return _.x=S(r,_),_.X=S(n,_),_.c=S(t,_),b.x=S(r,b),b.X=S(n,b),b.c=S(t,b),{format:function(e){var t=S(e+="",_);return t.toString=function(){return e},t},parse:function(e){var t=A(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=S(e+="",b);return t.toString=function(){return e},t},utcParse:function(e){var t=A(e+="",!0);return t.toString=function(){return e},t}}}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]})).format,l.parse,l.utcFormat,l.utcParse;let{isNil:hT,isString:hC,uniq:hw}=th,hL=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,hM={[iI.LINEAR]:function e(){var t=uC()(ub,ub);return t.copy=function(){return uT(t,e())},uc.apply(t,arguments),uU(t)},[iI.POWER]:function e(){var t,r,n,i=(r=(t=uC())(ub,ub),n=1,r.exponent=function(e){return arguments.length?1==(n=+e)?t(ub,ub):.5===n?t(uX,u$):t(uW(n),uW(1/n)):n},uU(r));return i.copy=function(){return uT(i,e()).exponent(i.exponent())},uc.apply(i,arguments),i},[iI.LOG]:function e(){var t=(function(e){var t,r,n=e(uB,uF),i=n.domain,o=10;function s(){var a,s;return t=(a=o)===Math.E?Math.log:10===a&&Math.log10||2===a&&Math.log2||(a=Math.log(a),function(e){return Math.log(e)/a}),r=10===(s=o)?uH:s===Math.E?Math.exp:function(e){return Math.pow(s,e)},i()[0]<0?(t=uG(t),r=uG(r),e(uj,uV)):e(uB,uF),n}return n.base=function(e){return arguments.length?(o=+e,s()):o},n.domain=function(e){return arguments.length?(i(e),s()):i()},n.ticks=function(e){var n,a=i(),s=a[0],l=a[a.length-1];(n=l<s)&&(d=s,s=l,l=d);var u,c,h,d=t(s),p=t(l),f=null==e?10:+e,g=[];if(!(o%1)&&p-d<f){if(d=Math.round(d)-1,p=Math.round(p)+1,s>0){for(;d<p;++d)for(c=1,u=r(d);c<o;++c)if(!((h=u*c)<s)){if(h>l)break;g.push(h)}}else for(;d<p;++d)for(c=o-1,u=r(d);c>=1;--c)if(!((h=u*c)<s)){if(h>l)break;g.push(h)}}else g=l9(d,p,Math.min(p-d,f)).map(r);return n?g.reverse():g},n.tickFormat=function(e,i){if(null==i&&(i=10===o?".0e":","),"function"!=typeof i&&(i=a(i)),e===1/0)return i;null==e&&(e=10);var s=Math.max(1,o*e/n.ticks().length);return function(e){var n=e/r(Math.round(t(e)));return n*o<o-.5&&(n*=o),n<=s?i(e):""}},n.nice=function(){return i(uz(i(),{floor:function(e){return r(Math.floor(t(e)))},ceil:function(e){return r(Math.ceil(t(e)))}}))},n})(uC()).domain([1,10]);return t.copy=function(){return uT(t,e()).base(t.base())},uc.apply(t,arguments),t},[iI.IDENTITY]:function e(t){let r;let n=[];function i(e){return null==e?r:e}return i.invert=i,i.domain=i.range=e=>e?(n=e,e):n,i.unknown=e=>e?(r=e,e):r,i.copy=()=>e(t).unknown(r),i},[iI.SEQUENTIAL]:function e(){var t=uU((function(){var e,t,r,n,i,o=0,a=1,s=ub,l=!1;function u(t){return isNaN(t=+t)?i:s(0===r?.5:(t=(n(t)-e)*r,l?Math.max(0,Math.min(1,t)):t))}return u.domain=function(i){return arguments.length?(e=n(o=+i[0]),t=n(a=+i[1]),r=e===t?0:1/(t-e),u):[o,a]},u.clamp=function(e){return arguments.length?(l=!!e,u):l},u.interpolator=function(e){return arguments.length?(s=e,u):s},u.unknown=function(e){return arguments.length?(i=e,u):i},function(i){return n=i,e=i(o),t=i(a),r=e===t?0:1/(t-e),u}})()(ub));return t.copy=function(){return hE(t,e())},uh.apply(t,arguments)},[iI.TIME]:function(){return uc.apply((function e(t,r,n,i,o,a,s,l,u){var c=uC()(ub,ub),h=c.invert,d=c.domain,p=u(".%L"),f=u(":%S"),g=u("%I:%M"),m=u("%I %p"),v=u("%a %d"),y=u("%b %d"),_=u("%B"),b=u("%Y"),x=[[s,1,1e3],[s,5,5e3],[s,15,15e3],[s,30,3e4],[a,1,6e4],[a,5,3e5],[a,15,9e5],[a,30,18e5],[o,1,36e5],[o,3,108e5],[o,6,216e5],[o,12,432e5],[i,1,864e5],[i,2,1728e5],[n,1,6048e5],[r,1,2592e6],[r,3,7776e6],[t,1,31536e6]];function S(e){return(s(e)<e?p:a(e)<e?f:o(e)<e?g:i(e)<e?m:r(e)<e?n(e)<e?v:y:t(e)<e?_:b)(e)}function A(e,r,n,i){if(null==e&&(e=10),"number"==typeof e){var o=Math.abs(n-r)/e,a=l2(function(e){return e[2]}).right(x,o);a===x.length?(i=ut(r/31536e6,n/31536e6,e),e=t):a?(i=(a=x[o/x[a-1][2]<x[a][2]/o?a-1:a])[1],e=a[0]):(i=Math.max(ut(r,n,e),1),e=l)}return null==i?e:e.every(i)}return c.invert=function(e){return new Date(h(e))},c.domain=function(e){return arguments.length?d(ul.call(e,hA)):d().map(hS)},c.ticks=function(e,t){var r,n=d(),i=n[0],o=n[n.length-1],a=o<i;return a&&(r=i,i=o,o=r),r=(r=A(e,i,o,t))?r.range(i,o+1):[],a?r.reverse():r},c.tickFormat=function(e,t){return null==t?S:u(t)},c.nice=function(e,t){var r=d();return(e=A(e,r[0],r[r.length-1],t))?d(uz(r,e)):c},c.copy=function(){return uT(c,e(t,r,n,i,o,a,s,l,u))},c})(uK,uQ,u0,u7,u8,u9,ce,ct,u).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},[iI.QUANTILE]:function e(){var t,r=[],n=[],i=[];function o(){var e=0,t=Math.max(1,n.length);for(i=Array(t-1);++e<t;)i[e-1]=function(e,t,r){if(null==r&&(r=ur),n=e.length){if((t=+t)<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,i=(n-1)*t,o=Math.floor(i),a=+r(e[o],o,e);return a+(+r(e[o+1],o+1,e)-a)*(i-o)}}(r,e/t);return a}function a(e){return isNaN(e=+e)?t:n[l4(i,e)]}return a.invertExtent=function(e){var t=n.indexOf(e);return t<0?[NaN,NaN]:[t>0?i[t-1]:r[0],t<i.length?i[t]:r[r.length-1]]},a.domain=function(e){if(!arguments.length)return r.slice();r=[];for(var t,n=0,i=e.length;n<i;++n)null==(t=e[n])||isNaN(t=+t)||r.push(t);return r.sort(l1),o()},a.range=function(e){return arguments.length?(n=uu.call(e),o()):n.slice()},a.unknown=function(e){return arguments.length?(t=e,a):t},a.quantiles=function(){return i.slice()},a.copy=function(){return e().domain(r).range(n).unknown(t)},uc.apply(a,arguments)},[iI.QUANTIZE]:function e(){var t,r=0,n=1,i=1,o=[.5],a=[0,1];function s(e){return e<=e?a[l4(o,e,0,i)]:t}function l(){var e=-1;for(o=Array(i);++e<i;)o[e]=((e+1)*n-(e-i)*r)/(i+1);return s}return s.domain=function(e){return arguments.length?(r=+e[0],n=+e[1],l()):[r,n]},s.range=function(e){return arguments.length?(i=(a=uu.call(e)).length-1,l()):a.slice()},s.invertExtent=function(e){var t=a.indexOf(e);return t<0?[NaN,NaN]:t<1?[r,o[0]]:t>=i?[o[i-1],n]:[o[t-1],o[t]]},s.unknown=function(e){return arguments.length&&(t=e),s},s.thresholds=function(){return o.slice()},s.copy=function(){return e().domain([r,n]).range(a).unknown(t)},uc.apply(uU(s),arguments)},[iI.THRESHOLD]:function e(){var t,r=[.5],n=[0,1],i=1;function o(e){return e<=e?n[l4(r,e,0,i)]:t}return o.domain=function(e){return arguments.length?(i=Math.min((r=uu.call(e)).length,n.length-1),o):r.slice()},o.range=function(e){return arguments.length?(n=uu.call(e),i=Math.min(r.length,n.length-1),o):n.slice()},o.invertExtent=function(e){var t=n.indexOf(e);return[r[t-1],r[t]]},o.unknown=function(e){return arguments.length?(t=e,o):t},o.copy=function(){return e().domain(r).range(n).unknown(t)},uc.apply(o,arguments)},[iI.CAT]:up,[iI.DIVERGING]:function e(){var t=uU((function(){var e,t,r,n,i,o,a,s=0,l=.5,u=1,c=ub,h=!1;function d(e){return isNaN(e=+e)?a:(e=.5+((e=+o(e))-t)*(e<t?n:i),c(h?Math.max(0,Math.min(1,e)):e))}return d.domain=function(a){return arguments.length?(e=o(s=+a[0]),t=o(l=+a[1]),r=o(u=+a[2]),n=e===t?0:.5/(t-e),i=t===r?0:.5/(r-t),d):[s,l,u]},d.clamp=function(e){return arguments.length?(h=!!e,d):h},d.interpolator=function(e){return arguments.length?(c=e,d):c},d.unknown=function(e){return arguments.length?(a=e,d):a},function(a){return o=a,e=a(s),t=a(l),r=a(u),n=e===t?0:.5/(t-e),i=t===r?0:.5/(r-t),d}})()(ub));return t.copy=function(){return hE(t,e())},uh.apply(t,arguments)}};class hO{constructor(){ia(this,"scaleOptions",{})}apply(e,{styleAttributeService:t}){var r,n=this;e.hooks.init.tapPromise("FeatureScalePlugin",iG(function*(){var r;e.log(iT.ScaleInitStart,iO.INIT),n.scaleOptions=e.getScaleOptions();let i=t.getLayerStyleAttributes(),o=null===(r=e.getSource())||void 0===r?void 0:r.data.dataArray;Array.isArray(o)&&0===o.length||(n.caculateScalesForAttributes(i||[],o),e.log(iT.ScaleInitEnd,iO.INIT))})),e.hooks.beforeRenderData.tapPromise("FeatureScalePlugin",(r=iG(function*(r){if(!r)return r;e.log(iT.ScaleInitStart,iO.UPDATE),n.scaleOptions=e.getScaleOptions();let i=t.getLayerStyleAttributes(),o=e.getSource().data.dataArray;return!!Array.isArray(o)&&0===o.length||(n.caculateScalesForAttributes(i||[],o),e.log(iT.ScaleInitEnd,iO.UPDATE),e.layerModelNeedUpdate=!0,!0)}),function(e){return r.apply(this,arguments)})),e.hooks.beforeRender.tap("FeatureScalePlugin",()=>{if(e.layerModelNeedUpdate)return;this.scaleOptions=e.getScaleOptions();let r=t.getLayerStyleAttributes(),n=e.getSource().data.dataArray;if((!Array.isArray(n)||0!==n.length)&&r){let e=r.filter(e=>e.needRescale);e.length&&this.caculateScalesForAttributes(e,n)}})}isNumber(e){return!isNaN(parseFloat(e))&&isFinite(e)}caculateScalesForAttributes(e,t){e.forEach(e=>{if(e.scale){let r=e.scale,n=e.scale.field;r.names=this.parseFields(hT(n)?[]:n);let i=[];r.names.forEach(r=>{var n;i.push(this.createScale(r,e.name,null===(n=e.scale)||void 0===n?void 0:n.values,t))}),i.some(e=>e.type===iP.VARIABLE)?(r.type=iP.VARIABLE,i.forEach(e=>{var t,n;if(!r.callback&&"text"!==r.values)switch(null===(t=e.option)||void 0===t?void 0:t.type){case iI.LOG:case iI.LINEAR:case iI.POWER:if(r.values&&r.values.length>2){let t=e.scale.ticks(r.values.length);e.scale.domain(t)}r.values?e.scale.range(r.values):e.scale.range(e.option.domain);break;case iI.QUANTILE:case iI.QUANTIZE:case iI.THRESHOLD:e.scale.range(r.values);break;case iI.IDENTITY:break;case iI.CAT:r.values?e.scale.range(r.values):e.scale.range(e.option.domain);break;case iI.DIVERGING:case iI.SEQUENTIAL:e.scale.interpolator(l0(r.values))}"text"===r.values&&e.scale.range(null===(n=e.option)||void 0===n?void 0:n.domain)})):(r.type=iP.CONSTANT,r.defaultValues=i.map((e,t)=>e.scale(r.names[t]))),r.scalers=i.map(e=>({field:e.field,func:e.scale,option:e.option})),e.needRescale=!1}})}parseFields(e){return Array.isArray(e)?e:hC(e)?e.split("*"):[e]}createScale(e,t,r,n){var i,o;let a=this.scaleOptions[t]&&(null===(i=this.scaleOptions[t])||void 0===i?void 0:i.field)===e?this.scaleOptions[t]:this.scaleOptions[e],s={field:e,scale:void 0,type:iP.VARIABLE,option:a};if(!n||!n.length)return a&&a.type?s.scale=this.createDefaultScale(a):(s.scale=up([e]),s.type=iP.CONSTANT),s;let l=null===(o=n.find(t=>!hT(t[e])))||void 0===o?void 0:o[e];if(this.isNumber(e)||hT(l)&&!a)s.scale=up([e]),s.type=iP.CONSTANT;else{let t=a&&a.type||this.getDefaultType(l);"text"===r&&(t=iI.CAT),void 0===r&&(t=iI.IDENTITY);let i=this.createScaleConfig(t,e,a,n);s.scale=this.createDefaultScale(i),s.option=i}return s}getDefaultType(e){let t=iI.LINEAR;return"string"==typeof e&&(t=hL.test(e)?iI.TIME:iI.CAT),t}createScaleConfig(e,t,r,n){let i={type:e},o=[];if(e===iI.QUANTILE){let e=new Map;null==n||n.forEach(r=>{e.set(r._id,r[t])}),o=Array.from(e.values())}else o=(null==n?void 0:n.map(e=>e[t]))||[];if(null!=r&&r.domain)i.domain=null==r?void 0:r.domain;else if(e===iI.CAT||e===iI.IDENTITY)i.domain=hw(o);else if(e===iI.QUANTILE)i.domain=o;else if(e===iI.DIVERGING){let e=lZ(o),t=(null==r?void 0:r.neutral)!==void 0?null==r?void 0:r.neutral:(e[0]+e[1])/2;i.domain=[e[0],t,e[1]]}else i.domain=lZ(o);return il(il({},i),r)}createDefaultScale({type:e,domain:t,unknown:r,clamp:n,nice:i}){let o=hM[e]();return t&&o.domain&&o.domain(t),r&&o.unknown(r),void 0!==n&&o.clamp&&o.clamp(n),void 0!==i&&o.nice&&o.nice(i),o}}class hI{apply(e){e.hooks.beforeRender.tap("LayerAnimateStylePlugin",()=>{e.animateStatus&&e.models.forEach(t=>{t.addUniforms(il({},e.layerModel.getAnimateUniforms()))})})}}class hP{apply(e){e.hooks.afterInit.tap("LayerMaskPlugin",()=>{let{maskLayers:t,enableMask:r}=e.getLayerConfig();!e.tileLayer&&t&&t.length>0&&e.updateLayerConfig({mask:r})})}}class hR{build(e){return iG(function*(){e.prepareBuildModel(),yield e.buildModels()})()}initLayerModel(e){var t=this;return iG(function*(){yield t.build(e),e.styleNeedUpdate=!1})()}prepareLayerModel(e){var t=this;return iG(function*(){yield t.build(e),e.styleNeedUpdate=!1})()}apply(e){var t,r=this;e.hooks.init.tapPromise("LayerModelPlugin",iG(function*(){if(e.getSource().isTile){e.prepareBuildModel();return}e.log(iT.BuildModelStart,iO.INIT),yield r.initLayerModel(e),e.log(iT.BuildModelEnd,iO.INIT)})),e.hooks.beforeRenderData.tapPromise("LayerModelPlugin",(t=iG(function*(t){return!!t&&!e.getSource().isTile&&(e.log(iT.BuildModelStart,iO.UPDATE),yield r.prepareLayerModel(e),e.log(iT.BuildModelEnd,iO.UPDATE),!0)}),function(e){return t.apply(this,arguments)}))}}class hk{apply(e){e.hooks.afterInit.tap("LayerStylePlugin",()=>{let{autoFit:t,fitBoundsOptions:r}=e.getLayerConfig();t&&e.fitBounds(r),e.styleNeedUpdate=!1})}}let hN=["type"],hD={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},hU={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},hz={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},hB={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5};class hF{apply(e){e.hooks.beforeRender.tap("LightingPlugin",()=>{let{enableLighting:t}=e.getLayerConfig();t&&e.models.forEach(e=>e.addUniforms(il({},function(e){let t={u_DirectionalLights:[,,,].fill(il({},hz)),u_NumOfDirectionalLights:0,u_SpotLights:[,,,].fill(il({},hB)),u_NumOfSpotLights:0};return e&&e.length||(e=[hU]),e.forEach(e=>{let{type:r="directional"}=e,n=ox(e,hN),i=hD[r].lights,o=hD[r].num,a=t[o];t[i][a]=il(il({},t[i][a]),n),t[o]++}),t}())))})}}function hj(e){return e.map(e=>("string"==typeof e&&(e=[e,{}]),e))}function hV(e,t,r,n){let i=e.multiPassRenderer;return i.add(n("render")),hj(t).forEach(e=>{let[t,n]=e;i.add(r(t),n)}),i.add(r("copy")),i}class hH{constructor(){ia(this,"enabled",void 0)}apply(e,{rendererService:t,postProcessingPassFactory:r,normalPassFactory:n}){e.hooks.init.tapPromise("MultiPassRendererPlugin",()=>{let{enableMultiPassRenderer:t,passes:i=[]}=e.getLayerConfig();this.enabled=!!t&&!1!==e.getLayerConfig().enableMultiPassRenderer,this.enabled&&(e.multiPassRenderer=hV(e,i,r,n),e.multiPassRenderer.setRenderFlag(!0))}),e.hooks.beforeRender.tap("MultiPassRendererPlugin",()=>{if(this.enabled){let{width:r,height:n}=t.getViewportSize();e.multiPassRenderer.resize(r,n)}})}}let hG={POSITION:0,POSITION_64LOW:1,COLOR:2,PICKING_COLOR:3,STROKE:4,OPACITY:5,OFFSETS:6,ROTATION:7,MAX:8},{isNumber:hW}=th,hX={ENCODE:1,HIGHLIGHT:2};class h${constructor(){ia(this,"pickingUniformMap",void 0)}pickOption2Array(){let e=[];return this.pickingUniformMap.forEach(t=>{hW(t)?e.push(t):e.push(...t)}),e}updatePickOption(e,t){Object.keys(e).forEach(t=>{this.pickingUniformMap.set(t,e[t])});let r=t.getLayerConfig().pickingBuffer||0,n=Number(t.getShaderPickStat());this.pickingUniformMap.set("u_PickingBuffer",r),this.pickingUniformMap.set("u_shaderPick",n),t.getPickingUniformBuffer().subData({offset:0,data:this.pickOption2Array()})}apply(e,{styleAttributeService:t}){this.pickingUniformMap=new Map([["u_HighlightColor",[1,0,0,1]],["u_SelectColor",[1,0,0,1]],["u_PickingColor",[0,0,0]],["u_PickingStage",0],["u_CurrentSelectedId",[0,0,0]],["u_PickingThreshold",10],["u_PickingBuffer",0],["u_shaderPick",0],["u_activeMix",0]]),e.hooks.init.tapPromise("PixelPickingPlugin",()=>{let{enablePicking:r}=e.getLayerConfig();t.registerStyleAttribute({name:"pickingColor",type:iR.Attribute,descriptor:{name:"a_PickingColor",shaderLocation:hG.PICKING_COLOR,buffer:{data:[],type:ic.FLOAT},size:3,update:e=>{let{id:t}=e;return r?eL(t):[0,0,0]}}})}),e.hooks.beforePickingEncode.tap("PixelPickingPlugin",()=>{let{enablePicking:t}=e.getLayerConfig();t&&e.isVisible()&&(this.updatePickOption({u_PickingStage:hX.ENCODE},e),e.models.forEach(e=>e.addUniforms({u_PickingStage:hX.ENCODE})))}),e.hooks.afterPickingEncode.tap("PixelPickingPlugin",()=>{let{enablePicking:t}=e.getLayerConfig();t&&e.isVisible()&&(this.updatePickOption({u_PickingStage:hX.HIGHLIGHT},e),e.models.forEach(e=>e.addUniforms({u_PickingStage:hX.HIGHLIGHT})))}),e.hooks.beforeHighlight.tap("PixelPickingPlugin",t=>{let{highlightColor:r,activeMix:n=0}=e.getLayerConfig(),i="string"==typeof r?eC(r):r||[1,0,0,1];e.updateLayerConfig({pickedFeatureID:ew(new Uint8Array(t))});let o={u_PickingStage:hX.HIGHLIGHT,u_PickingColor:t,u_HighlightColor:i.map(e=>255*e),u_activeMix:n};this.updatePickOption(o,e),e.models.forEach(e=>e.addUniforms(o))}),e.hooks.beforeSelect.tap("PixelPickingPlugin",t=>{let{selectColor:r,selectMix:n=0}=e.getLayerConfig(),i="string"==typeof r?eC(r):r||[1,0,0,1];e.updateLayerConfig({pickedFeatureID:ew(new Uint8Array(t))});let o={u_PickingStage:hX.HIGHLIGHT,u_PickingColor:t,u_HighlightColor:i.map(e=>255*e),u_activeMix:n,u_CurrentSelectedId:t,u_SelectColor:i.map(e=>255*e)};this.updatePickOption(o,e),e.models.forEach(e=>e.addUniforms(o))})}}let hZ=["mvt","geojsonvt","testTile"];class hY{apply(e,{styleAttributeService:t}){e.hooks.init.tapPromise("RegisterStyleAttributePlugin",()=>{!function(e){let t=e.getSource();return hZ.includes(t.parser.type)}(e)&&this.registerBuiltinAttributes(t,e)})}registerBuiltinAttributes(e,t){if("MaskLayer"===t.type){this.registerPositionAttribute(e);return}this.registerPositionAttribute(e),this.registerColorAttribute(e)}registerPositionAttribute(e){e.registerStyleAttribute({name:"position",type:iR.Attribute,descriptor:{name:"a_Position",shaderLocation:hG.POSITION,buffer:{data:[],type:ic.FLOAT},size:3,update:(e,t,r)=>2===r.length?[r[0],r[1],0]:[r[0],r[1],r[2]]}})}registerColorAttribute(e){e.registerStyleAttribute({name:"color",type:iR.Attribute,descriptor:{name:"a_Color",shaderLocation:hG.COLOR,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:4,update:e=>{let{color:t}=e;return t&&t.length?t:[1,1,1,1]}}})}}class hq{constructor(){ia(this,"cameraService",void 0),ia(this,"coordinateSystemService",void 0),ia(this,"rendererService",void 0),ia(this,"mapService",void 0),ia(this,"layerService",void 0)}apply(e,{rendererService:t,mapService:r,layerService:n,coordinateSystemService:i,cameraService:o}){let a;this.rendererService=t,this.mapService=r,this.layerService=n,this.coordinateSystemService=i,this.cameraService=o,this.rendererService.uniformBuffers[0]||(a=this.rendererService.createBuffer({data:new Float32Array(92),isUBO:!0,label:"renderUniformBuffer"}),this.rendererService.uniformBuffers[0]=a),e.hooks.beforeRender.tap("ShaderUniformPlugin",()=>{let t=e.getLayerConfig().tileOrigin;this.coordinateSystemService.refresh(t);let{width:r,height:n}=this.rendererService.getViewportSize(),{data:i,uniforms:o}=this.generateUBO(r,n);this.layerService.alreadyInRendering&&this.rendererService.uniformBuffers[0]&&this.rendererService.uniformBuffers[0].subData({offset:0,data:i}),"WebGL1"===this.rendererService.queryVerdorInfo()&&e.models.forEach(t=>{t.addUniforms(il(il({},o),{},{u_PickingBuffer:e.getLayerConfig().pickingBuffer||0,u_shaderPick:Number(e.getShaderPickStat())}))})})}generateUBO(e,t){let r=this.cameraService.getProjectionMatrix(),n=this.cameraService.getViewMatrix(),i=this.cameraService.getViewProjectionMatrix(),o=this.cameraService.getModelMatrix(),a=this.coordinateSystemService.getViewportCenterProjection(),s=this.coordinateSystemService.getPixelsPerDegree(),l=this.cameraService.getZoom(),u=this.coordinateSystemService.getPixelsPerDegree2(),c=this.cameraService.getZoomScale(),h=this.coordinateSystemService.getPixelsPerMeter(),d=this.coordinateSystemService.getCoordinateSystem(),p=this.cameraService.getCameraPosition(),f=window.devicePixelRatio,g=this.coordinateSystemService.getViewportCenter(),m=[e,t],v=this.cameraService.getFocalDistance();return{data:[...n,...r,...i,...o,...a,...s,l,...u,c,...h,d,...p,f,...g,...m,v,0,0,0],uniforms:{[ix.ProjectionMatrix]:r,[ix.ViewMatrix]:n,[ix.ViewProjectionMatrix]:i,[ix.Zoom]:l,[ix.ZoomScale]:c,[ix.FocalDistance]:v,[ix.CameraPosition]:p,[iE.CoordinateSystem]:d,[iE.ViewportCenter]:g,[iE.ViewportCenterProjection]:a,[iE.PixelsPerDegree]:s,[iE.PixelsPerDegree2]:u,[iE.PixelsPerMeter]:h,u_ViewportSize:m,u_ModelMatrix:o,u_DevicePixelRatio:f}}}}class hK{apply(e){e.hooks.beforeRender.tap("UpdateModelPlugin",()=>{e.layerModel&&e.layerModel.needUpdate().then(t=>{t&&e.renderLayers()})}),e.hooks.afterRender.tap("UpdateModelPlugin",()=>{e.layerModelNeedUpdate=!1})}}class hQ{apply(e,{styleAttributeService:t}){e.hooks.init.tapPromise("UpdateStyleAttributePlugin",()=>{this.initStyleAttribute(e,{styleAttributeService:t})}),e.hooks.beforeRender.tap("UpdateStyleAttributePlugin",()=>{!e.layerModelNeedUpdate&&e.inited&&this.updateStyleAttribute(e,{styleAttributeService:t})})}updateStyleAttribute(e,{styleAttributeService:t}){let r=t.getLayerStyleAttributes()||[],n=t.getLayerStyleAttribute("filter");if(n&&n.needRegenerateVertices){e.layerModelNeedUpdate=!0,r.forEach(e=>e.needRegenerateVertices=!1);return}r.filter(e=>e.needRegenerateVertices).forEach(r=>{t.updateAttributeByFeatureRange(r.name,e.getEncodedData(),r.featureRange.startIndex,r.featureRange.endIndex,e),r.needRegenerateVertices=!1})}initStyleAttribute(e,{styleAttributeService:t}){(t.getLayerStyleAttributes()||[]).filter(e=>e.needRegenerateVertices).forEach(r=>{t.updateAttributeByFeatureRange(r.name,e.getEncodedData(),r.featureRange.startIndex,r.featureRange.endIndex),r.needRegenerateVertices=!1})}}let hJ={[iw.additive]:{enable:!0,func:{srcRGB:ic.ONE,dstRGB:ic.ONE,srcAlpha:1,dstAlpha:1}},[iw.none]:{enable:!1},[iw.normal]:{enable:!0,func:{srcRGB:ic.SRC_ALPHA,dstRGB:ic.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}},[iw.subtractive]:{enable:!0,func:{srcRGB:ic.ONE,dstRGB:ic.ONE,srcAlpha:ic.ZERO,dstAlpha:ic.ONE_MINUS_SRC_COLOR},equation:{rgb:ic.FUNC_SUBTRACT,alpha:ic.FUNC_SUBTRACT}},[iw.max]:{enable:!0,func:{srcRGB:ic.ONE,dstRGB:ic.ONE},equation:{rgb:ic.MAX_EXT}},[iw.min]:{enable:!0,func:{srcRGB:ic.ONE,dstRGB:ic.ONE},equation:{rgb:ic.MIN_EXT}}};class h0{constructor(e){ia(this,"layer",void 0),this.layer=e}pickRender(e){let t=this.layer.getContainer().layerService,r=this.layer;if(r.tileLayer)return r.tileLayer.pickRender(e);r.hooks.beforePickingEncode.call(),t.renderTileLayerMask(r),r.renderModels({ispick:!0}),r.hooks.afterPickingEncode.call()}pick(e,t){var r=this;return iG(function*(){let n=r.layer.getContainer().pickingService;return"RasterLayer"===e.type?r.pickRasterLayer(e,t):(r.pickRender(t),n.pickFromPickingFBO(e,t))})()}pickRasterLayer(e,t,r){let n=this.layer.getContainer(),i=n.pickingService,o=n.mapService,a=this.layer.getSource().extent,s=function(e,t){let[r,n,i,o]=t;return e.lng>r&&e.lng<=i&&e.lat>n&&e.lat<=o}(t.lngLat,a),l={x:t.x,y:t.y,type:t.type,lngLat:t.lngLat,target:t,rasterValue:null},u=r||e;if(!s)return l.type="mousemove"===t.type?"mouseout":"un"+t.type,i.triggerHoverOnLayer(u,il(il({},l),{},{type:"unpick"})),i.triggerHoverOnLayer(u,l),!1;{let r=this.readRasterValue(e,a,o,t.x,t.y);return l.rasterValue=r,i.triggerHoverOnLayer(u,l),!0}}readRasterValue(e,t,r,n,i){let o=e.getSource().data.dataArray[0],[a=0,s=0,l=10,u=-10]=t,c=r.lngLatToContainer([a,s]),h=r.lngLatToContainer([l,u]),d=h.x-c.x,p=c.y-h.y,f=[(n-c.x)/d,(i-h.y)/p],g=o.width||1,m=o.height||1,v=Math.floor(f[0]*g),y=Math.max(0,Math.floor(f[1]*m)-1)*g+v;return o.data[y]}selectFeature(e){let t=this.layer,[r,n,i]=e;t.hooks.beforeSelect.call([r,n,i])}highlightPickedFeature(e){let[t,r,n]=e;this.layer.hooks.beforeHighlight.call([t,r,n])}getFeatureById(e){return this.layer.getSource().getFeatureById(e)}}class h1{constructor(e){ia(this,"layer",void 0),ia(this,"rendererService",void 0),ia(this,"colorTexture",void 0),ia(this,"key",void 0),this.layer=e;let t=this.layer.getContainer();this.rendererService=t.rendererService}getColorTexture(e,t){let r=this.getTextureKey(e,t);return this.key===r||(this.createColorTexture(e,t),this.key=r),this.colorTexture}createColorTexture(e,t){let{createTexture2D:r}=this.rendererService,n=this.getColorRampBar(e,t),i=r({data:new Uint8Array(n.data),width:n.width,height:n.height,flipY:!1,unorm:!0});return this.colorTexture=i,i}setColorTexture(e,t,r){this.key=this.getTextureKey(t,r),this.colorTexture=e}destroy(){var e;null===(e=this.colorTexture)||void 0===e||e.destroy()}getColorRampBar(e,t){switch(e.type){case"cat":return function(e){let t=window.document.createElement("canvas"),r=t.getContext("2d");t.width=256,t.height=1;let n=r.createImageData(256,1);return n.data.fill(0),e.positions.forEach((t,r)=>{let i=eC(e.colors[r]);n.data[4*t+0]=255*i[0],n.data[4*t+1]=255*i[1],n.data[4*t+2]=255*i[2],n.data[4*t+3]=255*i[3]}),t=null,r=null,n}(e);case"quantize":return function(e){let t=window.document.createElement("canvas"),r=t.getContext("2d");r.globalAlpha=1,t.width=256,t.height=1;let n=256/e.colors.length;for(let t=0;t<e.colors.length;t++)r.beginPath(),r.lineWidth=2,r.strokeStyle=e.colors[t],r.moveTo(t*n,0),r.lineTo((t+1)*n,0),r.stroke();let i=r.getImageData(0,0,256,1).data,o=eM(r,i);return t=null,r=null,o}(e);case"custom":return function(e,t){let r=window.document.createElement("canvas"),n=r.getContext("2d");n.globalAlpha=1,r.width=256,r.height=1;let i=t[1]-t[0];e.positions.length-e.colors.length!=1&&console.warn("positions 的数字个数应当比 colors 的样式多一个,poisitions 的首尾值一般为数据的最大最新值");for(let r=0;r<e.colors.length;r++)n.beginPath(),n.lineWidth=2,n.strokeStyle=e.colors[r],n.moveTo((e.positions[r]-t[0])/i*255,0),n.lineTo((e.positions[r+1]-t[0])/i*255,0),n.stroke();let o=n.getImageData(0,0,256,1).data,a=eM(n,o);return r=null,n=null,a}(e,t);case"linear":return function(e,t){let r=window.document.createElement("canvas"),n=r.getContext("2d");r.width=256,r.height=1;let i=n.createLinearGradient(0,0,256,1),o=t[1]-t[0];for(let r=0;r<e.colors.length;++r){let n=Math.max((e.positions[r]-t[0])/o,0);i.addColorStop(n,e.colors[r])}n.fillStyle=i,n.fillRect(0,0,256,1);let a=n.getImageData(0,0,256,1).data,s=eM(n,a);return r=null,n=null,s}(e,t);default:return function(e){let t=window.document.createElement("canvas"),r=t.getContext("2d");t.width=256,t.height=1;let n=null,i=r.createLinearGradient(0,0,256,1),o=e.positions[0],a=e.positions[e.positions.length-1];for(let t=0;t<e.colors.length;++t){let r=(e.positions[t]-o)/(a-o);i.addColorStop(r,e.colors[t])}return r.fillStyle=i,r.fillRect(0,0,256,1),n=new Uint8ClampedArray(r.getImageData(0,0,256,1).data),t=null,r=null,{data:n,width:256,height:1}}(e)}}getTextureKey(e,t){var r;return`${e.colors.join("_")}_${null==e||null===(r=e.positions)||void 0===r?void 0:r.join("_")}_${e.type}_${null==t?void 0:t.join("_")}`}}let h2=["passes"],h3=["moduleName","vertexShader","fragmentShader","defines","inject","triangulation","styleOption","pickingEnabled"],{isEqual:h4,isFunction:h5,isNumber:h6,isObject:h7,isPlainObject:h8,isUndefined:h9}=th,de=0;class dt extends tG.EventEmitter{get shaderModuleService(){return this.container.shaderModuleService}get cameraService(){return this.container.cameraService}get coordinateService(){return this.container.coordinateSystemService}get iconService(){return this.container.iconService}get fontService(){return this.container.fontService}get pickingService(){return this.container.pickingService}get rendererService(){return this.container.rendererService}get layerService(){return this.container.layerService}get debugService(){return this.container.debugService}get interactionService(){return this.container.interactionService}get mapService(){var e;return null===(e=this.container)||void 0===e?void 0:e.mapService}get normalPassFactory(){return this.container.normalPassFactory}constructor(e={}){super(),ia(this,"id",`${de++}`),ia(this,"name",`${de}`),ia(this,"parent",void 0),ia(this,"coordCenter",void 0),ia(this,"type",void 0),ia(this,"visible",!0),ia(this,"zIndex",0),ia(this,"minZoom",void 0),ia(this,"maxZoom",void 0),ia(this,"inited",!1),ia(this,"layerModelNeedUpdate",!1),ia(this,"pickedFeatureID",null),ia(this,"selectedFeatureID",null),ia(this,"styleNeedUpdate",!1),ia(this,"rendering",void 0),ia(this,"forceRender",!1),ia(this,"clusterZoom",0),ia(this,"layerType",void 0),ia(this,"triangulation",void 0),ia(this,"layerPickService",void 0),ia(this,"textureService",void 0),ia(this,"defaultSourceConfig",{data:[],options:{parser:{type:"json"}}}),ia(this,"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),ia(this,"hooks",{init:new an,afterInit:new at,beforeRender:new at,beforeRenderData:new ai,afterRender:new o5,beforePickingEncode:new o5,afterPickingEncode:new o5,beforeHighlight:new o5(["pickedColor"]),afterHighlight:new o5,beforeSelect:new o5(["pickedColor"]),afterSelect:new o5,beforeDestroy:new o5,afterDestroy:new o5}),ia(this,"models",[]),ia(this,"multiPassRenderer",void 0),ia(this,"plugins",void 0),ia(this,"startInit",!1),ia(this,"sourceOption",void 0),ia(this,"layerModel",void 0),ia(this,"shapeOption",void 0),ia(this,"tileLayer",void 0),ia(this,"layerChildren",[]),ia(this,"masks",[]),ia(this,"configService",aD),ia(this,"styleAttributeService",void 0),ia(this,"layerSource",void 0),ia(this,"postProcessingPassFactory",void 0),ia(this,"animateOptions",{enable:!1}),ia(this,"container",void 0),ia(this,"encodedData",void 0),ia(this,"currentPickId",null),ia(this,"rawConfig",void 0),ia(this,"needUpdateConfig",void 0),ia(this,"encodeStyleAttribute",{}),ia(this,"enableShaderEncodeStyles",[]),ia(this,"enableDataEncodeStyles",[]),ia(this,"pendingStyleAttributes",[]),ia(this,"scaleOptions",{}),ia(this,"animateStartTime",void 0),ia(this,"animateStatus",!1),ia(this,"isDestroyed",!1),ia(this,"uniformBuffers",[]),ia(this,"encodeDataLength",0),ia(this,"sourceEvent",()=>{this.dataState.dataSourceNeedUpdate=!0;let e=this.getLayerConfig();e&&e.autoFit&&this.fitBounds(e.fitBoundsOptions),this.layerSource.getSourceCfg().autoRender&&setTimeout(()=>{this.reRender()},10)}),this.name=e.name||this.id,this.zIndex=e.zIndex||0,this.rawConfig=e,this.masks=e.maskLayers||[]}addMask(e){this.masks.push(e),this.updateLayerConfig({maskLayers:this.masks}),this.enableMask()}removeMask(e){let t=this.masks.indexOf(e);t>-1&&this.masks.splice(t,1),this.updateLayerConfig({maskLayers:this.masks})}disableMask(){this.updateLayerConfig({enableMask:!1})}enableMask(){this.updateLayerConfig({enableMask:!0})}addMaskLayer(e){this.masks.push(e)}removeMaskLayer(e){let t=this.masks.indexOf(e);t>-1&&this.masks.splice(t,1),e.destroy()}getAttribute(e){return this.styleAttributeService.getLayerStyleAttribute(e)}getLayerConfig(){return this.configService.getLayerConfig(this.id)}updateLayerConfig(e){if(Object.keys(e).map(t=>{t in this.rawConfig&&(this.rawConfig[t]=e[t])}),this.startInit){let t=this.container.id;this.configService.setLayerConfig(t,this.id,il(il(il({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),e)),this.needUpdateConfig={}}else this.needUpdateConfig=il(il({},this.needUpdateConfig),e)}setContainer(e){this.container=e}getContainer(){return this.container}addPlugin(e){return this.plugins.push(e),this}init(){var e=this;return iG(function*(){let t=e.container.id;e.startInit=!0,e.configService.setLayerConfig(t,e.id,e.rawConfig),e.layerType=e.rawConfig.layerType;let{enableMultiPassRenderer:r,passes:n}=e.getLayerConfig();for(let t of(r&&null!=n&&n.length&&n.length>0&&e.mapService.on("mapAfterFrameChange",()=>{e.renderLayers()}),e.postProcessingPassFactory=e.container.postProcessingPassFactory,e.styleAttributeService=e.container.styleAttributeService,r&&(e.multiPassRenderer=e.container.multiPassRenderer,e.multiPassRenderer.setLayer(e)),e.pendingStyleAttributes.forEach(({attributeName:t,attributeField:r,attributeValues:n,updateOptions:i})=>{e.styleAttributeService.updateStyleAttribute(t,{scale:il({field:r},e.splitValuesAndCallbackInAttribute(n,r?void 0:e.getLayerConfig()[t]))},i)}),e.pendingStyleAttributes=[],e.plugins=[new l$,new hY,new hO,new lX,new hk,new hP,new hQ,new hK,new hH,new hq,new hI,new hF,new h$,new hR],e.plugins))t.apply(e,e.container);e.layerPickService=new h0(e),e.textureService=new h1(e),e.log(iT.LayerInitStart),yield e.hooks.init.promise(),e.log(iT.LayerInitEnd),e.inited=!0,e.emit("inited",{target:e,type:"inited"}),e.emit("add",{target:e,type:"add"}),e.hooks.afterInit.call()})()}log(e,t="init"){var r;if(this.tileLayer||this.isTileLayer)return;let n=`${this.id}.${t}.${e}`,i={id:this.id,type:this.type};null===(r=this.debugService)||void 0===r||r.log(n,i)}updateModelData(e){e.attributes&&e.elements?this.models.map(t=>{t.updateAttributesAndElements(e.attributes,e.elements)}):console.warn("data error")}setLayerPickService(e){this.layerPickService=e}prepareBuildModel(){0!==Object.keys(this.needUpdateConfig||{}).length&&this.updateLayerConfig({});let{animateOption:e}=this.getLayerConfig();null!=e&&e.enable&&(this.layerService.startAnimate(),this.animateStatus=!0)}color(e,t,r){return this.updateStyleAttribute("color",e,t,r),this}texture(e,t,r){return this.updateStyleAttribute("texture",e,t,r),this}rotate(e,t,r){return this.updateStyleAttribute("rotate",e,t,r),this}size(e,t,r){return this.updateStyleAttribute("size",e,t,r),this}filter(e,t,r){let n=this.updateStyleAttribute("filter",e,t,r);return this.dataState.dataSourceNeedUpdate=n&&this.inited,this}shape(e,t,r){this.shapeOption={field:e,values:t};let n=this.updateStyleAttribute("shape",e,t,r);return this.dataState.dataSourceNeedUpdate=n&&this.inited,this}label(e,t,r){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:e,attributeValues:t,updateOptions:r}),this}animate(e){let t={};return h7(e)?(t.enable=!0,t=il(il({},t),e)):t.enable=e,this.updateLayerConfig({animateOption:t}),this}source(e,t){return(null==e?void 0:e.type)==="source"?this.setSource(e):(this.sourceOption={data:e,options:t},this.clusterZoom=0),this}setData(e,t){return this.inited?(this.dataUpdatelog(),this.layerSource.setData(e,t)):this.on("inited",()=>{this.dataUpdatelog(),this.layerSource.setData(e,t)}),this}dataUpdatelog(){this.log(iT.SourceInitStart,iO.UPDATE),this.layerSource.once("update",()=>{this.log(iT.SourceInitEnd,iO.UPDATE)})}style(e){let{passes:t}=e,r=ox(e,h2);return t&&hj(t).forEach(e=>{let t=this.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(e[0]);t&&t.updateOptions(e[1])}),r.borderColor&&(r.stroke=r.borderColor),r.borderWidth&&(r.strokeWidth=r.borderWidth),Object.keys(r).forEach(e=>{let t=r[e];!Array.isArray(t)||2!==t.length||h6(t[0])||h6(t[1])||(r[e]={field:t[0],value:t[1]})}),this.encodeStyle(r),this.updateLayerConfig(r),this}encodeStyle(e){Object.keys(e).forEach(t=>{[...this.enableShaderEncodeStyles,...this.enableDataEncodeStyles].includes(t)&&h8(e[t])&&(e[t].field||e[t].value)&&!h4(this.encodeStyleAttribute[t],e[t])?(this.encodeStyleAttribute[t]=e[t],this.updateStyleAttribute(t,e[t].field,e[t].value),this.inited&&(this.dataState.dataMappingNeedUpdate=!0)):this.encodeStyleAttribute[t]&&(delete this.encodeStyleAttribute[t],this.dataState.dataSourceNeedUpdate=!0)})}scale(e,t){let r=il({},this.scaleOptions);if(h7(e)?this.scaleOptions=il(il({},this.scaleOptions),e):this.scaleOptions[e]=t,this.styleAttributeService&&!h4(r,this.scaleOptions)){let r=h7(e)?e:{[e]:t};this.styleAttributeService.updateScaleAttribute(r)}return this}renderLayers(){this.rendering=!0,this.layerService.reRender(),this.rendering=!1}prerender(){}render(e={}){return this.tileLayer?this.tileLayer.render():(this.layerService.beforeRenderData(this),this.encodeDataLength<=0&&!this.forceRender||this.renderModels(e)),this}renderMultiPass(){var e=this;return iG(function*(){(!(e.encodeDataLength<=0)||e.forceRender)&&(e.multiPassRenderer&&e.multiPassRenderer.getRenderFlag()?yield e.multiPassRenderer.render():e.renderModels())})()}active(e){let t={};return t.enableHighlight=!!h7(e)||e,h7(e)?(t.enableHighlight=!0,e.color&&(t.highlightColor=e.color),e.mix&&(t.activeMix=e.mix)):t.enableHighlight=!!e,this.updateLayerConfig(t),this}setActive(e,t){if(h7(e)){let{x:r=0,y:n=0}=e;this.updateLayerConfig({highlightColor:h7(t)?t.color:this.getLayerConfig().highlightColor,activeMix:h7(t)?t.mix:this.getLayerConfig().activeMix}),this.pick({x:r,y:n})}else this.updateLayerConfig({pickedFeatureID:e,highlightColor:h7(t)?t.color:this.getLayerConfig().highlightColor,activeMix:h7(t)?t.mix:this.getLayerConfig().activeMix}),this.hooks.beforeHighlight.call(eL(e)).then(()=>{setTimeout(()=>{this.reRender()},1)})}select(e){let t={};return t.enableSelect=!!h7(e)||e,h7(e)?(t.enableSelect=!0,e.color&&(t.selectColor=e.color),e.mix&&(t.selectMix=e.mix)):t.enableSelect=!!e,this.updateLayerConfig(t),this}setSelect(e,t){if(h7(e)){let{x:r=0,y:n=0}=e;this.updateLayerConfig({selectColor:h7(t)?t.color:this.getLayerConfig().selectColor,selectMix:h7(t)?t.mix:this.getLayerConfig().selectMix}),this.pick({x:r,y:n})}else this.updateLayerConfig({pickedFeatureID:e,selectColor:h7(t)?t.color:this.getLayerConfig().selectColor,selectMix:h7(t)?t.mix:this.getLayerConfig().selectMix}),this.hooks.beforeSelect.call(eL(e)).then(()=>{setTimeout(()=>{this.reRender()},1)})}setBlend(e){return this.updateLayerConfig({blend:e}),this.reRender(),this}show(){return this.updateLayerConfig({visible:!0}),this.reRender(),this.emit("show"),this}hide(){return this.updateLayerConfig({visible:!1}),this.reRender(),this.emit("hide"),this}setIndex(e){return this.zIndex=e,this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this}setCurrentPickId(e){this.currentPickId=e}getCurrentPickId(){return this.currentPickId}setCurrentSelectedId(e){this.selectedFeatureID=e}getCurrentSelectedId(){return this.selectedFeatureID}isVisible(){let e=this.mapService.getZoom(),{visible:t,minZoom:r=-1/0,maxZoom:n=1/0}=this.getLayerConfig();return!!t&&e>=r&&e<n}setMultiPass(e,t){if(this.updateLayerConfig({enableMultiPassRenderer:e}),t&&this.updateLayerConfig({passes:t}),e){let{passes:e=[]}=this.getLayerConfig();this.multiPassRenderer=hV(this,e,this.postProcessingPassFactory,this.normalPassFactory),this.multiPassRenderer.setRenderFlag(!0);let{width:t,height:r}=this.rendererService.getViewportSize();this.multiPassRenderer.resize(t,r)}return this}setMinZoom(e){return this.updateLayerConfig({minZoom:e}),this}getMinZoom(){let{minZoom:e}=this.getLayerConfig();return e}getMaxZoom(){let{maxZoom:e}=this.getLayerConfig();return e}get(e){return this.getLayerConfig()[e]}setMaxZoom(e){return this.updateLayerConfig({maxZoom:e}),this}setAutoFit(e){return this.updateLayerConfig({autoFit:e}),this}fitBounds(e){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;let t=this.getSource().extent;return t.some(e=>Math.abs(e)===1/0)||this.mapService.fitBounds([[t[0],t[1]],[t[2],t[3]]],e),this}destroy(e=!0){var t,r,n,i,o;if(this.isDestroyed)return;null===(t=this.layerModel)||void 0===t||t.uniformBuffers.forEach(e=>{e.destroy()}),this.layerChildren.map(e=>e.destroy(!1)),this.layerChildren=[];let{maskfence:a}=this.getLayerConfig();a&&(this.masks.map(e=>e.destroy(!1)),this.masks=[]),this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),null===(r=this.multiPassRenderer)||void 0===r||r.destroy(),this.textureService.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),null===(n=this.layerModel)||void 0===n||n.clearModels(e),null===(i=this.tileLayer)||void 0===i||i.destroy(),this.models=[],null===(o=this.debugService)||void 0===o||o.removeLog(this.id),this.emit("remove",{target:this,type:"remove"}),this.emit("destroy",{target:this,type:"destroy"}),this.removeAllListeners(),this.isDestroyed=!0}clear(){this.styleAttributeService.clearAllAttributes()}clearModels(){var e;this.models.forEach(e=>e.destroy()),null===(e=this.layerModel)||void 0===e||e.clearModels(),this.models=[]}isDirty(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(e=>e.needRescale||e.needRemapping||e.needRegenerateVertices).length}setSource(e){if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=e,this.clusterZoom=0,this.inited&&this.layerSource.cluster){let e=this.mapService.getZoom();this.layerSource.updateClusterData(e)}this.layerSource.inited&&this.sourceEvent(),this.layerSource.on("update",({type:e})=>{if(void 0===this.coordCenter){let e=this.layerSource.center;this.coordCenter=e}if("update"===e){if(this.tileLayer){this.tileLayer.reload();return}this.sourceEvent()}})}getSource(){return this.layerSource}getScaleOptions(){return this.scaleOptions}setEncodedData(e){this.encodedData=e,this.encodeDataLength=e.length}getEncodedData(){return this.encodedData}getScale(e){return this.styleAttributeService.getLayerAttributeScale(e)}getLegend(e){var t,r,n;let i=this.styleAttributeService.getLayerStyleAttribute(e);return{type:null===(r=((null==i||null===(t=i.scale)||void 0===t?void 0:t.scalers)||[])[0])||void 0===r||null===(r=r.option)||void 0===r?void 0:r.type,field:null==i||null===(n=i.scale)||void 0===n?void 0:n.field,items:this.getLegendItems(e)}}getLegendItems(e){let t=this.styleAttributeService.getLayerAttributeScale(e);return t?t.invertExtent?t.range().map(r=>({value:t.invertExtent(r),[e]:r})):t.ticks?t.ticks().map(r=>({value:r,[e]:t(r)})):null!=t&&t.domain?t.domain().filter(e=>!h9(e)).map(r=>({value:r,[e]:t(r)})):[]:[]}pick({x:e,y:t}){this.interactionService.triggerHover({x:e,y:t})}boxSelect(e,t){this.pickingService.boxPickLayer(this,e,t)}buildLayerModel(e){var t=this;return iG(function*(){let{moduleName:r,vertexShader:n,fragmentShader:i,defines:o,inject:a,triangulation:s,styleOption:l,pickingEnabled:u=!0}=e,c=ox(e,h3);t.shaderModuleService.registerModule(r,{vs:n,fs:i,defines:o,inject:a});let{vs:h,fs:d,uniforms:p}=t.shaderModuleService.getModule(r),{createModel:f}=t.rendererService;return new Promise(e=>{let{attributes:r,elements:n,count:i}=t.styleAttributeService.createAttributesAndIndices(t.encodedData,s,l,t),o=[...t.layerModel.uniformBuffers,...t.rendererService.uniformBuffers];u&&o.push(t.getPickingUniformBuffer());let a=il({attributes:r,uniforms:p,fs:d,vs:h,elements:n,blend:hJ[iw.normal],uniformBuffers:o,textures:t.layerModel.textures},c);i&&(a.count=i),e(f(a))})})()}createAttributes(e){let{triangulation:t}=e,{attributes:r}=this.styleAttributeService.createAttributes(this.encodedData,t);return r}getTime(){return this.layerService.clock.getDelta()}setAnimateStartTime(){this.animateStartTime=this.layerService.clock.getElapsedTime()}stopAnimate(){this.animateStatus&&(this.layerService.stopAnimate(),this.animateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}getLayerAnimateTime(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}needPick(e){let{enableHighlight:t=!0,enableSelect:r=!0}=this.getLayerConfig(),n=-1!==this.eventNames().indexOf(e)||-1!==this.eventNames().indexOf("un"+e);return("click"===e||"dblclick"===e)&&r&&(n=!0),"mousemove"===e&&(t||-1!==this.eventNames().indexOf("mouseenter")||-1!==this.eventNames().indexOf("unmousemove")||-1!==this.eventNames().indexOf("mouseout"))&&(n=!0),this.isVisible()&&n}buildModels(){return iG(function*(){throw Error("Method not implemented.")})()}rebuildModels(){var e=this;return iG(function*(){yield e.buildModels()})()}renderMulPass(e){return iG(function*(){yield e.render()})()}renderModels(e={}){return this.encodeDataLength<=0&&!this.forceRender?this.clearModels():(this.hooks.beforeRender.call(),this.models.forEach(t=>{t.draw({uniforms:this.layerModel.getUninforms(),blend:this.layerModel.getBlend(),stencil:this.layerModel.getStencil(e),textures:this.layerModel.textures},(null==e?void 0:e.ispick)||!1)}),this.hooks.afterRender.call()),this}updateStyleAttribute(e,t,r,n){return!h4((this.configService.getAttributeConfig(this.id)||{})[e],{field:t,values:r})&&(-1!==["color","size","texture","rotate","filter","label","shape"].indexOf(e)&&this.configService.setAttributeConfig(this.id,{[e]:{field:t,values:r}}),this.startInit?this.styleAttributeService.updateStyleAttribute(e,{scale:il({field:t},this.splitValuesAndCallbackInAttribute(r,this.getLayerConfig()[t]))},n):this.pendingStyleAttributes.push({attributeName:e,attributeField:t,attributeValues:r,updateOptions:n}),!0)}getLayerAttributeConfig(){return this.configService.getAttributeConfig(this.id)}getShaderPickStat(){return this.layerService.getShaderPickStat()}setEarthTime(e){console.warn("empty fn")}processData(e){return e}getModelType(){throw Error("Method not implemented.")}getDefaultConfig(){return{}}initLayerModels(){var e=this;return iG(function*(){e.models.forEach(e=>e.destroy()),e.models=[],e.uniformBuffers.forEach(e=>{e.destroy()}),e.uniformBuffers=[];let t=e.rendererService.createBuffer({data:new Float32Array(20).fill(0),isUBO:!0,label:"pickingUniforms"});e.uniformBuffers.push(t),e.models=yield e.layerModel.initModels()})()}getPickingUniformBuffer(){return this.uniformBuffers[0]}reRender(){this.inited&&this.layerService.reRender()}splitValuesAndCallbackInAttribute(e){return{values:h5(e)?void 0:e,callback:h5(e)?e:void 0}}}function dr(e){return e.maskOperation===iM.OR?{enable:!0,mask:255,func:{cmp:ic.ALWAYS,ref:1,mask:255},opFront:{fail:ic.KEEP,zfail:ic.REPLACE,zpass:ic.REPLACE}}:{enable:!0,mask:255,func:{cmp:e.stencilType===iL.SINGLE?ic.ALWAYS:0===e.stencilIndex?ic.ALWAYS:ic.LESS,ref:e.stencilType===iL.SINGLE?1:0===e.stencilIndex?2:1,mask:255},opFront:{fail:ic.KEEP,zfail:ic.REPLACE,zpass:ic.REPLACE}}}let dn={opacity:1,stroke:[1,0,0,1],offsets:[0,0],rotation:0,extrusionBase:0,strokeOpacity:1,thetaOffset:.314},di={opacity:"float",stroke:"vec4",offsets:"vec2",textOffset:"vec2",rotation:"float",extrusionBase:"float",strokeOpacity:"float",thetaOffset:"float"};var da=r(97074),ds=r.n(da);function dl(e){return Math.max(4*Math.ceil(e/4),4)}function du(e,t,r,n=!0){let i=3===r;if(n){e=e.slice();let t=[];for(let n=0;n<e.length;n+=r){t[0]=e[n],t[1]=e[n+1],i&&(t[2]=e[n+2]);let r=tM(t,!0,{enable:!1,decimal:1});e[n]=r[0],e[n+1]=r[1],i&&(e[n+2]=r[2])}}return ds()(e,t,r)}let dc="ATTRIBUTE_LOCATION_";class dh{get attributeLocation(){return il({},hG)}constructor(e){ia(this,"triangulation",void 0),ia(this,"uniformBuffers",[]),ia(this,"textures",[]),ia(this,"createTexture2D",void 0),ia(this,"preStyleAttribute",{}),ia(this,"encodeStyleAttribute",{}),ia(this,"layer",void 0),ia(this,"dataTexture",void 0),ia(this,"DATA_TEXTURE_WIDTH",void 0),ia(this,"dataTextureTest",void 0),ia(this,"configService",void 0),ia(this,"shaderModuleService",void 0),ia(this,"rendererService",void 0),ia(this,"iconService",void 0),ia(this,"fontService",void 0),ia(this,"styleAttributeService",void 0),ia(this,"mapService",void 0),ia(this,"cameraService",void 0),ia(this,"layerService",void 0),ia(this,"pickingService",void 0),ia(this,"attributeUnifoms",void 0),ia(this,"commonUnifoms",void 0),this.layer=e,this.configService=e.getContainer().globalConfigService,this.rendererService=e.getContainer().rendererService,this.pickingService=e.getContainer().pickingService,this.shaderModuleService=e.getContainer().shaderModuleService,this.styleAttributeService=e.getContainer().styleAttributeService,this.mapService=e.getContainer().mapService,this.iconService=e.getContainer().iconService,this.fontService=e.getContainer().fontService,this.cameraService=e.getContainer().cameraService,this.layerService=e.getContainer().layerService,this.registerStyleAttribute(),this.registerBuiltinAttributes(),this.startModelAnimate();let{createTexture2D:t}=this.rendererService;this.createTexture2D=t}getBlend(){let{blend:e="normal"}=this.layer.getLayerConfig();return hJ[iw[e]]}getStencil(e){let{mask:t=!1,maskInside:r=!0,enableMask:n,maskOperation:i=iM.AND}=this.layer.getLayerConfig();return"MaskLayer"===this.layer.type?dr({isStencil:!0,stencilType:iL.SINGLE}):e.isStencil?dr(il(il({},e),{},{maskOperation:i})):{enable:t||n&&0!==this.layer.masks.length||void 0!==this.layer.tileMask,mask:255,func:{cmp:ic.EQUAL,ref:r?1:0,mask:1}}}getDefaultStyle(){return{}}getUninforms(){let e=this.getCommonUniformsInfo(),t=this.getUniformsBufferInfo(this.getStyleAttribute());this.updateStyleUnifoms();let r=il(il({},t.uniformsOption),e.uniformsOption);return Object.keys(r).forEach(e=>{"boolean"==typeof r[e]&&(r[e]=r[e]?1:0)}),!this.rendererService.hasOwnProperty("device")&&this.textures&&1===this.textures.length&&(r.u_texture=this.textures[0]),r}getAnimateUniforms(){return{}}needUpdate(){return iG(function*(){return!1})()}buildModels(){return iG(function*(){throw Error("Method not implemented.")})()}initModels(){return iG(function*(){throw Error("Method not implemented.")})()}clearModels(e=!0){}getAttribute(){throw Error("Method not implemented.")}prerender(){}render(e){throw Error("Method not implemented.")}registerBuiltinAttributes(){throw Error("Method not implemented.")}animateOption2Array(e){return[e.enable?0:1,e.duration||4,e.interval||.2,e.trailLength||.1]}startModelAnimate(){let{animateOption:e}=this.layer.getLayerConfig();e.enable&&this.layer.setAnimateStartTime()}getInject(){return function(e,t){let r=[],n="";e.forEach(e=>{let i=e.replace(/([a-z])([A-Z])/g,"$1_$2").toUpperCase();t[e]?n+=`#define USE_ATTRIBUTE_${i} 0.0 
`:r.push(`  ${di[e]} u_${e};`),n+=`
#ifdef USE_ATTRIBUTE_${i}
layout(location = ${dc+i}) in ${di[e]} a_${e.charAt(0).toUpperCase()+e.slice(1)};
#endif 
`});let i=r.length?`
layout(std140) uniform AttributeUniforms {
  ${r.join("\n")}
};
`:"";n+=i;let o="";return e.forEach(e=>{let t=e.replace(/([a-z])([A-Z])/g,"$1_$2").toUpperCase();o+=`
  #ifdef USE_ATTRIBUTE_${t}
    ${di[e]} ${e} = a_${e.charAt(0).toUpperCase()+e.slice(1)};
  #else
    ${di[e]} ${e} = u_${e};
  #endif
  `}),{"vs:#decl":n,"fs:#decl":i,"vs:#main-start":o}}(this.layer.enableShaderEncodeStyles,this.layer.encodeStyleAttribute)}getDefines(){return il({},Object.keys(this.attributeLocation).reduce((e,t)=>(e[dc+t]=this.attributeLocation[t],e),{}))}getStyleAttribute(){let e={};return this.layer.enableShaderEncodeStyles.forEach(t=>{if(!this.layer.encodeStyleAttribute[t]){let r=this.layer.getLayerConfig()[t],n=void 0===r?dn[t]:r;"stroke"===t&&(n=eC(n)),e["u_"+t]=n}}),e}registerStyleAttribute(){Object.keys(this.layer.encodeStyleAttribute).forEach(e=>{let t=function(e){switch(e){case"rotation":return{name:"Rotation",type:iR.Attribute,descriptor:{name:"a_Rotation",shaderLocation:hG.ROTATION,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:1,update:e=>{let{rotation:t=0}=e;return Array.isArray(t)?[t[0]]:[t]}}};case"stroke":return{name:"stroke",type:iR.Attribute,descriptor:{name:"a_Stroke",shaderLocation:hG.STROKE,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:4,update:e=>{let{stroke:t=[1,1,1,1]}=e;return t}}};case"opacity":return{name:"opacity",type:iR.Attribute,descriptor:{name:"a_Opacity",shaderLocation:hG.OPACITY,buffer:{usage:ic.STATIC_DRAW,data:[],type:ic.FLOAT},size:1,update:e=>{let{opacity:t=1}=e;return[t]}}};case"offsets":return{name:"offsets",type:iR.Attribute,descriptor:{name:"a_Offsets",shaderLocation:hG.OFFSETS,buffer:{usage:ic.STATIC_DRAW,data:[],type:ic.FLOAT},size:2,update:e=>{let{offsets:t}=e;return t}}};default:return}}(e);t&&this.styleAttributeService.registerStyleAttribute(t)})}registerPosition64LowAttribute(e=!0){this.styleAttributeService.registerStyleAttribute({name:"position64Low",type:iR.Attribute,descriptor:{name:"a_Position64Low",shaderLocation:this.attributeLocation.POSITION_64LOW,buffer:{data:[],type:ic.FLOAT},size:2,update:(t,r,n)=>e?[tw(n[0]),tw(n[1])]:[0,0]}})}updateEncodeAttribute(e,t){this.encodeStyleAttribute[e]=t}initUniformsBuffer(){let e=this.getUniformsBufferInfo(this.getStyleAttribute()),t=this.getCommonUniformsInfo();0!==e.uniformsLength&&(this.attributeUnifoms=this.rendererService.createBuffer({data:new Float32Array(dl(e.uniformsLength)).fill(0),isUBO:!0,label:"layerModelAttributeUnifoms"}),this.uniformBuffers.push(this.attributeUnifoms)),0!==t.uniformsLength&&(this.commonUnifoms=this.rendererService.createBuffer({data:new Float32Array(dl(t.uniformsLength)).fill(0),isUBO:!0,label:"layerModelCommonUnifoms"}),this.uniformBuffers.push(this.commonUnifoms))}getUniformsBufferInfo(e){let t=0,r=[];return Object.values(e).forEach(e=>{Array.isArray(e)?(r.push(...e),t+=e.length):"number"==typeof e?(r.push(e),t+=1):"boolean"==typeof e&&(r.push(Number(e)),t+=1)}),{uniformsOption:e,uniformsLength:t,uniformsArray:r}}getCommonUniformsInfo(){return{uniformsLength:0,uniformsArray:[],uniformsOption:{}}}updateStyleUnifoms(){var e,t;let{uniformsArray:r}=this.getUniformsBufferInfo(this.getStyleAttribute()),{uniformsArray:n}=this.getCommonUniformsInfo();null===(e=this.attributeUnifoms)||void 0===e||e.subData({offset:0,data:new Uint8Array(new Float32Array(r).buffer)}),null===(t=this.commonUnifoms)||void 0===t||t.subData({offset:0,data:new Uint8Array(new Float32Array(n).buffer)})}}function dd(e){return e/180*Math.acos(-1)}function dp(e){let t=dd(e[0])+Math.PI/2,r=dd(e[1]),n=100+.4*Math.random(),i=n*Math.cos(r)*Math.cos(t);return[n*Math.cos(r)*Math.sin(t),n*Math.sin(r),i]}function df(){var e=new iX(2);return iX!=Float32Array&&(e[0]=0,e[1]=0),e}function dg(e,t){var r=new iX(2);return r[0]=e,r[1]=t,r}function dm(e,t){return e[0]=t[0],e[1]=t[1],e}function dv(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function dy(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function d_(e,t){var r=t[0],n=t[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e}function db(e,t){return e[0]*t[0]+e[1]*t[1]}df();let dx=df();df();let dS=df(),dA=df(),dE=df();function dT(e,t,r,n,i){return dv(e,r,n),d_(e,e),[i/db(t=dg(-e[1],e[0]),dg(-r[1],r[0])),t]}function dC(e,t){var r,n;return r=-t[1],n=t[0],e[0]=r,e[1]=n,e}function dw(e,t,r){return dy(e,t,r),d_(e,e),e}function dL(e,t){return e[0]===t[0]&&e[1]===t[1]}class dM{constructor(e={}){ia(this,"complex",void 0),ia(this,"join",void 0),ia(this,"cap",void 0),ia(this,"miterLimit",void 0),ia(this,"thickness",void 0),ia(this,"normal",void 0),ia(this,"lastFlip",-1),ia(this,"miter",dg(0,0)),ia(this,"started",!1),ia(this,"dash",!1),ia(this,"totalDistance",0),ia(this,"currentIndex",0),this.join=e.join||"miter",this.cap=e.cap||"butt",this.miterLimit=e.miterLimit||10,this.thickness=e.thickness||1,this.dash=e.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}simpleExtrude(e){let t=this.complex;if(e.length<=1)return t;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;let r=e.length,n=t.startIndex;for(let i=1;i<r;i++){let r=e[i-1],o=e[i],a=i<e.length-1?e[i+1]:null,s=this.simpleSegment(t,n,r,o,a);n+=s}if(this.dash)for(let e=0;e<t.positions.length/6;e++)t.positions[6*e+5]=this.totalDistance;return t.startIndex=t.positions.length/6,t}extrude(e){let t=this.complex;if(e.length<=1)return t;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;let r=e.length,n=t.startIndex;for(let i=1;i<r;i++){let r=e[i-1],o=e[i],a=i<e.length-1?e[i+1]:null,s=this.segment(t,n,r,o,a);n+=s}if(this.dash)for(let e=0;e<t.positions.length/6;e++)t.positions[6*e+5]=this.totalDistance;return t.startIndex=t.positions.length/6,t}simpleSegment(e,t,r,n,i){let o=0,a=e.indices,s=e.positions,l=e.normals,u=tO([n[0],n[1]]),c=tO([r[0],r[1]]);dw(dS,u,c);let h=0;if(this.dash&&(h=this.lineSegmentDistance(u,c),this.totalDistance+=h),this.normal||(this.normal=df(),dC(this.normal,dS)),this.started||(this.started=!0,this.extrusions(s,l,r,this.normal,this.thickness,this.totalDistance-h)),a.push(t+0,t+1,t+2),i){let e=tO([i[0],i[1]]);dL(u,e)&&dv(e,u,d_(e,dy(e,u,c))),dw(dA,e,u);let[r,h]=dT(dE,df(),dS,dA,this.thickness),d=0>db(dE,this.normal)?-1:1;this.extrusions(s,l,n,h,r,this.totalDistance),a.push(...1===this.lastFlip?[t,t+2,t+3]:[t+2,t+1,t+3]),d=-1,dm(this.normal,h),o+=2,this.lastFlip=d}else dC(this.normal,dS),this.extrusions(s,l,n,this.normal,this.thickness,this.totalDistance),a.push(...1===this.lastFlip?[t,t+2,t+3]:[t+2,t+1,t+3]),o+=2;return o}segment(e,t,r,n,i){let o=0,a=e.indices,s=e.positions,l=e.normals,u="square"===this.cap,c="bevel"===this.join,h=tO([n[0],n[1]]),d=tO([r[0],r[1]]);dw(dS,h,d);let p=0;if(this.dash&&(p=this.lineSegmentDistance(h,d),this.totalDistance+=p),this.normal||(this.normal=df(),dC(this.normal,dS)),!this.started){if(this.started=!0,u){let e=df(),t=df();dv(e,this.normal,dS),dv(t,this.normal,dS),l.push(t[0],t[1],0),l.push(e[0],e[1],0),s.push(r[0],r[1],0|r[2],this.totalDistance-p,-this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),s.push(r[0],r[1],0|r[2],this.totalDistance-p,this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(s,l,r,this.normal,this.thickness,this.totalDistance-p)}if(a.push(t+0,t+1,t+2),i){let e=tO([i[0],i[1]]);dL(h,e)&&dv(e,h,d_(e,dy(e,h,d))),dw(dA,e,h);let[r,u]=dT(dE,df(),dS,dA,this.thickness),p=0>db(dE,this.normal)?-1:1,f=c;!f&&"miter"===this.join&&r>this.miterLimit&&(f=!0),f?(l.push(this.normal[0],this.normal[1],0),l.push(u[0],u[1],0),s.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*p,0|n[2]),this.complex.indexes.push(this.currentIndex),s.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness*p,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,a.push(...this.lastFlip!==-p?[t,t+2,t+3]:[t+2,t+1,t+3]),a.push(t+2,t+3,t+4),dC(dx,dA),dm(this.normal,dx),l.push(this.normal[0],this.normal[1],0),s.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*p,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,o+=3):(this.extrusions(s,l,n,u,r,this.totalDistance),a.push(...1===this.lastFlip?[t,t+2,t+3]:[t+2,t+1,t+3]),p=-1,dm(this.normal,u),o+=2),this.lastFlip=p}else{if(dC(this.normal,dS),u){let e=df(),t=df();dy(t,dS,this.normal),dv(e,dS,this.normal),l.push(t[0],t[1],0),l.push(e[0],e[1],0),s.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),s.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(s,l,n,this.normal,this.thickness,this.totalDistance);a.push(...1===this.lastFlip?[t,t+2,t+3]:[t+2,t+1,t+3]),o+=2}return o}extrusions(e,t,r,n,i,o){t.push(n[0],n[1],0),t.push(n[0],n[1],0),e.push(r[0],r[1],0|r[2],o,-i,0|r[2]),this.complex.indexes.push(this.currentIndex),e.push(r[0],r[1],0|r[2],o,i,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}lineSegmentDistance(e,t){let r=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(r*r+n*n)}}let dO=function(e){return e.CYLINDER="cylinder",e.SQUARECOLUMN="squareColumn",e.TRIANGLECOLUMN="triangleColumn",e.HEXAGONCOLUMN="hexagonColumn",e.PENTAGONCOLUMN="pentagonColumn",e}({}),dI=function(e){return e.CIRCLE="circle",e.SQUARE="square",e.TRIANGLE="triangle",e.HEXAGON="hexagon",e.PENTAGON="pentagon",e}({});function dP(e,t=0){let r=2*Math.PI/e,n=[];for(let i=0;i<e;i++)n.push(r*i+t*Math.PI/12);return n.map(e=>[Math.sin(e+Math.PI/4),Math.cos(e+Math.PI/4),0])}function dR(){return dP(30)}function dk(){return dP(4)}function dN(){return dP(3)}function dD(){return dP(6,1)}function dU(){return dP(5)}let dz={[dI.CIRCLE]:dR,[dI.HEXAGON]:dD,[dI.TRIANGLE]:dN,[dI.SQUARE]:dk,[dI.PENTAGON]:dU,[dO.CYLINDER]:dR,[dO.HEXAGONCOLUMN]:dD,[dO.TRIANGLECOLUMN]:dN,[dO.SQUARECOLUMN]:dk,[dO.PENTAGONCOLUMN]:dU};function dB(){var e=new iX(3);return iX!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function dF(e,t,r){var n=new iX(3);return n[0]=e,n[1]=t,n[2]=r,n}function dj(e,t){var r=t[0],n=t[1],i=t[2],o=r*r+n*n+i*i;return o>0&&(o=1/Math.sqrt(o)),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e}function dV(e,t,r){var n=t[0],i=t[1],o=t[2],a=r[3]*n+r[7]*i+r[11]*o+r[15];return a=a||1,e[0]=(r[0]*n+r[4]*i+r[8]*o+r[12])/a,e[1]=(r[1]*n+r[5]*i+r[9]*o+r[13])/a,e[2]=(r[2]*n+r[6]*i+r[10]*o+r[14])/a,e}function dH(e,t){var r=e[0],n=e[1],i=e[2],o=t[0],a=t[1],s=t[2],l=Math.sqrt(r*r+n*n+i*i)*Math.sqrt(o*o+a*a+s*s);return Math.acos(Math.min(Math.max(l&&(e[0]*t[0]+e[1]*t[1]+e[2]*t[2])/l,-1),1))}var dG=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e};function dW(e,t=!1){let r=e[0][0],n=e[0][e[0].length-1];r[0]===n[0]&&r[1]===n[1]&&(e[0]=e[0].slice(0,e[0].length-1));let i=e[0].length,o=ds().flatten(e),{vertices:a,dimensions:s,holes:l}=o,u=[],c=[],h=[];for(let e=0;e<a.length/s;e++)u.push(a[e*s],a[e*s+1],1,-1,-1),h.push(0,0,1);let d=du(a,l,s,t);c.push(...d);for(let e=0;e<i;e++){let r=o.vertices.slice(e*s,(e+1)*s),n=o.vertices.slice((e+1)*s,(e+2)*s);0===n.length&&(n=o.vertices.slice(0,s));let i=u.length/5;u.push(r[0],r[1],1,0,0,n[0],n[1],1,.1,0,r[0],r[1],0,0,.8,n[0],n[1],0,.1,.8);let a=function(e,t,r,n=!1){var i,o,a,s,l,u;let c=dB(),h=dB(),d=dB();n&&(e=tM(e),t=tM(t),r=tM(r));let p=dF(...e),f=dF(...t);dG(c,dF(...r),f),dG(h,p,f),i=c[0],o=c[1],a=c[2],s=h[0],l=h[1],u=h[2],d[0]=o*u-a*l,d[1]=a*s-i*u,d[2]=i*l-o*s;let g=dB();return dj(g,d),g}([n[0],n[1],1],[r[0],r[1],0],[r[0],r[1],1],t);h.push(...a,...a,...a,...a),c.push(...[1,2,0,3,2,1].map(e=>e+i))}return{positions:u,index:c,normals:h}}dB();let dX={};function d$(e){let t=tk(e.coordinates);return{vertices:[...t,...t,...t,...t],indices:[0,1,2,2,3,0],size:t.length}}function dZ(e){let t=dp(tk(e.coordinates));return{vertices:[...t,...t,...t,...t],indices:[0,1,2,2,3,0],size:t.length}}function dY(e){let{shape:t}=e,{positions:r,index:n,normals:i}=function(e,t=!1){if(dX&&dX[e])return dX[e];let r=dW([dz[e]?dz[e]():dz.cylinder()],t);return dX[e]=r,r}(t,!1);return{vertices:r,indices:n,normals:i,size:5}}function dq(e){let t=tk(e.coordinates);return{vertices:[...t],indices:[0],size:t.length}}function dK(e){let{coordinates:t}=e,r=new dM({dash:!0,join:"bevel"}),n=t;n[0]&&!Array.isArray(n[0][0])&&(n=[t]),n.forEach(e=>{r.extrude(e)});let i=r.complex;return{vertices:i.positions,indices:i.indices,normals:i.normals,indexes:i.indexes,size:6}}function dQ(e){let{coordinates:t}=e,r=[];if(!Array.isArray(t[0]))return{vertices:[],indices:[],normals:[],size:6,count:0};let{results:n,totalDistance:i}=function(e){let t=e;Array.isArray(t)&&Array.isArray(t[0])&&Array.isArray(t[0][0])&&(t=e.flat());let r=0;if(t.length<2)return{results:t,totalDistance:0};{let e=[],n=d0(t[0],r);e.push(n);for(let n=1;n<t.length-1;n++){r+=dJ(tO(t[n-1]),tO(t[n]));let i=d0(t[n],r);e.push(i),e.push(i)}return r+=dJ(tO(t[t.length-2]),tO(t[t.length-1])),e.push(d0(t[t.length-1],r)),{results:e,totalDistance:r}}}(t);return n.map(e=>{r.push(e[0],e[1],e[2],e[3],0,i)}),{vertices:r,indices:[],normals:[],size:6,count:n.length}}function dJ(e,t){let r=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(r*r+n*n)}function d0(e,t){return e.length<3&&e.push(0),void 0!==t&&e.push(t),e}function d1(e){let{coordinates:t}=e,{vertices:r,dimensions:n,holes:i}=ds().flatten(t);return{indices:du(r,i,n),vertices:r,size:n}}function d2(e){let{indices:t,vertices:r,size:n}=d1(e);return{indices:t,vertices:function(e){let t=[],{center:r,radius:n}=function(e){let t=e[0],r=e[1],n=e[0],i=e[1],o=0,a=0,s=0;for(let l=0;l<e.length;l+=2){let u=e[l],c=e[l+1];u&&c&&(t=Math.max(u,t),r=Math.max(c,r),n=Math.min(u,n),i=Math.min(c,i),o+=u,a+=c,s++)}return{center:[o/s,a/s],radius:Math.sqrt(Math.pow(t-n,2)+Math.pow(r-i,2))/2}}(e);for(let i=0;i<e.length;i+=2){let o=e[i],a=e[i+1];t.push(o,a,0,...r,n)}return t}(r),size:n+4}}function d3(e){let{positions:t,index:r,normals:n}=dW(e.coordinates,!0);return{vertices:t,indices:r,normals:n,size:5}}function d4(e){let t=e.coordinates;return{vertices:[...t[0],0,0,0,...t[1],0,1,0,...t[2],0,1,1,...t[3],0,0,1],indices:[0,1,2,0,2,3],size:5}}function d5(e,t){let{segmentNumber:r=30}=t,n=e.coordinates,i=[],o=[];for(let e=0;e<r;e++)i.push(e,1,e,n[0][0],n[0][1],n[1][0],n[1][1],e,-1,e,n[0][0],n[0][1],n[1][0],n[1][1]),e!==r-1&&o.push(...[0,1,2,1,3,2].map(t=>2*e+t));return{vertices:i,indices:o,size:7}}let d6={solid:0,dash:1};class d7 extends dh{constructor(...e){super(...e),ia(this,"texture",void 0),ia(this,"updateTexture",()=>{let{createTexture2D:e}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=e({data:this.iconService.getCanvas(),mag:ic.NEAREST,min:ic.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12,THETA_OFFSET:13})}getCommonUniformsInfo(){let{sourceColor:e,targetColor:t,textureBlend:r="normal",lineType:n="solid",dashArray:i=[10,5],forward:o=!0,lineTexture:a=!1,iconStep:s=100,segmentNumber:l=30}=this.layer.getLayerConfig(),{animateOption:u}=this.layer.getLayerConfig(),c=i;"dash"!==n&&(c=[0,0]),2===c.length&&c.push(0,0);let h=0,d=[0,0,0,0],p=[0,0,0,0];if(e&&t&&(d=eC(e),p=eC(t),h=1),this.rendererService.getDirty()){var f;null===(f=this.texture)||void 0===f||f.bind()}let g={u_animate:this.animateOption2Array(u),u_dash_array:c,u_sourceColor:d,u_targetColor:p,u_textSize:[1024,this.iconService.canvasHeight||128],segmentNumber:l,u_lineDir:o?1:-1,u_icon_step:s,u_line_texture:a?1:0,u_textureBlend:"normal"===r?0:1,u_blur:.9,u_line_type:d6[n||"solid"],u_time:this.layer.getLayerAnimateTime()||0,u_linearColor:h};return this.getUniformsBufferInfo(g)}initModels(){var e=this;return iG(function*(){return e.updateTexture(),e.iconService.on("imageUpdate",e.updateTexture),e.buildModels()})()}clearModels(){var e;null===(e=this.texture)||void 0===e||e.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}getShaders(){return{frag:'\n#define Animate 0.0\n#define LineTexture 1.0\nuniform sampler2D u_texture;\nlayout(std140) uniform commonUniorm {\n  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n  vec4 u_dash_array;\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  vec2 u_textSize;\n  float segmentNumber;\n  float u_lineDir: 1.0;\n  float u_icon_step: 100;\n  float u_line_texture: 0.0;\n  float u_textureBlend;\n  float u_blur : 0.9;\n  float u_line_type: 0.0;\n  float u_time;\n  float u_linearColor: 0.0;\n};\n\nin vec4 v_color;\nin vec2 v_iconMapUV;\nin vec4 v_lineData;\n//dash\nin vec4 v_dash_array;\nin float v_distance_ratio;\n\nout vec4 outputColor;\n#pragma include "picking"\n\nvoid main() {\n  if(u_dash_array!=vec4(0.0)){\n    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);\n    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {\n      discard;\n    };\n  }\n  float animateSpeed = 0.0; // 运动速度\n  outputColor = v_color;\n  if(u_animate.x == Animate && u_line_texture != LineTexture) {\n      animateSpeed = u_time / u_animate.y;\n      float alpha =1.0 - fract( mod(1.0- v_lineData.b, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);\n      alpha = (alpha + u_animate.w -1.0) / u_animate.w;\n      // alpha = smoothstep(0., 1., alpha);\n      alpha = clamp(alpha, 0.0, 1.0);\n      outputColor.a *= alpha;\n  }\n\n  // 当存在贴图时在底色上贴上贴图\n  if(u_line_texture == LineTexture) { // while load texture\n    float arcRadio = smoothstep( 0.0, 1.0, (v_lineData.r / segmentNumber));\n    // float arcRadio = smoothstep( 0.0, 1.0, d_distance_ratio);\n\n    float count = v_lineData.g; // 贴图在弧线上重复的数量\n\n    float time = 0.0;\n    if(u_animate.x == Animate) {\n      time = u_time / u_animate.y;\n    }\n    float redioCount = arcRadio * count;\n\n    float u = fract(redioCount - time);\n    float v = v_lineData.a; // 横向 v\n    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;\n\n    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);\n\n    if(u_animate.x == Animate) {\n      float currentPlane = floor(redioCount - time);\n      float textureStep = floor(count * u_animate.z);\n      float a = mod(currentPlane, textureStep);\n      if(a < textureStep - 1.0) {\n        pattern = vec4(0.0);\n      }\n    }\n\n    if(u_textureBlend == 0.0) { // normal\n      pattern.a = 0.0;\n      outputColor = filterColor(outputColor + pattern);\n    } else { // replace\n        pattern.a *= v_color.a;\n        if(outputColor.a <= 0.0) {\n          pattern.a = 0.0;\n        }\n        outputColor = filterColor(pattern);\n    }\n    \n  } else {\n     outputColor = filterColor(outputColor);\n  }\n}',vert:'#define Animate (0.0)\n#define LineTexture (1.0)\n\nlayout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\nlayout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;\nlayout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;\n\nlayout(std140) uniform commonUniorm {\n  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n  vec4 u_dash_array;\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  vec2 u_textSize;\n  float segmentNumber;\n  float u_lineDir: 1.0;\n  float u_icon_step: 100;\n  float u_line_texture: 0.0;\n  float u_textureBlend;\n  float u_blur : 0.9;\n  float u_line_type: 0.0;\n  float u_time;\n  float u_linearColor: 0.0;\n};\n\nout vec4 v_color;\nout vec2 v_iconMapUV;\nout vec4 v_lineData;\n//dash\nout vec4 v_dash_array;\nout float v_distance_ratio;\n\n#pragma include "projection"\n#pragma include "project"\n#pragma include "picking"\n\nfloat bezier3(vec3 arr, float t) {\n  float ut = 1.0 - t;\n  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;\n}\nvec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {\n  vec2 center = target - source;\n  float r = length(center);\n  float theta = atan(center.y, center.x);\n  float thetaOffset = arcThetaOffset;\n  float r2 = r / 2.0 / cos(thetaOffset);\n  float theta2 = theta + thetaOffset;\n  vec2 mid = vec2(r2 * cos(theta2) + source.x, r2 * sin(theta2) + source.y);\n  if (u_lineDir == 1.0) {\n    // 正向\n    return mid;\n  } else {\n    // 逆向\n    // (mid + vmin)/2 = (s + t)/2\n    vec2 vmid = source + target - mid;\n    return vmid;\n  }\n  // return mid;\n}\nfloat getSegmentRatio(float index) {\n  // dash: index / (segmentNumber - 1.);\n  // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));\n  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));\n  //  return index / (segmentNumber - 1.);\n}\nvec2 interpolate(vec2 source, vec2 target, float t, float arcThetaOffset) {\n  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation\n  vec2 mid = midPoint(source, target, arcThetaOffset);\n  vec3 x = vec3(source.x, mid.x, target.x);\n  vec3 y = vec3(source.y, mid.y, target.y);\n  return vec2(bezier3(x, t), bezier3(y, t));\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;\n  return offset;\n}\nvec2 getNormal(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n   return dir_screenspace.xy * sign(offset_direction);\n}\n\nvoid main() {\n  //vs中计算渐变色\n  if (u_linearColor == 1.0) {\n    float d_segmentIndex = a_Position.x + 1.0; // 当前顶点在弧线中所处的分段位置\n    v_color = mix(u_sourceColor, u_targetColor, d_segmentIndex / segmentNumber);\n  } else {\n    v_color = a_Color;\n  }\n  v_color.a = v_color.a * opacity;\n\n  vec2 source_world = a_Instance.rg; // 起始点\n  vec2 target_world = a_Instance.ba; // 终点\n\n  float segmentIndex = a_Position.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n\n  // 计算 dashArray 和 distanceRatio 输出到片元\n  float total_Distance = pixelDistance(source_world, target_world) / 2.0 * PI;\n  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;\n  v_distance_ratio = segmentIndex / segmentNumber;\n\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n  float d_distance_ratio;\n\n  if(u_animate.x == Animate) {\n      d_distance_ratio = segmentIndex / segmentNumber;\n      if(u_lineDir != 1.0) {\n        d_distance_ratio = 1.0 - d_distance_ratio;\n      }\n  }\n\n  v_lineData.b = d_distance_ratio;\n\n  vec4 source = project_position(vec4(source_world, 0, 1.), a_Instance64Low.xy);\n  vec4 target = project_position(vec4(target_world, 0, 1.), a_Instance64Low.zw);\n\n  vec2 currPos = interpolate(source.xy, target.xy, segmentRatio, thetaOffset);\n  vec2 nextPos = interpolate(source.xy, target.xy, nextSegmentRatio, thetaOffset);\n\n  vec2 offset = project_pixel(\n    getExtrusionOffset((nextPos.xy - currPos.xy) * indexDir, a_Position.y)\n  );\n\n  float d_segmentIndex = a_Position.x + 1.0; // 当前顶点在弧线中所处的分段位置\n  v_lineData.r = d_segmentIndex;\n\n  if(LineTexture == u_line_texture) { // 开启贴图模式\n    float arcDistrance = length(source - target); // 起始点和终点的距离\n    arcDistrance = project_pixel(arcDistrance);\n\n    v_iconMapUV = a_iconMapUV;\n\n    float pixelLen = project_pixel_texture(u_icon_step); // 贴图沿弧线方向的长度 - 随地图缩放改变\n    float texCount = floor(arcDistrance / pixelLen); // 贴图在弧线上重复的数量\n    v_lineData.g = texCount;\n\n    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // 线横向偏移的距离\n    float linePixelSize = project_pixel(a_Size); // 定点位置偏移\n    v_lineData.a = lineOffsetWidth / linePixelSize; // 线图层贴图部分的 v 坐标值\n  }\n\n  gl_Position = project_common_position_to_clipspace(vec4(currPos.xy + offset, 0, 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n',type:""}}buildModels(){var e=this;return iG(function*(){e.initUniformsBuffer();let{segmentNumber:t=30}=e.layer.getLayerConfig(),{frag:r,vert:n,type:i}=e.getShaders();return[(yield e.layer.buildLayerModel({moduleName:"lineArc2d"+i,vertexShader:n,fragmentShader:r,defines:e.getDefines(),inject:e.getInject(),triangulation:d5,depth:{enable:!1},styleOption:{segmentNumber:t}}))]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:iR.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:1,update:e=>{let{size:t=1}=e;return Array.isArray(t)?[t[0]]:[t]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:iR.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:ic.STATIC_DRAW,data:[],type:ic.FLOAT},size:4,update:(e,t,r)=>[r[3],r[4],r[5],r[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:iR.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:ic.STATIC_DRAW,data:[],type:ic.FLOAT},size:4,update:(e,t,r)=>[tw(r[3]),tw(r[4]),tw(r[5]),tw(r[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:iR.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:2,update:e=>{let t=this.iconService.getIconMap(),{texture:r}=e,{x:n,y:i}=t[r]||{x:0,y:0};return[n,i]}}}),this.styleAttributeService.registerStyleAttribute({name:"thetaOffset",type:iR.Attribute,descriptor:{name:"a_ThetaOffset",shaderLocation:this.attributeLocation.THETA_OFFSET,buffer:{usage:ic.STATIC_DRAW,data:[],type:ic.FLOAT},size:1,update:e=>{let{thetaOffset:t=1}=e;return[t]}}})}}let d8={solid:0,dash:1};class d9 extends dh{constructor(...e){super(...e),ia(this,"texture",void 0),ia(this,"updateTexture",()=>{let{createTexture2D:e}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=e({data:this.iconService.getCanvas(),mag:ic.NEAREST,min:ic.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12,THETA_OFFSET:13})}getCommonUniformsInfo(){let{sourceColor:e,targetColor:t,textureBlend:r="normal",lineType:n="solid",dashArray:i=[10,5],lineTexture:o=!1,iconStep:a=100,segmentNumber:s=30,globalArcHeight:l=10}=this.layer.getLayerConfig(),{animateOption:u}=this.layer.getLayerConfig();2===i.length&&i.push(0,0);let c=0,h=[0,0,0,0],d=[0,0,0,0];if(e&&t&&(h=eC(e),d=eC(t),c=1),this.rendererService.getDirty()){var p;null===(p=this.texture)||void 0===p||p.bind()}let f={u_animate:this.animateOption2Array(u),u_dash_array:i,u_sourceColor:h,u_targetColor:d,u_textSize:[1024,this.iconService.canvasHeight||128],u_globel:"GLOBEL"===this.mapService.version?1:0,u_globel_radius:100,u_global_height:l,segmentNumber:s,u_line_type:d8[n]||0,u_icon_step:a,u_line_texture:o?1:0,u_textureBlend:"normal"===r?0:1,u_time:this.layer.getLayerAnimateTime()||0,u_linearColor:c};return this.getUniformsBufferInfo(f)}initModels(){var e=this;return iG(function*(){return e.initUniformsBuffer(),e.updateTexture(),e.iconService.on("imageUpdate",e.updateTexture),e.buildModels()})()}clearModels(){var e;null===(e=this.texture)||void 0===e||e.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}getShaders(){return{frag:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n#define LineTexture 1.0\n\nuniform sampler2D u_texture;\n\nlayout(std140) uniform commonUniorm {\n  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n  vec4 u_dash_array: [10.0, 5., 0, 0];\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  vec2 u_textSize;\n  float u_globel;\n  float u_globel_radius;\n  float u_global_height: 10;\n  float segmentNumber;\n  float u_line_type: 0.0;\n  float u_icon_step: 100;\n  float u_line_texture: 0.0;\n  float u_textureBlend;\n  float u_time;\n  float u_linearColor: 0.0;\n};\n\nin vec4 v_color;\nin vec4 v_dash_array;\nin float v_segmentIndex;\nin vec2 v_iconMapUV;\nin vec4 v_line_data;\n\nout vec4 outputColor;\n\n#pragma include "picking"\n\nvoid main() {\n  float animateSpeed = 0.0; // 运动速度\n  float d_distance_ratio = v_line_data.g; // 当前点位距离占线总长的比例\n  outputColor = v_color;\n\n  if(u_line_type == LineTypeDash) {\n    float flag = 0.;\n    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);\n    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {\n      flag = 1.;\n    }\n    outputColor.a *=flag;\n  }\n\n  if(u_animate.x == Animate && u_line_texture != LineTexture) {\n      animateSpeed = u_time / u_animate.y;\n      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);\n\n      alpha = (alpha + u_animate.w -1.0) / u_animate.w;\n      // alpha = smoothstep(0., 1., alpha);\n      alpha = clamp(alpha, 0.0, 1.0);\n      outputColor.a *= alpha;\n\n      // u_animate\n      // x enable\n      // y duration\n      // z interval\n      // w trailLength\n  }\n\n  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture\n    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));\n    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);\n    float count = v_line_data.b; // // 贴图在弧线上重复的数量\n\n    float time = 0.0;\n    if(u_animate.x == Animate) {\n      time = u_time / u_animate.y;\n    }\n    float redioCount = arcRadio * count;\n\n    float u = fract(redioCount - time);\n\n    float v = v_line_data.a;  // 线图层贴图部分的 v 坐标值\n    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;\n    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);\n\n    if(u_animate.x == Animate) {\n      float currentPlane = floor(redioCount - time);\n      float textureStep = floor(count * u_animate.z);\n      float a = mod(currentPlane, textureStep);\n      if(a < textureStep - 1.0) {\n        pattern = vec4(0.0);\n      }\n    }\n\n    if(u_textureBlend == 0.0) { // normal\n      pattern.a = 0.0;\n      outputColor = filterColor(outputColor + pattern);\n    } else { // replace\n        pattern.a *= v_color.a;\n        if(outputColor.a <= 0.0) {\n          pattern.a = 0.0;\n          discard;\n        } else {\n          outputColor = filterColor(pattern);\n        }\n    }\n\n  } else {\n    outputColor = filterColor(outputColor);\n  }\n}\n',vert:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n#define LineTexture 1.0\n\nlayout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\nlayout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;\nlayout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;\n\n\nlayout(std140) uniform commonUniorm {\n  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n  vec4 u_dash_array: [10.0, 5., 0, 0];\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  vec2 u_textSize;\n  float u_globel;\n  float u_globel_radius;\n  float u_global_height: 10;\n  float segmentNumber;\n  float u_line_type: 0.0;\n  float u_icon_step: 100;\n  float u_line_texture: 0.0;\n  float u_textureBlend;\n  float u_time;\n  float u_linearColor: 0.0;\n};\nout vec4 v_color;\nout vec4 v_dash_array;\nout float v_segmentIndex;\nout vec2 v_iconMapUV;\nout vec4 v_line_data;\n\n#pragma include "projection"\n#pragma include "project"\n#pragma include "picking"\n\nfloat maps (float value, float start1, float stop1, float start2, float stop2) {\n  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));\n}\n\nfloat getSegmentRatio(float index) {\n  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));\n}\n\nfloat paraboloid(vec2 source, vec2 target, float ratio) {\n  vec2 x = mix(source, target, ratio);\n  vec2 center = mix(source, target, 0.5);\n  float dSourceCenter = distance(source, center);\n  float dXCenter = distance(x, center);\n  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);\n}\n\nvec3 getPos(vec2 source, vec2 target, float segmentRatio) {\n  float vertex_height = paraboloid(source, target, segmentRatio);\n\n  return vec3(\n    mix(source, target, segmentRatio),\n    sqrt(max(0.0, vertex_height))\n  );\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;\n\n  return offset;\n}\nvec2 getNormal(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n  return dir_screenspace.xy * sign(offset_direction);\n}\n\nfloat torad(float deg) {\n  return (deg / 180.0) * acos(-1.0);\n}\n\nvec3 lglt2xyz(vec2 lnglat) {\n  float pi = 3.1415926;\n  // + Math.PI/2 是为了对齐坐标\n  float lng = torad(lnglat.x) + pi / 2.0;\n  float lat = torad(lnglat.y);\n\n  // 手动增加一些偏移，减轻面的冲突\n  float radius = u_globel_radius;\n\n  float z = radius * cos(lat) * cos(lng);\n  float x = radius * cos(lat) * sin(lng);\n  float y = radius * sin(lat);\n  return vec3(x, y, z);\n}\n\nvoid main() {\n  //vs中计算渐变色\n  if(u_linearColor==1.0){\n    float d_segmentIndex = a_Position.x + 1.0; // 当前顶点在弧线中所处的分段位置\n    v_color = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);\n  }\n  else{\n    v_color = a_Color;\n  }\n  v_color.a = v_color.a * opacity;\n  vec2 source = project_position(vec4(a_Instance.rg, 0, 0), a_Instance64Low.xy).xy;\n  vec2 target = project_position(vec4(a_Instance.ba, 0, 0), a_Instance64Low.zw).xy;\n  float segmentIndex = a_Position.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n\n  float d_distance_ratio;\n   if(u_line_type == LineTypeDash) {\n    d_distance_ratio = segmentIndex / segmentNumber;\n    float total_Distance = pixelDistance(source, target) / 2.0 * PI;\n    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);\n  }\n    if(u_animate.x == Animate) {\n      d_distance_ratio = segmentIndex / segmentNumber;\n  }\n  v_line_data.g = d_distance_ratio; // 当前点位距离占线总长的比例\n\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n  vec3 curr = getPos(source, target, segmentRatio);\n  vec3 next = getPos(source, target, nextSegmentRatio);\n  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);\n  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);\n\n\n  v_segmentIndex = a_Position.x;\n  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // 开启贴图模式\n\n    float arcDistrance = length(source - target);\n    float pixelLen =  project_pixel_texture(u_icon_step);\n    v_line_data.b = floor(arcDistrance/pixelLen); // 贴图在弧线上重复的数量\n\n    vec2 projectOffset = project_pixel(offset);\n    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // 线横向偏移的距离\n    float linePixelSize = project_pixel(a_Size);  // 定点位置偏移，按地图等级缩放后的距离\n    v_line_data.a = lineOffsetWidth/linePixelSize;  // 线图层贴图部分的 v 坐标值\n\n    v_iconMapUV = a_iconMapUV;\n  }\n\n\n  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z * thetaOffset, 1.0));\n\n  // 地球模式\n  if(u_globel > 0.0) {\n    vec3 startLngLat = lglt2xyz(a_Instance.rg);\n    vec3 endLngLat = lglt2xyz(a_Instance.ba);\n    float globalRadius = length(startLngLat);\n\n    vec3 lineDir = normalize(endLngLat - startLngLat);\n    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);\n\n    // 线的偏移\n    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;\n    // 计算起始点和终止点的距离\n    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;\n    // 计算飞线各个节点相应的高度\n    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;\n    // 地球点位\n    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;\n\n    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);\n  }\n\n\n  setPickingColor(a_PickingColor);\n}\n',type:""}}buildModels(){var e=this;return iG(function*(){let{segmentNumber:t=30}=e.layer.getLayerConfig(),{frag:r,vert:n,type:i}=e.getShaders();return[(yield e.layer.buildLayerModel({moduleName:"lineArc3d"+i,vertexShader:n,fragmentShader:r,defines:e.getDefines(),inject:e.getInject(),triangulation:d5,styleOption:{segmentNumber:t}}))]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:iR.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:1,update:e=>{let{size:t=1}=e;return Array.isArray(t)?[t[0]]:[t]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:iR.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:ic.STATIC_DRAW,data:[],type:ic.FLOAT},size:4,update:(e,t,r)=>[r[3],r[4],r[5],r[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:iR.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:ic.STATIC_DRAW,data:[],type:ic.FLOAT},size:4,update:(e,t,r)=>[tw(r[3]),tw(r[4]),tw(r[5]),tw(r[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:iR.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:2,update:e=>{let t=this.iconService.getIconMap(),{texture:r}=e,{x:n,y:i}=t[r]||{x:0,y:0};return[n,i]}}}),this.styleAttributeService.registerStyleAttribute({name:"thetaOffset",type:iR.Attribute,descriptor:{name:"a_ThetaOffset",shaderLocation:this.attributeLocation.THETA_OFFSET,buffer:{usage:ic.STATIC_DRAW,data:[],type:ic.FLOAT},size:1,update:e=>{let{thetaOffset:t=1}=e;return[t]}}})}}let pe={circle:2,triangle:2,diamond:4,rect:2,classic:3,halfTriangle:2,none:0};function pt(e,t){let r="object"==typeof e?e.type:e,n="source"===t?1:-1,i="object"==typeof e?e:{};switch(r){case"circle":return function(e,t){let{width:r=2,height:n=2}=t,i=dR(),o=ds().flatten([i]),a=ds()(o.vertices,o.holes,o.dimensions),s=i.map(t=>[t[0]*r*e,t[1]*n]).flat();return{vertices:[...s,...s],dimensions:2,indices:a.map(e=>e+i.length),outLineIndices:a,normals:[...i.map(t=>[t[1]*n,t[0]*r*e,1]).flat(),...Array(3*i.length).fill(0)]}}(n,i);case"triangle":return function(e,t){let{width:r=2,height:n=3}=t;return{vertices:[0,0,1*e*r,1*n,1*e*r,-1*n,0,0,1*e*r,1*n,1*e*r,-1*n],outLineIndices:[0,1,2],indices:[3,4,5],normals:[0,-1.5*e,1,2,1*e,1,-2,1*e,1,0,0,0,0,0,0,0,0,0],dimensions:2}}(n,i);case"diamond":return function(e,t){let{width:r=2,height:n=3}=t;return{vertices:[0,0,1*r*e,.5*n,2*r*e,0,1*r*e,-.5*n,0,0,1*r*e,.5*n,2*r*e,0,1*r*e,-.5*n],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-e,1,1,0,1,0,-e,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}(n,i);case"rect":return function(e,t){let{width:r=2,height:n=2}=t;return{vertices:[0,n/2,e*r*1,n/2,e*r*1,-n/2,0,-n/2,0,n/2,e*r*1,n/2,e*r*1,-n/2,0,-n/2],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-e,1,1,0,1,0,-e,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}(n,i);case"classic":return function(e,t){let{width:r=2,height:n=3}=t;return{vertices:[0,0,2*e*r,1*n,1.5*e*r,0,2*e*r,-1*n,0,0,2*e*r,1*n,1.5*e*r,0,2*e*r,-1*n],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-e,1,1,0,1,0,-e,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}(n,i);case"halfTriangle":return function(e,t){let{width:r=2,height:n=1}=t;return{vertices:[0,.5*e,1*e*r,-(n+.5)*e,1*e*r,(n-.5)*e,0,.5*e,1*e*r,-(n+.5)*e,1*e*r,(n-.5)*e],indices:[3,4,5],outLineIndices:[0,1,2],normals:[1*e,-2*e,1,-2*e,1.5*e,1,1*e,1.5*e,1,0,0,0,0,0,0,0,0,0],dimensions:2}}(n,i);default:return{vertices:[],indices:[],normals:[],dimensions:2,outLineIndices:[],outLineNormals:[]}}}function pr(e,t){return t?function(e,t){let r=e.coordinates.flat(),{target:n="classic",source:i="circle"}=t,o=pn(pt(i,"source"),r,0,0),a=function(e,t=0,r){let n="object"==typeof r.source?r.source.type:r.source,i="object"==typeof r.target?r.target.type:r.target,{width:o=n?pe[n]:0}="object"==typeof r.source?r.source:{},{width:a=i?pe[i]:0}="object"==typeof r.target?r.target:{};return{vertices:[0,.5,1*o,...e,1,.5,-1*a,...e,1,-.5,-1*a,...e,0,-.5,1*o,...e,0,.5,1*o,...e,1,.5,-1*a,...e,1,-.5,-1*a,...e,0,-.5,1*o,...e],outLineIndices:[0,1,2,0,2,3].map(e=>e+t),indices:[4,5,6,4,6,7].map(e=>e+t),normals:[1,-1,1,1,1,1,-1,0,1,-1,0,1,0,0,0,0,0,0,0,0,0,0,0,0],dimensions:2}}(r,o.vertices.length/7,t),s=pn(pt(n,"target"),r,1,o.vertices.length/7+a.vertices.length/7);return{vertices:[...o.vertices,...a.vertices,...s.vertices],indices:[...o.outLineIndices,...a.outLineIndices,...s.outLineIndices,...o.indices,...a.indices,...s.indices],normals:[...o.normals,...a.normals,...s.normals],size:7}}(e,t):function(e){let t=e.coordinates.flat();return{vertices:[1,0,0,...t,1,2,-3,...t,1,1,-3,...t,0,1,0,...t,0,0,0,...t,1,0,0,...t,1,2,-3,...t,1,1,-3,...t,0,1,0,...t,0,0,0,...t],normals:[-1,2,1,2,-1,1,1,-1,1,1,-1,1,-1,-1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],indices:[0,1,2,0,2,3,0,3,4,5,6,7,5,7,8,5,8,9],size:7}}(e)}function pn(e,t,r=1,n=0){let i=[],{vertices:o,indices:a,dimensions:s,outLineIndices:l}=e;for(let e=0;e<o.length;e+=s)i.push(r,o[e+1],o[e],...t);return il(il({},e),{},{vertices:i,indices:a.map(e=>e+n),outLineIndices:l.map(e=>e+n)})}class pi extends dh{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,NORMAL:12})}getCommonUniformsInfo(){let{gapWidth:e=2,strokeWidth:t=1,strokeOpacity:r=1}=this.layer.getLayerConfig();return this.getUniformsBufferInfo({u_gap_width:e,u_stroke_width:t,u_stroke_opacity:r})}initModels(){var e=this;return iG(function*(){return e.initUniformsBuffer(),e.buildModels()})()}buildModels(){var e=this;return iG(function*(){return[(yield e.layer.buildLayerModel({moduleName:"flow_line",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;\nlayout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;\nlayout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;\nlayout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;\n\nlayout(std140) uniform commonUniorm {\n  float u_gap_width: 1.0;\n  float u_stroke_width: 1.0;\n  float u_stroke_opacity: 1.0;\n};\n\n#pragma include "projection"\n#pragma include "project"\n#pragma include "picking"\n\nout vec4 v_color;\n\nvec2 project_pixel_offset(vec2 offsets) {\n  vec2 data = project_pixel(offsets);\n\n  return vec2(data.x, -data.y);\n}\n\nvec2 line_dir(vec2 target, vec2 source) {\n  return normalize(ProjectFlat(target) - ProjectFlat(source));\n}\n\n\nvoid main() {\n  // 透明度计算\n  vec2 source_world = a_Instance.rg; // 起点\n  vec2 target_world = a_Instance.ba; // 终点\n  vec2 flowlineDir = line_dir(target_world, source_world);\n  vec2 perpendicularDir = vec2(-flowlineDir.y, flowlineDir.x);\n\n  vec2 position = mix(source_world, target_world, a_Position.x);\n  vec2 position64Low = mix(a_Instance64Low.rg, a_Instance64Low.ba, a_Position.x);\n\n  float lengthCommon = length(\n    project_position(vec4(target_world, 0, 1)) - project_position(vec4(source_world, 0, 1))\n  );\n  vec2 offsetDistances = a_Size.x * project_pixel_offset(vec2(a_Position.y, a_Position.z)); // Mapbox || 高德\n  vec2 limitedOffsetDistances = clamp(\n    offsetDistances,\n    project_pixel(-lengthCommon * 0.2),\n    project_pixel(lengthCommon * 0.2)\n  );\n\n  float startOffsetCommon = project_pixel(offsets[0]);\n  float endOffsetCommon = project_pixel(offsets[1]);\n  float endpointOffset = mix(\n    clamp(startOffsetCommon, 0.0, lengthCommon * 0.2),\n    -clamp(endOffsetCommon, 0.0, lengthCommon * 0.2),\n    a_Position.x\n  );\n\n  vec2 normalsCommon = u_stroke_width * project_pixel_offset(vec2(a_Normal.x, a_Normal.y));\n\n  float gapCommon = -1. * project_pixel(u_gap_width);\n  vec3 offsetCommon = vec3(\n    flowlineDir * (limitedOffsetDistances[1] + normalsCommon.y + endpointOffset * 1.05) -\n      perpendicularDir * (limitedOffsetDistances[0] + gapCommon + normalsCommon.x),\n    0.0\n  );\n\n  vec4 project_pos = project_position(vec4(position.xy, 0, 1.0), position64Low);\n\n  vec4 fillColor = vec4(a_Color.rgb, a_Color.a * opacity);\n  v_color = mix(fillColor, vec4(u_stroke.xyz, u_stroke.w * fillColor.w * u_stroke_opacity), a_Normal.z);\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy +  offsetCommon.xy, 0., 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'// #extension GL_OES_standard_derivatives : enable\n\nin vec4 v_color;\nout vec4 outputColor;\n\n\n// line texture\n\n#pragma include "picking"\n\nvoid main() {\n  outputColor = v_color;\n  outputColor = filterColor(outputColor);\n}\n',defines:e.getDefines(),inject:e.getInject(),triangulation:pr,styleOption:e.layer.getLayerConfig().symbol,primitive:ic.TRIANGLES,depth:{enable:!1},pick:!1}))]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:iR.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:2,update:e=>{let{size:t=1}=e;return Array.isArray(t)?[t[0],t[1]]:[t,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:iR.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:ic.STATIC_DRAW,data:[],type:ic.FLOAT},size:4,update:(e,t,r)=>[r[3],r[4],r[5],r[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:iR.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:ic.STATIC_DRAW,data:[],type:ic.FLOAT},size:4,update:(e,t,r)=>[tw(r[3]),tw(r[4]),tw(r[5]),tw(r[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:iR.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:ic.STATIC_DRAW,data:[],type:ic.FLOAT},size:3,update:(e,t,r,n,i)=>i}})}}let po={solid:0,dash:1};class pa extends dh{constructor(...e){super(...e),ia(this,"texture",void 0),ia(this,"updateTexture",()=>{let{createTexture2D:e}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=e({data:this.iconService.getCanvas(),mag:ic.NEAREST,min:ic.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12})}getCommonUniformsInfo(){let{sourceColor:e,targetColor:t,textureBlend:r="normal",lineType:n="solid",dashArray:i=[10,5],lineTexture:o=!1,iconStep:a=100,segmentNumber:s=30}=this.layer.getLayerConfig(),{animateOption:l}=this.layer.getLayerConfig();if(2===i.length&&i.push(0,0),this.rendererService.getDirty()){var u;null===(u=this.texture)||void 0===u||u.bind()}let c=0,h=[0,0,0,0],d=[0,0,0,0];e&&t&&(h=eC(e),d=eC(t),c=1);let p=this.layer.getLayerAnimateTime();isNaN(p)&&(p=0);let f={u_animate:this.animateOption2Array(l),u_dash_array:i,u_sourceColor:h,u_targetColor:d,u_textSize:[1024,this.iconService.canvasHeight||128],segmentNumber:s,u_line_type:po[n]||0,u_icon_step:a,u_line_texture:o?1:0,u_textureBlend:"normal"===r?0:1,u_time:p,u_linearColor:c};return this.getUniformsBufferInfo(f)}initModels(){var e=this;return iG(function*(){return e.initUniformsBuffer(),e.updateTexture(),e.iconService.on("imageUpdate",e.updateTexture),e.buildModels()})()}clearModels(){var e;null===(e=this.texture)||void 0===e||e.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var e=this;return iG(function*(){let{segmentNumber:t=30}=e.layer.getLayerConfig();return[(yield e.layer.buildLayerModel({moduleName:"lineGreatCircle",vertexShader:'#define LineTypeSolid (0.0)\n#define LineTypeDash (1.0)\n#define Animate (0.0)\n#define LineTexture (1.0)\n\nlayout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\nlayout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;\nlayout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;\n\nlayout(std140) uniform commonUniorm {\n  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n  vec4 u_dash_array: [10.0, 5., 0, 0];\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  vec2 u_textSize;\n  float segmentNumber;\n  float u_line_type: 0.0;\n  float u_icon_step: 100;\n  float u_line_texture: 0.0;\n  float u_textureBlend;\n  float u_time;\n  float u_linearColor: 0;\n};\n\nout vec4 v_dash_array;\nout vec4 v_color;\nout vec2 v_iconMapUV;\nout vec4 v_line_data;\nout float v_distance_ratio;\n\n#pragma include "projection"\n#pragma include "project"\n#pragma include "picking"\n\nfloat maps(float value, float start1, float stop1, float start2, float stop2) {\n  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));\n}\n\nfloat getSegmentRatio(float index) {\n  return index / (segmentNumber - 1.0);\n}\n\nfloat paraboloid(vec2 source, vec2 target, float ratio) {\n  vec2 x = mix(source, target, ratio);\n  vec2 center = mix(source, target, 0.5);\n  float dSourceCenter = distance(source, center);\n  float dXCenter = distance(x, center);\n  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);\n}\n\nvec3 getPos(vec2 source, vec2 target, float segmentRatio) {\n  float vertex_height = paraboloid(source, target, segmentRatio);\n\n  return vec3(mix(source, target, segmentRatio), sqrt(max(0.0, vertex_height)));\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;\n  return offset;\n}\nvec2 getNormal(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n  return dir_screenspace.xy * sign(offset_direction);\n}\nfloat getAngularDist(vec2 source, vec2 target) {\n  vec2 delta = source - target;\n  vec2 sin_half_delta = sin(delta / 2.0);\n  float a =\n    sin_half_delta.y * sin_half_delta.y +\n    cos(source.y) * cos(target.y) * sin_half_delta.x * sin_half_delta.x;\n  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));\n}\n\nvec2 midPoint(vec2 source, vec2 target) {\n  vec2 center = target - source;\n  float r = length(center);\n  float theta = atan(center.y, center.x);\n  float thetaOffset = 0.314;\n  float r2 = r / 2.0 / cos(thetaOffset);\n  float theta2 = theta + thetaOffset;\n  vec2 mid = vec2(r2 * cos(theta2) + source.x, r2 * sin(theta2) + source.y);\n  return mid;\n}\nfloat bezier3(vec3 arr, float t) {\n  float ut = 1.0 - t;\n  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;\n}\n\nvec2 interpolate(vec2 source, vec2 target, float angularDist, float t) {\n  if (abs(angularDist - PI) < 0.001) {\n    return (1.0 - t) * source + t * target;\n  }\n  float a = sin((1.0 - t) * angularDist) / sin(angularDist);\n  float b = sin(t * angularDist) / sin(angularDist);\n  vec2 sin_source = sin(source);\n  vec2 cos_source = cos(source);\n  vec2 sin_target = sin(target);\n  vec2 cos_target = cos(target);\n  float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;\n  float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;\n  float z = a * sin_source.y + b * sin_target.y;\n  return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));\n\n}\n\nvoid main() {\n  v_color = a_Color;\n  v_color.a = v_color.a * opacity;\n  vec2 source = radians(a_Instance.rg);\n  vec2 target = radians(a_Instance.ba);\n  float angularDist = getAngularDist(source, target);\n  float segmentIndex = a_Position.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n\n  if (u_line_type == LineTypeDash) {\n    v_distance_ratio = segmentIndex / segmentNumber;\n    float total_Distance = pixelDistance(source, target) / 2.0 * PI;\n    total_Distance = total_Distance * 16.0; // total_Distance*16.0 调整默认的效果\n    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;\n  }\n\n  if (u_animate.x == Animate) {\n    v_distance_ratio = segmentIndex / segmentNumber;\n  }\n\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n  v_distance_ratio = segmentIndex / segmentNumber;\n\n  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0), a_Instance64Low.xy);\n  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0), a_Instance64Low.zw);\n\n  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);\n  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));\n  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));\n  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));\n\n  v_line_data.g = a_Position.x; // 该顶点在弧线上的分段排序\n  if (LineTexture == u_line_texture) {\n    float d_arcDistrance = length(source - target);\n    d_arcDistrance = project_pixel(d_arcDistrance);\n\n    float d_pixelLen = project_pixel(u_icon_step) / 8.0;\n    v_line_data.b = floor(d_arcDistrance / d_pixelLen); // 贴图在弧线上重复的数量\n\n    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // 线横向偏移的距离\n    float linePixelSize = project_pixel(a_Size); // 定点位置偏移，按地图等级缩放后的距离\n    v_line_data.a = lineOffsetWidth / linePixelSize; // 线图层贴图部分的 v 坐标值\n\n    v_iconMapUV = a_iconMapUV;\n  }\n\n  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));\n  setPickingColor(a_PickingColor);\n}\n\n',fragmentShader:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n#define LineTexture 1.0\n\nuniform sampler2D u_texture;\nlayout(std140) uniform commonUniorm {\n  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n  vec4 u_dash_array: [10.0, 5., 0, 0];\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  vec2 u_textSize;\n  float segmentNumber;\n  float u_line_type: 0.0;\n  float u_icon_step: 100;\n  float u_line_texture: 0.0;\n  float u_textureBlend;\n  float u_time;\n  float u_linearColor: 0;\n};\n\nin vec4 v_dash_array;\nin vec4 v_color;\nin vec2 v_iconMapUV;\nin vec4 v_line_data;\nin float v_distance_ratio;\n\nout vec4 outputColor;\n#pragma include "picking"\n#pragma include "project"\n#pragma include "projection"\n\nvoid main() {\n\n  float animateSpeed = 0.0;\n  float d_segmentIndex = v_line_data.g;\n\n  // 设置弧线的底色\n  if(u_linearColor == 1.0) { // 使用渐变颜色\n    outputColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);\n    outputColor.a *= v_color.a;\n  } else { // 使用 color 方法传入的颜色\n    outputColor = v_color;\n  }\n\n  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));\n  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));\n  if(u_line_type == LineTypeDash) {\n    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);\n    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {\n      // 实线部分\n    } else {\n      // 虚线部分\n      discard;\n    };\n  }\n\n  // 设置弧线的动画模式\n  if(u_animate.x == Animate) {\n      animateSpeed = u_time / u_animate.y;\n      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);\n      alpha = (alpha + u_animate.w -1.0) / u_animate.w;\n      alpha = smoothstep(0., 1., alpha);\n      outputColor.a *= alpha;\n  }\n\n  // 设置弧线的贴图\n  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) {\n    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / (segmentNumber - 1.0)));\n    // float arcRadio = d_segmentIndex / (segmentNumber - 1.0);\n    float count = v_line_data.b; // 贴图在弧线上重复的数量\n    float u = fract(arcRadio * count - animateSpeed * count);\n    // float u = fract(arcRadio * count - animateSpeed);\n    if(u_animate.x == Animate) {\n      u = outputColor.a/v_color.a;\n    }\n\n    float v = v_line_data.a; // 线图层贴图部分的 v 坐标值\n\n    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;\n    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);\n\n    // 设置贴图和底色的叠加模式\n    if(u_textureBlend == 0.0) { // normal\n      pattern.a = 0.0;\n      outputColor = filterColor(outputColor + pattern);\n    } else { // replace\n        pattern.a *= v_color.a;\n        if(outputColor.a <= 0.0) {\n          pattern.a = 0.0;\n        }\n        outputColor = filterColor(pattern);\n    }\n  } else {\n    outputColor = filterColor(outputColor);\n  }\n\n  // gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:d5,styleOption:{segmentNumber:t},defines:e.getDefines(),inject:e.getInject(),depth:{enable:!1}}))]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:iR.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:1,update:e=>{let{size:t=1}=e;return Array.isArray(t)?[t[0]]:[t]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:iR.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:ic.STATIC_DRAW,data:[],type:ic.FLOAT},size:4,update:(e,t,r)=>[r[3],r[4],r[5],r[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:iR.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:ic.STATIC_DRAW,data:[],type:ic.FLOAT},size:4,update:(e,t,r)=>[tw(r[3]),tw(r[4]),tw(r[5]),tw(r[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:iR.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:2,update:e=>{let t=this.iconService.getIconMap(),{texture:r}=e,{x:n,y:i}=t[r]||{x:0,y:0};return[n,i]}}})}}let ps=function(e){return e.VERTICAL="vertical",e.HORIZONTAL="horizontal",e}({}),pl=function(e){return e.NORMAL="normal",e.REPLACE="replace",e}({}),pu=function(e){return e[e.pixel=0]="pixel",e[e.meter=1]="meter",e}({});class pc extends dh{constructor(...e){super(...e),ia(this,"textureEventFlag",!1),ia(this,"texture",this.createTexture2D({data:new Uint8Array([0,0,0,0]),width:1,height:1})),ia(this,"updateTexture",()=>{let{createTexture2D:e}=this.rendererService;if(0===this.textures.length&&(this.textures=[this.texture]),this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=e({data:this.iconService.getCanvas(),mag:ic.NEAREST,min:ic.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128})})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,DISTANCE_INDEX:10,NORMAL:11,UV:12})}getCommonUniformsInfo(){let{sourceColor:e,targetColor:t,textureBlend:r="normal",lineType:n="solid",dashArray:i=[10,5,0,0],lineTexture:o=!1,iconStep:a=100,vertexHeightScale:s=20,strokeWidth:l=0,raisingHeight:u=0,heightfixed:c=!1,linearDir:h=ps.VERTICAL,blur:d=[1,1,1,0]}=this.layer.getLayerConfig(),p=i;if("dash"!==n&&(p=[0,0,0,0]),2===p.length&&p.push(0,0),this.rendererService.getDirty()&&this.texture){var f;null===(f=this.texture)||void 0===f||f.bind()}let{animateOption:g}=this.layer.getLayerConfig(),m=0,v=[0,0,0,0],y=[0,0,0,0];e&&t&&(v=eC(e),y=eC(t),m=1);let _={u_animate:this.animateOption2Array(g),u_dash_array:p,u_blur:d,u_sourceColor:v,u_targetColor:y,u_textSize:[1024,this.iconService.canvasHeight||128],u_icon_step:a,u_heightfixed:Number(c),u_vertexScale:s,u_raisingHeight:Number(u),u_strokeWidth:l,u_textureBlend:r===pl.NORMAL?0:1,u_line_texture:o?1:0,u_linearDir:h===ps.VERTICAL?1:0,u_linearColor:m,u_time:this.layer.getLayerAnimateTime()||0};return this.getUniformsBufferInfo(_)}initModels(){var e=this;return iG(function*(){return e.initUniformsBuffer(),e.textureEventFlag||(e.textureEventFlag=!0,e.updateTexture(),e.iconService.on("imageUpdate",e.updateTexture)),e.buildModels()})()}clearModels(){var e;null===(e=this.texture)||void 0===e||e.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var e=this;return iG(function*(){let{depth:t=!1}=e.layer.getLayerConfig(),{frag:r,vert:n,type:i}=e.getShaders();return e.layer.triangulation=dK,[(yield e.layer.buildLayerModel({moduleName:"line"+i,vertexShader:n,fragmentShader:r,triangulation:dK,defines:e.getDefines(),inject:e.getInject(),depth:{enable:t}}))]})()}getShaders(){return{frag:'// #extension GL_OES_standard_derivatives : enable\n#define Animate 0.0\n#define LineTexture 1.0\n\nuniform sampler2D u_texture;\nlayout(std140) uniform commonUniorm {\n  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n  vec4 u_dash_array;\n  vec4 u_blur;\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  vec2 u_textSize;\n  float u_icon_step: 100;\n  float u_heightfixed: 0.0;\n  float u_vertexScale: 1.0;\n  float u_raisingHeight: 0.0;\n  float u_strokeWidth: 0.0;\n  float u_textureBlend;\n  float u_line_texture;\n  float u_linearDir: 1.0;\n  float u_linearColor: 0;\n  float u_time;\n};\n\nin vec4 v_color;\nin vec4 v_stroke;\n// dash\nin vec4 v_dash_array;\nin float v_d_distance_ratio;\nin vec2 v_iconMapUV;\nin vec4 v_texture_data;\n\nout vec4 outputColor;\n#pragma include "picking"\n\n// [animate, duration, interval, trailLength],\nvoid main() {\n  if(u_dash_array!=vec4(0.0)){\n    float dashLength = mod(v_d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);\n    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {\n      // 虚线部分\n      discard;\n    };\n  }\n  float animateSpeed = 0.0; // 运动速度\n  float d_distance_ratio = v_texture_data.r; // 当前点位距离占线总长的比例\n  if(u_linearDir < 1.0) {\n    d_distance_ratio = v_texture_data.a;\n  }\n  if(u_linearColor == 1.0) { // 使用渐变颜色\n    outputColor = mix(u_sourceColor, u_targetColor, d_distance_ratio);\n    outputColor.a *= v_color.a;\n  } else { // 使用 color 方法传入的颜色\n     outputColor = v_color;\n  }\n  // anti-alias\n  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));\n  if(u_animate.x == Animate) {\n      animateSpeed = u_time / u_animate.y;\n       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);\n      alpha = (alpha + u_animate.w -1.0) / u_animate.w;\n      alpha = smoothstep(0., 1., alpha);\n      outputColor.a *= alpha;\n  }\n\n  if(u_line_texture == LineTexture) { // while load texture\n    float aDistance = v_texture_data.g;      // 当前顶点的距离\n    float d_texPixelLen = v_texture_data.b;  // 贴图的像素长度，根据地图层级缩放\n    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);\n    float v = v_texture_data.a;  // 线图层贴图部分的 v 坐标值\n\n    // v = max(smoothstep(0.95, 1.0, v), v);\n    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;\n     vec4 pattern = texture(SAMPLER_2D(u_texture), uv);\n\n    if(u_textureBlend == 0.0) { // normal\n      pattern.a = 0.0;\n      outputColor += pattern;\n    } else { // replace\n        pattern.a *= v_color.a;\n        if(outputColor.a <= 0.0) {\n          pattern.a = 0.0;\n        }\n        outputColor = pattern;\n    }\n  } \n\n  float v = v_texture_data.a;\n  float strokeWidth = min(0.5, u_strokeWidth);\n  // 绘制 border\n  if(strokeWidth > 0.01) {\n    float borderOuterWidth = strokeWidth / 2.0;\n\n\n    if(v >= 1.0 - strokeWidth || v <= strokeWidth) {\n      if(v > strokeWidth) { // 外侧\n        float linear = smoothstep(0.0, 1.0, (v - (1.0 - strokeWidth))/strokeWidth);\n        //  float linear = step(0.0, (v - (1.0 - borderWidth))/borderWidth);\n        outputColor.rgb = mix(outputColor.rgb, v_stroke.rgb, linear);\n      } else if(v <= strokeWidth) {\n        float linear = smoothstep(0.0, 1.0, v/strokeWidth);\n        outputColor.rgb = mix(v_stroke.rgb, outputColor.rgb, linear);\n      }\n    }\n\n    if(v < borderOuterWidth) {\n      outputColor.a = mix(0.0, outputColor.a, v/borderOuterWidth);\n    } else if(v > 1.0 - borderOuterWidth) {\n      outputColor.a = mix(outputColor.a, 0.0, (v - (1.0 - borderOuterWidth))/borderOuterWidth);\n    }\n  }\n\n  // blur\n  float blurV = v_texture_data.a;\n  if(blurV < 0.5) {\n    outputColor.a *= mix(u_blur.r, u_blur.g, blurV/0.5);\n  } else {\n    outputColor.a *= mix(u_blur.g, u_blur.b, (blurV - 0.5)/0.5);\n  }\n  \n  outputColor = filterColor(outputColor);\n}\n',vert:'#define Animate (0.0)\n\nlayout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;\nlayout(location = ATTRIBUTE_LOCATION_DISTANCE_INDEX) in vec3 a_DistanceAndIndexAndMiter;\nlayout(location = ATTRIBUTE_LOCATION_NORMAL) in vec4 a_Normal_Total_Distance;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;\n\nlayout(std140) uniform commonUniorm {\n  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n  vec4 u_dash_array;\n  vec4 u_blur;\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  vec2 u_textSize;\n  float u_icon_step: 100;\n  float u_heightfixed: 0.0;\n  float u_vertexScale: 1.0;\n  float u_raisingHeight: 0.0;\n  float u_strokeWidth: 0.0;\n  float u_textureBlend;\n  float u_line_texture;\n  float u_linearDir: 1.0;\n  float u_linearColor: 0;\n  float u_time;\n};\n\nout vec4 v_color;\nout vec4 v_stroke;\n//dash\nout vec4 v_dash_array;\nout float v_d_distance_ratio;\n// texV 线图层 - 贴图部分的 v 坐标（线的宽度方向）\nout vec2 v_iconMapUV;\nout vec4 v_texture_data;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  vec2 a_DistanceAndIndex = a_DistanceAndIndexAndMiter.xy;\n  float a_Miter = a_DistanceAndIndexAndMiter.z;\n  vec3 a_Normal = a_Normal_Total_Distance.xyz;\n  float a_Total_Distance = a_Normal_Total_Distance.w;\n  //dash输出\n  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;\n  v_d_distance_ratio = a_DistanceAndIndex.x / a_Total_Distance;\n\n  // cal style mapping - 数据纹理映射部分的计算\n  float d_texPixelLen; // 贴图的像素长度，根据地图层级缩放\n  v_iconMapUV = a_iconMapUV;\n  d_texPixelLen = project_float_pixel(u_icon_step);\n\n  v_color = a_Color;\n  v_color.a *= opacity;\n  v_stroke = stroke;\n\n  vec3 size = a_Miter * setPickingSize(a_Size.x) * a_Normal;\n\n  vec2 offset = project_pixel(size.xy);\n\n  float lineDistance = a_DistanceAndIndex.x;\n  float currentLinePointRatio = lineDistance / a_Total_Distance;\n\n  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // 线横向偏移的距离（向两侧偏移的和）\n  float linePixelSize = project_pixel(a_Size.x) * 2.0; // 定点位置偏移，按地图等级缩放后的距离 单侧 * 2\n  float texV = lineOffsetWidth / linePixelSize; // 线图层贴图部分的 v 坐标值\n\n  v_texture_data = vec4(currentLinePointRatio, lineDistance, d_texPixelLen, texV);\n  // 设置数据集的参数\n\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);\n\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));\n\n  float h = float(a_Position.z) * u_vertexScale; // 线顶点的高度 - 兼容不存在第三个数值的情况 vertex height\n  float lineHeight = a_Size.y; // size 第二个参数代表的高度 [linewidth, lineheight]\n\n  // 兼容 mapbox 在线高度上的效果表现基本一致\n  if (\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n  ) {\n    // mapbox\n    // 保持高度相对不变\n    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);\n    h *= mapboxZoomScale;\n    h += u_raisingHeight * mapboxZoomScale;\n    if (u_heightfixed > 0.0) {\n      lineHeight *= mapboxZoomScale;\n    }\n  }\n\n  gl_Position = project_common_position_to_clipspace(\n    vec4(project_pos.xy + offset, lineHeight + h, 1.0)\n  );\n\n  setPickingColor(a_PickingColor);\n}\n',type:""}}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:iR.Attribute,descriptor:{name:"a_DistanceAndIndexAndMiter",shaderLocation:this.attributeLocation.DISTANCE_INDEX,buffer:{usage:ic.STATIC_DRAW,data:[],type:ic.FLOAT},size:3,update:(e,t,r,n,i,o)=>void 0===o?[r[3],10,r[4]]:[r[3],o,r[4]]}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:iR.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:2,update:e=>{let{size:t=1}=e;return Array.isArray(t)?[t[0],t[1]]:[t,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal_total_distance",type:iR.Attribute,descriptor:{name:"a_Normal_Total_Distance",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:ic.STATIC_DRAW,data:[],type:ic.FLOAT},size:4,update:(e,t,r,n,i)=>[...i,r[5]]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:iR.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:2,update:e=>{let t=this.iconService.getIconMap(),{texture:r}=e,{x:n,y:i}=t[r]||{x:0,y:0};return[n,i]}}})}}class ph extends dh{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9})}getCommonUniformsInfo(){let{sourceColor:e,targetColor:t,lineType:r="solid",dashArray:n=[10,5,0,0],vertexHeightScale:i=20}=this.layer.getLayerConfig(),o=n;"dash"!==r&&(o=[0,0,0,0]),2===o.length&&o.push(0,0);let a=0,s=[0,0,0,0],l=[0,0,0,0];e&&t&&(s=eC(e),l=eC(t),a=1);let u={u_sourceColor:s,u_targetColor:l,u_dash_array:o,u_vertexScale:i,u_linearColor:a};return this.getUniformsBufferInfo(u)}initModels(){var e=this;return iG(function*(){return e.buildModels()})()}getShaders(){return{frag:"\nlayout(std140) uniform commonUniorm {\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  vec4 u_dash_array;\n  float u_vertexScale: 1.0;\n  float u_linearColor: 0;\n};\nin float v_distanceScale;\nin vec4 v_color;\n//dash\nin vec4 v_dash_array;\n\nout vec4 outputColor;\nvoid main() {\n  if(u_dash_array!=vec4(0.0)){\n    float dashLength = mod(v_distanceScale, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);\n    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {\n      // 虚线部分\n      discard;\n    };\n  }\n  if(u_linearColor==1.0){\n    outputColor = mix(u_sourceColor, u_targetColor, v_distanceScale);\n    outputColor.a *= v_color.a; // 全局透明度\n  }\n  else{\n    outputColor = v_color;\n  }\n}\n",vert:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in vec4 a_SizeDistanceAndTotalDistance;\n\nlayout(std140) uniform commonUniorm {\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  vec4 u_dash_array;\n  float u_vertexScale: 1.0;\n  float u_linearColor: 0;\n};\n\n#pragma include "projection"\n#pragma include "picking"\n\nout vec4 v_color;\nout float v_distanceScale;\nout vec4 v_dash_array;\n\nvoid main() {\n  //dash输出\n  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_SizeDistanceAndTotalDistance.a;\n\n  v_color = a_Color;\n  v_distanceScale = a_SizeDistanceAndTotalDistance.b / a_SizeDistanceAndTotalDistance.a;\n  v_color.a = v_color.a * opacity;\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);\n\n  float h = float(a_Position.z) * u_vertexScale; // 线顶点的高度 - 兼容不存在第三个数值的情况\n\n  float lineHeight = a_SizeDistanceAndTotalDistance.y;\n  // 兼容 mapbox 在线高度上的效果表现基本一致\n  if (\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n  ) {\n    // 保持高度相对不变\n    h *= 2.0 / pow(2.0, 20.0 - u_Zoom);\n  }\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, lineHeight + h, 1.0));\n  gl_PointSize = 10.0;\n\n}\n',type:"lineSimpleNormal"}}buildModels(){var e=this;return iG(function*(){e.initUniformsBuffer();let{frag:t,vert:r,type:n}=e.getShaders();return[(yield e.layer.buildLayerModel({moduleName:n,vertexShader:r,fragmentShader:t,triangulation:dQ,defines:e.getDefines(),inject:e.getInject(),primitive:ic.LINES,depth:{enable:!1},pick:!1}))]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"sizeDistanceAndTotalDistance",type:iR.Attribute,descriptor:{name:"a_SizeDistanceAndTotalDistance",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:ic.STATIC_DRAW,data:[],type:ic.FLOAT},size:4,update:(e,t,r)=>{let{size:n=1}=e,i=Array.isArray(n)?[n[0],n[1]]:[n,0];return[i[0],i[1],r[3],r[5]]}}})}}class pd extends dh{constructor(...e){super(...e),ia(this,"texture",void 0),ia(this,"updateTexture",()=>{let{createTexture2D:e}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=e({data:this.iconService.getCanvas(),mag:ic.NEAREST,min:ic.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:12,UV:13,DISTANCE_MITER_TOTAL:15})}getCommonUniformsInfo(){let{sourceColor:e,targetColor:t,textureBlend:r="normal",heightfixed:n=!1,lineTexture:i=!1,iconStep:o=100,iconStepCount:a=1}=this.layer.getLayerConfig(),{animateOption:s}=this.layer.getLayerConfig();if(this.rendererService.getDirty()){var l;null===(l=this.texture)||void 0===l||l.bind()}let u=0,c=[0,0,0,0],h=[0,0,0,0];e&&t&&(c=eC(e),h=eC(t),u=1);let d={u_animate:this.animateOption2Array(s),u_sourceColor:c,u_targetColor:h,u_textSize:[1024,this.iconService.canvasHeight||128],u_icon_step:o,u_heightfixed:Number(n),u_linearColor:u,u_line_texture:i?1:0,u_textureBlend:"normal"===r?0:1,u_iconStepCount:a,u_time:this.layer.getLayerAnimateTime()||0};return this.getUniformsBufferInfo(d)}initModels(){var e=this;return iG(function*(){return e.initUniformsBuffer(),e.updateTexture(),e.iconService.on("imageUpdate",e.updateTexture),e.buildModels()})()}clearModels(){var e;null===(e=this.texture)||void 0===e||e.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var e=this;return iG(function*(){return[(yield e.layer.buildLayerModel({moduleName:"lineWall",vertexShader:'#define Animate 0.0\nlayout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;\nlayout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;\nlayout(location = ATTRIBUTE_LOCATION_DISTANCE_MITER_TOTAL) in vec3 a_Distance_Total_Miter;\n\nlayout(std140) uniform commonUniorm {\n  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  vec2 u_textSize;\n  float u_icon_step: 100;\n  float u_heightfixed;\n  float u_linearColor: 0;\n  float u_line_texture;\n  float u_textureBlend;\n  float u_iconStepCount;\n  float u_time;\n};\n\n// texV 线图层 - 贴图部分的 v 坐标（线的宽度方向）\nout vec2 v_iconMapUV;\nout vec4 v_color;\nout float v_blur;\nout vec4 v_dataset;\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nvoid main() {\n  float a_Distance = a_Distance_Total_Miter.x;\n  float a_Miter = a_Distance_Total_Miter.y;\n  float a_Total_Distance = a_Distance_Total_Miter.z;\n\n  float d_distance_ratio; // 当前点位距离占线总长的比例\n  float d_texPixelLen; // 贴图的像素长度，根据地图层级缩放\n\n  v_iconMapUV = a_iconMapUV;\n  if (u_heightfixed < 1.0) {\n    // 高度随 zoom 调整\n    d_texPixelLen = project_pixel(u_icon_step);\n  } else {\n    d_texPixelLen = u_icon_step;\n  }\n\n  if (u_animate.x == Animate || u_linearColor == 1.0) {\n    d_distance_ratio = a_Distance / a_Total_Distance;\n  }\n\n  float miter = (a_Miter + 1.0) / 2.0;\n  // 设置数据集的参数\n  v_dataset[0] = d_distance_ratio; // 当前点位距离占线总长的比例\n  v_dataset[1] = a_Distance; // 当前顶点的距离\n  v_dataset[2] = d_texPixelLen; // 贴图的像素长度，根据地图层级缩放\n  v_dataset[3] = miter; // 线图层贴图部分的 v 坐标值 0 - 1\n\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);\n\n  float originSize = a_Size.x; // 固定高度\n  if (u_heightfixed < 1.0) {\n    originSize = project_float_meter(a_Size.x); // 高度随 zoom 调整\n  }\n\n  float wallHeight = originSize * miter;\n  float lightWeight = calc_lighting(vec4(project_pos.xy, wallHeight, 1.0));\n\n  v_blur = min(project_float_pixel(2.0) / originSize, 0.05);\n  v_color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);\n\n  // 兼容 mapbox 在线高度上的效果表现基本一致\n  if (\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n  ) {\n    // mapbox\n    // 保持高度相对不变\n    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);\n    if (u_heightfixed > 0.0) {\n      wallHeight *= mapboxZoomScale;\n    }\n  }\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, wallHeight, 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'#define Animate 0.0\n#define LineTexture 1.0\n\n// line texture\n\nuniform sampler2D u_texture;\nlayout(std140) uniform commonUniorm {\n  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  vec2 u_textSize;\n  float u_icon_step: 100;\n  float u_heightfixed;\n  float u_linearColor: 0;\n  float u_line_texture;\n  float u_textureBlend;\n  float u_iconStepCount;\n  float u_time;\n};\n\n\nin vec2 v_iconMapUV;\nin vec4 v_color;\nin float v_blur;\nin vec4 v_dataset;\n\nout vec4 outputColor;\n\n#pragma include "picking"\n\nvoid main() {\n  float animateSpeed = 0.0; // 运动速度\n  float d_distance_ratio = v_dataset.r; // 当前点位距离占线总长的比例\n  float v = v_dataset.a;\n\n  if(u_linearColor == 1.0) { // 使用渐变颜色\n    outputColor = mix(u_sourceColor, u_targetColor, v);\n  } else { // 使用 color 方法传入的颜色\n     outputColor = v_color;\n  }\n\n  outputColor.a *= v_color.a; // 全局透明度\n  if(u_animate.x == Animate) {\n      animateSpeed = u_time / u_animate.y;\n       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);\n      alpha = (alpha + u_animate.w -1.0) / u_animate.w;\n      alpha = smoothstep(0., 1., alpha);\n      outputColor.a *= alpha;\n  }\n\n  if(u_line_texture == LineTexture) { // while load texture\n    float aDistance = v_dataset.g;      // 当前顶点的距离\n    float d_texPixelLen = v_dataset.b;  // 贴图的像素长度，根据地图层级缩放\n    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);\n    float v = v_dataset.a;  // 线图层贴图部分的 v 坐标值\n\n    // 计算纹理间隔 start\n    float flag = 0.0;\n    if(u > 1.0/u_iconStepCount) {\n      flag = 1.0;\n    }\n    u = fract(u*u_iconStepCount);\n    // 计算纹理间隔 end\n\n    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;\n    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);\n\n    // Tip: 判断纹理间隔\n    if(flag > 0.0) {\n      pattern = vec4(0.0);\n    }\n\n    if(u_textureBlend == 0.0) { // normal\n      pattern.a = 0.0;\n      outputColor = filterColor(outputColor + pattern);\n    } else { // replace\n        pattern.a *= v_color.a;\n        if(outputColor.a <= 0.0) {\n          pattern.a = 0.0;\n        }\n        outputColor = filterColor(pattern);\n    }\n  }\n\n\n  // blur - AA\n  if(v < v_blur) {\n    outputColor.a = mix(0.0, outputColor.a, v/v_blur);\n  } else if(v > 1.0 - v_blur) {\n    outputColor.a = mix(outputColor.a, 0.0, (v - (1.0 - v_blur))/v_blur);\n  }\n\n  outputColor = filterColor(outputColor);\n}\n',triangulation:dK,defines:e.getDefines(),inject:e.getInject(),depth:{enable:!1},blend:e.getBlend()}))]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:iR.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:2,update:e=>{let{size:t=1}=e;return Array.isArray(t)?[t[0],t[1]]:[t,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:iR.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:ic.STATIC_DRAW,data:[],type:ic.FLOAT},size:3,update:(e,t,r,n,i)=>i}}),this.styleAttributeService.registerStyleAttribute({name:"distanceAndTotalAndMiter",type:iR.Attribute,descriptor:{name:"a_Distance_Total_Miter",shaderLocation:this.attributeLocation.DISTANCE_MITER_TOTAL,buffer:{usage:ic.STATIC_DRAW,data:[],type:ic.FLOAT},size:3,update:(e,t,r)=>[r[3],r[4],r[5]]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:iR.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:2,update:e=>{let t=this.iconService.getIconMap(),{texture:r}=e,{x:n,y:i}=t[r]||{x:0,y:0};return[n,i]}}})}}let pp={arc:d7,arc3d:d9,greatcircle:pa,wall:pd,line:pc,simple:ph,flowline:pi,earthArc3d:d9};class pf extends dt{constructor(...e){super(...e),ia(this,"type","LineLayer"),ia(this,"enableShaderEncodeStyles",["stroke","offsets","opacity","thetaOffset"]),ia(this,"arrowInsertCount",0),ia(this,"defaultSourceConfig",{data:[{lng1:100,lat1:30,lng2:130,lat2:30}],options:{parser:{type:"json",x:"lng1",y:"lat1",x1:"lng2",y1:"lat2"}}})}buildModels(){var e=this;return iG(function*(){let t=e.getModelType();e.layerModel=new pp[t](e),yield e.initLayerModels()})()}getDefaultConfig(){return({line:{},linearline:{},simple:{},wall:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"},tileLine:{},earthArc3d:{},flowline:{},arrow:{}})[this.getModelType()]}getModelType(){var e;if(this.layerType)return this.layerType;let t=this.styleAttributeService.getLayerStyleAttribute("shape");return(null==t||null===(e=t.scale)||void 0===e?void 0:e.field)||"line"}processData(e){if("simple"!==this.getModelType())return e;let t=[];return e.map(e=>{if(Array.isArray(e.coordinates)&&Array.isArray(e.coordinates[0])&&Array.isArray(e.coordinates[0][0])){let r=il({},e);e.coordinates.map(e=>{t.push(il(il({},r),{},{coordinates:e}))})}else t.push(e)}),t}}class pg extends dh{constructor(...e){super(...e),ia(this,"raiseCount",0),ia(this,"raiseRepeat",0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10,NORMAL:11})}getCommonUniformsInfo(){let{animateOption:e={enable:!1,speed:.01,repeat:!1},sourceColor:t,targetColor:r,pickLight:n=!1,heightfixed:i=!1,opacityLinear:o={enable:!1,dir:"up"},lightEnable:a=!0}=this.layer.getLayerConfig(),s=0,l=[0,0,0,0],u=[0,0,0,0];if(t&&r&&(l=eC(t),u=eC(r),s=1),this.raiseCount<1&&this.raiseRepeat>0&&e.enable){let{speed:t=.01}=e;this.raiseCount+=t,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}let c={u_pickLight:Number(n),u_heightfixed:Number(i),u_r:e.enable&&this.raiseRepeat>0?this.raiseCount:1,u_linearColor:s,u_sourceColor:l,u_targetColor:u,u_opacitylinear:Number(o.enable),u_opacitylinear_dir:"up"===o.dir?1:0,u_lightEnable:Number(a)};return this.getUniformsBufferInfo(c)}initModels(){var e=this;return iG(function*(){return e.buildModels()})()}buildModels(){var e=this;return iG(function*(){let{depth:t=!0,animateOption:{repeat:r=1}}=e.layer.getLayerConfig();return e.raiseRepeat=r,e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:"pointExtrude",vertexShader:'#define pi (3.1415926535)\n\nlayout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in vec3 a_Size;\nlayout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec4 a_Extrude;\nlayout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;\n\nlayout(std140) uniform commonUniforms {\n  float u_pickLight;\n  float u_heightfixed;\n  float u_r;\n  float u_linearColor;\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  float u_opacitylinear;\n  float u_opacitylinear_dir;\n  float u_lightEnable;\n};\nout vec4 v_color;\nout float v_lightWeight;\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nfloat getYRadian(float x, float z) {\n  if (x > 0.0 && z > 0.0) {\n    return atan(x / z);\n  } else if (x > 0.0 && z <= 0.0) {\n    return atan(-z / x) + pi / 2.0;\n  } else if (x <= 0.0 && z <= 0.0) {\n    return pi + atan(x / z); //atan(x/z) +\n  } else {\n    return atan(z / -x) + pi * 3.0 / 2.0;\n  }\n}\n\nfloat getXRadian(float y, float r) {\n  return atan(y / r);\n}\n\nvoid main() {\n  vec3 size = a_Size * a_Position;\n\n  vec3 offset = size; // 控制圆柱体的大小 - 从标准单位圆柱体进行偏移\n\n  if (u_heightfixed < 1.0) {\n    // 圆柱体不固定高度\n  } else {\n    // 圆柱体固定高度 （ 处理 mapbox ）\n    if (\n      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n    ) {\n      offset *= 4.0 / pow(2.0, 21.0 - u_Zoom);\n    }\n  }\n\n  vec2 positions = a_Extrude.xy;\n  vec2 positions64Low = a_Extrude.zw;\n  vec4 project_pos = project_position(vec4(positions, 0.0, 1.0), positions64Low);\n\n  // u_r 控制圆柱的生长\n  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);\n\n  // // 圆柱光照效果\n  float lightWeight = 1.0;\n\n  if (u_lightEnable > 0.0) {\n    // 取消三元表达式，增强健壮性\n    lightWeight = calc_lighting(pos);\n  }\n\n  v_lightWeight = lightWeight;\n\n  v_color = a_Color;\n\n  // 设置圆柱的底色\n  if (u_linearColor == 1.0) {\n    // 使用渐变颜色\n    v_color = mix(u_sourceColor, u_targetColor, a_Position.z);\n    v_color.a = v_color.a * opacity;\n  } else {\n    v_color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);\n  }\n\n  if (u_opacitylinear > 0.0) {\n    v_color.a *= u_opacitylinear_dir > 0.0 ? 1.0 - a_Position.z : a_Position.z;\n  }\n\n  gl_Position = project_common_position_to_clipspace(pos);\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'\nin vec4 v_color;\nin float v_lightWeight;\nout vec4 outputColor;\n\nlayout(std140) uniform commonUniforms {\n  float u_pickLight;\n  float u_heightfixed;\n  float u_r;\n  float u_linearColor;\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  float u_opacitylinear;\n  float u_opacitylinear_dir;\n  float u_lightEnable;\n};\n\n#pragma include "scene_uniforms"\n#pragma include "picking"\n\nvoid main() {\n\n  outputColor = v_color;\n  // 开启透明度渐变\n  // picking\n  if(u_pickLight > 0.0) {\n    outputColor = filterColorAlpha(outputColor, v_lightWeight);\n  } else {\n    outputColor = filterColor(outputColor);\n  }\n}\n',triangulation:dY,defines:e.getDefines(),inject:e.getInject(),cull:{enable:!0,face:ic.FRONT},depth:{enable:t}}))]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:iR.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:3,update:e=>{let{size:t}=e;if(!t)return[2,2,2];{let e=[];return Array.isArray(t)&&(e=2===t.length?[t[0],t[0],t[1]]:t),Array.isArray(t)||(e=[t,t,t]),e}}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:iR.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:ic.STATIC_DRAW,data:[],type:ic.FLOAT},size:3,update:(e,t,r,n,i)=>i}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:iR.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:4,update:e=>{let t=tk(e.coordinates);return[t[0],t[1],tw(t[0]),tw(t[1])]}}})}}class pm extends dh{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,SHAPE:10,EXTRUDE:11})}getCommonUniformsInfo(){let{strokeOpacity:e=1,strokeWidth:t=0,blend:r,blur:n=0,raisingHeight:i=0,heightfixed:o=!1,unit:a="pixel"}=this.layer.getLayerConfig(),s=this.getAnimateUniforms().u_time;isNaN(s)&&(s=-1);let l={u_blur_height_fixed:[n,Number(i),Number(o)],u_stroke_width:t,u_additive:"additive"===r?1:0,u_stroke_opacity:e,u_size_unit:pu[a],u_time:s,u_animate:this.getAnimateUniforms().u_animate};return this.getUniformsBufferInfo(l)}getAnimateUniforms(){let{animateOption:e={enable:!1}}=this.layer.getLayerConfig();return{u_animate:this.animateOption2Array(e),u_time:this.layer.getLayerAnimateTime()}}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),d$)}initModels(){var e=this;return iG(function*(){return e.buildModels()})()}buildModels(){var e=this;return iG(function*(){let{frag:t,vert:r,type:n}=e.getShaders();return e.layer.triangulation=d$,e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:n,vertexShader:r,fragmentShader:t,defines:e.getDefines(),inject:e.getInject(),triangulation:d$,depth:{enable:!1}}))]})()}getShaders(){return{frag:"\nlayout(std140) uniform commonUniforms {\n  vec3 u_blur_height_fixed;\n  float u_stroke_width;\n  float u_additive;\n  float u_stroke_opacity;\n  float u_size_unit;\n  float u_time;\n  vec4 u_animate;\n};\n\nin vec4 v_color;\nin vec4 v_stroke;\nin vec4 v_data;\nin float v_radius;\n\n#pragma include \"scene_uniforms\"\n#pragma include \"sdf_2d\"\n#pragma include \"picking\"\n\nout vec4 outputColor;\n\nvoid main() {\n  int shape = int(floor(v_data.w + 0.5));\n  lowp float antialiasblur = v_data.z;\n  float r = v_radius / (v_radius + u_stroke_width);\n\n  float outer_df;\n  float inner_df;\n  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'\n  if (shape == 0) {\n    outer_df = sdCircle(v_data.xy, 1.0);\n    inner_df = sdCircle(v_data.xy, r);\n  } else if (shape == 1) {\n    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);\n    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);\n  } else if (shape == 2) {\n    outer_df = sdBox(v_data.xy, vec2(1.));\n    inner_df = sdBox(v_data.xy, vec2(r));\n  } else if (shape == 3) {\n    outer_df = sdPentagon(v_data.xy, 0.8);\n    inner_df = sdPentagon(v_data.xy, r * 0.8);\n  } else if (shape == 4) {\n    outer_df = sdHexagon(v_data.xy, 0.8);\n    inner_df = sdHexagon(v_data.xy, r * 0.8);\n  } else if (shape == 5) {\n    outer_df = sdOctogon(v_data.xy, 1.0);\n    inner_df = sdOctogon(v_data.xy, r);\n  } else if (shape == 6) {\n    outer_df = sdHexagram(v_data.xy, 0.52);\n    inner_df = sdHexagram(v_data.xy, r * 0.52);\n  } else if (shape == 7) {\n    outer_df = sdRhombus(v_data.xy, vec2(1.0));\n    inner_df = sdRhombus(v_data.xy, vec2(r));\n  } else if (shape == 8) {\n    outer_df = sdVesica(v_data.xy, 1.1, 0.8);\n    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);\n  }\n\n  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);\n\n  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(\n    antialiasblur,\n    0.0,\n    inner_df\n  );\n\n  float PI = 3.14159;\n  float N_RINGS = 3.0;\n  float FREQ = 1.0;\n\n  if(u_stroke_width < 0.01) {\n    outputColor = v_color;\n  } else {\n    outputColor = mix(v_color, v_stroke * u_stroke_opacity, color_t);\n  }\n  float intensity = 1.0;\n  if(u_time!=-1.0){\n    //wave相关逻辑\n    float d = length(v_data.xy);\n    if(d > 0.5) {\n      discard;\n    }\n    intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_animate.z - u_animate.y * u_time)), 0.0, 1.0);\n  }\n\n  if(u_additive > 0.0) {\n    outputColor *= opacity_t;\n    outputColor *= intensity;//wave\n    outputColor = filterColorAlpha(outputColor, outputColor.a);\n  } else {\n    outputColor.a *= opacity_t;\n    outputColor.a *= intensity;//wave \n    outputColor = filterColor(outputColor);\n  }\n   // 作为 mask 模板时需要丢弃透明的像素\n  if(outputColor.a < 0.01) {\n    discard;\n  } \n}\n",vert:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\nlayout(location = ATTRIBUTE_LOCATION_SHAPE) in float a_Shape;\nlayout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;\n\nlayout(std140) uniform commonUniforms {\n  vec3 u_blur_height_fixed;\n  float u_stroke_width;\n  float u_additive;\n  float u_stroke_opacity;\n  float u_size_unit;\n  float u_time;\n  vec4 u_animate;\n};\n\nout vec4 v_color;\nout vec4 v_stroke;\nout vec4 v_data;\nout float v_radius;\n\n#pragma include "projection"\n#pragma include "picking"\n#pragma include "rotation_2d"\n\nvoid main() {\n  // 透明度计算\n   v_stroke = stroke;\n  vec3 extrude = a_Extrude;\n  float shape_type = a_Shape;\n  /*\n  *  setPickingSize 设置拾取大小\n  *  u_meter2coord 在等面积大小的时候设置单位\n  */\n  float newSize = setPickingSize(a_Size);\n  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;\n\n\n\n  // unpack color(vec2)\n  v_color = vec4(a_Color.xyz, a_Color.w * opacity);\n\n  if(u_size_unit == 1.0) {\n    newSize = newSize  * u_PixelsPerMeter.z;\n  }\n\n   v_radius = newSize;\n\n  // anti-alias\n  //  float antialiased_blur = -max(u_blur, antialiasblur);\n  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur_height_fixed.x);\n\n  vec2 offset = (extrude.xy * (newSize + u_stroke_width) + u_offsets);\n\n  offset = project_pixel(offset);\n  offset = rotate_matrix(offset,rotation);\n\n  // TODP: /abs(extrude.x) 是为了兼容地球模式\n  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);\n\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));\n\n  float raisingHeight = u_blur_height_fixed.y;\n\n  if(u_blur_height_fixed.z < 1.0) { // false\n    raisingHeight = project_pixel(u_blur_height_fixed.y);\n  } else {\n     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);\n      raisingHeight = u_blur_height_fixed.y * mapboxZoomScale;\n    }\n  }\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n',type:"pointFill"}}animateOption2Array(e){return[e.enable?0:1,e.speed||1,e.rings||3,0]}registerBuiltinAttributes(){let e=this.layer.getLayerConfig().shape2d;this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:iR.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:3,update:(e,t,r,n)=>{let i=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],o=n%4*3;return[i[o],i[o+1],i[o+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:iR.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:1,update:e=>{let{size:t=5}=e;return Array.isArray(t)?[t[0]]:[t]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:iR.Attribute,descriptor:{name:"a_Shape",shaderLocation:this.attributeLocation.SHAPE,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:1,update:t=>{let{shape:r=2}=t;return[e.indexOf(r)]}}})}}class pv extends dh{constructor(...e){super(...e),ia(this,"texture",void 0),ia(this,"updateTexture",()=>{let{createTexture2D:e}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),setTimeout(()=>{this.layerService.throttleRenderLayers()});return}this.texture=e({data:this.iconService.getCanvas(),mag:ic.LINEAR,min:ic.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128,mipmap:!0})})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,UV:10})}getUninforms(){if(this.rendererService.getDirty()){var e;null===(e=this.texture)||void 0===e||e.bind()}let t=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),il(il({},t.uniformsOption),r.uniformsOption)}getCommonUniformsInfo(){let{raisingHeight:e=0,heightfixed:t=!1}=this.layer.getLayerConfig(),r={u_textSize:[1024,this.iconService.canvasHeight||128],u_raisingHeight:Number(e),u_heightfixed:Number(t),u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(r)}initModels(){var e=this;return iG(function*(){return e.iconService.on("imageUpdate",e.updateTexture),e.updateTexture(),e.buildModels()})()}clearModels(){var e;null===(e=this.texture)||void 0===e||e.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var e=this;return iG(function*(){return e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:"pointImage",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;\n\nlayout(std140) uniform commonUniforms {\n  vec2 u_textSize;\n  float u_raisingHeight;\n  float u_heightfixed;\n};\n\nout vec4 v_color;\nout vec2 v_uv;\nout float v_opacity;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  // cal style mapping - 数据纹理映射部分的计算\n  v_color = a_Color;\n  v_opacity = opacity;\n  v_uv = a_Uv;\n  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);\n\n  vec2 offset = project_pixel(offsets);\n\n  float raisingHeight = u_raisingHeight;\n  if (u_heightfixed < 1.0) {\n    // false\n    raisingHeight = project_pixel(u_raisingHeight);\n  } else {\n    if (\n      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n    ) {\n      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);\n      raisingHeight = u_raisingHeight * mapboxZoomScale;\n    }\n  }\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));\n\n  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'layout(std140) uniform commonUniforms {\n  vec2 u_textSize;\n  float u_raisingHeight;\n  float u_heightfixed;\n};\n\nuniform sampler2D u_texture;\n\nin vec4 v_color;\nin vec2 v_uv;\nin float v_opacity;\n\n#pragma include "picking"\n\nout vec4 outputColor;\n\nvoid main(){\n  vec2 pos = v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;\n  vec4 textureColor;\n\n  // Y = 0.299R + 0.587G + 0.114B // 亮度提取\n  \n  textureColor = texture(SAMPLER_2D(u_texture), pos);\n\n  // Tip: 去除边缘部分 mipmap 导致的混合变暗\n  float fragmengTocenter = distance(vec2(0.5), gl_PointCoord);\n  if(fragmengTocenter >= 0.5) {\n        float luma = 0.299 * textureColor.r + 0.587 * textureColor.g + 0.114 * textureColor.b;\n        textureColor.a *= luma;\n  }\n  \n  if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){\n        outputColor= textureColor;\n  }else {\n        outputColor= step(0.01, textureColor.z) * v_color;\n  }\n  outputColor.a *= v_opacity;\n  if (outputColor.a < 0.01) {\n      discard;\n  }\n  outputColor = filterColor(outputColor);\n}\n',triangulation:dq,defines:e.getDefines(),inject:e.getInject(),depth:{enable:!1},primitive:ic.POINTS}))]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:iR.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:1,update:e=>{let{size:t=5}=e;return Array.isArray(t)?[t[0]]:[t]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:iR.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:2,update:e=>{let t=this.iconService.getIconMap(),{shape:r}=e,{x:n,y:i}=t[r]||{x:-64,y:-64};return[n,i]}}})}}function py(e){let t=e.coordinates;return{vertices:[...t],indices:[0],size:t.length}}class p_ extends dh{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9})}getDefaultStyle(){return{blend:"additive"}}getCommonUniformsInfo(){return this.getUniformsBufferInfo({u_size_scale:.5})}initModels(){var e=this;return iG(function*(){return e.buildModels()})()}buildModels(){var e=this;return iG(function*(){return e.layer.triangulation=py,e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:"pointNormal",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\n\nlayout(std140) uniform u_Common {\n  float u_size_scale;\n};\n\nout vec4 v_color;\n\n#pragma include "projection"\n#pragma include "project"\n\nvoid main() {\n  v_color = vec4(a_Color.xyz, a_Color.w * opacity);\n\n  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);\n  gl_Position = project_common_position_to_clipspace(project_pos);\n\n  gl_PointSize = a_Size * u_size_scale * 2.0 * u_DevicePixelRatio;\n}\n',fragmentShader:"in vec4 v_color;\nout vec4 outputColor;\nvoid main() {\n  outputColor = v_color;\n}",triangulation:py,defines:e.getDefines(),inject:e.getInject(),depth:{enable:!1},primitive:ic.POINTS,pick:!1}))]})()}clearModels(){}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:iR.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:1,update:e=>{let{size:t=1}=e;return Array.isArray(t)?[t[0]]:[t]}}})}}class pb{constructor(e,t,r){ia(this,"boxCells",[]),ia(this,"xCellCount",void 0),ia(this,"yCellCount",void 0),ia(this,"boxKeys",void 0),ia(this,"bboxes",void 0),ia(this,"width",void 0),ia(this,"height",void 0),ia(this,"xScale",void 0),ia(this,"yScale",void 0),ia(this,"boxUid",void 0);let n=this.boxCells;this.xCellCount=Math.ceil(e/r),this.yCellCount=Math.ceil(t/r);for(let e=0;e<this.xCellCount*this.yCellCount;e++)n.push([]);this.boxKeys=[],this.bboxes=[],this.width=e,this.height=t,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/t,this.boxUid=0}insert(e,t,r,n,i){this.forEachCell(t,r,n,i,this.insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i)}query(e,t,r,n,i){return this.queryHitTest(e,t,r,n,!1,i)}hitTest(e,t,r,n,i){return this.queryHitTest(e,t,r,n,!0,i)}insertBoxCell(e,t,r,n,i,o){this.boxCells[i].push(o)}queryHitTest(e,t,r,n,i,o){if(r<0||e>this.width||n<0||t>this.height)return!i&&[];let a=[];if(e<=0&&t<=0&&this.width<=r&&this.height<=n){if(i)return!0;for(let e=0;e<this.boxKeys.length;e++)a.push({key:this.boxKeys[e],x1:this.bboxes[4*e],y1:this.bboxes[4*e+1],x2:this.bboxes[4*e+2],y2:this.bboxes[4*e+3]});return o?a.filter(o):a}return this.forEachCell(e,t,r,n,this.queryCell,a,{hitTest:i,seenUids:{box:{},circle:{}}},o),i?a.length>0:a}queryCell(e,t,r,n,i,o,a,s){let l=a.seenUids,u=this.boxCells[i];if(null!==u){let i=this.bboxes;for(let c of u)if(!l.box[c]){l.box[c]=!0;let u=4*c;if(e<=i[u+2]&&t<=i[u+3]&&r>=i[u+0]&&n>=i[u+1]&&(!s||s(this.boxKeys[c]))){if(a.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[c],x1:i[u],y1:i[u+1],x2:i[u+2],y2:i[u+3]})}}}return!1}forEachCell(e,t,r,n,i,o,a,s){let l=this.convertToXCellCoord(e),u=this.convertToYCellCoord(t),c=this.convertToXCellCoord(r),h=this.convertToYCellCoord(n);for(let d=l;d<=c;d++)for(let l=u;l<=h;l++){let u=this.xCellCount*l+d;if(i.call(this,e,t,r,n,u,o,a,s))return}}convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}}class px{constructor(e,t){ia(this,"width",void 0),ia(this,"height",void 0),ia(this,"grid",void 0),ia(this,"viewportPadding",100),ia(this,"screenRightBoundary",void 0),ia(this,"screenBottomBoundary",void 0),ia(this,"gridRightBoundary",void 0),ia(this,"gridBottomBoundary",void 0),this.width=e,this.height=t,this.viewportPadding=Math.max(e,t),this.grid=new pb(e+this.viewportPadding,t+this.viewportPadding,25),this.screenRightBoundary=e+this.viewportPadding,this.screenBottomBoundary=t+this.viewportPadding,this.gridRightBoundary=e+2*this.viewportPadding,this.gridBottomBoundary=t+2*this.viewportPadding}placeCollisionBox(e){let t=e.x1+e.anchorPointX+this.viewportPadding,r=e.y1+e.anchorPointY+this.viewportPadding,n=e.x2+e.anchorPointX+this.viewportPadding,i=e.y2+e.anchorPointY+this.viewportPadding;return!this.isInsideGrid(t,r,n,i)||this.grid.hitTest(t,r,n,i)?{box:[]}:{box:[t,r,n,i]}}insertCollisionBox(e,t){this.grid.insert({featureIndex:t},e[0],e[1],e[2],e[3])}project(e,t,r){var n;let i=((n=new iX(4))[0]=t,n[1]=r,n[2]=0,n[3]=1,n),o=on();return oi(o,i,function(e,t,r,n,i,o,a,s,l,u,c,h,d,p,f,g){var m=new iX(16);return m[0]=e,m[1]=t,m[2]=r,m[3]=n,m[4]=i,m[5]=o,m[6]=a,m[7]=s,m[8]=l,m[9]=u,m[10]=c,m[11]=h,m[12]=d,m[13]=p,m[14]=f,m[15]=g,m}(...e)),{x:(o[0]/o[3]+1)/2*this.width+this.viewportPadding,y:(-o[1]/o[3]+1)/2*this.height+this.viewportPadding}}isInsideGrid(e,t,r,n){return r>=0&&e<this.gridRightBoundary&&n>=0&&t<this.gridBottomBoundary}}function pS(e){let t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0;break;default:t=.5}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0;break;default:r=.5}return{horizontalAlign:t,verticalAlign:r}}function pA(e,t,r,n,i){if(!i)return;let o=e[n],a=o.glyph;if(a){let s=t[a].advance*o.scale,l=(e[n].x+s)*i;for(let t=r;t<=n;t++)e[t].x-=l}}function pE(e,t,r,n,i,o,a){let s=(t-r)*i,l=(-n*a+.5)*o;for(let t of e)t.x+=s,t.y+=l}let pT='#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105\n#define FONT_SIZE 48.0\n\nuniform sampler2D u_sdf_map;\nlayout(std140) uniform commonUniforms {\n  vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];\n  vec2 u_sdf_map_size;\n  float u_raisingHeight: 0.0;\n  float u_stroke_width : 2;\n  float u_gamma_scale : 0.5;\n  float u_halo_blur : 0.5;\n};\n\nin vec2 v_uv;\nin float v_gamma_scale;\nin vec4 v_color;\nin vec4 v_stroke_color;\nin float v_fontScale;\n\nout vec4 outputColor;\n\n#pragma include "picking"\nvoid main() {\n  // get style data mapping\n\n  // get sdf from atlas\n  float dist = texture(SAMPLER_2D(u_sdf_map), v_uv).a;\n\n  lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;\n  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;\n\n  highp float gamma_scaled = gamma * v_gamma_scale;\n\n  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);\n\n  outputColor = mix(v_color, v_stroke_color, smoothstep(0., 0.5, 1.- dist));\n\n  outputColor.a *= alpha;\n   // 作为 mask 模板时需要丢弃透明的像素\n  if (outputColor.a < 0.01) {\n    discard;\n  }\n  outputColor = filterColor(outputColor);\n}\n',pC='#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105\n#define FONT_SIZE 24.0\n\nlayout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\nlayout(location = ATTRIBUTE_LOCATION_TEXT_OFFSETS) in vec2 a_textOffsets;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_tex;\n\nlayout(std140) uniform commonUniforms {\n  vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];\n  vec2 u_sdf_map_size;\n  float u_raisingHeight: 0.0;\n  float u_stroke_width : 2;\n  float u_gamma_scale : 0.5;\n  float u_halo_blur : 0.5;\n};\n\nout vec2 v_uv;\nout float v_gamma_scale;\nout vec4 v_color;\nout vec4 v_stroke_color;\nout float v_fontScale;\n\n#pragma include "projection"\n#pragma include "picking"\n#pragma include "rotation_2d"\n\nvoid main() {\n  // cal style mapping - 数据纹理映射部分的计算\n\n  v_uv = a_tex / u_sdf_map_size;\n\n\n\n  v_color = vec4(a_Color.xyz, a_Color.w * opacity);\n  v_stroke_color = vec4(u_stroke_color.xyz, u_stroke_color.w * opacity);\n\n  // 文本缩放比例\n  float fontScale = a_Size / FONT_SIZE;\n  v_fontScale = fontScale;\n\n  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);\n  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  vec2 offset = rotate_matrix(a_textOffsets,rotation);\n\n  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);\n\n  float raiseHeight = u_raisingHeight;\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);\n    raiseHeight = u_raisingHeight * mapboxZoomScale;\n  }\n\n  vec4 projected_position = project_common_position_to_clipspace(vec4(project_pos.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));\n\n  gl_Position = vec4(\n    projected_position.xy / projected_position.w + offset * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);\n  v_gamma_scale = gl_Position.w;\n  setPickingColor(a_PickingColor);\n\n}\n',{isEqual:pw}=th;function pL(e){let t=e.id,r=[],n=[];if(!this.glyphInfoMap||!this.glyphInfoMap[t])return{vertices:[],indices:[],size:7};let i=this.glyphInfoMap[t].centroid,o=2===i.length?[i[0],i[1],0]:i;return this.glyphInfoMap[t].glyphQuads.forEach((e,t)=>{r.push(...o,e.tex.x,e.tex.y+e.tex.height,e.tl.x,e.tl.y,...o,e.tex.x+e.tex.width,e.tex.y+e.tex.height,e.tr.x,e.tr.y,...o,e.tex.x+e.tex.width,e.tex.y,e.br.x,e.br.y,...o,e.tex.x,e.tex.y,e.bl.x,e.bl.y),n.push(0+4*t,1+4*t,2+4*t,2+4*t,3+4*t,0+4*t)}),{vertices:r,indices:n,size:7}}class pM extends dh{constructor(...e){var t;super(...e),t=this,ia(this,"glyphInfo",void 0),ia(this,"glyphInfoMap",{}),ia(this,"rawEncodeData",void 0),ia(this,"texture",void 0),ia(this,"currentZoom",-1),ia(this,"extent",void 0),ia(this,"textureHeight",0),ia(this,"textCount",0),ia(this,"preTextStyle",{}),ia(this,"mapping",iG(function*(){t.initGlyph(),t.updateTexture(),yield t.reBuildModel()}))}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,TEXT_OFFSETS:10,UV:11})}getUninforms(){let e=this.getCommonUniformsInfo(),t=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),il(il(il({},e.uniformsOption),t.uniformsOption),{u_sdf_map:this.textures[0]})}getCommonUniformsInfo(){let{stroke:e="#fff",strokeWidth:t=0,halo:r=.5,gamma:n=2,raisingHeight:i=0}=this.layer.getLayerConfig(),o=this.getFontServiceMapping(),a=this.getFontServiceCanvas();o&&Object.keys(o).length!==this.textCount&&a&&(this.updateTexture(),this.textCount=Object.keys(o).length),this.preTextStyle=this.getTextStyle();let s={u_stroke_color:eC(e),u_sdf_map_size:[(null==a?void 0:a.width)||1,(null==a?void 0:a.height)||1],u_raisingHeight:Number(i),u_stroke_width:t,u_gamma_scale:n,u_halo_blur:r};return this.getUniformsBufferInfo(s)}initModels(){var e=this;return iG(function*(){return e.bindEvent(),e.extent=e.textExtent(),e.rawEncodeData=e.layer.getEncodedData(),e.preTextStyle=e.getTextStyle(),e.initUniformsBuffer(),e.buildModels()})()}buildModels(){var e=this;return iG(function*(){let{textAllowOverlap:t=!1}=e.layer.getLayerConfig();return e.initGlyph(),e.updateTexture(),t||e.filterGlyphs(),[(yield e.layer.buildLayerModel({moduleName:"pointText",vertexShader:pC,fragmentShader:pT,defines:e.getDefines(),inject:e.getInject(),triangulation:pL.bind(e),depth:{enable:!1}}))]})()}needUpdate(){var e=this;return iG(function*(){let{textAllowOverlap:t=!1,textAnchor:r="center",textOffset:n,padding:i,fontFamily:o,fontWeight:a}=e.getTextStyle();if(!pw(i,e.preTextStyle.padding)||!pw(n,e.preTextStyle.textOffset)||!pw(r,e.preTextStyle.textAnchor)||!pw(o,e.preTextStyle.fontFamily)||!pw(a,e.preTextStyle.fontWeight))return yield e.mapping(),!0;if(t)return!1;let s=e.mapService.getZoom(),l=e.mapService.getBounds(),u=tP(e.extent,l);return(Math.abs(e.currentZoom-s)>.5||!u||t!==e.preTextStyle.textAllowOverlap)&&(yield e.reBuildModel(),!0)})()}clearModels(){var e;null===(e=this.texture)||void 0===e||e.destroy(),this.layer.off("remapping",this.mapping)}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:iR.Attribute,descriptor:{shaderLocation:this.attributeLocation.TEXT_OFFSETS,name:"a_textOffsets",buffer:{usage:ic.STATIC_DRAW,data:[],type:ic.FLOAT},size:2,update:(e,t,r)=>[r[5],r[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:iR.Attribute,descriptor:{name:"a_tex",shaderLocation:this.attributeLocation.UV,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:2,update:(e,t,r)=>[r[3],r[4]]}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:iR.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:1,update:e=>{let{size:t=12}=e;return Array.isArray(t)?[t[0]]:[t]}}})}bindEvent(){this.layer.isTileLayer||this.layer.on("remapping",this.mapping)}textExtent(){return tI(this.mapService.getBounds(),.5)}initTextFont(){let{fontWeight:e,fontFamily:t}=this.getTextStyle(),r=this.rawEncodeData,n=[];r.forEach(e=>{let{shape:t=""}=e;for(let e of t=t.toString())-1===n.indexOf(e)&&n.push(e)}),this.fontService.setFontOptions({characterSet:n,fontWeight:e,fontFamily:t,iconfont:!1})}initIconFontTex(){let{fontWeight:e,fontFamily:t}=this.getTextStyle(),r=this.rawEncodeData,n=[];r.forEach(e=>{let{shape:t=""}=e;t=`${t}`,-1===n.indexOf(t)&&n.push(t)}),this.fontService.setFontOptions({characterSet:n,fontWeight:e,fontFamily:t,iconfont:!0})}getTextStyle(){let{fontWeight:e="400",fontFamily:t="sans-serif",textAllowOverlap:r=!1,padding:n=[0,0],textAnchor:i="center",textOffset:o=[0,0],opacity:a=1,strokeOpacity:s=1,strokeWidth:l=0,stroke:u="#000"}=this.layer.getLayerConfig();return{fontWeight:e,fontFamily:t,textAllowOverlap:r,padding:n,textAnchor:i,textOffset:o,opacity:a,strokeOpacity:s,strokeWidth:l,stroke:u}}generateGlyphLayout(e){let t=this.getFontServiceMapping(),{spacing:r=2,textAnchor:n="center",textOffset:i}=this.layer.getLayerConfig(),o=this.rawEncodeData;this.glyphInfo=o.map(o=>{let{shape:a="",id:s,size:l=1}=o,u=o.textOffset?o.textOffset:i||[0,0],c=o.textAnchor?o.textAnchor:n||"center",h=function(e,t,r,n,i,o,a=[0,0],s){let l=e.split("\n"),u=[],c={positionedGlyphs:u,top:a[1],bottom:a[1],left:a[0],right:a[0],lineCount:l.length,text:e};return s?function(e,t,r,n,i,o,a){let s=0,l=-8,u=0,c=e.positionedGlyphs,h="right"===o?1:"left"===o?0:.5,d=c.length;r.forEach(e=>{let r=t[e];r&&(c.push({glyph:e,x:r.advance/2,y:l+0,vertical:!1,scale:1,metrics:r}),s+=r.advance+a),c.length!==d&&(u=Math.max(s-a,u),pA(c,t,d,c.length-1,h)),s=0,l-=n+5});let{horizontalAlign:p,verticalAlign:f}=pS(i);pE(c,h,p,f,u,n,r.length);let g=l- -8;e.top+=-f*g,e.bottom=e.top-g,e.left+=-p*u,e.right=e.left+u}(c,t,l,r,n,i,o):function(e,t,r,n,i,o,a){let s=0,l=-8,u=0,c=e.positionedGlyphs,h="right"===o?1:"left"===o?0:.5,d=c.length;r.forEach(e=>{e.split("").forEach(e=>{let r=t[e];r&&(c.push({glyph:e,x:s,y:l+0,vertical:!1,scale:1,metrics:r}),s+=r.advance+a)}),c.length!==d&&(u=Math.max(s-a,u),pA(c,t,d,c.length-1,h)),s=0,l-=n+5});let{horizontalAlign:p,verticalAlign:f}=pS(i);pE(c,h,p,f,u,n,r.length);let g=l- -8;e.top+=-f*g,e.bottom=e.top-g,e.left+=-p*u,e.right=e.left+u}(c,t,l,r,n,i,o),!!u.length&&c}(a.toString(),t,l,c,"left",r,u,e),d=function(e,t=[0,0],r){let{positionedGlyphs:n=[]}=e,i=[];for(let e of n){let n=e.metrics,o=n.advance*e.scale/2,a=r?[e.x+o,e.y]:[0,0],s=r?[0,0]:[e.x+o+t[0],e.y+t[1]],l=-4*e.scale-o+s[0],u=-4*e.scale+s[1],c=l+n.width*e.scale,h=u+n.height*e.scale,d={x:l,y:u},p={x:c,y:u},f={x:l,y:h},g={x:c,y:h};i.push({tl:d,tr:p,bl:f,br:g,tex:n,glyphOffset:a})}return i}(h,u,!1);return o.shaping=h,o.glyphQuads=d,o.centroid=tk(o.coordinates),this.glyphInfoMap[s]={shaping:h,glyphQuads:d,centroid:tk(o.coordinates)},o})}getFontServiceMapping(){let{fontWeight:e="400",fontFamily:t="sans-serif"}=this.layer.getLayerConfig();return this.fontService.getMappingByKey(`${t}_${e}`)}getFontServiceCanvas(){let{fontWeight:e="400",fontFamily:t="sans-serif"}=this.layer.getLayerConfig();return this.fontService.getCanvasByKey(`${t}_${e}`)}filterGlyphs(){let{padding:e=[0,0],textAllowOverlap:t=!1}=this.layer.getLayerConfig();if(t)return;this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();let{width:r,height:n}=this.rendererService.getViewportSize(),i=new px(r,n);this.glyphInfo.filter(t=>{let{shaping:r,id:n=0}=t,o=t.centroid,a=t.size/16,s=this.mapService.lngLatToContainer(o),{box:l}=i.placeCollisionBox({x1:r.left*a-e[0],x2:r.right*a+e[0],y1:r.top*a-e[1],y2:r.bottom*a+e[1],anchorPointX:s.x,anchorPointY:s.y});return!!l&&!!l.length&&(i.insertCollisionBox(l,n),!0)}).forEach(e=>{this.glyphInfoMap[e.id]=e})}initGlyph(){let{iconfont:e=!1}=this.layer.getLayerConfig();e?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(e)}updateTexture(){let{createTexture2D:e}=this.rendererService,t=this.getFontServiceCanvas();this.textureHeight=t.height,this.texture&&this.texture.destroy(),this.texture=e({data:t,mag:ic.LINEAR,min:ic.LINEAR,width:t.width,height:t.height}),this.textures=[this.texture]}reBuildModel(){var e=this;return iG(function*(){e.filterGlyphs();let t=yield e.layer.buildLayerModel({moduleName:"pointText",vertexShader:pC,fragmentShader:pT,triangulation:pL.bind(e),defines:e.getDefines(),inject:e.getInject(),depth:{enable:!1}});e.layer.models=[t]})()}}function pO(){return(pO=iG(function*(e){if(window.createImageBitmap){let t=yield fetch(e);return yield createImageBitmap((yield t.blob()))}{let t=new window.Image;return new Promise(r=>{t.onload=()=>r(t),t.src=e,t.crossOrigin="Anonymous"})}})).apply(this,arguments)}class pI extends dh{constructor(...e){super(...e),ia(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:10,UV:11})}getUninforms(){let e=this.getCommonUniformsInfo(),t=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),il(il({},e.uniformsOption),t.uniformsOption)}getCommonUniformsInfo(){let{mapTexture:e,heightfixed:t=!1,raisingHeight:r=0,topsurface:n=!0,sidesurface:i=!0,sourceColor:o,targetColor:a}=this.layer.getLayerConfig(),s=0,l=[1,1,1,1],u=[1,1,1,1];o&&a&&(l=eC(o),u=eC(a),s=1);let c={u_sourceColor:l,u_targetColor:u,u_linearColor:s,u_topsurface:Number(n),u_sidesurface:Number(i),u_heightfixed:Number(t),u_raisingHeight:Number(r)};return e&&this.texture&&(c.u_texture=this.texture,this.textures=[this.texture]),this.getUniformsBufferInfo(c)}initModels(){var e=this;return iG(function*(){return yield e.loadTexture(),e.buildModels()})()}buildModels(){var e=this;return iG(function*(){let{frag:t,vert:r,type:n}=e.getShaders();return e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:n,vertexShader:r,fragmentShader:t,depth:{enable:!0},defines:e.getDefines(),inject:e.getInject(),triangulation:d3}))]})()}getShaders(){let{pickLight:e,mapTexture:t}=this.layer.getLayerConfig();return t?{frag:'uniform sampler2D u_texture;\n\nlayout(std140) uniform commonUniforms {\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  float u_linearColor;\n  float u_topsurface;\n  float u_sidesurface;\n  float u_heightfixed; // 默认不固定\n  float u_raisingHeight;\n};\n\nin vec4 v_Color;\nin vec3 v_uvs;\nin vec2 v_texture_data;\n\n#pragma include "scene_uniforms"\n#pragma include "picking"\n\nout vec4 outputColor;\n\nvoid main() {\n  float opacity = u_opacity;\n  float isSide = v_texture_data.x;\n  float lightWeight = v_texture_data.y;\n  float topU = v_uvs[0];\n  float topV = 1.0 - v_uvs[1];\n  float sidey = v_uvs[2];\n\n  outputColor = texture(SAMPLER_2D(u_texture), vec2(topU, topV));\n  // Tip: 部分机型 GPU 计算精度兼容\n  if (isSide < 0.999) {// 是否是边缘\n    // side face\n    if (u_sidesurface < 1.0) {\n      discard;\n    }\n\n    if (u_linearColor == 1.0) {\n      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);\n      linearColor.rgb *= lightWeight;\n      outputColor = linearColor;\n    } else {\n      outputColor = v_Color;\n    }\n  } else {\n     // top face\n    if (u_topsurface < 1.0) {\n      discard;\n    }\n  }\n  \n  outputColor.a *= opacity;\n  outputColor = filterColor(outputColor);\n}\n',vert:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\nlayout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;\n\nlayout(std140) uniform commonUniforms {\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  float u_linearColor;\n  float u_topsurface;\n  float u_sidesurface;\n  float u_heightfixed; // 默认不固定\n  float u_raisingHeight;\n};\n\nout vec4 v_Color;\nout vec3 v_uvs;\nout vec2 v_texture_data;\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nvoid main() {\n  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);\n  vec4 project_pos = project_position(pos, a_Position64Low);\n  float lightWeight = calc_lighting(project_pos);\n  v_uvs = a_uvs;\n  v_Color = a_Color;\n  v_Color.a *= opacity;\n\n  v_texture_data = vec2(a_Position.z, lightWeight);\n\n  if (u_heightfixed > 0.0) {\n    // 判断几何体是否固定高度\n    project_pos.z = a_Position.z * a_Size;\n    project_pos.z += u_raisingHeight;\n\n    if (\n      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n    ) {\n      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);\n      project_pos.z *= mapboxZoomScale;\n      project_pos.z += u_raisingHeight * mapboxZoomScale;\n    }\n  }\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n',type:"polygonExtrudeTexture"}:e?{frag:'\nlayout(std140) uniform commonUniforms {\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  float u_linearColor;\n  float u_topsurface;\n  float u_sidesurface;\n  float u_heightfixed; // 默认不固定\n  float u_raisingHeight;\n};\n\nin vec4 v_Color;\nin vec3 v_uvs;\nin vec2 v_texture_data;\nout vec4 outputColor;\n\n#pragma include "scene_uniforms"\n#pragma include "picking"\n\nvoid main() {\n  float isSide =  v_texture_data.x;\n  float sidey = v_uvs[2];\n  float lightWeight = v_texture_data.y;\n\n  // Tip: 部分机型 GPU 计算精度兼容\n  if(isSide < 0.999) {\n    // side face\n    if(u_sidesurface < 1.0) {\n      discard;\n    }\n    \n    if( u_linearColor == 1.0) {\n      // side use linear\n      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);\n      linearColor.rgb *= lightWeight;\n      outputColor = linearColor;\n    } else {\n      // side notuse linear\n       outputColor = v_Color;\n    }\n  } else {\n    // top face\n    if(u_topsurface < 1.0) {\n      discard;\n    }\n    outputColor = v_Color;\n  }\n\n  outputColor = filterColorAlpha(outputColor, lightWeight);\n}\n',vert:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\nlayout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;\n\nlayout(std140) uniform commonUniforms {\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  float u_linearColor;\n  float u_topsurface;\n  float u_sidesurface;\n  float u_heightfixed; // 默认不固定\n  float u_raisingHeight;\n};\n\nout vec4 v_Color;\nout vec3 v_uvs;\nout vec2 v_texture_data;\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nvoid main() {\n  v_uvs = a_uvs;\n  // cal style mapping - 数据纹理映射部分的计算\n  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);\n  vec4 project_pos = project_position(pos, a_Position64Low);\n\n  if (u_heightfixed > 0.0) {\n    // 判断几何体是否固定高度\n    project_pos.z = a_Position.z * a_Size;\n    project_pos.z += u_raisingHeight;\n    if (\n      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n    ) {\n      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);\n      project_pos.z *= mapboxZoomScale;\n      project_pos.z += u_raisingHeight * mapboxZoomScale;\n    }\n  }\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n  float lightWeight = calc_lighting(project_pos);\n  v_texture_data = vec2(a_Position.z, lightWeight);\n\n  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);\n\n  setPickingColor(a_PickingColor);\n}\n',type:"polygonExtrudePickLight"}:{frag:'layout(std140) uniform commonUniforms {\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  float u_linearColor;\n  float u_topsurface;\n  float u_sidesurface;\n  float u_heightfixed; // 默认不固定\n  float u_raisingHeight;\n};\n\nin vec4 v_Color;\n#pragma include "scene_uniforms"\n#pragma include "picking"\nout vec4 outputColor;\nvoid main() {\n\n     // top face\n    if(u_topsurface < 1.0) {\n      discard;\n    }\n\n    outputColor = v_Color;\n  \n  outputColor = filterColor(outputColor);\n}\n',vert:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\nlayout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;\n\nlayout(std140) uniform commonUniforms {\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  float u_linearColor;\n  float u_topsurface;\n  float u_sidesurface;\n  float u_heightfixed; // 默认不固定\n  float u_raisingHeight;\n};\n\nout vec4 v_Color;\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nvoid main() {\n  float isSide = a_Position.z;\n  float topU = a_uvs[0];\n  float topV = 1.0 - a_uvs[1];\n  float sidey = a_uvs[2];\n\n  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);\n\n  vec4 project_pos = project_position(pos, a_Position64Low);\n  float lightWeight = calc_lighting(project_pos);\n\n  if (u_heightfixed > 0.0) {\n    // 判断几何体是否固定高度\n    project_pos.z = a_Position.z * a_Size;\n    project_pos.z += u_raisingHeight;\n\n    if (\n      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n    ) {\n      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);\n      project_pos.z *= mapboxZoomScale;\n      project_pos.z += u_raisingHeight * mapboxZoomScale;\n    }\n  }\n\n gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  // Tip: 部分机型 GPU 计算精度兼容\n  if (isSide < 0.999) {\n    // side face\n    // if(u_sidesurface < 1.0) {\n    //   discard;\n    // }\n\n    if (u_linearColor == 1.0) {\n      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);\n      linearColor.rgb *= lightWeight;\n      v_Color = linearColor;\n    } else {\n      v_Color = a_Color;\n    }\n\n  } else {\n    v_Color = a_Color;\n  }\n\n  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);\n\n  setPickingColor(a_PickingColor);\n}\n',type:"polygonExtrude"}}clearModels(){var e;null===(e=this.texture)||void 0===e||e.destroy(),this.textures=[]}registerBuiltinAttributes(){let e=this.layer.getSource().extent,t=e[2]-e[0],r=e[3]-e[1];this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uvs",type:iR.Attribute,descriptor:{name:"a_uvs",shaderLocation:this.attributeLocation.UV,buffer:{usage:ic.STATIC_DRAW,data:[],type:ic.FLOAT},size:3,update:(n,i,o)=>{let a=o[0],s=o[1];return[(a-e[0])/t,(s-e[1])/r,o[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:iR.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:ic.STATIC_DRAW,data:[],type:ic.FLOAT},size:3,update:(e,t,r,n,i)=>i}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:iR.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:1,update:e=>{let{size:t=10}=e;return Array.isArray(t)?[t[0]]:[t]}}})}loadTexture(){var e=this;return iG(function*(){let{mapTexture:t}=e.layer.getLayerConfig(),{createTexture2D:r}=e.rendererService;if(e.texture=r({height:1,width:1}),t){let n=yield function(e){return pO.apply(this,arguments)}(t);e.texture=r({data:n,width:n.width,height:n.height,wrapS:ic.CLAMP_TO_EDGE,wrapT:ic.CLAMP_TO_EDGE,min:ic.LINEAR,mag:ic.LINEAR})}})()}}class pP extends dh{constructor(...e){super(...e),ia(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:10,EXTRUSION_BASE:11})}getUninforms(){let e=this.getCommonUniformsInfo(),t=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),il(il({},e.uniformsOption),t.uniformsOption)}getCommonUniformsInfo(){return this.getUniformsBufferInfo({})}initModels(){var e=this;return iG(function*(){return e.buildModels()})()}buildModels(){var e=this;return iG(function*(){let{frag:t,vert:r,type:n}=e.getShaders();return e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:n,vertexShader:r,fragmentShader:t,defines:e.getDefines(),inject:e.getInject(),triangulation:d3,depth:{enable:!0}}))]})()}getShaders(){return{frag:'\nin vec4 v_Color;\n#pragma include "scene_uniforms"\n#pragma include "picking"\nout vec4 outputColor;\nvoid main() {\n\n  outputColor = v_Color;\n  outputColor = filterColor(outputColor);\n}\n',vert:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\nlayout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;\n\nout vec4 v_Color;\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nvoid main() {\n  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size + (1.0 - a_Position.z) * extrusionBase, 1.0);\n\n  vec4 project_pos = project_position(pos, a_Position64Low);\n  float lightWeight = calc_lighting(project_pos);\n  v_Color = a_Color;\n  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n',type:"polygonExtrude"}}clearModels(){var e;null===(e=this.texture)||void 0===e||e.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"normal",type:iR.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:ic.STATIC_DRAW,data:[],type:ic.FLOAT},size:3,update:(e,t,r,n,i)=>i}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:iR.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:1,update:e=>{let{size:t=10}=e;return Array.isArray(t)?[t[0]]:[t]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrusionBase",type:iR.Attribute,descriptor:{name:"a_ExtrusionBase",shaderLocation:this.attributeLocation.EXTRUSION_BASE,buffer:{usage:ic.STATIC_DRAW,data:[],type:ic.FLOAT},size:1,update:e=>{let{extrusionBase:t=0}=e;return[t]}}})}}class pR extends dh{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,LINEAR:9})}getUninforms(){let e=this.getCommonUniformsInfo(),t=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),il(il({},e.uniformsOption),t.uniformsOption)}getCommonUniformsInfo(){let{raisingHeight:e=0,opacityLinear:t={enable:!1,dir:"in"}}=this.layer.getLayerConfig(),r={u_raisingHeight:Number(e),u_opacitylinear:Number(t.enable),u_dir:"in"===t.dir?1:0};return this.getUniformsBufferInfo(r)}initModels(){var e=this;return iG(function*(){return e.buildModels()})()}buildModels(){var e=this;return iG(function*(){let{frag:t,vert:r,triangulation:n,type:i}=e.getModelParams();return e.initUniformsBuffer(),e.layer.triangulation=n,[(yield e.layer.buildLayerModel({moduleName:i,vertexShader:r,fragmentShader:t,defines:e.getDefines(),inject:e.getInject(),triangulation:n,primitive:ic.TRIANGLES,depth:{enable:!1}}))]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute();let{opacityLinear:e={enable:!1,dir:"in"}}=this.layer.getLayerConfig();e.enable&&this.styleAttributeService.registerStyleAttribute({name:"linear",type:iR.Attribute,descriptor:{name:"a_linear",shaderLocation:this.attributeLocation.LINEAR,buffer:{usage:ic.STATIC_DRAW,data:[],type:ic.FLOAT},size:3,update:(e,t,r)=>[r[3],r[4],r[5]]}})}getModelParams(){let{opacityLinear:e={enable:!1}}=this.layer.getLayerConfig();return e.enable?{frag:'\nlayout(std140) uniform commonUniforms {\n  float u_raisingHeight;\n  float u_opacitylinear;\n  float u_dir;\n};\n\nin vec4 v_color;\nin vec3 v_linear;\nin vec2 v_pos;\nout vec4 outputColor;\n#pragma include "scene_uniforms"\n#pragma include "picking"\n\nvoid main() {\n  outputColor = v_color;\n  if (u_opacitylinear > 0.0) {\n    outputColor.a *= u_dir == 1.0 ? 1.0 - length(v_pos - v_linear.xy)/v_linear.z : length(v_pos - v_linear.xy)/v_linear.z;\n  }\n  outputColor = filterColor(outputColor);\n}\n',vert:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_LINEAR) in vec3 a_linear;\n\nlayout(std140) uniform commonUniforms {\n  float u_raisingHeight;\n  float u_opacitylinear;\n  float u_dir;\n};\n\nout vec4 v_color;\nout vec3 v_linear;\nout vec2 v_pos;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  if (u_opacitylinear > 0.0) {\n    v_linear = a_linear;\n    v_pos = a_Position.xy;\n  }\n  v_color = vec4(a_Color.xyz, a_Color.w * opacity);\n  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);\n  project_pos.z += u_raisingHeight;\n\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);\n    project_pos.z *= mapboxZoomScale;\n    project_pos.z += u_raisingHeight * mapboxZoomScale;\n  }\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n  setPickingColor(a_PickingColor);\n}\n',type:"polygonLinear",triangulation:d2}:{frag:'in vec4 v_color;\n#pragma include "scene_uniforms"\n#pragma include "picking"\nout vec4 outputColor;\nvoid main() {\n  outputColor = v_color;\n  outputColor = filterColor(outputColor);\n}\n',vert:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\n\nlayout(std140) uniform commonUniforms {\n  float u_raisingHeight;\n};\n\nout vec4 v_color;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  // cal style mapping - 数据纹理映射部分的计算\n\n  v_color = vec4(a_Color.xyz, a_Color.w * opacity);\n  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);\n\n  project_pos.z += u_raisingHeight;\n\n  if (\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n  ) {\n    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);\n    project_pos.z *= mapboxZoomScale;\n    project_pos.z += u_raisingHeight * mapboxZoomScale;\n  }\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n\n',type:"polygonFill",triangulation:d1}}}class pk extends dh{constructor(...e){super(...e),ia(this,"texture1",void 0),ia(this,"texture2",void 0),ia(this,"texture3",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){let e=this.getCommonUniformsInfo(),t=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),il(il({},e.uniformsOption),t.uniformsOption)}getCommonUniformsInfo(){let{watercolor:e="#6D99A8",watercolor2:t="#0F121C"}=this.layer.getLayerConfig(),r={u_watercolor:eC(e),u_watercolor2:eC(t),u_time:this.layer.getLayerAnimateTime(),u_texture1:this.texture1,u_texture2:this.texture2,u_texture3:this.texture3};return this.textures=[this.texture1,this.texture2,this.texture3],this.getUniformsBufferInfo(r)}getAnimateUniforms(){return{u_time:this.layer.getLayerAnimateTime()}}initModels(){var e=this;return iG(function*(){return e.loadTexture(),e.buildModels()})()}buildModels(){var e=this;return iG(function*(){return e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:"polygonOcean",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_uv;\n\nlayout(std140) uniform commonUniforms {\n  vec4 u_watercolor;\n  vec4 u_watercolor2;\n  float u_time;\n};\n\nout vec2 v_uv;\nout float v_opacity;\n\n#pragma include "projection"\n\nvoid main() {\n  v_uv = a_uv;\n  v_opacity = opacity;\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n}\n\n',fragmentShader:"\nlayout(std140) uniform commonUniforms {\n  vec4 u_watercolor;\n  vec4 u_watercolor2;\n  float u_time;\n};\n\nin vec2 v_uv;\nin float v_opacity;\nout vec4 outputColor;\n\nfloat coast2water_fadedepth = 0.10;\nfloat large_waveheight      = .750; // change to adjust the \"heavy\" waves\nfloat large_wavesize        = 3.4;  // factor to adjust the large wave size\nfloat small_waveheight      = 0.6;  // change to adjust the small random waves\nfloat small_wavesize        = 0.5;   // factor to ajust the small wave size\nfloat water_softlight_fact  = 15.;  // range [1..200] (should be << smaller than glossy-fact)\nfloat water_glossylight_fact= 120.; // range [1..200]\nfloat particle_amount       = 70.;\n\nvec3 water_specularcolor    = vec3(1.3, 1.3, 0.9);    // specular Color (RGB) of the water-highlights\n#define light                 vec3(-0., sin(u_time*0.5)*.5 + .35, 2.8) // position of the sun\n\nuniform sampler2D u_texture1;\nuniform sampler2D u_texture2;\nuniform sampler2D u_texture3;\n\n  \n\nfloat hash( float n ) {\n    return fract(sin(n)*43758.5453123);\n}\n\n// 2d noise function\nfloat noise1( in vec2 x ) {\n  vec2 p  = floor(x);\n  vec2 f  = smoothstep(0.0, 1.0, fract(x));\n  float n = p.x + p.y*57.0;\n  return mix(mix( hash(n+  0.0), hash(n+  1.0),f.x),\n    mix( hash(n+ 57.0), hash(n+ 58.0),f.x),f.y);\n}\n\nfloat noise(vec2 p) {\n    return texture(SAMPLER_2D(u_texture2),p*vec2(1./256.)).x;\n}\n\nvec4 highness(vec2 p) {\n    vec4 t = texture(SAMPLER_2D(u_texture1),fract(p));\n    float clipped = -2.0-smoothstep(3.,10.,t.a)*6.9-smoothstep(10.,100.,t.a)*89.9-smoothstep(0.,10000.,t.a)*10000.0;\n    return clamp(t, 0.0,3.0)+clamp(t/3.0-1.0, 0.0,1.0)+clamp(t/16.0-1.0, 0.0,1.0);\n}\n\nfloat height_map( vec2 p ) {\n    vec4 height=highness(p);\n    /*\n    height = -0.5+\n        0.5*smoothstep(-100.,0.,-height)+\n        2.75*smoothstep(0.,2.,height)+\n        1.75*smoothstep(2.,4.,height)+\n        2.75*smoothstep(4.,16.,height)+\n        1.5*smoothstep(16.,1000.,height);\n    */\n\n    mat2 m = mat2( 0.9563*1.4,  -0.2924*1.4,  0.2924*1.4,  0.9563*1.4 );\n    //p = p*6.;\n    float f = 0.6000*noise1( p ); p = m*p*1.1*6.;\n    f += 0.2500*noise( p ); p = m*p*1.32;\n    f += 0.1666*noise( p ); p = m*p*1.11;\n    f += 0.0834*noise( p ); p = m*p*1.12;\n    f += 0.0634*noise( p ); p = m*p*1.13;\n    f += 0.0444*noise( p ); p = m*p*1.14;\n    f += 0.0274*noise( p ); p = m*p*1.15;\n    f += 0.0134*noise( p ); p = m*p*1.16;\n    f += 0.0104*noise( p ); p = m*p*1.17;\n    f += 0.0084*noise( p );\n    f = .25*f+dot(height,vec4(-.03125,-.125,.25,.25))*.5;\n        const float FLAT_LEVEL = 0.92525;\n        //f = f*0.25+height*0.75;\n    if (f<FLAT_LEVEL)\n        f = f;\n    else\n        f = pow((f-FLAT_LEVEL)/(1.-FLAT_LEVEL), 2.)*(1.-FLAT_LEVEL)*2.0+FLAT_LEVEL; // makes a smooth coast-increase\n    return clamp(f, 0., 10.);\n}\n\nvec3 plasma_quintic( float x ) {\n    x = clamp( x, 0.0, 1.0);\n    vec4 x1 = vec4( 1.0, x, x * x, x * x * x ); // 1 x x2 x3\n    vec4 x2 = x1 * x1.w * x; // x4 x5 x6 x7\n    return vec3(\n        dot( x1.xyzw, vec4( +0.063861086, +1.992659096, -1.023901152, -0.490832805 ) ) + dot( x2.xy, vec2( +1.308442123, -0.914547012 ) ),\n        dot( x1.xyzw, vec4( +0.049718590, -0.791144343, +2.892305078, +0.811726816 ) ) + dot( x2.xy, vec2( -4.686502417, +2.717794514 ) ),\n        dot( x1.xyzw, vec4( +0.513275779, +1.580255060, -5.164414457, +4.559573646 ) ) + dot( x2.xy, vec2( -1.916810682, +0.570638854 ) ) );\n}\n\nvec4 color(vec2 p){\n    vec4 c1 = vec4(1.7,1.6,.9,1);\n    vec4 c2 = vec4(.2,.94,.1,1);\n    vec4 c3 = vec4(.3,.2,.0,1);\n    vec4 c4 = vec4(.99,.99,1.6,1);\n    vec4 v = highness(p);\n    float los = smoothstep(0.1,1.1,v.b);\n    float his = smoothstep(3.5,6.5,v.b);\n    float ces = smoothstep(1.,5.,v.a);\n    vec4 lo = mix(c1,c2,los);\n    vec4 hi = mix(c3,c4,his);\n    vec4 ce = mix(lo,hi,ces);\n\n    return vec4(plasma_quintic(ces),1).ragb;\n}\n\nvec3 terrain_map( vec2 p )\n{\n  return color(p).rgb*0.75+0.25*vec3(0.7, .55, .4)+texture(SAMPLER_2D(u_texture3), fract(p*5.)).rgb*.5; // test-terrain is simply 'sandstone'\n}\n\nconst mat2 m = mat2( 0.72, -1.60,  1.60,  0.72 );\n\nfloat water_map( vec2 p, float height ) {\n    vec2 p2 = p*large_wavesize;\n    vec2 shift1 = 0.001*vec2( u_time*160.0*2.0, u_time*120.0*2.0 );\n    vec2 shift2 = 0.001*vec2( u_time*190.0*2.0, -u_time*130.0*2.0 );\n\n    // coarse crossing 'ocean' waves...\n    float f = 0.6000*noise( p );\n    f += 0.2500*noise( p*m );\n    f += 0.1666*noise( p*m*m );\n    float wave = sin(p2.x*0.622+p2.y*0.622+shift2.x*4.269)*large_waveheight*f*height*height ;\n\n    p *= small_wavesize;\n    f = 0.;\n    float amp = 1.0, s = .5;\n    for (int i=0; i<9; i++)\n    { p = m*p*.947; f -= amp*abs(sin((noise( p+shift1*s )-.5)*2.)); amp = amp*.59; s*=-1.329; }\n    \n    return wave+f*small_waveheight;\n}\n\nfloat nautic(vec2 p) {\n    p *= 18.;\n    float f = 0.;\n    float amp = 1.0, s = .5;\n    for (int i=0; i<3; i++)\n    { p = m*p*1.2; f += amp*abs(smoothstep(0., 1., noise( p+u_time*s ))-.5); amp = amp*.5; s*=-1.227; }\n    return pow(1.-f, 5.);\n}\n\nfloat particles(vec2 p) {\n    p *= 200.;\n    float f = 0.;\n    float amp = 1.0, s = 1.5;\n    for (int i=0; i<3; i++)\n    { p = m*p*1.2; f += amp*noise( p+u_time*s ); amp = amp*.5; s*=-1.227; }\n    return pow(f*.35, 7.)*particle_amount;\n}\n\nfloat test_shadow( vec2 xy, float height) {\n    vec3 r0 = vec3(xy, height);\n    vec3 rd = normalize( light - r0 );\n    \n    float hit = 1.0;\n    float t   = 0.001;\n    for (int j=1; j<25; j++)\n    {\n        vec3 p = r0 + t*rd;\n        float h = height_map( p.xy );\n        float height_diff = p.z - h;\n        if (height_diff<0.0)\n        {\n            return 0.0;\n        }\n        t += 0.01+height_diff*.02;\n        hit = min(hit, 2.*height_diff/t); // soft shaddow   \n    }\n    return hit;\n}\n\nvec3 CalcTerrain(vec2 uv, float height) {\n    vec3 col = terrain_map( uv );\n    vec2 iResolution = vec2(512.);\n    float h1 = height_map(uv-vec2(0., 0.5)/ iResolution.xy);\n    float h2 = height_map(uv+vec2(0., 0.5)/ iResolution.xy);\n    float h3 = height_map(uv-vec2(0.5, 0.)/ iResolution.xy);\n    float h4 = height_map(uv+vec2(0.5, 0.)/ iResolution.xy);\n    vec3 norm = normalize(vec3(h3-h4, h1-h2, 1.));\n    vec3 r0 = vec3(uv, height);\n    vec3 rd = normalize( light - r0 );\n    float grad = dot(norm, rd);\n    col *= grad+pow(grad, 8.);\n    float terrainshade = test_shadow( uv, height );\n    col = mix(col*.25, col, terrainshade);\n    return col;\n}\n\n\nvoid main() {\n  vec3 watercolor = u_watercolor.rgb;\n  vec3 watercolor2 = u_watercolor2.rgb;\n  vec2 uv = v_uv;\n  float WATER_LEVEL = 0.84; // Water level (range: 0.0 - 2.0)\n  float deepwater_fadedepth   = 0.4 + coast2water_fadedepth;\n  float height = height_map( uv );\n  vec3 col;\n\n    float waveheight = clamp(WATER_LEVEL*3.-1.5, 0., 1.);\n    float level = WATER_LEVEL + .2*water_map(uv*15. + vec2(u_time*.1), waveheight);\n    if (height > level)\n    {\n        col = CalcTerrain(uv, height);\n    }\n    if (height <= level)\n    {\n        vec2 dif = vec2(.0, .01);\n        vec2 pos = uv*15. + vec2(u_time*.01);\n        float h1 = water_map(pos-dif,waveheight);\n        float h2 = water_map(pos+dif,waveheight);\n        float h3 = water_map(pos-dif.yx,waveheight);\n        float h4 = water_map(pos+dif.yx,waveheight);\n        vec3 normwater = normalize(vec3(h3-h4, h1-h2, .125)); // norm-vector of the 'bumpy' water-plane\n        uv += normwater.xy*.002*(level-height);\n        \n        col = CalcTerrain(uv, height);\n\n        float coastfade = clamp((level-height)/coast2water_fadedepth, 0., 1.);\n        float coastfade2= clamp((level-height)/deepwater_fadedepth, 0., 1.);\n        float intensity = col.r*.2126+col.g*.7152+col.b*.0722;\n        watercolor = mix(watercolor*intensity, watercolor2, smoothstep(0., 1., coastfade2));\n\n        vec3 r0 = vec3(uv, WATER_LEVEL);\n        vec3 rd = normalize( light - r0 ); // ray-direction to the light from water-position\n        float grad     = dot(normwater, rd); // dot-product of norm-vector and light-direction\n        float specular = pow(grad, water_softlight_fact);  // used for soft highlights                          \n        float specular2= pow(grad, water_glossylight_fact); // used for glossy highlights\n        float gradpos  = dot(vec3(0., 0., 1.), rd);\n        float specular1= smoothstep(0., 1., pow(gradpos, 5.));  // used for diffusity (some darker corona around light's specular reflections...)                          \n        float watershade  = test_shadow( uv, level );\n        watercolor *= 2.2+watershade;\n        watercolor += (.2+.8*watershade) * ((grad-1.0)*.5+specular) * .25;\n        watercolor /= (1.+specular1*1.25);\n        watercolor += watershade*specular2*water_specularcolor;\n        watercolor += watershade*coastfade*(1.-coastfade2)*(vec3(.5, .6, .7)*nautic(uv)+vec3(1., 1., 1.)*particles(uv));\n        \n        col = mix(col, watercolor, coastfade);\n    }\n    \n  outputColor = vec4(col, v_opacity);  \n}\n",defines:e.getDefines(),inject:e.getInject(),triangulation:d1,primitive:ic.TRIANGLES,depth:{enable:!1}}))]})()}clearModels(){var e,t,r;null===(e=this.texture1)||void 0===e||e.destroy(),null===(t=this.texture2)||void 0===t||t.destroy(),null===(r=this.texture3)||void 0===r||r.destroy()}registerBuiltinAttributes(){let[e,t,r,n]=this.layer.getSource().extent,i=r-e,o=n-t;this.styleAttributeService.registerStyleAttribute({name:"oceanUv",type:iR.Attribute,descriptor:{name:"a_uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:ic.STATIC_DRAW,data:[],type:ic.FLOAT},size:2,update:(r,n,a)=>{let[s,l]=a;return[(s-e)/i,(l-t)/o]}}})}loadTexture(){let{createTexture2D:e}=this.rendererService,t={height:0,width:0};function r(t){return e({data:t,width:t.width,height:t.height,wrapS:ic.MIRRORED_REPEAT,wrapT:ic.MIRRORED_REPEAT,min:ic.LINEAR,mag:ic.LINEAR})}this.texture1=e(t),this.texture2=e(t),this.texture3=e(t),function(e){let t=0,r=[];["https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*MJ22QbpuCzIAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*-z2HSIVDsHIAAAAAAAAAAAAAARQnAQ"].map(n=>{let i=new Image;i.crossOrigin="",i.src=n,r.push(i),i.onload=()=>{3==++t&&e(r)}})}(e=>{this.texture1=r(e[0]),this.texture2=r(e[1]),this.texture3=r(e[2]),this.layerService.reRender()})}}class pN extends dh{constructor(...e){super(...e),ia(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){let e=this.getCommonUniformsInfo(),t=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),il(il({},e.uniformsOption),t.uniformsOption)}getCommonUniformsInfo(){let{speed:e=.5}=this.layer.getLayerConfig(),t={u_speed:e,u_time:this.layer.getLayerAnimateTime(),u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(t)}getAnimateUniforms(){return{u_time:this.layer.getLayerAnimateTime()}}initModels(){var e=this;return iG(function*(){return e.loadTexture(),e.buildModels()})()}buildModels(){var e=this;return iG(function*(){return e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:"polygonWater",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_uv;\n\nlayout(std140) uniform commonUniforms {\n  float u_speed;\n  float u_time;\n};\nout vec4 v_Color;\nout vec2 v_uv;\n\n#pragma include "projection"\n\nvoid main() {\n  v_uv = a_uv;\n  v_Color = a_Color;\n  v_Color.a *= opacity;\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n}\n\n',fragmentShader:"uniform sampler2D u_texture;\nlayout(std140) uniform commonUniforms {\n  float u_speed;\n  float u_time;\n};\n\nout vec4 outputColor;\n\n\nin vec4 v_Color;\nin vec2 v_uv;\n\nfloat rand(vec2 n) { return 0.5 + 0.5 * fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453); }\n\nfloat water(vec3 p) {\n  float t = u_time * u_speed;\n  p.z += t * 2.; p.x += t * 2.;\n  vec3 c1 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;\n  p.z += t * 3.; p.x += t * 0.52;\n  vec3 c2 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;\n  p.z += t * 4.; p.x += t * 0.8;\n  vec3 c3 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;\n  c1 += c2 - c3;\n  float z = (c1.x + c1.y + c1.z) / 3.;\n  return p.y + z / 4.;\n}\n\nfloat map(vec3 p) {\n  float d = 100.0;\n  d = water(p);\n  return d;\n}\n\nfloat intersect(vec3 ro, vec3 rd) {\n  float d = 0.0;\n  for (int i = 0; i <= 100; i++) {\n    float h = map(ro + rd * d);\n    if (h < 0.1) return  d;\n    d += h;\n  }\n  return 0.0;\n}\n\nvec3 norm(vec3 p) {\n  float eps = .1;\n  return normalize(vec3(\n    map(p + vec3(eps, 0, 0)) - map(p + vec3(-eps, 0, 0)),\n    map(p + vec3(0, eps, 0)) - map(p + vec3(0, -eps, 0)),\n    map(p + vec3(0, 0, eps)) - map(p + vec3(0, 0, -eps))\n  ));\n} \n\nfloat calSpc() {\n  vec3 l1 = normalize(vec3(1, 1, 1));\n  vec3 ro = vec3(-3, 20, -8);\n  vec3 rc = vec3(0, 0, 0);\n  vec3 ww = normalize(rc - ro);\n  vec3 uu = normalize(cross(vec3(0,1,0), ww));\n  vec3 vv = normalize(cross(rc - ro, uu));\n  vec3 rd = normalize(uu * v_uv.x + vv * v_uv.y + ww);\n  float d = intersect(ro, rd);\n  vec3 p = ro + rd * d;\n  vec3 n = norm(p);\n  float spc = pow(max(0.0, dot(reflect(l1, n), rd)), 30.0);\n  return spc;\n}\n\nvoid main() {\n\n  outputColor = v_Color;\n  float spc = calSpc();\n  outputColor += spc * 0.4;\n}\n",triangulation:d1,defines:e.getDefines(),inject:e.getInject(),primitive:ic.TRIANGLES,depth:{enable:!1},pickingEnabled:!1,diagnosticDerivativeUniformityEnabled:!1}))]})()}clearModels(){var e;null===(e=this.texture)||void 0===e||e.destroy()}registerBuiltinAttributes(){let[e,t,r,n]=this.layer.getSource().extent,i=r-e,o=n-t;this.styleAttributeService.registerStyleAttribute({name:"waterUv",type:iR.Attribute,descriptor:{name:"a_uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:ic.STATIC_DRAW,data:[],type:ic.FLOAT},size:2,update:(r,n,a)=>{let[s,l]=a;return[(s-e)/i,(l-t)/o]}}})}loadTexture(){let{waterTexture:e}=this.layer.getLayerConfig(),{createTexture2D:t}=this.rendererService;this.texture=t({height:1,width:1});let r=new Image;r.crossOrigin="",e?(console.warn("L7 recommend：https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ"),r.src=e):r.src="https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ",r.onload=()=>{this.texture=t({data:r,width:r.width,height:r.height,wrapS:ic.MIRRORED_REPEAT,wrapT:ic.MIRRORED_REPEAT,min:ic.LINEAR,mag:ic.LINEAR}),this.layerService.reRender()}}}let pD={fill:pR,line:pc,extrude:pI,text:pM,point_fill:pm,point_image:pv,point_normal:p_,point_extrude:pg,water:pN,ocean:pk,extrusion:pP};class pU extends dt{constructor(...e){super(...e),ia(this,"type","PolygonLayer"),ia(this,"enableShaderEncodeStyles",["opacity","extrusionBase","rotation","offsets","stroke"])}buildModels(){var e=this;return iG(function*(){let t=e.getModelType();e.layerModel=new pD[t](e),yield e.initLayerModels()})()}getModelType(){var e;let t=this.styleAttributeService.getLayerStyleAttribute("shape"),r=null==t||null===(e=t.scale)||void 0===e?void 0:e.field;return"fill"!==r&&r?"extrude"===r?"extrude":"extrusion"===r?"extrusion":"water"===r?"water":"ocean"===r?"ocean":"line"===r?"line":this.getPointModelType():"fill"}getPointModelType(){let e=this.getEncodedData(),{shape2d:t,shape3d:r}=this.getLayerConfig(),n=this.iconService.getIconMap(),i=e.find(e=>e.hasOwnProperty("shape"));if(!i)return"fill";{let e=i.shape;return"dot"===e?"point_normal":(null==t?void 0:t.indexOf(e))!==-1?"point_fill":(null==r?void 0:r.indexOf(e))!==-1?"point_extrude":n.hasOwnProperty(e)?"point_image":"text"}}}class pz{constructor({rendererService:e,layerService:t,parent:r}){ia(this,"tileResource",new Map),ia(this,"rendererService",void 0),ia(this,"layerService",void 0),ia(this,"parent",void 0),ia(this,"layerTiles",[]),this.rendererService=e,this.layerService=t,this.parent=r}get tiles(){return this.layerTiles}hasTile(e){return this.layerTiles.some(t=>t.key===e)}addTile(e){this.layerTiles.push(e)}getTile(e){return this.layerTiles.find(t=>t.key===e)}getVisibleTileBylngLat(e){return this.layerTiles.find(t=>t.isLoaded&&t.visible&&t.lnglatInBounds(e))}removeTile(e){let t=this.layerTiles.findIndex(t=>t.key===e),r=this.layerTiles.splice(t,1);r[0]&&r[0].destroy()}updateTileVisible(e){let t=this.getTile(e.key);if(e.isVisible){if(e.parent){let r=this.isChildrenLoaded(e.parent);null==t||t.updateVisible(r)}else null==t||t.updateVisible(!0)}else if(e.parent){let r=this.isChildrenLoaded(e.parent);null==t||t.updateVisible(!r)}else null==t||t.updateVisible(!1)}isParentLoaded(e){let t=e.parent;if(!t)return!0;let r=this.getTile(null==t?void 0:t.key);return null!=r&&!!r.isLoaded}isChildrenLoaded(e){let t=null==e?void 0:e.children;return 0===t.length||t.every(e=>{let t=this.getTile(null==e?void 0:e.key);return!t||(null==t?void 0:t.isLoaded)===!0})}render(){var e=this;return iG(function*(){var t;let r=e.getRenderLayers().map((t=iG(function*(t){yield e.layerService.renderTileLayer(t)}),function(e){return t.apply(this,arguments)}));yield Promise.all(r)})()}getRenderLayers(){let e=this.layerTiles.filter(e=>e.visible&&e.isLoaded),t=[];return e.map(e=>t.push(...e.getLayers())),t}getLayers(){let e=this.layerTiles.filter(e=>e.isLoaded),t=[];return e.map(e=>t.push(...e.getLayers())),t}getTiles(){return this.layerTiles}destroy(){this.layerTiles.forEach(e=>e.destroy()),this.tileResource.clear()}}var pB=r(48704);let pF=function(e,t,r){void 0===r&&(r={});var n,i,o=C(e),a=C(t),s=pB.union(o.coordinates,a.coordinates);return 0===s.length?null:1===s.length?E(s[0],r.properties):(n=r.properties,void 0===i&&(i={}),A({type:"MultiPolygon",coordinates:s},n,i))};class pj{getCombineFeature(e){let t=null,r=e[0];return e.map(e=>{let r=E(e.coordinates);t=null===t?r:pF(t,r)}),r&&(t.properties=il({},r)),t}}let pV="select",pH="active";class pG{constructor({layerService:e,tileLayerService:t,parent:r}){ia(this,"layerService",void 0),ia(this,"tileLayerService",void 0),ia(this,"tileSourceService",void 0),ia(this,"parent",void 0),ia(this,"tilePickID",new Map),this.layerService=e,this.tileLayerService=t,this.parent=r,this.tileSourceService=new pj}pickRender(e){let t=this.tileLayerService.getVisibleTileBylngLat(e.lngLat);if(t){let r=t.getMainLayer();null==r||r.layerPickService.pickRender(e)}}pick(e,t){var r=this;return iG(function*(){let n=r.parent.getContainer().pickingService;if("RasterLayer"===e.type){let e=r.tileLayerService.getVisibleTileBylngLat(t.lngLat);if(e&&void 0!==e.getMainLayer()){let n=e.getMainLayer();return n.layerPickService.pickRasterLayer(n,t,r.parent)}return!1}return r.pickRender(t),n.pickFromPickingFBO(e,t)})()}selectFeature(e){let[t,r,n]=e,i=this.color2PickId(t,r,n);this.tilePickID.set(pV,i),this.updateHighLight(t,r,n,pV)}highlightPickedFeature(e){let[t,r,n]=e,i=this.color2PickId(t,r,n);this.tilePickID.set(pH,i),this.updateHighLight(t,r,n,pH)}updateHighLight(e,t,r,n){this.tileLayerService.tiles.map(i=>{let o=i.getMainLayer();switch(n){case pV:null==o||o.hooks.beforeSelect.call([e,t,r]);break;case pH:null==o||o.hooks.beforeHighlight.call([e,t,r])}})}setPickState(){let e=this.tilePickID.get(pV),t=this.tilePickID.get(pH);if(e){let[t,r,n]=this.pickId2Color(e);this.updateHighLight(t,r,n,pV);return}if(t){let[e,r,n]=this.pickId2Color(t);this.updateHighLight(e,r,n,pH);return}}color2PickId(e,t,r){return ew(new Uint8Array([e,t,r]))}pickId2Color(e){return eL(e)}getFeatureById(e){let t=this.tileLayerService.getTiles().filter(e=>e.visible),r=[];return t.forEach(t=>{r.push(...t.getFeatureById(e))}),r}pickRasterLayer(){return!1}}function pW(e){let t=e.coordinates;return{vertices:[...t],indices:[0],size:t.length}}class pX extends dh{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9})}getDefaultStyle(){return{blend:"additive"}}getCommonUniformsInfo(){let{blend:e,strokeOpacity:t=1,strokeWidth:r=0,stroke:n="#fff"}=this.layer.getLayerConfig(),i={u_stroke_color:eC(n),u_additive:"additive"===e?1:0,u_stroke_opacity:t,u_stroke_width:r};return this.getUniformsBufferInfo(i)}initModels(){var e=this;return iG(function*(){return e.buildModels()})()}buildModels(){var e=this;return iG(function*(){return e.layer.triangulation=pW,e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:"pointSimple",vertexShader:'\nlayout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\n\nlayout(std140) uniform commonUniorm {\n  vec4 u_stroke_color;\n  float u_additive;\n  float u_stroke_opacity;\n  float u_stroke_width;\n};\n\nout vec4 v_color;\nout float v_blur;\nout float v_innerRadius;\n\n#pragma include "projection"\n#pragma include "picking"\n#pragma include "project"\nvoid main() {\n  v_color = vec4(a_Color.xyz, a_Color.w * opacity);\n  v_blur = 1.0 - max(2.0 / a_Size, 0.05);\n  v_innerRadius = max((a_Size - u_stroke_width) / a_Size, 0.0);\n\n  vec2 offset = project_pixel(u_offsets);\n\n  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);\n  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));\n\n  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'\nlayout(std140) uniform commonUniorm {\n  vec4 u_stroke_color;\n  float u_additive;\n  float u_stroke_opacity;\n  float u_stroke_width;\n};\n\nin vec4 v_color;\nin float v_blur;\nin float v_innerRadius;\n\nout vec4 outputColor;\n\n#pragma include "picking"\nvoid main() {\n  vec2 center = vec2(0.5);\n\n  // Tip: 片元到中心点的距离 0 - 1\n  float fragmengTocenter = distance(center, gl_PointCoord) * 2.0;\n  // Tip: 片元的剪切成圆形\n  float circleClipOpacity = 1.0 - smoothstep(v_blur, 1.0, fragmengTocenter);\n\n\n  if(v_innerRadius < 0.99) {\n    // 当存在 stroke 且 stroke > 0.01\n    float blurWidth = (1.0 - v_blur)/2.0;\n    vec4 stroke = vec4(u_stroke_color.rgb, u_stroke_opacity);\n    if(fragmengTocenter > v_innerRadius + blurWidth) {\n      outputColor = stroke;\n    } else if(fragmengTocenter > v_innerRadius - blurWidth){\n      float mixR = (fragmengTocenter - (v_innerRadius - blurWidth)) / (blurWidth * 2.0);\n      outputColor = mix(v_color, stroke, mixR);\n    } else {\n      outputColor = v_color;\n    }\n  } else {\n    // 当不存在 stroke 或 stroke <= 0.01\n    outputColor = v_color;\n  }\n\n  outputColor = filterColor(outputColor);\n  \n  if(u_additive > 0.0) {\n    outputColor *= circleClipOpacity;\n  } else {\n    outputColor.a *= circleClipOpacity;\n  }\n\n}\n',defines:e.getDefines(),inject:e.getInject(),triangulation:pW,depth:{enable:!1},primitive:ic.POINTS}))]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:iR.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:1,update:e=>{let{size:t=1}=e;return Array.isArray(t)?[t[0]]:[t]}}})}}let{isNumber:p$}=th;class pZ extends dh{constructor(...e){super(...e),ia(this,"raiseCount",0),ia(this,"raiseRepeat",0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,POS:10,NORMAL:11})}getCommonUniformsInfo(){let{animateOption:e={enable:!1,speed:.01,repeat:!1},opacity:t=1,sourceColor:r,targetColor:n,pickLight:i=!1,heightfixed:o=!0,opacityLinear:a={enable:!1,dir:"up"},lightEnable:s=!0}=this.layer.getLayerConfig(),l=0,u=[0,0,0,0],c=[0,0,0,0];if(r&&n&&(u=eC(r),c=eC(n),l=1),this.raiseCount<1&&this.raiseRepeat>0&&e.enable){let{speed:t=.01}=e;this.raiseCount+=t,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}let h={u_sourceColor:u,u_targetColor:c,u_linearColor:l,u_pickLight:Number(i),u_heightfixed:Number(o),u_r:e.enable&&this.raiseRepeat>0?this.raiseCount:1,u_opacity:p$(t)?t:1,u_opacitylinear:Number(a.enable),u_opacitylinear_dir:"up"===a.dir?1:0,u_lightEnable:Number(s)};return this.getUniformsBufferInfo(h)}initModels(){var e=this;return iG(function*(){return e.initUniformsBuffer(),e.buildModels()})()}buildModels(){var e=this;return iG(function*(){let{animateOption:{repeat:t=1}}=e.layer.getLayerConfig();return e.raiseRepeat=t,[(yield e.layer.buildLayerModel({moduleName:"pointEarthExtrude",vertexShader:'precision highp float;\n\n#define pi 3.1415926535\n#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\nlayout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in vec3 a_Size;\nlayout(location = ATTRIBUTE_LOCATION_POS) in vec3 a_Pos;\nlayout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;\n\nlayout(std140) uniform commonUniform {\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  float u_linearColor: 0;\n  float u_heightfixed: 0.0; // 默认不固定\n  float u_globel;\n  float u_r;\n  float u_pickLight: 0.0;\n  float u_opacitylinear: 0.0;\n  float u_opacitylinear_dir: 1.0;\n  float u_lightEnable: 1.0;\n};\n\nout vec4 v_color;\nout float v_lightWeight;\nout float v_barLinearZ;\n// 用于将在顶点着色器中计算好的样式值传递给片元\n\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nfloat getYRadian(float x, float z) {\n  if(x > 0.0 && z > 0.0) {\n    return atan(x/z);\n  } else if(x > 0.0 && z <= 0.0){\n    return atan(-z/x) + pi/2.0;\n  } else if(x <= 0.0 && z <= 0.0) {\n    return  pi + atan(x/z); //atan(x/z) +\n  } else {\n    return atan(z/-x) + pi*3.0/2.0;\n  }\n}\n\nfloat getXRadian(float y, float r) {\n  return atan(y/r);\n}\n\nvoid main() {\n\n  // cal style mapping - 数据纹理映射部分的计算\n  vec3 size = a_Size * a_Position;\n\n  // a_Position.z 是在构建网格的时候传入的标准值 0 - 1，在插值器插值可以获取 0～1 线性渐变的值\n  v_barLinearZ =  a_Position.z;\n\n  vec3 offset = size; // 控制圆柱体的大小 - 从标准单位圆柱体进行偏移\n  if(u_heightfixed < 1.0) { // 圆柱体不固定高度\n    //\n  } else {// 圆柱体固定高度 （ 处理 mapbox ）\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);\n    }\n  }\n\n\n  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));\n\n  // u_r 控制圆柱的生长\n  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);\n\n  // 圆柱光照效果\n  float lightWeight = 1.0;\n  if(u_lightEnable > 0.0) { // 取消三元表达式，增强健壮性\n    lightWeight = calc_lighting(pos);\n  }\n  v_lightWeight = lightWeight;\n  // 设置圆柱的底色\n  if(u_linearColor == 1.0) { // 使用渐变颜色\n    v_color = mix(u_sourceColor, u_targetColor, v_barLinearZ);\n    v_color.rgb *= lightWeight;\n  } else { // 使用 color 方法传入的颜色\n     v_color = a_Color;\n  }\n  v_color.a *= u_opacity;\n\n\n  // 在地球模式下，将原本垂直于 xy 平面的圆柱调整姿态到适应圆的角度\n  //旋转矩阵mx，创建绕x轴旋转矩阵\n  float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);\n  float xRadian = getXRadian(a_Pos.y, r);\n  float xcos = cos(xRadian);//求解旋转角度余弦值\n  float xsin = sin(xRadian);//求解旋转角度正弦值\n  mat4 mx = mat4(\n    1,0,0,0,\n    0,xcos,-xsin,0,\n    0,xsin,xcos,0,\n    0,0,0,1);\n\n  //旋转矩阵my，创建绕y轴旋转矩阵\n  float yRadian = getYRadian(a_Pos.x, a_Pos.z);\n  float ycos = cos(yRadian);//求解旋转角度余弦值\n  float ysin = sin(yRadian);//求解旋转角度正弦值\n  mat4 my = mat4(\n    ycos,0,-ysin,0,\n    0,1,0,0,\n    ysin,0,ycos,0,\n    0,0,0,1);\n\n  gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);\n\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'precision highp float;\nin vec4 v_color;\n\n#pragma include "picking"\n\nlayout(std140) uniform commonUniform {\n  vec4 u_sourceColor;\n  vec4 u_targetColor;\n  float u_linearColor: 0;\n  float u_heightfixed: 0.0; // 默认不固定\n  float u_globel;\n  float u_r;\n  float u_pickLight: 0.0;\n  float u_opacitylinear: 0.0;\n  float u_opacitylinear_dir: 1.0;\n  float u_lightEnable: 1.0;\n};\nin float v_lightWeight;\nin float v_barLinearZ;\nout vec4 outputColor;\nvoid main() {\n\n   outputColor = v_color;\n\n  // 开启透明度渐变\n  if(u_opacitylinear > 0.0) {\n    outputColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - v_barLinearZ): v_barLinearZ;\n  }\n\n  // picking\n  if(u_pickLight > 0.0) {\n    outputColor = filterColorAlpha(outputColor, v_lightWeight);\n  } else {\n    outputColor = filterColor(outputColor);\n  }\n}\n',triangulation:dY,depth:{enable:!0},defines:e.getDefines(),inject:e.getInject(),cull:{enable:!0,face:ic.FRONT},blend:e.getBlend()}))]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:iR.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:3,update:e=>{let{size:t}=e;if(!t)return[2,2,2];{let e=[];return Array.isArray(t)&&(e=2===t.length?[t[0],t[0],t[1]]:t),Array.isArray(t)||(e=[t,t,t]),e}}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:iR.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:ic.STATIC_DRAW,data:[],type:ic.FLOAT},size:3,update:(e,t,r,n,i)=>i}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:iR.Attribute,descriptor:{name:"a_Pos",shaderLocation:this.attributeLocation.POS,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:3,update:e=>{let t=tk(e.coordinates);return dp([t[0],t[1]])}}})}}class pY extends dh{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,SHAPE:10,EXTRUDE:11})}getCommonUniformsInfo(){let{strokeOpacity:e=1,strokeWidth:t=0,blend:r,blur:n=0}=this.layer.getLayerConfig();return this.layer.getLayerConfig(),this.getUniformsBufferInfo({u_additive:"additive"===r?1:0,u_stroke_opacity:e,u_stroke_width:t,u_blur:n})}initModels(){var e=this;return iG(function*(){return e.initUniformsBuffer(),e.buildModels()})()}buildModels(){var e=this;return iG(function*(){return e.layer.triangulation=dZ,[(yield e.layer.buildLayerModel({moduleName:"pointEarthFill",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\nlayout(location = ATTRIBUTE_LOCATION_SHAPE) in float a_Shape;\nlayout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;\n\nlayout(std140) uniform commonUniform {\n  float u_additive;\n  float u_stroke_opacity : 1;\n  float u_stroke_width : 2;\n  float u_blur : 0.0;\n};\nout vec4 v_data;\nout vec4 v_color;\nout float v_radius;\n\n#pragma include "projection"\n#pragma include "picking"\n\n\nvoid main() {\n  vec3 extrude = a_Extrude;\n  float shape_type = a_Shape;\n  /*\n  *  setPickingSize 设置拾取大小\n  */\n  float newSize = setPickingSize(a_Size);\n  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;\n\n  // unpack color(vec2)\n  v_color = a_Color;\n\n  // radius(16-bit)\n  v_radius = newSize;\n\n  // anti-alias\n  //  float antialiased_blur = -max(u_blur, antialiasblur);\n  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);\n\n  // TODP: /abs(extrude.x) 是为了兼容地球模式\n  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);\n\n  gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1 + vec3(u_offsets,0.0), 1.0);\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:"in vec4 v_data;\nin vec4 v_color;\nin float v_radius;\n\nlayout(std140) uniform commonUniform {\n  float u_additive;\n  float u_stroke_opacity : 1;\n  float u_stroke_width : 2;\n  float u_blur : 0.0;\n};\n#pragma include \"sdf_2d\"\n#pragma include \"picking\"\n\nout vec4 outputColor;\n\nvoid main() {\n  int shape = int(floor(v_data.w + 0.5));\n\n  vec4 strokeColor = u_stroke == vec4(0.0) ? v_color : u_stroke;\n\n  lowp float antialiasblur = v_data.z;\n  float r = v_radius / (v_radius + u_stroke_width);\n\n  float outer_df;\n  float inner_df;\n  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'\n  if (shape == 0) {\n    outer_df = sdCircle(v_data.xy, 1.0);\n    inner_df = sdCircle(v_data.xy, r);\n  } else if (shape == 1) {\n    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);\n    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);\n  } else if (shape == 2) {\n    outer_df = sdBox(v_data.xy, vec2(1.));\n    inner_df = sdBox(v_data.xy, vec2(r));\n  } else if (shape == 3) {\n    outer_df = sdPentagon(v_data.xy, 0.8);\n    inner_df = sdPentagon(v_data.xy, r * 0.8);\n  } else if (shape == 4) {\n    outer_df = sdHexagon(v_data.xy, 0.8);\n    inner_df = sdHexagon(v_data.xy, r * 0.8);\n  } else if (shape == 5) {\n    outer_df = sdOctogon(v_data.xy, 1.0);\n    inner_df = sdOctogon(v_data.xy, r);\n  } else if (shape == 6) {\n    outer_df = sdHexagram(v_data.xy, 0.52);\n    inner_df = sdHexagram(v_data.xy, r * 0.52);\n  } else if (shape == 7) {\n    outer_df = sdRhombus(v_data.xy, vec2(1.0));\n    inner_df = sdRhombus(v_data.xy, vec2(r));\n  } else if (shape == 8) {\n    outer_df = sdVesica(v_data.xy, 1.1, 0.8);\n    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);\n  }\n\n  if(outer_df > antialiasblur + 0.018) discard;\n\n  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);\n\n  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(\n    antialiasblur,\n    0.0,\n    inner_df\n  );\n\n  if(u_stroke_width < 0.01) {\n    outputColor = vec4(v_color.rgb, v_color.a * u_opacity);\n  } else {\n    outputColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);\n  }\n\n  if(u_additive > 0.0) {\n    outputColor *= opacity_t;\n    outputColor = filterColorAlpha(outputColor, outputColor.a);\n  } else {\n    outputColor.a *= opacity_t;\n    outputColor = filterColor(outputColor);\n  }\n}\n",triangulation:dZ,defines:e.getDefines(),inject:e.getInject(),depth:{enable:!0},blend:e.getBlend()}))]})()}animateOption2Array(e){return[e.enable?0:1,e.speed||1,e.rings||3,0]}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"extrude",type:iR.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:3,update:(e,t,r,n)=>{let[i,o,a]=r,s=dF(0,0,1),l=dF(i,0,a),u=i>=0?dH(s,l):2*Math.PI-dH(s,l),c=2*Math.PI-Math.asin(o/100),h=i$();iJ(h,h,u),iQ(h,h,c);let d=dF(1,1,0);dV(d,d,h),dj(d,d);let p=dF(-1,1,0);dV(p,p,h),dj(p,p);let f=dF(-1,-1,0);dV(f,f,h),dj(f,f);let g=dF(1,-1,0);dV(g,g,h),dj(g,g);let m=[...d,...p,...f,...g],v=n%4*3;return[m[v],m[v+1],m[v+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:iR.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:1,update:e=>{let{size:t=5}=e;return Array.isArray(t)?[t[0]]:[t]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:iR.Attribute,descriptor:{name:"a_Shape",shaderLocation:this.attributeLocation.SHAPE,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:1,update:e=>{let{shape:t=2}=e;return[this.layer.getLayerConfig().shape2d.indexOf(t)]}}})}}class pq extends dh{constructor(...e){super(...e),ia(this,"meter2coord",1),ia(this,"texture",void 0),ia(this,"isMeter",!1),ia(this,"radian",0),ia(this,"updateTexture",()=>{let{createTexture2D:e}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),this.layerService.throttleRenderLayers();return}this.texture=e({data:this.iconService.getCanvas(),mag:ic.LINEAR,min:ic.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128,mipmap:!0}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10,UV:11})}getCommonUniformsInfo(){let{raisingHeight:e=0,heightfixed:t=!1,unit:r="pixel"}=this.layer.getLayerConfig();if(this.rendererService.getDirty()){var n;null===(n=this.texture)||void 0===n||n.bind()}let i={u_textSize:[1024,this.iconService.canvasHeight||128],u_heightfixed:Number(t),u_raisingHeight:Number(e),u_size_unit:pu[r]};return this.getUniformsBufferInfo(i)}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),d$)}initModels(){var e=this;return iG(function*(){return e.iconService.on("imageUpdate",e.updateTexture),e.updateTexture(),e.buildModels()})()}buildModels(){var e=this;return iG(function*(){return e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:"pointFillImage",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\nlayout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;\n\nlayout(std140) uniform commonUniform {\n  vec2 u_textSize;\n  float u_heightfixed;\n  float u_raisingHeight;\n  float u_size_unit;\n};\n\nout vec2 v_uv;\nout vec2 v_Iconuv;\nout float v_opacity;\n\n#pragma include "projection"\n#pragma include "picking"\n#pragma include "rotation_2d"\n\nvoid main() {\n  vec3 extrude = a_Extrude;\n  v_uv = (a_Extrude.xy + 1.0) / 2.0;\n  v_uv.y = 1.0 - v_uv.y;\n  v_Iconuv = a_Uv;\n  v_opacity = opacity;\n  float newSize = a_Size;\n  if (u_size_unit == 1.0) {\n    newSize = newSize * u_PixelsPerMeter.z;\n  }\n\n  // vec2 offset = (u_RotateMatrix * extrude.xy * (a_Size) + textrueOffsets);\n  vec2 offset = extrude.xy * newSize + offsets;\n\n  offset = rotate_matrix(offset, rotation);\n\n  offset = project_pixel(offset);\n\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'in vec2 v_uv;// 本身的 uv 坐标\nin vec2 v_Iconuv;\nin float v_opacity;\nout vec4 outputColor;\n\nuniform sampler2D u_texture;\nlayout(std140) uniform commonUniform {\n  vec2 u_textSize;\n  float u_heightfixed: 0.0;\n  float u_raisingHeight: 0.0;\n  float u_size_unit;\n};\n\n#pragma include "scene_uniforms"\n#pragma include "sdf_2d"\n#pragma include "picking"\n\nvoid main() {\n  vec2 pos = v_Iconuv / u_textSize + v_uv / u_textSize * 64.;\n  outputColor = texture(SAMPLER_2D(u_texture), pos);\n  outputColor.a *= v_opacity;\n  outputColor = filterColor(outputColor);\n}\n',triangulation:d$,depth:{enable:!1},defines:e.getDefines(),inject:e.getInject(),cull:{enable:!0,face:ic.FRONT}}))]})()}clearModels(){var e;this.iconService.off("imageUpdate",this.updateTexture),null===(e=this.texture)||void 0===e||e.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:iR.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:2,update:e=>{let t=this.iconService.getIconMap(),{shape:r}=e,{x:n,y:i}=t[r]||{x:-64,y:-64};return[n,i]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:iR.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:3,update:(e,t,r,n)=>{let i=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],o=n%4*3;return[i[o],i[o+1],i[o+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:iR.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:1,update:e=>{let{size:t=5}=e;return Array.isArray(t)?[t[0]]:[t]}}})}}class pK extends dh{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10})}getCommonUniformsInfo(){let{blend:e,speed:t=1,unit:r="pixel"}=this.layer.getLayerConfig(),n={u_additive:"additive"===e?1:0,u_size_unit:pu[r],u_speed:t,u_time:this.layer.getLayerAnimateTime()};return this.getUniformsBufferInfo(n)}getAnimateUniforms(){return{}}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),d$)}initModels(){var e=this;return iG(function*(){return e.buildModels()})()}buildModels(){var e=this;return iG(function*(){return e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:"pointRadar",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;\nlayout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;\nlayout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;\n\nlayout(std140) uniform commonUniorm {\n  float u_additive;\n  float u_size_unit;\n  float u_speed: 1.0;\n  float u_time;\n};\n\nout vec4 v_data;\nout vec4 v_color;\nout float v_radius;\nout vec2 v_extrude;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  float newSize = setPickingSize(a_Size);\n\n  float time = u_time * u_speed;\n  mat2 rotateMatrix = mat2(\n    cos(time), sin(time),\n    -sin(time), cos(time)\n  );\n  v_extrude = rotateMatrix * a_Extrude.xy;\n\n  v_color = a_Color;\n  v_color.a *= opacity;\n\n  float blur = 0.0;\n  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, blur);\n\n  if(u_size_unit == 1.) {\n    newSize = newSize  * u_PixelsPerMeter.z;\n  }\n  v_radius = newSize;\n\n  vec2 offset = (a_Extrude.xy * (newSize));\n\n  offset = project_pixel(offset);\n\n  v_data = vec4(a_Extrude.x, a_Extrude.y, antialiasblur, -1.0);\n\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'\nlayout(std140) uniform commonUniorm{\n  float u_additive;\n  float u_size_unit;\n  float u_speed: 1.0;\n  float u_time;\n};\nin vec4 v_data;\nin vec4 v_color;\nin float v_radius;\nin vec2 v_extrude;\n#pragma include "sdf_2d"\n#pragma include "picking"\n\nout vec4 outputColor;\n\nvoid main() {\n\n  lowp float antialiasblur = v_data.z;\n  float r = v_radius / (v_radius);\n\n  float outer_df = sdCircle(v_data.xy, 1.0);\n  float inner_df = sdCircle(v_data.xy, r);\n\n  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);\n\n  outputColor = vec4(v_color.rgb, v_color.a);\n\n  if(u_additive > 0.0) {\n    outputColor *= opacity_t;\n  } else {\n    outputColor.a *= opacity_t;\n  }\n\n  if(outputColor.a > 0.0) {\n    outputColor = filterColor(outputColor);\n  }\n\n  vec2 extrude =  v_extrude;\n  vec2 dir = normalize(extrude);\n  vec2 baseDir = vec2(1.0, 0.0);\n  float pi = 3.14159265359;\n  float flag = sign(dir.y);\n  float rades = dot(dir, baseDir);\n  float radar_v = (flag - 1.0) * -0.5 * acos(rades)/pi;\n  // simple AA\n  if(radar_v > 0.99) {\n    radar_v = 1.0 - (radar_v - 0.99)/0.01;\n  }\n\n  outputColor.a *= radar_v;\n}\n',triangulation:d$,defines:e.getDefines(),inject:e.getInject(),depth:{enable:!1}}))]})()}animateOption2Array(e){return[e.enable?0:1,e.speed||1,e.rings||3,0]}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:iR.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:3,update:(e,t,r,n)=>{let i=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],o=n%4*3;return[i[o],i[o+1],i[o+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:iR.Attribute,descriptor:{shaderLocation:this.attributeLocation.SIZE,name:"a_Size",buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:1,update:e=>{let{size:t=5}=e;return Array.isArray(t)?[t[0]]:[t]}}})}}let pQ={fillImage:pq,fill:pm,radar:pK,image:pv,normal:p_,simplePoint:pX,extrude:pg,text:pM,earthFill:pY,earthExtrude:pZ};class pJ extends dt{constructor(...e){super(...e),ia(this,"type","PointLayer"),ia(this,"enableShaderEncodeStyles",["stroke","offsets","opacity","rotation"]),ia(this,"enableDataEncodeStyles",["textOffset","textAnchor"]),ia(this,"defaultSourceConfig",{data:[],options:{parser:{type:"json",x:"lng",y:"lat"}}})}buildModels(){var e=this;return iG(function*(){let t=e.getModelType();e.layerModel&&e.layerModel.clearModels(),e.layerModel=new pQ[t](e),yield e.initLayerModels()})()}rebuildModels(){var e=this;return iG(function*(){yield e.buildModels()})()}getModelTypeWillEmptyData(){if(this.shapeOption){let{field:e,values:t}=this.shapeOption,{shape2d:r}=this.getLayerConfig(),n=this.iconService.getIconMap();if(e&&(null==r?void 0:r.indexOf(e))!==-1)return"fill";if("text"===t)return"text";if(t&&t instanceof Array){for(let e of t)if("string"==typeof e&&n.hasOwnProperty(e))return"image"}}return"normal"}getDefaultConfig(){return({fillImage:{},normal:{blend:"additive"},radar:{},simplePoint:{},fill:{blend:"normal"},extrude:{},image:{},text:{blend:"normal"},tile:{},tileText:{},earthFill:{},earthExtrude:{}})[this.getModelType()]}getModelType(){let e=this.getEncodedData(),{shape2d:t,shape3d:r,billboard:n=!0}=this.getLayerConfig(),i=this.iconService.getIconMap(),o=e.find(e=>e.hasOwnProperty("shape"));if(!o)return this.getModelTypeWillEmptyData();{let e=o.shape;return"dot"===e?"normal":"simple"===e?"simplePoint":"radar"===e?"radar":"fillImage"===this.layerType||!1===n?"fillImage":(null==t?void 0:t.indexOf(e))!==-1?"GLOBEL"===this.mapService.version?"earthFill":"fill":(null==r?void 0:r.indexOf(e))!==-1?"GLOBEL"===this.mapService.version?"earthExtrude":"extrude":i.hasOwnProperty(e)?"image":"text"}}}class p0 extends tG.EventEmitter{constructor(e,t){super(),ia(this,"x",void 0),ia(this,"y",void 0),ia(this,"z",void 0),ia(this,"key",void 0),ia(this,"parent",void 0),ia(this,"sourceTile",void 0),ia(this,"visible",!0),ia(this,"layers",[]),ia(this,"isLoaded",!1),ia(this,"tileMaskLayers",[]),ia(this,"tileMask",void 0),this.parent=t,this.sourceTile=e,this.x=e.x,this.y=e.y,this.z=e.z,this.key=`${this.x}_${this.y}_${this.z}`}getLayers(){return this.layers}styleUpdate(...e){}lnglatInBounds(e){let[t,r,n,i]=this.sourceTile.bounds,{lng:o,lat:a}=e;return o>=t&&o<=n&&a>=r&&a<=i}getLayerOptions(){var e;let t=this.parent.getLayerConfig();return il(il({},t),{},{textAllowOverlap:!0,autoFit:!1,maskLayers:this.getMaskLayer(),tileMask:-1!==["PolygonLayer","LineLayer"].indexOf(this.parent.type),mask:t.mask||(null===(e=t.maskLayers)||void 0===e?void 0:e.length)!==0&&t.enableMask})}getMaskLayer(){let{maskLayers:e}=this.parent.getLayerConfig(),t=[];return null==e||e.forEach(e=>{if(!e.tileLayer)return t.push(e),e;let r=e.tileLayer.getTile(this.sourceTile.key),n=null==r?void 0:r.getLayers()[0];n&&t.push(n)}),t}addTileMask(){var e=this;return iG(function*(){let t=new pU({name:"mask",visible:!0,enablePicking:!1}).source({type:"FeatureCollection",features:[e.sourceTile.bboxPolygon]},{parser:{type:"geojson",featureId:"id"}}).shape("fill").color("#0f0").style({opacity:.5}),r=az(e.parent.container);t.setContainer(r),yield t.init(),e.tileMask=t;let n=e.getMainLayer();return void 0!==n&&(n.tileMask=t),t})()}addMask(e,t){var r=this;return iG(function*(){let n=az(r.parent.container);t.setContainer(n),yield t.init(),e.addMask(t),r.tileMaskLayers.push(t)})()}addLayer(e){var t=this;return iG(function*(){e.isTileLayer=!0;let r=az(t.parent.container);e.setContainer(r),t.layers.push(e),yield e.init()})()}updateVisible(e){this.visible=e,this.updateOptions("visible",e)}updateOptions(e,t){this.layers.forEach(r=>{r.updateLayerConfig({[e]:t})})}getMainLayer(){return this.layers[0]}getFeatures(e){return[]}getFeatureById(e){return[]}destroy(){var e;null===(e=this.tileMask)||void 0===e||e.destroy(),this.layers.forEach(e=>e.destroy())}}class p1 extends p0{initTileLayer(){var e=this;return iG(function*(){let t=e.getSourceOption(),r=t.data.features[0].properties,n=new pf().source(t.data,t.options).size(1).shape("line").color("red"),i=new pJ({minZoom:e.z-1,maxZoom:e.z+1,textAllowOverlap:!0}).source([r],{parser:{type:"json",x:"x",y:"y"}}).size(20).color("red").shape(e.key).style({stroke:"#fff",strokeWidth:2});yield e.addLayer(n),yield e.addLayer(i),e.isLoaded=!0})()}getSourceOption(){let e=this.parent.getSource();return{data:{type:"FeatureCollection",features:this.sourceTile.data.layers.testTile.features},options:{parser:{type:"geojson"},transforms:e.transforms}}}}class p2 extends dh{constructor(...e){super(...e),ia(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getCommonUniformsInfo(){let{opacity:e,brightness:t,contrast:r,saturation:n,gamma:i}=this.layer.getLayerConfig(),o={u_opacity:rh(e,1),u_brightness:rh(t,1),u_contrast:rh(r,1),u_saturation:rh(n,1),u_gamma:rh(i,1)};return this.textures=[this.texture],this.getUniformsBufferInfo(o)}initModels(){var e=this;return iG(function*(){return yield e.loadTexture(),e.buildModels()})()}clearModels(){var e;null===(e=this.texture)||void 0===e||e.destroy()}loadTexture(){var e=this;return iG(function*(){let{createTexture2D:t}=e.rendererService,r=e.layer.getSource(),n=yield r.data.images;e.texture=t({data:n[0],width:n[0].width,height:n[0].height,mag:ic.LINEAR,min:ic.LINEAR})})()}buildModels(){var e=this;return iG(function*(){return e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:"rasterImage",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;\n\nlayout(std140) uniform commonUniforms {\n    float u_opacity:1.0;\n    float u_brightness:1.0;\n    float u_contrast:1.0;\n    float u_saturation:1.0;\n    float u_gamma:1.0;\n};\n\nout vec2 v_texCoord;\n#pragma include "projection"\n\nvoid main() {\n  v_texCoord = a_Uv;\n  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));\n}\n',fragmentShader:"uniform sampler2D u_texture;\nlayout(std140) uniform commonUniforms {\n    float u_opacity:1.0;\n    float u_brightness:1.0;\n    float u_contrast:1.0;\n    float u_saturation:1.0;\n    float u_gamma:1.0;\n};\n\nin vec2 v_texCoord;\nout vec4 outputColor;\nvec3 setContrast(vec3 rgb, float contrast) {\n  vec3 color = mix(vec3(0.5), rgb, contrast);\n  color = clamp(color, 0.0, 1.0);\n  return color;\n}\nvec3 setSaturation(vec3 rgb, float adjustment) {\n  const vec3 grayVector = vec3(0.2125, 0.7154, 0.0721);\n  vec3 intensity = vec3(dot(rgb, grayVector));\n  vec3 color = mix(intensity, rgb, adjustment);\n  color = clamp(color, 0.0, 1.0);\n  return color;\n}\nvoid main() {\n  vec4 color = texture(SAMPLER_2D(u_texture),vec2(v_texCoord.x,v_texCoord.y));\n  //brightness\n  color.rgb = mix(vec3(0.0, 0.0, 0.0), color.rgb, u_brightness);\n  //contrast\n  color.rgb = setContrast(color.rgb, u_contrast);\n  // saturation\n  color.rgb = setSaturation(color.rgb, u_saturation);\n  // gamma\n  color.rgb = pow(color.rgb, vec3(u_gamma));\n  outputColor = color;\n  outputColor.a *= u_opacity;\n  if(outputColor.a < 0.01)\n    discard;\n}\n",defines:e.getDefines(),triangulation:d4,primitive:ic.TRIANGLES,blend:{enable:!0},depth:{enable:!1},pickingEnabled:!1}))]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:iR.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:2,update:(e,t,r)=>[r[3],r[4]]}})}}let p3={image:p2};class p4 extends dt{constructor(...e){super(...e),ia(this,"type","ImageLayer")}buildModels(){var e=this;return iG(function*(){let t=e.getModelType();e.layerModel=new p3[t](e),yield e.initLayerModels()})()}getDefaultConfig(){return({image:{}})[this.getModelType()]}getModelType(){return"image"}}class p5 extends p0{initTileLayer(){var e=this;return iG(function*(){let t=e.parent.getLayerAttributeConfig(),r=e.getLayerOptions(),n=e.getSourceOption(),i=new p4(il({},r)).source(n.data,n.options);t&&Object.keys(t).forEach(e=>{var r,n;i[e](null===(r=t[e])||void 0===r?void 0:r.field,null===(n=t[e])||void 0===n?void 0:n.values)}),yield e.addLayer(i),e.isLoaded=!0})()}getSourceOption(){let e=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:e.transforms}}}}class p6 extends dh{getUninforms(){let e=this.getCommonUniformsInfo(),t=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),il(il({},e.uniformsOption),t.uniformsOption)}getCommonUniformsInfo(){let{opacity:e=1,color:t="#000"}=this.layer.getLayerConfig(),r={u_color:eC(t),u_opacity:e||1};return this.getUniformsBufferInfo(r)}initModels(){var e=this;return iG(function*(){return e.buildModels()})()}buildModels(){var e=this;return iG(function*(){return e.initUniformsBuffer(),[(yield e.layer.buildLayerModel({moduleName:"mask",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\n\nlayout(std140) uniform commonUniorm {\n  vec4 u_color;\n  float u_opacity;\n};\n\n#pragma include "projection"\n\nvoid main() {\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n}\n\n',fragmentShader:"layout(std140) uniform commonUniorm {\n  vec4 u_color;\n  float u_opacity;\n};\n\nout vec4 outputColor;\n\nvoid main() {\n  outputColor = u_color;\n  outputColor.a *= u_opacity;\n}\n",defines:e.getDefines(),triangulation:d1,depth:{enable:!1},pick:!1}))]})()}clearModels(e=!0){e&&this.layerService.clear()}registerBuiltinAttributes(){return""}}let p7={fill:p6};class p8 extends dt{constructor(...e){super(...e),ia(this,"type","MaskLayer")}buildModels(){var e=this;return iG(function*(){let t=e.getModelType();e.layerModel=new p7[t](e),yield e.initLayerModels()})()}getModelType(){return"fill"}}class p9 extends p0{initTileLayer(){var e=this;return iG(function*(){let t=e.parent.getLayerAttributeConfig(),r=e.getLayerOptions(),n=e.getSourceOption(),i=new p8(il({},r)).source(n.data,n.options);t&&Object.keys(t).forEach(e=>{var r,n;i[e](null===(r=t[e])||void 0===r?void 0:r.field,null===(n=t[e])||void 0===n?void 0:n.values)}),yield e.addLayer(i),e.isLoaded=!0})()}getFeatures(e){return e?this.sourceTile.data.getTileData(e):[]}getSourceOption(){let e=this.parent.getSource(),{sourceLayer:t,featureId:r}=this.parent.getLayerConfig();return{data:{type:"FeatureCollection",features:this.getFeatures(t)},options:{parser:{type:"geojson",featureId:r},transforms:e.transforms}}}}class fe extends dh{constructor(...e){super(...e),ia(this,"texture",void 0),ia(this,"colorTexture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){let e=this.getCommonUniformsInfo(),t=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),il(il({},e.uniformsOption),t.uniformsOption)}getCommonUniformsInfo(){let{opacity:e=1,clampLow:t=!0,clampHigh:r=!0,noDataValue:n=-9999999,domain:i,rampColors:o}=this.layer.getLayerConfig(),a=i||eO(o);this.colorTexture=this.layer.textureService.getColorTexture(o,a);let s={u_domain:a,u_opacity:e||1,u_noDataValue:n,u_clampLow:t?1:0,u_clampHigh:(void 0!==r?r:t)?1:0,u_rasterTexture:this.texture,u_colorTexture:this.colorTexture};return this.textures=[this.texture,this.colorTexture],this.getUniformsBufferInfo(s)}getRasterData(e){return iG(function*(){if(Array.isArray(e.data))return{data:e.data,width:e.width,height:e.height};{let{rasterData:t,width:r,height:n}=yield e.data;return{data:Array.from(t),width:r,height:n}}})()}initModels(){var e=this;return iG(function*(){return e.buildModels()})()}buildModels(){var e=this;return iG(function*(){e.initUniformsBuffer();let t=e.layer.getSource(),{createTexture2D:r,queryVerdorInfo:n}=e.rendererService,i=t.data.dataArray[0],{data:o,width:a,height:s}=yield e.getRasterData(i);return e.texture=r({data:new Float32Array(o),width:a,height:s,format:"WebGL1"===n()?ic.LUMINANCE:ic.RED,type:ic.FLOAT,alignment:1}),[(yield e.layer.buildLayerModel({moduleName:"rasterImageData",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;\n\nlayout(std140) uniform commonUniforms {\n  vec2 u_domain;\n  float u_opacity;\n  float u_noDataValue;\n  float u_clampLow;\n  float u_clampHigh;\n};\n\nout vec2 v_texCoord;\n\n#pragma include "projection"\n\nvoid main() {\n  v_texCoord = a_Uv;\n  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));\n}\n',fragmentShader:"layout(std140) uniform commonUniforms {\n  vec2 u_domain;\n  float u_opacity;\n  float u_noDataValue;\n  float u_clampLow;\n  float u_clampHigh;\n};\n\nuniform sampler2D u_rasterTexture;\nuniform sampler2D u_colorTexture;\n\nin vec2 v_texCoord;\n\nbool isnan_emu(float x) { return (x > 0.0 || x < 0.0) ? x != x : x != 0.0; }\n\nout vec4 outputColor;\n\nvoid main() {\n  // Can use any component here since u_rasterTexture is under luminance format.\n  float value = texture(SAMPLER_2D(u_rasterTexture), vec2(v_texCoord.x, v_texCoord.y)).r;\n  if (value == u_noDataValue || isnan_emu(value)) {\n    discard;\n  } else if ((u_clampLow < 0.5 && value < u_domain[0]) || (u_clampHigh < 0.5 && value > u_domain[1])) {\n    discard;\n  } else {\n    float normalisedValue =(value - u_domain[0]) / (u_domain[1] - u_domain[0]);\n    vec4 color = texture(SAMPLER_2D(u_colorTexture), vec2(normalisedValue, 0));\n    \n    outputColor = color;\n    outputColor.a = outputColor.a * u_opacity ;\n    if (outputColor.a < 0.01)\n      discard;\n  }\n}\n",defines:e.getDefines(),triangulation:d4,primitive:ic.TRIANGLES,depth:{enable:!1},pickingEnabled:!1}))]})()}clearModels(){var e,t;null===(e=this.texture)||void 0===e||e.destroy(),null===(t=this.colorTexture)||void 0===t||t.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:iR.Attribute,descriptor:{shaderLocation:this.attributeLocation.UV,name:"a_Uv",buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:2,update:(e,t,r)=>[r[3],r[4]]}})}}let ft=["data"],fr=["rasterData"];class fn extends dh{constructor(...e){super(...e),ia(this,"texture",void 0),ia(this,"dataOption",{})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){let e=this.getCommonUniformsInfo(),t=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),il(il({},e.uniformsOption),t.uniformsOption)}getCommonUniformsInfo(){let{opacity:e=1,noDataValue:t=0}=this.layer.getLayerConfig(),{rMinMax:r=[0,255],gMinMax:n=[0,255],bMinMax:i=[0,255]}=this.dataOption,o={u_rminmax:r,u_gminmax:n,u_bminmax:i,u_opacity:e||1,u_noDataValue:t,u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(o)}getRasterData(e){var t=this;return iG(function*(){if(Array.isArray(e.data)){let{data:r}=e,n=ox(e,ft);return t.dataOption=n,il({data:r},n)}let r=yield e.data,{rasterData:n}=r,i=ox(r,fr);return(t.dataOption=i,Array.isArray(n))?il({data:n},i):il({data:Array.from(n)},i)})()}initModels(){var e=this;return iG(function*(){e.initUniformsBuffer();let t=e.layer.getSource(),{createTexture2D:r}=e.rendererService,n=t.data.dataArray[0],{data:i,width:o,height:a}=yield e.getRasterData(n);return e.texture=r({data:new Float32Array(i),width:o,height:a,format:ic.RGB,type:ic.FLOAT}),[(yield e.layer.buildLayerModel({moduleName:"rasterImageDataRGBA",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;\n\nlayout(std140) uniform commonUniforms {\n  vec2 u_rminmax;\n  vec2 u_gminmax;\n  vec2 u_bminmax;\n  float u_opacity;\n  float u_noDataValue;\n};\n\nout vec2 v_texCoord;\n\n#pragma include "projection"\n\nvoid main() {\n  v_texCoord = a_Uv;\n  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));\n}\n',fragmentShader:"uniform sampler2D u_texture;\nlayout(std140) uniform commonUniforms {\n vec2 u_rminmax;\n vec2 u_gminmax;\n vec2 u_bminmax;\n float u_opacity;\n float u_noDataValue;\n};\n\nin vec2 v_texCoord;\n\nout vec4 outputColor;\n\nvoid main() {\n\n  vec3 rgb = texture(SAMPLER_2D(u_texture),vec2(v_texCoord.x,v_texCoord.y)).rgb;\n\n  if(rgb == vec3(u_noDataValue)) {\n    outputColor = vec4(0.0, 0, 0, 0.0);\n  } else {\n    outputColor = vec4(rgb.r / (u_rminmax.y -u_rminmax.x), rgb.g /(u_gminmax.y -u_gminmax.x), rgb.b/ (u_bminmax.y - u_bminmax.x), u_opacity);\n  }\n\n  if(outputColor.a < 0.01)\n    discard;\n \n}",defines:e.getDefines(),triangulation:d4,primitive:ic.TRIANGLES,depth:{enable:!1},pickingEnabled:!1}))]})()}buildModels(){var e=this;return iG(function*(){return e.initModels()})()}clearModels(){var e;null===(e=this.texture)||void 0===e||e.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:iR.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:2,update:(e,t,r)=>[r[3],r[4]]}})}}class fi extends dh{constructor(...e){super(...e),ia(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getCommonUniformsInfo(){let{opacity:e,clampLow:t=!0,clampHigh:r=!0,noDataValue:n=-9999999,domain:i,rampColors:o,colorTexture:a,rScaler:s=6553.6,gScaler:l=25.6,bScaler:u=.1,offset:c=1e4}=this.layer.getLayerConfig(),h=i||eO(o),d=a;a?this.layer.textureService.setColorTexture(a,o,h):d=this.layer.textureService.getColorTexture(o,h);let p={u_unpack:[s,l,u,c],u_domain:h,u_opacity:e||1,u_noDataValue:n,u_clampLow:t,u_clampHigh:void 0!==r?r:t,u_texture:this.texture,u_colorTexture:d};return this.textures=[this.texture,d],this.getUniformsBufferInfo(p)}initModels(){var e=this;return iG(function*(){e.initUniformsBuffer();let t=e.layer.getSource(),{createTexture2D:r}=e.rendererService,n=yield t.data.images;return e.texture=r({data:n[0],width:n[0].width,height:n[0].height,min:ic.LINEAR,mag:ic.LINEAR}),[(yield e.layer.buildLayerModel({moduleName:"RasterTileDataImage",vertexShader:'layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;\nlayout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;\n\nlayout(std140) uniform commonUniforms {\n  vec4 u_unpack;\n  vec2 u_domain;\n  float u_opacity;\n  float u_noDataValue;\n  float u_clampLow;\n  float u_clampHigh;\n};\nout vec2 v_texCoord;\n#pragma include "projection"\n\nvoid main() {\n  v_texCoord = a_Uv;\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));\n}\n',fragmentShader:"uniform sampler2D u_texture;\nuniform sampler2D u_colorTexture;\n\nlayout(std140) uniform commonUniforms {\n vec4 u_unpack;\n vec2 u_domain;\n float u_opacity;\n float u_noDataValue;\n float u_clampLow;\n float u_clampHigh;\n};\n\nin vec2 v_texCoord;\nout vec4 outputColor;\n\n\nfloat getElevation(vec2 coord, float bias) {\n    // Convert encoded elevation value to meters\n    vec4 data =  texture(SAMPLER_2D(u_texture), coord,bias) * 255.0;\n    data.a = -1.0;\n    return dot(data, u_unpack);\n}\n\nvec4 getColor(float value) {\n   float normalisedValue =(value- u_domain[0]) / (u_domain[1] - u_domain[0]);\n    vec2 coord = vec2(normalisedValue, 0);\n    return  texture(SAMPLER_2D(u_colorTexture), coord);\n}\n\nvoid main() {\n  float value = getElevation(v_texCoord,0.0);\n  if (value == u_noDataValue) {\n    outputColor = vec4(0.0, 0, 0, 0.0);\n  } else if ((u_clampLow < 0.5 && value < u_domain[0]) || (u_clampHigh < 0.5 && value > u_domain[1])) {\n     outputColor = vec4(0.0, 0, 0, 0.0);\n  } else {\n   \n    outputColor = getColor(value);\n    outputColor.a =  outputColor.a * u_opacity ;\n      if(outputColor.a < 0.01)\n      discard;\n  }\n}\n",defines:e.getDefines(),triangulation:d4,primitive:ic.TRIANGLES,depth:{enable:!1}}))]})()}clearModels(){var e;null===(e=this.texture)||void 0===e||e.destroy()}buildModels(){var e=this;return iG(function*(){return e.initModels()})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:iR.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:ic.DYNAMIC_DRAW,data:[],type:ic.FLOAT},size:2,update:(e,t,r)=>[r[3],r[4]]}})}}let fo={raster:fe,rasterRgb:fn,raster3d:fe,rasterTerrainRgb:fi};class fa extends dt{constructor(...e){super(...e),ia(this,"type","RasterLayer")}buildModels(){var e=this;return iG(function*(){let t=e.getModelType();e.layerModel=new fo[t](e),yield e.initLayerModels()})()}getDefaultConfig(){return({raster:{},rasterRgb:{},raster3d:{},rasterTerrainRgb:{}})[this.getModelType()]}getModelType(){switch(this.layerSource.getParserType()){case"raster":default:return"raster";case"rasterRgb":case"rgb":return"rasterRgb";case"image":return"rasterTerrainRgb"}}getLegend(e){var t;return"color"!==e?{type:void 0,field:void 0,items:[]}:{type:(t=this.getLayerConfig().rampColors).type,field:"value",items:t.positions.map((r,n)=>({[e]:n>=t.colors.length?null:t.colors[n],value:r}))}}}let fs=["rasterData"];class fl extends p0{initTileLayer(){var e=this;return iG(function*(){let t=e.parent.getLayerAttributeConfig(),r=e.getLayerOptions(),n=e.getSourceOption(),i=new fa(il({},r)).source(n.data,n.options);t&&Object.keys(t).forEach(e=>{var r,n;i[e](null===(r=t[e])||void 0===r?void 0:r.field,null===(n=t[e])||void 0===n?void 0:n.values)}),yield e.addLayer(i),e.isLoaded=!0})()}getSourceOption(){let e=this.parent.getSource(),t=this.sourceTile.data.data,{rasterData:r}=t,n=ox(t,fs);return{data:r,options:{parser:il({type:"rasterRgb",extent:this.sourceTile.bounds},n),transforms:e.transforms}}}}class fu extends p0{initTileLayer(){var e=this;return iG(function*(){let t=e.parent.getLayerAttributeConfig(),r=e.getLayerOptions(),n=e.getSourceOption(),i=new fa(il({},r)).source(n.data,n.options);t&&Object.keys(t).forEach(e=>{var r,n;i[e](null===(r=t[e])||void 0===r?void 0:r.field,null===(n=t[e])||void 0===n?void 0:n.values)}),yield e.addLayer(i),e.isLoaded=!0})()}getSourceOption(){let e=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:e.transforms}}}}let fc=["rasterData"],fh={positions:[0,1],colors:["#000","#fff"]};class fd extends p0{constructor(...e){super(...e),ia(this,"colorTexture",void 0)}initTileLayer(){var e=this;return iG(function*(){let t=e.parent.getLayerAttributeConfig(),r=e.getLayerOptions(),n=e.getSourceOption(),{rampColors:i,domain:o}=e.getLayerOptions();e.colorTexture=e.parent.textureService.getColorTexture(i,o);let a=new fa(il(il({},r),{},{colorTexture:e.colorTexture})).source(n.data,n.options);t&&Object.keys(t).forEach(e=>{var r,n;a[e](null===(r=t[e])||void 0===r?void 0:r.field,null===(n=t[e])||void 0===n?void 0:n.values)}),yield e.addLayer(a),e.isLoaded=!0})()}getSourceOption(){let e=this.parent.getSource(),t=this.sourceTile.data.data,{rasterData:r}=t,n=ox(t,fc);return{data:r,options:{parser:il({type:"raster",extent:this.sourceTile.bounds},n),transforms:e.transforms}}}styleUpdate(...e){let{rampColors:t=fh,domain:r}=e;this.colorTexture=this.parent.textureService.getColorTexture(t,r||eO(t)),this.layers.forEach(e=>e.style({colorTexture:this.colorTexture}))}destroy(){this.layers.forEach(e=>e.destroy())}}class fp extends p0{initTileLayer(){var e=this;return iG(function*(){var t;let r=e.parent.getLayerAttributeConfig(),n=e.getLayerOptions(),i="PolygonLayer"===(t=e.parent.type)?pU:"LineLayer"===t?pf:pJ,o=e.getSourceOption();if(!o){e.isLoaded=!0,e.emit("loaded");return}let a=new i(il({},n)).source(o.data,o.options);Object.keys(r).forEach(e=>{var t,n;a[e](null===(t=r[e])||void 0===t?void 0:t.field,null===(n=r[e])||void 0===n?void 0:n.values)}),yield e.addLayer(a),n.tileMask&&(yield e.addTileMask()),e.setLayerMinMaxZoom(a),e.isLoaded=!0,e.emit("loaded")})()}getSourceOption(){let e=this.parent.getSource(),{sourceLayer:t="defaultLayer",featureId:r="id"}=this.parent.getLayerConfig();return{data:{type:"FeatureCollection",features:this.getFeatures(t)},options:{parser:{type:"geojson",featureId:r},transforms:e.transforms}}}setLayerMinMaxZoom(e){"text"===e.getModelType()&&e.updateLayerConfig({maxZoom:this.z+1,minZoom:this.z-1})}getFeatures(e){return this.sourceTile.data.getTileData(e)}getFeatureById(e){let t=this.getMainLayer();return t?t.getSource().data.dataArray.filter(t=>t._id===e):[]}}let ff=["shape","color","size","style","animate","filter","rotate","scale","setBlend","setSelect","setActive","disableMask","enableMask","addMask","removeMask"],{debounce:fg}=th;class fm{constructor(e){ia(this,"parent",void 0),ia(this,"tileLayerService",void 0),ia(this,"mapService",void 0),ia(this,"layerService",void 0),ia(this,"rendererService",void 0),ia(this,"pickingService",void 0),ia(this,"tilePickService",void 0),ia(this,"tilesetManager",void 0),ia(this,"initedTileset",!1),ia(this,"lastViewStates",void 0),ia(this,"mapchange",()=>{var e;if(!1===this.parent.isVisible())return;let{latLonBounds:t,zoom:r}=this.getCurrentView();this.lastViewStates&&this.lastViewStates.zoom===r&&this.lastViewStates.latLonBounds.toString()===t.toString()||(this.lastViewStates={zoom:r,latLonBounds:t},null===(e=this.tilesetManager)||void 0===e||e.throttleUpdate(r,t))}),ia(this,"viewchange",fg(this.mapchange,24)),this.parent=e;let t=this.parent.getContainer();this.rendererService=t.rendererService,this.layerService=t.layerService,this.mapService=t.mapService,this.pickingService=t.pickingService,this.tileLayerService=new pz({rendererService:this.rendererService,layerService:this.layerService,parent:e}),this.tilePickService=new pG({tileLayerService:this.tileLayerService,layerService:this.layerService,parent:e}),this.parent.setLayerPickService(this.tilePickService),this.proxy(e),this.initTileSetManager()}initTileSetManager(){var e;let t=this.parent.getSource();if(this.tilesetManager=t.tileset,this.initedTileset||(this.bindTilesetEvent(),this.initedTileset=!0),!1===this.parent.isVisible())return;let{latLonBounds:r,zoom:n}=this.getCurrentView();null===(e=this.tilesetManager)||void 0===e||e.update(n,r)}getCurrentView(){let e=this.mapService.getBounds();return{latLonBounds:[e[0][0],e[0][1],e[1][0],e[1][1]],zoom:this.mapService.getZoom()}}bindTilesetEvent(){this.tilesetManager.on("tile-loaded",e=>{}),this.tilesetManager.on("tile-unload",e=>{this.tileUnLoad(e)}),this.tilesetManager.on("tile-error",(e,t)=>{this.tileError(e)}),this.tilesetManager.on("tile-update",()=>{this.tileUpdate()}),this.mapService.on("zoomend",this.mapchange),this.mapService.on("moveend",this.viewchange)}render(){this.tileLayerService.render()}getLayers(){return this.tileLayerService.getLayers()}getTiles(){return this.tileLayerService.getTiles()}getTile(e){return this.tileLayerService.getTile(e)}tileLoaded(e){}tileError(e){console.warn("error:",e)}destroy(){var e;this.mapService.off("zoomend",this.mapchange),this.mapService.off("moveend",this.viewchange),null===(e=this.tilesetManager)||void 0===e||e.destroy(),this.tileLayerService.destroy()}reload(){var e;this.tilesetManager.clear();let{latLonBounds:t,zoom:r}=this.getCurrentView();null===(e=this.tilesetManager)||void 0===e||e.update(r,t)}tileUnLoad(e){this.tileLayerService.removeTile(e.key)}tileUpdate(){var e=this;return iG(function*(){var t;if(!e.tilesetManager)return;let r=e.parent.getMinZoom(),n=e.parent.getMaxZoom(),i=e.tilesetManager.tiles.filter(e=>e.isLoaded).filter(e=>e.isVisibleChange).filter(e=>e.data).filter(e=>e.z>=r&&e.z<n);yield Promise.all(i.map((t=iG(function*(t){if(e.tileLayerService.hasTile(t.key))e.tileLayerService.updateTileVisible(t),e.tilePickService.setPickState(),e.layerService.reRender();else{let r=new(function(e){switch(e.type){case"PolygonLayer":case"LineLayer":case"PointLayer":return fp;case"TileDebugLayer":return p1;case"MaskLayer":return p9;case"RasterLayer":let{dataType:t}=e.getSource().parser;switch(t){case aF.RGB:case aF.CUSTOMRGB:return fl;case aF.ARRAYBUFFER:case aF.CUSTOMARRAYBUFFER:return fd;case aF.TERRAINRGB:case aF.CUSTOMTERRAINRGB:return fu;default:return p5}default:return fp}}(e.parent))(t,e.parent);yield r.initTileLayer(),e.tilePickService.setPickState(),0!==r.getLayers().length&&(e.tileLayerService.addTile(r),e.tileLayerService.updateTileVisible(t),e.layerService.reRender())}}),function(e){return t.apply(this,arguments)}))),e.tilesetManager.isLoaded&&e.parent.emit("tiles-loaded",e.tilesetManager.currentTiles)})()}setPickState(e){}pickRender(e){this.tilePickService.pickRender(e)}selectFeature(e){this.tilePickService.selectFeature(e)}highlightPickedFeature(e){this.tilePickService.highlightPickedFeature(e)}proxy(e){ff.forEach(t=>{let r=e[t].bind(e);e[t]=(...n)=>(r(...n),this.getLayers().map(e=>{e[t](...n)}),"style"===t&&this.getTiles().forEach(e=>e.styleUpdate(...n)),e)})}}let{get:fv}=th;!function(e,t){var r="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM,n="undefined"!=typeof wx&&null!==wx&&(void 0!==wx.request||void 0!==wx.miniProgram);if(!r&&!n&&(t||(t=document),t)){var i=t.head||t.getElementsByTagName("head")[0];if(!i){i=t.createElement("head");var o=t.body||t.getElementsByTagName("body")[0];o?o.parentNode.insertBefore(i,o):t.documentElement.appendChild(i)}var a=t.createElement("style");a.type="text/css",a.styleSheet?a.styleSheet.cssText=e:a.appendChild(t.createTextNode(e)),i.appendChild(a)}}(`.l7-marker-container {
  position: absolute;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
.l7-marker {
  position: absolute !important;
  top: 0;
  left: 0;
  z-index: 5;
  cursor: pointer;
}
.l7-marker-cluster {
  width: 40px;
  height: 40px;
  background-color: rgba(181, 226, 140, 0.6);
  background-clip: padding-box;
  border-radius: 20px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-top: 5px;
  margin-left: 5px;
  font:
    12px 'Helvetica Neue',
    Arial,
    Helvetica,
    sans-serif;
  text-align: center;
  background-color: rgba(110, 204, 57, 0.6);
  border-radius: 15px;
}
.l7-marker-cluster span {
  line-height: 30px;
}
.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  box-shadow: none;
}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  background-clip: padding-box;
  border: 2px solid rgba(0, 0, 0, 0.2);
}
.mapboxgl-ctrl-logo,
.amap-logo {
  display: none !important;
}
.l7-select-box {
  border: 3px dashed gray;
  border-radius: 2px;
  position: absolute;
  z-index: 999;
  box-sizing: border-box;
}
.l7-control-container {
  font:
    12px/1.5 'Helvetica Neue',
    Arial,
    Helvetica,
    sans-serif;
}
.l7-control-container .l7-control {
  position: relative;
  z-index: 999;
  float: left;
  clear: both;
  color: #595959;
  font-size: 12px;
  pointer-events: visiblePainted;
  /* IE 9-10 doesn't have auto */
  pointer-events: auto;
}
.l7-control-container .l7-control.l7-control--hide {
  display: none;
}
.l7-control-container .l7-top {
  top: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-top .l7-control:not(.l7-control--hide) {
  margin-top: 8px;
}
.l7-control-container .l7-right {
  right: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-right .l7-control:not(.l7-control--hide) {
  margin-right: 8px;
}
.l7-control-container .l7-bottom {
  bottom: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-bottom .l7-control:not(.l7-control--hide) {
  margin-bottom: 8px;
}
.l7-control-container .l7-left {
  left: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-left .l7-control:not(.l7-control--hide) {
  margin-left: 8px;
}
.l7-control-container .l7-center {
  position: absolute;
  display: flex;
  justify-content: center;
}
.l7-control-container .l7-center.l7-top,
.l7-control-container .l7-center.l7-bottom {
  width: 100%;
}
.l7-control-container .l7-center.l7-left,
.l7-control-container .l7-center.l7-right {
  height: 100%;
}
.l7-control-container .l7-center .l7-control {
  margin-right: 8px;
  margin-bottom: 8px;
}
.l7-control-container .l7-row {
  flex-direction: row;
}
.l7-control-container .l7-row.l7-top {
  align-items: flex-start;
}
.l7-control-container .l7-row.l7-bottom {
  align-items: flex-end;
}
.l7-control-container .l7-column {
  flex-direction: column;
}
.l7-control-container .l7-column.l7-left {
  align-items: flex-start;
}
.l7-control-container .l7-column.l7-right {
  align-items: flex-end;
}
.l7-button-control {
  min-width: 28px;
  height: 28px;
  background-color: #fff;
  border-width: 0;
  border-radius: 2px;
  outline: 0;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 0 6px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  line-height: 16px;
}
.l7-button-control .l7-iconfont {
  fill: #595959;
  color: #595959;
  width: 16px;
  height: 16px;
}
.l7-button-control.l7-button-control--row {
  padding: 0 16px 0 13px;
}
.l7-button-control.l7-button-control--row * + .l7-button-control__text {
  margin-left: 8px;
}
.l7-button-control.l7-button-control--column {
  height: 44px;
  flex-direction: column;
}
.l7-button-control.l7-button-control--column .l7-iconfont {
  margin-top: 3px;
}
.l7-button-control.l7-button-control--column .l7-button-control__text {
  margin-top: 3px;
  font-size: 10px;
  -webkit-transform: scale(0.83333);
          transform: scale(0.83333);
}
.l7-button-control:not(:disabled):hover {
  background-color: #f3f3f3;
}
.l7-button-control:not(:disabled):active {
  background-color: #f3f3f3;
}
.l7-button-control:disabled {
  background-color: #fafafa;
  color: #bdbdbd;
  cursor: not-allowed;
}
.l7-button-control:disabled .l7-iconfont {
  fill: #bdbdbd;
  color: #bdbdbd;
}
.l7-button-control:disabled:hover {
  background-color: #fafafa;
}
.l7-button-control:disabled:active {
  background-color: #fafafa;
}
.l7-popper {
  position: absolute;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 5;
  color: #595959;
}
.l7-popper.l7-popper-hide {
  display: none;
}
.l7-popper .l7-popper-content {
  min-height: 28px;
  background: #fff;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper .l7-popper-arrow {
  width: 0;
  height: 0;
  border-width: 4px;
  border-style: solid;
  border-top-color: transparent;
  border-bottom-color: transparent;
  border-left-color: transparent;
  border-right-color: transparent;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper.l7-popper-left {
  flex-direction: row;
}
.l7-popper.l7-popper-left .l7-popper-arrow {
  border-left-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-right {
  flex-direction: row-reverse;
}
.l7-popper.l7-popper-right .l7-popper-arrow {
  border-right-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-top {
  flex-direction: column;
}
.l7-popper.l7-popper-top .l7-popper-arrow {
  border-top-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-bottom {
  flex-direction: column-reverse;
}
.l7-popper.l7-popper-bottom .l7-popper-arrow {
  border-bottom-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-start {
  align-items: flex-start;
}
.l7-popper.l7-popper-end {
  align-items: flex-end;
}
.l7-select-control--normal {
  padding: 4px 0;
}
.l7-select-control--normal .l7-select-control-item {
  display: flex;
  align-items: center;
  height: 24px;
  padding: 0 16px;
  font-size: 12px;
  line-height: 24px;
}
.l7-select-control--normal .l7-select-control-item > * + * {
  margin-left: 6px;
}
.l7-select-control--normal .l7-select-control-item input[type='checkbox'] {
  width: 14px;
  height: 14px;
}
.l7-select-control--normal .l7-select-control-item:hover {
  background-color: #f3f3f3;
}
.l7-select-control--image {
  display: flex;
  flex-wrap: wrap;
  align-items: flex-start;
  box-sizing: content-box;
  max-width: 460px;
  max-height: 400px;
  margin: 12px 0 0 12px;
  overflow-x: hidden;
  overflow-y: auto;
}
.l7-select-control--image .l7-select-control-item {
  position: relative;
  display: flex;
  flex: 0 0 calc((100% - (12px + 9px) * 2) / 3);
  flex-direction: column;
  justify-content: center;
  box-sizing: content-box;
  margin-right: 12px;
  margin-bottom: 12px;
  overflow: hidden;
  font-size: 12px;
  border: 1px solid #fff;
  border-radius: 2px;
}
.l7-select-control--image .l7-select-control-item img {
  width: 100%;
  height: 80px;
}
.l7-select-control--image .l7-select-control-item input[type='checkbox'] {
  position: absolute;
  top: 0;
  right: 0;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row {
  display: flex;
  align-items: center;
  justify-content: center;
  line-height: 26px;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row > * + * {
  margin-left: 8px;
}
.l7-select-control--image .l7-select-control-item.l7-select-control-item-active {
  border-color: #0370fe;
}
.l7-select-control-item {
  cursor: pointer;
}
.l7-select-control-item input[type='checkbox'] {
  margin: 0;
  cursor: pointer;
}
.l7-select-control--multiple .l7-select-control-item:hover {
  background-color: transparent;
}
.l7-control-logo {
  width: 89px;
  height: 16px;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}
.l7-control-logo img {
  height: 100%;
  width: 100%;
}
.l7-control-logo .l7-control-logo-link {
  display: block;
  cursor: pointer;
}
.l7-control-logo .l7-control-logo-link img {
  cursor: pointer;
}
.l7-control-mouse-location {
  background-color: #fff;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  padding: 2px 4px;
  min-width: 130px;
}
.l7-control-zoom {
  overflow: hidden;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-control-zoom .l7-button-control {
  font-size: 16px;
  border-bottom: 1px solid #f0f0f0;
  border-radius: 0;
  box-shadow: 0 0 0;
}
.l7-control-zoom .l7-button-control .l7-iconfont {
  width: 14px;
  height: 14px;
}
.l7-control-zoom .l7-button-control:last-child {
  border-bottom: 0;
}
.l7-control-zoom .l7-control-zoom__number {
  color: #595959;
  padding: 0;
}
.l7-control-zoom .l7-control-zoom__number:hover {
  background-color: #fff;
}
.l7-control-scale {
  display: flex;
  flex-direction: column;
}
.l7-control-scale .l7-control-scale-line {
  box-sizing: border-box;
  padding: 2px 5px 1px;
  overflow: hidden;
  color: #595959;
  font-size: 10px;
  line-height: 1.1;
  white-space: nowrap;
  background: #fff;
  border: 2px solid #000;
  border-top: 0;
  transition: width 0.1s;
}
.l7-control-scale .l7-control-scale-line + .l7-control-scale .l7-control-scale-line {
  margin-top: -2px;
  border-top: 2px solid #777;
  border-bottom: none;
}
.l7-right .l7-control-scale {
  display: flex;
  align-items: flex-end;
}
.l7-right .l7-control-scale .l7-control-scale-line {
  text-align: right;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 5;
  display: flex;
  will-change: transform;
  pointer-events: none;
}
.l7-popup.l7-popup-hide {
  display: none;
}
.l7-popup .l7-popup-content {
  position: relative;
  padding: 16px;
  font-size: 14px;
  background: #fff;
  border-radius: 3px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}
.l7-popup .l7-popup-content .l7-popup-content__title {
  margin-bottom: 8px;
  font-weight: bold;
}
.l7-popup .l7-popup-content .l7-popup-close-button,
.l7-popup .l7-popup-content .l7-popup-content__title,
.l7-popup .l7-popup-content .l7-popup-content__panel {
  white-space: normal;
  -webkit-user-select: text;
     -moz-user-select: text;
      -ms-user-select: text;
          user-select: text;
  pointer-events: initial;
}
.l7-popup .l7-popup-content .l7-popup-close-button {
  position: absolute;
  top: 0;
  right: 0;
  width: 18px;
  height: 18px;
  padding: 0;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  background-color: transparent;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
}
.l7-popup .l7-popup-tip {
  position: relative;
  z-index: 1;
  width: 0;
  height: 0;
  border: 10px solid transparent;
}
.l7-popup.l7-popup-anchor-bottom,
.l7-popup.l7-popup-anchor-bottom-left,
.l7-popup.l7-popup-anchor-bottom-right {
  flex-direction: column-reverse;
}
.l7-popup.l7-popup-anchor-bottom .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-right .l7-popup-tip {
  bottom: 1px;
}
.l7-popup.l7-popup-anchor-top,
.l7-popup.l7-popup-anchor-top-left,
.l7-popup.l7-popup-anchor-top-right {
  flex-direction: column;
}
.l7-popup.l7-popup-anchor-top .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-right .l7-popup-tip {
  top: 1px;
}
.l7-popup.l7-popup-anchor-left {
  flex-direction: row;
}
.l7-popup.l7-popup-anchor-right {
  flex-direction: row-reverse;
}
.l7-popup-anchor-top .l7-popup-tip {
  position: relative;
  align-self: center;
  border-top: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-tip {
  align-self: flex-start;
  border-top: none;
  border-bottom-color: #fff;
  border-left: none;
}
.l7-popup-anchor-top-right .l7-popup-tip {
  align-self: flex-end;
  border-top: none;
  border-right: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-bottom .l7-popup-tip {
  align-self: center;
  border-top-color: #fff;
  border-bottom: none;
}
.l7-popup-anchor-bottom-left .l7-popup-tip {
  align-self: flex-start;
  border-top-color: #fff;
  border-bottom: none;
  border-left: none;
}
.l7-popup-anchor-bottom-right .l7-popup-tip {
  align-self: flex-end;
  border-top-color: #fff;
  border-right: none;
  border-bottom: none;
}
.l7-popup-anchor-left .l7-popup-tip {
  align-self: center;
  border-right-color: #fff;
  border-left: none;
}
.l7-popup-anchor-right .l7-popup-tip {
  right: 1px;
  align-self: center;
  border-right: none;
  border-left-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-content {
  border-top-left-radius: 0;
}
.l7-popup-anchor-top-right .l7-popup-content {
  border-top-right-radius: 0;
}
.l7-popup-anchor-bottom-left .l7-popup-content {
  border-bottom-left-radius: 0;
}
.l7-popup-anchor-bottom-right .l7-popup-content {
  border-bottom-right-radius: 0;
}
.l7-popup-track-pointer {
  display: none;
}
.l7-popup-track-pointer * {
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
  pointer-events: none;
}
.l7-map:hover .l7-popup-track-pointer {
  display: flex;
}
.l7-map:active .l7-popup-track-pointer {
  display: none;
}
.l7-layer-popup__row {
  font-size: 12px;
}
.l7-layer-popup__row + .l7-layer-popup__row {
  margin-top: 4px;
}
.l7-control-swipe {
  position: absolute;
  top: 50%;
  left: 50%;
  z-index: 6;
  -webkit-transform: translate(-50%, -50%);
          transform: translate(-50%, -50%);
  touch-action: none;
}
.l7-control-swipe_hide {
  display: none;
}
.l7-control-swipe:before {
  position: absolute;
  top: -5000px;
  bottom: -5000px;
  left: 50%;
  z-index: -1;
  width: 4px;
  background: #fff;
  -webkit-transform: translate(-2px, 0);
          transform: translate(-2px, 0);
  content: '';
}
.l7-control-swipe.horizontal:before {
  top: 50%;
  right: -5000px;
  bottom: auto;
  left: -5000px;
  width: auto;
  height: 4px;
}
.l7-control-swipe__button {
  display: block;
  width: 28px;
  height: 28px;
  margin: 0;
  padding: 0;
  color: #595959;
  font-weight: bold;
  font-size: inherit;
  text-align: center;
  text-decoration: none;
  background-color: #fff;
  border: none;
  border-radius: 2px;
  outline: none;
}
.l7-control-swipe,
.l7-control-swipe__button {
  cursor: ew-resize;
}
.l7-control-swipe.horizontal,
.l7-control-swipe.horizontal button {
  cursor: ns-resize;
}
.l7-control-swipe:after,
.l7-control-swipe__button:before,
.l7-control-swipe__button:after {
  position: absolute;
  top: 25%;
  bottom: 25%;
  left: 50%;
  width: 2px;
  background: currentColor;
  -webkit-transform: translate(-1px, 0);
          transform: translate(-1px, 0);
  content: '';
}
.l7-control-swipe__button:after {
  -webkit-transform: translateX(4px);
          transform: translateX(4px);
}
.l7-control-swipe__button:before {
  -webkit-transform: translateX(-6px);
          transform: translateX(-6px);
}
`);class fy{constructor(e){ia(this,"configService",void 0),ia(this,"config",void 0),this.config=e}setContainer(e,t){this.configService=e.globalConfigService,e.mapConfig=il(il({},this.config),{},{id:t}),e.mapService=new(this.getServiceConstructor())(e)}getServiceConstructor(){throw Error("Method not implemented.")}}var f_=r(51563),fb=r.n(f_);function fx(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function fS(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,io(n.key),n)}}function fA(e,t,r){return t&&fS(e.prototype,t),r&&fS(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var fE=r(44722);function fT(e){return(fT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var fC=r(64365);function fw(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function fL(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return fw(e,t);var r=({}).toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?fw(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fM(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function fO(e,t){var r,n=oi([],t,e);return r=1/n[3],n[0]=n[0]*r,n[1]=n[1]*r,n[2]=n[2]*r,n[3]=n[3]*r,n}function fI(e,t){if(!e)throw Error(t||"viewport-mercator-project: assertion failed.")}var fP=Math.PI,fR=fP/4,fk=fP/180,fN=180/fP;function fD(e){return Math.pow(2,e)}function fU(e,t){var r=fL(e,2),n=r[0],i=r[1];return fI(Number.isFinite(n)&&Number.isFinite(t)),fI(Number.isFinite(i)&&i>=-90&&i<=90,"invalid latitude"),[(t*=512)*(n*fk+fP)/(2*fP),t*(fP-Math.log(Math.tan(fR+i*fk*.5)))/(2*fP)]}function fz(e,t){var r=fL(e,2);return[(r[0]/(t*=512)*(2*fP)-fP)*fN,2*(Math.atan(Math.exp(fP-r[1]/t*(2*fP)))-fR)*fN]}function fB(e,t){var r,n,i,o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=fL(e,3),l=s[0],u=s[1],c=s[2];if(fI(Number.isFinite(l)&&Number.isFinite(u),"invalid pixel coordinate"),Number.isFinite(c))return fO(t,[l,u,c,1]);var h=fO(t,[l,u,0,1]),d=fO(t,[l,u,1,1]),p=h[2],f=d[2];return r=[],n=p===f?0:((a||0)-p)/(f-p),i=h[0],o=h[1],r[0]=i+n*(d[0]-i),r[1]=o+n*(d[1]-o),r}var fF=fM(),fj=function(e){function t(){var e,r,n,i,o,a,s,l,u,c,h,d,p,f,g,m,v,y,_,b,x,S,A,E,T,C,w,L,M=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},O=M.width,I=M.height,P=M.latitude,R=void 0===P?0:P,k=M.longitude,N=void 0===k?0:k,D=M.zoom,U=void 0===D?0:D,z=M.pitch,B=void 0===z?0:z,F=M.bearing,j=void 0===F?0:F,V=M.altitude,H=void 0===V?1.5:V,G=M.nearZMultiplier,W=M.farZMultiplier;fx(this,t),O=O||1,I=I||1;var X=fD(U);H=Math.max(.75,H);var $=fU([N,R],X);$[2]=0;var Z=(d=(h={width:O,height:I,pitch:B,bearing:j,altitude:H,nearZMultiplier:G||1/I,farZMultiplier:W||1.01}).width,p=h.height,f=h.pitch,i1([],(m=(g={width:d,height:p,altitude:h.altitude,pitch:f,nearZMultiplier:h.nearZMultiplier,farZMultiplier:h.farZMultiplier}).width,v=g.height,_=void 0===(y=g.altitude)?1.5:y,b=g.pitch,x=g.nearZMultiplier,S=g.farZMultiplier,A=(void 0===b?0:b)*fk,T=Math.sin(E=Math.atan(.5/_))*_/Math.sin(Math.PI/2-A-E),C=Math.cos(Math.PI/2-A)*T+_,w={fov:2*Math.atan(v/2/_),aspect:m/v,focalDistance:_,near:void 0===x?1:x,far:C*(void 0===S?1:S)}).fov,w.aspect,w.near,w.far)),Y=(n=(e={height:I,center:$,pitch:B,bearing:j,altitude:H,flipY:!0}).height,i=e.pitch,o=e.bearing,a=e.altitude,l=void 0===(s=e.center)?null:s,u=e.flipY,iq(c=fM(),c,[0,0,-a]),iK(c,c,[1,1,1/n]),iQ(c,c,-i*fk),i0(c,c,o*fk),void 0!==u&&u&&iK(c,c,[1,-1,1]),l&&iq(c,c,((r=[])[0]=-l[0],r[1]=-l[1],r[2]=-l[2],r)),c);return(L=function(e,t){if(t&&("object"==ii(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return(0,fE.A)(e)}(this,fT(t).call(this,{width:O,height:I,viewMatrix:Y,projectionMatrix:Z}))).latitude=R,L.longitude=N,L.zoom=U,L.pitch=B,L.bearing=j,L.altitude=H,L.scale=X,L.center=$,L.pixelsPerMeter=function(e){var t=e.latitude,r=e.longitude,n=e.zoom,i=e.scale,o=e.highPrecision;i=void 0!==i?i:fD(n),fI(Number.isFinite(t)&&Number.isFinite(r)&&Number.isFinite(i));var a={},s=512*i,l=Math.cos(t*fk),u=s/360,c=u/l,h=s/4003e4/l;if(a.pixelsPerMeter=[h,-h,h],a.metersPerPixel=[1/h,-1/h,1/h],a.pixelsPerDegree=[u,-c,h],a.degreesPerPixel=[1/u,-1/c,1/h],void 0!==o&&o){var d=fk*Math.tan(t*fk)/l,p=u*d/2,f=s/4003e4*d,g=f/c*h;a.pixelsPerDegree2=[0,-p,f],a.pixelsPerMeter2=[g,0,g]}return a}((0,fE.A)((0,fE.A)(L))).pixelsPerMeter[2],Object.freeze((0,fE.A)((0,fE.A)(L))),L}return!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&(0,fC.A)(e,t)}(t,e),fA(t,[{key:"projectFlat",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return fU(e,t)}},{key:"unprojectFlat",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return fz(e,t)}},{key:"getMapCenterByLngLatPosition",value:function(e){var t,r=e.lngLat,n=fB(e.pos,this.pixelUnprojectionMatrix),i=dv([],fU(r,this.scale),((t=[])[0]=-n[0],t[1]=-n[1],t));return fz(dv([],this.center,i),this.scale)}},{key:"getLocationAtPoint",value:function(e){var t=e.lngLat,r=e.pos;return this.getMapCenterByLngLatPosition({lngLat:t,pos:r})}},{key:"fitBounds",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.width,i=this.height,o=function(e){var t=e.width,r=e.height,n=e.bounds,i=e.minExtent,o=void 0===i?0:i,a=e.maxZoom,s=e.padding,l=void 0===s?0:s,u=e.offset,c=void 0===u?[0,0]:u,h=fL(n,2),d=fL(h[0],2),p=d[0],f=d[1],g=fL(h[1],2),m=g[0],v=g[1];if(Number.isFinite(l)){var y=l;l={top:y,bottom:y,left:y,right:y}}else fI(Number.isFinite(l.top)&&Number.isFinite(l.bottom)&&Number.isFinite(l.left)&&Number.isFinite(l.right));var _=new fj({width:t,height:r,longitude:0,latitude:0,zoom:0}),b=_.project([p,v]),x=_.project([m,f]),S=[Math.max(Math.abs(x[0]-b[0]),o),Math.max(Math.abs(x[1]-b[1]),o)],A=[t-l.left-l.right-2*Math.abs(c[0]),r-l.top-l.bottom-2*Math.abs(c[1])];fI(A[0]>0&&A[1]>0);var E=A[0]/S[0],T=A[1]/S[1],C=(l.right-l.left)/2/E,w=(l.bottom-l.top)/2/T,L=[(x[0]+b[0])/2+C,(x[1]+b[1])/2+w],M=_.unproject(L),O=_.zoom+Math.log2(Math.abs(Math.min(E,T)));return{longitude:M[0],latitude:M[1],zoom:Math.min(O,void 0===a?24:a)}}(Object.assign({width:n,height:i,bounds:e},r));return new t({width:n,height:i,longitude:o.longitude,latitude:o.latitude,zoom:o.zoom})}}]),t}(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.width,n=t.height,i=t.viewMatrix,o=void 0===i?fF:i,a=t.projectionMatrix,s=void 0===a?fF:a;fx(this,e),this.width=r||1,this.height=n||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=o,this.projectionMatrix=s;var l=fM();iY(l,l,this.projectionMatrix),iY(l,l,this.viewMatrix),this.viewProjectionMatrix=l;var u=fM();iK(u,u,[this.width/2,-this.height/2,1]),iq(u,u,[1,-1,0]),iY(u,u,this.viewProjectionMatrix);var c=iZ(fM(),u);if(!c)throw Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=u,this.pixelUnprojectionMatrix=c,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return fA(e,[{key:"equals",value:function(t){return t instanceof e&&t.width===this.width&&t.height===this.height&&i2(t.projectionMatrix,this.projectionMatrix)&&i2(t.viewMatrix,this.viewMatrix)}},{key:"project",value:function(e){var t,r,n,i,o,a,s,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u=l.topLeft,c=(t=this.projectPosition(e),r=this.pixelProjectionMatrix,i=(n=fL(t,3))[0],o=n[1],s=void 0===(a=n[2])?0:a,fI(Number.isFinite(i)&&Number.isFinite(o)&&Number.isFinite(s)),fO(r,[i,o,s,1])),h=fL(c,2),d=h[0],p=h[1],f=void 0===u||u?p:this.height-p;return 2===e.length?[d,f]:[d,f,c[2]]}},{key:"unproject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.topLeft,n=t.targetZ,i=fL(e,3),o=i[0],a=i[1],s=i[2],l=void 0===r||r?a:this.height-a,u=n&&n*this.pixelsPerMeter,c=fB([o,l,s],this.pixelUnprojectionMatrix,u),h=fL(this.unprojectPosition(c),3),d=h[0],p=h[1],f=h[2];return Number.isFinite(s)?[d,p,f]:Number.isFinite(n)?[d,p,n]:[d,p]}},{key:"projectPosition",value:function(e){var t=fL(this.projectFlat(e),2);return[t[0],t[1],(e[2]||0)*this.pixelsPerMeter]}},{key:"unprojectPosition",value:function(e){var t=fL(this.unprojectFlat(e),2);return[t[0],t[1],(e[2]||0)/this.pixelsPerMeter]}},{key:"projectFlat",value:function(e){return arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale,e}},{key:"unprojectFlat",value:function(e){return arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale,e}}]),e}());class fV{constructor(){ia(this,"viewport",new fj)}syncWithMapCamera(e){let{center:t,zoom:r,pitch:n,bearing:i,viewportHeight:o,viewportWidth:a}=e,s={width:this.viewport.width,height:this.viewport.height,longitude:this.viewport.center[0],latitude:this.viewport.center[1],zoom:this.viewport.zoom,pitch:this.viewport.pitch,bearing:this.viewport.bearing};this.viewport=new fj(il(il({},s),{},{width:a,height:o,longitude:t&&t[0],latitude:t&&t[1],zoom:r,pitch:n,bearing:i}))}getZoom(){return this.viewport.zoom}getZoomScale(){return Math.pow(2,this.getZoom())}getCenter(){return[this.viewport.longitude,this.viewport.latitude]}getProjectionMatrix(){return this.viewport.projectionMatrix}getModelMatrix(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}getViewMatrix(){return this.viewport.viewMatrix}getViewMatrixUncentered(){return this.viewport.viewMatrixUncentered}getViewProjectionMatrix(){return this.viewport.viewProjectionMatrix}getViewProjectionMatrixUncentered(){return this.viewport.viewProjectionMatrix}getFocalDistance(){return 1}projectFlat(e,t){return this.viewport.projectFlat(e,t)}}class fH{constructor(e){ia(this,"size",1e4),this.size=e||1e4}setSize(e){this.size=e}getSize(){return[this.size,this.size]}mercatorXfromLng(e){return(180+e)/360*this.size}mercatorYfromLat(e){return(1-(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360)*this.size}lngFromMercatorX(e){return e/this.size*360-180}latFromMercatorY(e){return 360/Math.PI*Math.atan(Math.exp((180-(1-e/this.size)*360)*Math.PI/180))-90}project(e){return[this.mercatorXfromLng(e[0]),this.mercatorYfromLat(e[1])]}unproject(e){return[this.lngFromMercatorX(e[0]),this.latFromMercatorY(e[1])]}}let fG={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},fW={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"};class fX{constructor(e){ia(this,"version","DEFAUlTMAP"),ia(this,"map",void 0),ia(this,"simpleMapCoord",new fH),ia(this,"bgColor","rgba(0.0, 0.0, 0.0, 0.0)"),ia(this,"config",void 0),ia(this,"configService",void 0),ia(this,"coordinateSystemService",void 0),ia(this,"eventEmitter",void 0),ia(this,"markerContainer",void 0),ia(this,"cameraChangedCallback",void 0),ia(this,"$mapContainer",void 0),ia(this,"handleCameraChanged",e=>{let{lat:t,lng:r}=this.map.getCenter();this.emit("mapchange"),this.viewport.syncWithMapCamera({bearing:this.map.getBearing(),center:[r,t],viewportHeight:this.map.transform.height,pitch:this.map.getPitch(),viewportWidth:this.map.transform.width,zoom:this.map.getZoom(),cameraHeight:0}),this.updateCoordinateSystemService(),this.cameraChangedCallback(this.viewport)}),this.config=e.mapConfig,this.configService=e.globalConfigService,this.coordinateSystemService=e.coordinateSystemService,this.eventEmitter=new tG.EventEmitter}setBgColor(e){this.bgColor=e}addMarkerContainer(){let e=this.map.getCanvasContainer();this.markerContainer=tg("div","l7-marker-container",e),this.markerContainer.setAttribute("tabindex","-1")}getMarkerContainer(){return this.markerContainer}getOverlayContainer(){}getCanvasOverlays(){}on(e,t){-1!==ik.indexOf(e)?this.eventEmitter.on(e,t):this.map.on(fW[e]||e,t)}off(e,t){this.map.off(fW[e]||e,t),this.eventEmitter.off(e,t)}getContainer(){return this.map.getContainer()}getMapCanvasContainer(){return this.map.getCanvasContainer()}getSize(){if("SIMPLE"===this.version)return this.simpleMapCoord.getSize();let e=this.map.transform;return[e.width,e.height]}getType(){return"default"}getZoom(){return this.map.getZoom()}setZoom(e){return this.map.setZoom(e)}getCenter(){return this.map.getCenter()}setCenter(e){this.map.setCenter(e)}getPitch(){return this.map.getPitch()}getRotation(){return this.map.getBearing()}getBounds(){return this.map.getBounds().toArray()}getMinZoom(){return this.map.getMinZoom()}getMaxZoom(){return this.map.getMaxZoom()}setRotation(e){this.map.setBearing(e)}zoomIn(e,t){this.map.zoomIn(e,t)}zoomOut(e,t){this.map.zoomOut(e,t)}setPitch(e){return this.map.setPitch(e)}panTo(e){this.map.panTo(e)}panBy(e=0,t=0){this.map.panBy([e,t])}fitBounds(e,t){this.map.fitBounds(e,t)}setMaxZoom(e){this.map.setMaxZoom(e)}setMinZoom(e){this.map.setMinZoom(e)}setMapStatus(e){!0===e.doubleClickZoom&&this.map.doubleClickZoom.enable(),!1===e.doubleClickZoom&&this.map.doubleClickZoom.disable(),!1===e.dragEnable&&this.map.dragPan.disable(),!0===e.dragEnable&&this.map.dragPan.enable(),!1===e.rotateEnable&&this.map.dragRotate.disable(),!0===e.dragEnable&&this.map.dragRotate.enable(),!1===e.keyboardEnable&&this.map.keyboard.disable(),!0===e.keyboardEnable&&this.map.keyboard.enable(),!1===e.zoomEnable&&this.map.scrollZoom.disable(),!0===e.zoomEnable&&this.map.scrollZoom.enable()}setZoomAndCenter(e,t){this.map.flyTo({zoom:e,center:t})}setMapStyle(e){var t;null===(t=this.map)||void 0===t||t.setStyle(this.getMapStyleValue(e))}meterToCoord(e,t){return 1}pixelToLngLat(e){return this.map.unproject(e)}lngLatToPixel(e){return this.map.project(e)}containerToLngLat(e){return this.map.unproject(e)}lngLatToContainer(e){return this.map.project(e)}getMapStyle(){try{var e;let t=null!==(e=this.map.getStyle().sprite)&&void 0!==e?e:"";if(/^mapbox:\/\/sprites\/zcxduo\/\w+\/\w+$/.test(t))return null==t?void 0:t.replace(/\/\w+$/,"").replace(/sprites/,"styles");return t}catch(e){return""}}getMapStyleConfig(){return fG}getMapStyleValue(e){var t;return null!==(t=this.getMapStyleConfig()[e])&&void 0!==t?t:e}destroy(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}emit(e,...t){this.eventEmitter.emit(e,...t)}once(e,...t){this.eventEmitter.once(e,...t)}getMapContainer(){return this.$mapContainer}exportMap(e){var t;let r=null===(t=this.map)||void 0===t?void 0:t.getCanvas();return"jpg"===e?null==r?void 0:r.toDataURL("image/jpeg"):null==r?void 0:r.toDataURL("image/png")}onCameraChanged(e){this.cameraChangedCallback=e}creatMapContainer(e){let t=e;return"string"==typeof e&&(t=document.getElementById(e)),t}updateView(e){this.emit("mapchange"),this.viewport.syncWithMapCamera({bearing:e.bearing,center:e.center,viewportHeight:e.viewportHeight,pitch:e.pitch,viewportWidth:e.viewportWidth,zoom:e.zoom,cameraHeight:0}),this.updateCoordinateSystemService(),this.cameraChangedCallback(this.viewport)}updateCoordinateSystemService(){let{offsetCoordinate:e=!0}=this.config;this.viewport.getZoom()>12&&e?this.coordinateSystemService.setCoordinateSystem(iA.LNGLAT_OFFSET):this.coordinateSystemService.setCoordinateSystem(iA.LNGLAT)}}let f$=["id","attributionControl","style","token","rotation","mapInstance"];!function(e,t){var r="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM,n="undefined"!=typeof wx&&null!==wx&&(void 0!==wx.request||void 0!==wx.miniProgram);if(!r&&!n&&(t||(t=document),t)){var i=t.head||t.getElementsByTagName("head")[0];if(!i){i=t.createElement("head");var o=t.body||t.getElementsByTagName("body")[0];o?o.parentNode.insertBefore(i,o):t.documentElement.appendChild(i)}var a=t.createElement("style");a.type="text/css",a.styleSheet?a.styleSheet.cssText=e:a.appendChild(t.createTextNode(e)),i.appendChild(a)}}(".mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-attrib-button:focus,.mapboxgl-ctrl-group button:focus{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E\")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E\")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:2px 24px 2px 0;margin:10px;position:relative;background-color:#fff;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 8px 2px 28px;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib-button{display:none;cursor:pointer;position:absolute;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E\");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;box-sizing:border-box;border-radius:12px;outline:none;top:0;right:0;border:0}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-top-left .mapboxgl-ctrl-attrib-button{left:0}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-inner,.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-button{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-button{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E\")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{flex-direction:column-reverse}.mapboxgl-popup-anchor-left{flex-direction:row}.mapboxgl-popup-anchor-right{flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:\"\";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:\"\";height:19px;left:-2px;position:absolute;top:-2px;width:19px;box-sizing:border-box;box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}"),window.mapboxgl=fb();let fZ=0,fY="101MlGsZ2AmmA&access_token=pk.eyJ1IjoiZXhhbXBsZXMiLCJhIjoiY2p0MG01MXRqMW45cjQzb2R6b2ptc3J4MSJ9.zA2W0IkI0c6KaAhJfk9bWg";class fq extends fX{constructor(...e){super(...e),ia(this,"version","MAPBOX"),ia(this,"viewport",void 0)}getType(){return"mapbox"}lngLatToCoord(e,t={x:0,y:0,z:0}){let{x:r,y:n}=this.lngLatToMercator(e,0);return[r-t.x,n-t.y]}lngLatToMercator(e,t){let{x:r=0,y:n=0,z:i=0}=window.mapboxgl.MercatorCoordinate.fromLngLat(e,t);return{x:r,y:n,z:i}}getModelMatrix(e,t,r,n=[1,1,1],i={x:0,y:0,z:0}){let o=window.mapboxgl.MercatorCoordinate.fromLngLat(e,t),a=o.meterInMercatorCoordinateUnits(),s=i$();return iq(s,s,dF(o.x-i.x,o.y-i.y,o.z||0-i.z)),iK(s,s,dF(a*n[0],-a*n[1],a*n[2])),iQ(s,s,r[0]),iJ(s,s,r[1]),i0(s,s,r[2]),s}init(){var e=this;return iG(function*(){let t=e.config,{id:r="map",attributionControl:n=!1,style:i="light",token:o=fY,rotation:a=0,mapInstance:s}=t,l=ox(t,f$);e.viewport=new fV,s||window.mapboxgl||console.error(e.configService.getSceneWarninfo("SDK")),o!==fY||"blank"===i||window.mapboxgl.accessToken||s||console.warn(e.configService.getSceneWarninfo("MapToken")),s||window.mapboxgl.accessToken||(window.mapboxgl.accessToken=o),s?(e.map=s,e.$mapContainer=e.map.getContainer()):(e.$mapContainer=e.creatMapContainer(r),e.map=new window.mapboxgl.Map(il({container:e.$mapContainer,style:e.getMapStyleValue(i),attributionControl:n,bearing:a},l))),e.map.on("load",()=>{e.handleCameraChanged()}),e.map.on("move",e.handleCameraChanged),e.handleCameraChanged()})()}destroy(){var e;null===(e=this.$mapContainer)||void 0===e||null===(e=e.parentNode)||void 0===e||e.removeChild(this.$mapContainer),this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}emit(e,...t){this.eventEmitter.emit(e,...t)}once(e,...t){this.eventEmitter.once(e,...t)}getMapContainer(){return this.$mapContainer}getCanvasOverlays(){var e;return null===(e=this.getMapContainer())||void 0===e?void 0:e.querySelector(".mapboxgl-canvas-container")}meterToCoord(e,t){let r=new(fb()).LngLat(e[0],e[1]),n=new(fb()).LngLat(t[0],t[1]),i=r.distanceTo(n),o=fb().MercatorCoordinate.fromLngLat({lng:e[0],lat:e[1]}),a=fb().MercatorCoordinate.fromLngLat({lng:t[0],lat:t[1]}),{x:s,y:l}=o,{x:u,y:c}=a;return 8388608*Math.sqrt(Math.pow(s-u,2)+Math.pow(l-c,2))/i}exportMap(e){let t=this.map.getCanvas();return"jpg"===e?null==t?void 0:t.toDataURL("image/jpeg"):null==t?void 0:t.toDataURL("image/png")}creatMapContainer(e){let t=e;"string"==typeof e&&(t=document.getElementById(e));let r=document.createElement("div");return r.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,r.id="l7_mapbox_div"+fZ++,t.appendChild(r),r}}!function(e,t){var r="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM,n="undefined"!=typeof wx&&null!==wx&&(void 0!==wx.request||void 0!==wx.miniProgram);if(!r&&!n&&(t||(t=document),t)){var i=t.head||t.getElementsByTagName("head")[0];if(!i){i=t.createElement("head");var o=t.body||t.getElementsByTagName("body")[0];o?o.parentNode.insertBefore(i,o):t.documentElement.appendChild(i)}var a=t.createElement("style");a.type="text/css",a.styleSheet?a.styleSheet.cssText=e:a.appendChild(t.createTextNode(e)),i.appendChild(a)}}(`.mapboxgl-ctrl-logo {
  display: none !important;
}
`);class fK extends fy{getServiceConstructor(){return fq}}var fQ=r(16502),fJ=r.n(fQ),f0=class{constructor(e,t){let{buffer:r,offset:n,stride:i,normalized:o,size:a,divisor:s}=t;this.buffer=r,this.attribute={buffer:r.get(),offset:n||0,stride:i||0,normalized:o||!1,divisor:s||0},a&&(this.attribute.size=a)}get(){return this.attribute}updateBuffer(e){this.buffer.subData(e)}destroy(){this.buffer.destroy()}},f1={[ic.POINTS]:"points",[ic.LINES]:"lines",[ic.LINE_LOOP]:"line loop",[ic.LINE_STRIP]:"line strip",[ic.TRIANGLES]:"triangles",[ic.TRIANGLE_FAN]:"triangle fan",[ic.TRIANGLE_STRIP]:"triangle strip"},f2={[ic.STATIC_DRAW]:"static",[ic.DYNAMIC_DRAW]:"dynamic",[ic.STREAM_DRAW]:"stream"},f3={[ic.BYTE]:"int8",[ic.INT]:"int32",[ic.UNSIGNED_BYTE]:"uint8",[ic.UNSIGNED_SHORT]:"uint16",[ic.UNSIGNED_INT]:"uint32",[ic.FLOAT]:"float"},f4={[ic.ALPHA]:"alpha",[ic.LUMINANCE]:"luminance",[ic.LUMINANCE_ALPHA]:"luminance alpha",[ic.RGB]:"rgb",[ic.RGBA]:"rgba",[ic.RGBA4]:"rgba4",[ic.RGB5_A1]:"rgb5 a1",[ic.RGB565]:"rgb565",[ic.DEPTH_COMPONENT]:"depth",[ic.DEPTH_STENCIL]:"depth stencil"},f5={[ic.DONT_CARE]:"dont care",[ic.NICEST]:"nice",[ic.FASTEST]:"fast"},f6={[ic.NEAREST]:"nearest",[ic.LINEAR]:"linear",[ic.LINEAR_MIPMAP_LINEAR]:"mipmap",[ic.NEAREST_MIPMAP_LINEAR]:"nearest mipmap linear",[ic.LINEAR_MIPMAP_NEAREST]:"linear mipmap nearest",[ic.NEAREST_MIPMAP_NEAREST]:"nearest mipmap nearest"},f7={[ic.REPEAT]:"repeat",[ic.CLAMP_TO_EDGE]:"clamp",[ic.MIRRORED_REPEAT]:"mirror"},f8={[ic.NONE]:"none",[ic.BROWSER_DEFAULT_WEBGL]:"browser"},f9={[ic.NEVER]:"never",[ic.ALWAYS]:"always",[ic.LESS]:"less",[ic.LEQUAL]:"lequal",[ic.GREATER]:"greater",[ic.GEQUAL]:"gequal",[ic.EQUAL]:"equal",[ic.NOTEQUAL]:"notequal"},ge={[ic.FUNC_ADD]:"add",[ic.MIN_EXT]:"min",[ic.MAX_EXT]:"max",[ic.FUNC_SUBTRACT]:"subtract",[ic.FUNC_REVERSE_SUBTRACT]:"reverse subtract"},gt={[ic.ZERO]:"zero",[ic.ONE]:"one",[ic.SRC_COLOR]:"src color",[ic.ONE_MINUS_SRC_COLOR]:"one minus src color",[ic.SRC_ALPHA]:"src alpha",[ic.ONE_MINUS_SRC_ALPHA]:"one minus src alpha",[ic.DST_COLOR]:"dst color",[ic.ONE_MINUS_DST_COLOR]:"one minus dst color",[ic.DST_ALPHA]:"dst alpha",[ic.ONE_MINUS_DST_ALPHA]:"one minus dst alpha",[ic.CONSTANT_COLOR]:"constant color",[ic.ONE_MINUS_CONSTANT_COLOR]:"one minus constant color",[ic.CONSTANT_ALPHA]:"constant alpha",[ic.ONE_MINUS_CONSTANT_ALPHA]:"one minus constant alpha",[ic.SRC_ALPHA_SATURATE]:"src alpha saturate"},gr={[ic.NEVER]:"never",[ic.ALWAYS]:"always",[ic.LESS]:"less",[ic.LEQUAL]:"lequal",[ic.GREATER]:"greater",[ic.GEQUAL]:"gequal",[ic.EQUAL]:"equal",[ic.NOTEQUAL]:"notequal"},gn={[ic.ZERO]:"zero",[ic.KEEP]:"keep",[ic.REPLACE]:"replace",[ic.INVERT]:"invert",[ic.INCR]:"increment",[ic.DECR]:"decrement",[ic.INCR_WRAP]:"increment wrap",[ic.DECR_WRAP]:"decrement wrap"},gi={[ic.FRONT]:"front",[ic.BACK]:"back"},go=class{constructor(e,t){this.isDestroyed=!1;let{data:r,usage:n,type:i}=t;this.buffer=e.buffer({data:r,usage:f2[n||ic.STATIC_DRAW],type:f3[i||ic.UNSIGNED_BYTE]})}get(){return this.buffer}destroy(){this.isDestroyed||this.buffer.destroy(),this.isDestroyed=!0}subData({data:e,offset:t}){this.buffer.subdata(e,t)}},ga=class{constructor(e,t){let{data:r,usage:n,type:i,count:o}=t;this.elements=e.elements({data:r,usage:f2[n||ic.STATIC_DRAW],type:f3[i||ic.UNSIGNED_BYTE],count:o})}get(){return this.elements}subData({data:e}){this.elements.subdata(e)}destroy(){}},gs=class{constructor(e,t){let{width:r,height:n,color:i,colors:o}=t,a={width:r,height:n};Array.isArray(o)&&(a.colors=o.map(e=>e.get())),i&&"boolean"!=typeof i&&(a.color=i.get()),this.framebuffer=e.framebuffer(a)}get(){return this.framebuffer}destroy(){this.framebuffer.destroy()}resize({width:e,height:t}){this.framebuffer.resize(e,t)}},gl=r(64049),gu=Object.defineProperty,gc=Object.defineProperties,gh=Object.getOwnPropertyDescriptors,gd=Object.getOwnPropertySymbols,gp=Object.prototype.hasOwnProperty,gf=Object.prototype.propertyIsEnumerable,gg=(e,t,r)=>t in e?gu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,gm=(e,t)=>{for(var r in t||(t={}))gp.call(t,r)&&gg(e,r,t[r]);if(gd)for(var r of gd(t))gf.call(t,r)&&gg(e,r,t[r]);return e},gv=(e,t)=>gc(e,gh(t)),{isPlainObject:gy,isTypedArray:g_}=th,gb=class{constructor(e,t){this.destroyed=!1,this.uniforms={},this.reGl=e;let{vs:r,fs:n,attributes:i,uniforms:o,primitive:a,count:s,elements:l,depth:u,cull:c,instances:h}=t,d={platformString:"WebGL1",glslVersion:"#version 100",explicitBindingLocations:!1,separateSamplerTextures:!1,viewportOrigin:gl.FS.LOWER_LEFT,clipSpaceNearZ:gl.rF.NEGATIVE_ONE,supportMRT:!1},p={};this.options=t,o&&(this.uniforms=this.extractUniforms(o),Object.keys(o).forEach(t=>{p[t]=e.prop(t)}));let f={};Object.keys(i).forEach(e=>{f[e]=i[e].get()});let g={attributes:f,frag:i_((0,gl.hv)(d,"frag",n,null,!1)),uniforms:p,vert:i_((0,gl.hv)(d,"vert",r,null,!1)),colorMask:e.prop("colorMask"),lineWidth:1,blend:{enable:e.prop("blend.enable"),func:e.prop("blend.func"),equation:e.prop("blend.equation"),color:e.prop("blend.color")},stencil:{enable:e.prop("stencil.enable"),mask:e.prop("stencil.mask"),func:e.prop("stencil.func"),opFront:e.prop("stencil.opFront"),opBack:e.prop("stencil.opBack")},primitive:f1[void 0===a?ic.TRIANGLES:a]};h&&(g.instances=h),s?g.count=s:l&&(g.elements=l.get()),this.initDepthDrawParams({depth:u},g),this.initCullDrawParams({cull:c},g),this.drawCommand=e(g),this.drawParams=g}updateAttributesAndElements(e,t){let r={};Object.keys(e).forEach(t=>{r[t]=e[t].get()}),this.drawParams.attributes=r,this.drawParams.elements=t.get(),this.drawCommand=this.reGl(this.drawParams)}updateAttributes(e){let t={};Object.keys(e).forEach(r=>{t[r]=e[r].get()}),this.drawParams.attributes=t,this.drawCommand=this.reGl(this.drawParams)}addUniforms(e){this.uniforms=gm(gm({},this.uniforms),this.extractUniforms(e))}draw(e,t){if(this.drawParams.attributes&&0===Object.keys(this.drawParams.attributes).length)return;let r=gm(gm({},this.uniforms),this.extractUniforms(e.uniforms||{})),n={};Object.keys(r).forEach(e=>{let t=typeof r[e];"boolean"===t||"number"===t||Array.isArray(r[e])||r[e].BYTES_PER_ELEMENT?n[e]=r[e]:n[e]=r[e].get()}),n.blend=t?this.getBlendDrawParams({blend:{enable:!1}}):this.getBlendDrawParams(e),n.stencil=this.getStencilDrawParams(e),n.colorMask=this.getColorMaskDrawParams(e,t),this.drawCommand(n)}destroy(){var e,t;null==(t=null==(e=this.drawParams)?void 0:e.elements)||t.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(e=>{null==e||e.destroy()}),this.destroyed=!0}initDepthDrawParams({depth:e},t){e&&(t.depth={enable:void 0===e.enable||!!e.enable,mask:void 0===e.mask||!!e.mask,func:f9[e.func||ic.LESS],range:e.range||[0,1]})}getBlendDrawParams({blend:e}){let{enable:t,func:r,equation:n,color:i=[0,0,0,0]}=e||{};return{enable:!!t,func:{srcRGB:gt[r&&r.srcRGB||ic.SRC_ALPHA],srcAlpha:gt[r&&r.srcAlpha||ic.SRC_ALPHA],dstRGB:gt[r&&r.dstRGB||ic.ONE_MINUS_SRC_ALPHA],dstAlpha:gt[r&&r.dstAlpha||ic.ONE_MINUS_SRC_ALPHA]},equation:{rgb:ge[n&&n.rgb||ic.FUNC_ADD],alpha:ge[n&&n.alpha||ic.FUNC_ADD]},color:i}}getStencilDrawParams({stencil:e}){let{enable:t,mask:r=-1,func:n={cmp:ic.ALWAYS,ref:0,mask:-1},opFront:i={fail:ic.KEEP,zfail:ic.KEEP,zpass:ic.KEEP},opBack:o={fail:ic.KEEP,zfail:ic.KEEP,zpass:ic.KEEP}}=e||{};return{enable:!!t,mask:r,func:gv(gm({},n),{cmp:gr[n.cmp]}),opFront:{fail:gn[i.fail],zfail:gn[i.zfail],zpass:gn[i.zpass]},opBack:{fail:gn[o.fail],zfail:gn[o.zfail],zpass:gn[o.zpass]}}}getColorMaskDrawParams({stencil:e},t){return(null==e?void 0:e.enable)&&e.opFront&&!t?[!1,!1,!1,!1]:[!0,!0,!0,!0]}initCullDrawParams({cull:e},t){if(e){let{enable:r,face:n=ic.BACK}=e;t.cull={enable:!!r,face:gi[n]}}}extractUniforms(e){let t={};return Object.keys(e).forEach(r=>{this.extractUniformsRecursively(r,e[r],t,"")}),t}extractUniformsRecursively(e,t,r,n){if(null===t||"number"==typeof t||"boolean"==typeof t||Array.isArray(t)&&"number"==typeof t[0]||g_(t)||""===t||"resize"in t){r[`${n&&n+"."}${e}`]=t;return}gy(t)&&Object.keys(t).forEach(i=>{this.extractUniformsRecursively(i,t[i],r,`${n&&n+"."}${e}`)}),Array.isArray(t)&&t.forEach((t,i)=>{Object.keys(t).forEach(o=>{this.extractUniformsRecursively(o,t[o],r,`${n&&n+"."}${e}[${i}]`)})})}},gx=class{constructor(e,t){this.isDestroy=!1;let{data:r,type:n=ic.UNSIGNED_BYTE,width:i,height:o,flipY:a=!1,format:s=ic.RGBA,mipmap:l=!1,wrapS:u=ic.CLAMP_TO_EDGE,wrapT:c=ic.CLAMP_TO_EDGE,aniso:h=0,alignment:d=1,premultiplyAlpha:p=!1,mag:f=ic.NEAREST,min:g=ic.NEAREST,colorSpace:m=ic.BROWSER_DEFAULT_WEBGL,x:v=0,y=0,copy:_=!1}=t;this.width=i,this.height=o;let b={width:i,height:o,type:f3[n],format:f4[s],wrapS:f7[u],wrapT:f7[c],mag:f6[f],min:f6[g],alignment:d,flipY:a,colorSpace:f8[m],premultiplyAlpha:p,aniso:h,x:v,y,copy:_};r&&(b.data=r),"number"==typeof l?b.mipmap=f5[l]:"boolean"==typeof l&&(b.mipmap=l),this.texture=e.texture(b)}get(){return this.texture}update(e={}){this.texture(e)}bind(){this.texture._texture.bind()}resize({width:e,height:t}){this.texture.resize(e,t),this.width=e,this.height=t}getSize(){return[this.width,this.height]}destroy(){var e;this.isDestroy||null==(e=this.texture)||e.destroy(),this.isDestroy=!0}},gS=(e,t,r)=>new Promise((n,i)=>{var o=e=>{try{s(r.next(e))}catch(e){i(e)}},a=e=>{try{s(r.throw(e))}catch(e){i(e)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,a);s((r=r.apply(e,t)).next())}),gA=class{constructor(){this.uniformBuffers=[],this.queryVerdorInfo=()=>"WebGL1",this.createModel=e=>new gb(this.gl,e),this.createAttribute=e=>new f0(this.gl,e),this.createBuffer=e=>new go(this.gl,e),this.createElements=e=>new ga(this.gl,e),this.createTexture2D=e=>new gx(this.gl,e),this.createFramebuffer=e=>new gs(this.gl,e),this.useFramebuffer=(e,t)=>{this.gl({framebuffer:e?e.get():null})(t)},this.useFramebufferAsync=(e,t)=>gS(this,null,function*(){this.gl({framebuffer:e?e.get():null})(t)}),this.clear=e=>{var t;let{color:r,depth:n,stencil:i,framebuffer:o=null}=e,a={color:r,depth:n,stencil:i};a.framebuffer=null===o?o:o.get(),null==(t=this.gl)||t.clear(a)},this.viewport=({x:e,y:t,width:r,height:n})=>{this.gl._gl.viewport(e,t,r,n),this.width=r,this.height=n,this.gl._refresh()},this.readPixels=e=>{let{framebuffer:t,x:r,y:n,width:i,height:o}=e,a={x:r,y:n,width:i,height:o};return t&&(a.framebuffer=t.get()),this.gl.read(a)},this.readPixelsAsync=e=>gS(this,null,function*(){return this.readPixels(e)}),this.getViewportSize=()=>({width:this.gl._gl.drawingBufferWidth,height:this.gl._gl.drawingBufferHeight}),this.getContainer=()=>{var e;return null==(e=this.canvas)?void 0:e.parentElement},this.getCanvas=()=>this.canvas,this.getGLContext=()=>this.gl._gl,this.destroy=()=>{var e,t,r;this.canvas=null,null==(r=null==(t=null==(e=this.gl)?void 0:e._gl)?void 0:t.getExtension("WEBGL_lose_context"))||r.loseContext(),this.gl.destroy(),this.gl=null}}init(e,t,r){return gS(this,null,function*(){this.canvas=e,r?this.gl=r:this.gl=yield new Promise((e,r)=>{fJ()({canvas:this.canvas,attributes:{alpha:!0,antialias:t.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,stencil:t.stencil},extensions:["OES_element_index_uint","OES_standard_derivatives","ANGLE_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture","WEBGL_lose_context"],profile:!0,onDone:(t,n)=>{(t||!n)&&r(t),e(n)}})}),this.extensionObject={OES_texture_float:this.testExtension("OES_texture_float")}})}getPointSizeRange(){return this.gl._gl.getParameter(this.gl._gl.ALIASED_POINT_SIZE_RANGE)}testExtension(e){return!!this.getGLContext().getExtension(e)}setState(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!0,equation:"add"},framebuffer:null}),this.gl._refresh()}setBaseState(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}setCustomLayerDefaults(){let e=this.getGLContext();e.disable(e.CULL_FACE)}setDirty(e){this.isDirty=e}getDirty(){return this.isDirty}beginFrame(){}endFrame(){}},gE=class{constructor(e,t){let{buffer:r,offset:n,stride:i,normalized:o,size:a,divisor:s,shaderLocation:l}=t;this.buffer=r,this.attribute={shaderLocation:l,buffer:r.get(),offset:n||0,stride:i||0,normalized:o||!1,divisor:s||0},a&&(this.attribute.size=a)}get(){return this.buffer}updateBuffer(e){this.buffer.subData(e)}destroy(){this.buffer.destroy()}},gT={[ic.FLOAT]:Float32Array,[ic.UNSIGNED_BYTE]:Uint8Array,[ic.SHORT]:Int16Array,[ic.UNSIGNED_SHORT]:Uint16Array,[ic.INT]:Int32Array,[ic.UNSIGNED_INT]:Uint32Array},gC={[ic.POINTS]:gl.P8.POINTS,[ic.LINES]:gl.P8.LINES,[ic.LINE_LOOP]:gl.P8.LINES,[ic.LINE_STRIP]:gl.P8.LINE_STRIP,[ic.TRIANGLES]:gl.P8.TRIANGLES,[ic.TRIANGLE_FAN]:gl.P8.TRIANGLES,[ic.TRIANGLE_STRIP]:gl.P8.TRIANGLE_STRIP},gw={1:gl.yL.F32_R,2:gl.yL.F32_RG,3:gl.yL.F32_RGB,4:gl.yL.F32_RGBA},gL={[ic.STATIC_DRAW]:gl.WP.STATIC,[ic.DYNAMIC_DRAW]:gl.WP.DYNAMIC,[ic.STREAM_DRAW]:gl.WP.DYNAMIC},gM={[ic.REPEAT]:gl.Ap.REPEAT,[ic.CLAMP_TO_EDGE]:gl.Ap.CLAMP_TO_EDGE,[ic.MIRRORED_REPEAT]:gl.Ap.MIRRORED_REPEAT},gO={[ic.NEVER]:gl.MT.NEVER,[ic.ALWAYS]:gl.MT.ALWAYS,[ic.LESS]:gl.MT.LESS,[ic.LEQUAL]:gl.MT.LEQUAL,[ic.GREATER]:gl.MT.GREATER,[ic.GEQUAL]:gl.MT.GEQUAL,[ic.EQUAL]:gl.MT.EQUAL,[ic.NOTEQUAL]:gl.MT.NOTEQUAL},gI={[ic.FRONT]:gl.Ac.FRONT,[ic.BACK]:gl.Ac.BACK},gP={[ic.FUNC_ADD]:gl.Nx.ADD,[ic.MIN_EXT]:gl.Nx.MIN,[ic.MAX_EXT]:gl.Nx.MAX,[ic.FUNC_SUBTRACT]:gl.Nx.SUBSTRACT,[ic.FUNC_REVERSE_SUBTRACT]:gl.Nx.REVERSE_SUBSTRACT},gR={[ic.ZERO]:gl.dn.ZERO,[ic.ONE]:gl.dn.ONE,[ic.SRC_COLOR]:gl.dn.SRC,[ic.ONE_MINUS_SRC_COLOR]:gl.dn.ONE_MINUS_SRC,[ic.SRC_ALPHA]:gl.dn.SRC_ALPHA,[ic.ONE_MINUS_SRC_ALPHA]:gl.dn.ONE_MINUS_SRC_ALPHA,[ic.DST_COLOR]:gl.dn.DST,[ic.ONE_MINUS_DST_COLOR]:gl.dn.ONE_MINUS_DST,[ic.DST_ALPHA]:gl.dn.DST_ALPHA,[ic.ONE_MINUS_DST_ALPHA]:gl.dn.ONE_MINUS_DST_ALPHA,[ic.CONSTANT_COLOR]:gl.dn.CONST,[ic.ONE_MINUS_CONSTANT_COLOR]:gl.dn.ONE_MINUS_CONSTANT,[ic.CONSTANT_ALPHA]:gl.dn.CONST,[ic.ONE_MINUS_CONSTANT_ALPHA]:gl.dn.ONE_MINUS_CONSTANT,[ic.SRC_ALPHA_SATURATE]:gl.dn.SRC_ALPHA_SATURATE},gk={[ic.REPLACE]:gl.Eb.REPLACE,[ic.KEEP]:gl.Eb.KEEP,[ic.ZERO]:gl.Eb.ZERO,[ic.INVERT]:gl.Eb.INVERT,[ic.INCR]:gl.Eb.INCREMENT_CLAMP,[ic.DECR]:gl.Eb.DECREMENT_CLAMP,[ic.INCR_WRAP]:gl.Eb.INCREMENT_WRAP,[ic.DECR_WRAP]:gl.Eb.DECREMENT_WRAP},gN={[ic.ALWAYS]:gl.MT.ALWAYS,[ic.EQUAL]:gl.MT.EQUAL,[ic.GEQUAL]:gl.MT.GEQUAL,[ic.GREATER]:gl.MT.GREATER,[ic.LEQUAL]:gl.MT.LEQUAL,[ic.LESS]:gl.MT.LESS,[ic.NEVER]:gl.MT.NEVER,[ic.NOTEQUAL]:gl.MT.NOTEQUAL},gD={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121};function gU(e){return Object.prototype.toString.call(e)in gD}var gz=class{constructor(e,t){let r;this.isDestroyed=!1;let{data:n,usage:i,type:o,isUBO:a,label:s}=t;r=gU(n)?n:new gT[this.type||ic.FLOAT](n),this.type=o,this.size=r.byteLength,this.buffer=e.createBuffer({viewOrSize:r,usage:a?gl.Sd.UNIFORM:gl.Sd.VERTEX,hint:gL[i||ic.STATIC_DRAW]}),s&&e.setResourceName(this.buffer,s)}get(){return this.buffer}destroy(){this.isDestroyed||this.buffer.destroy(),this.isDestroyed=!0}subData({data:e,offset:t}){let r;r=gU(e)?e:new gT[this.type||ic.FLOAT](e),this.buffer.setSubData(t,new Uint8Array(r.buffer))}};function gB(e,t=0){return e+=t,e+=e<<10,(e+=e>>>6)>>>0}function gF(e){return e+=e<<3,e^=e>>>11,(e+=e<<15)>>>0}function gj(){return 0}var gV=class{constructor(){this.keys=[],this.values=[]}},gH=class{constructor(e,t){this.keyEqualFunc=e,this.keyHashFunc=t,this.buckets=new Map}findBucketIndex(e,t){for(let r=0;r<e.keys.length;r++)if(this.keyEqualFunc(t,e.keys[r]))return r;return -1}findBucket(e){let t=this.keyHashFunc(e);return this.buckets.get(t)}get(e){let t=this.findBucket(e);if(void 0===t)return null;let r=this.findBucketIndex(t,e);return r<0?null:t.values[r]}add(e,t){let r=this.keyHashFunc(e);void 0===this.buckets.get(r)&&this.buckets.set(r,new gV);let n=this.buckets.get(r);n.keys.push(e),n.values.push(t)}delete(e){let t=this.findBucket(e);if(void 0===t)return;let r=this.findBucketIndex(t,e);-1!==r&&(t.keys.splice(r,1),t.values.splice(r,1))}clear(){this.buckets.clear()}size(){let e=0;for(let t of this.buckets.values())e+=t.values.length;return e}*values(){for(let e of this.buckets.values())for(let t=e.values.length-1;t>=0;t--)yield e.values[t]}};function gG(e,t){return e=gB(e,t.blendMode),e=gB(e,t.blendSrcFactor),e=gB(e,t.blendDstFactor)}function gW(e){let t=0;t=gB(0,e.program.id),null!==e.inputLayout&&(t=gB(t,e.inputLayout.id)),t=function(e,t){var r,n,i,o,a,s,l,u,c,h,d;for(let r=0;r<t.attachmentsState.length;r++)c=gG(c=e,(h=t.attachmentsState[r]).rgbBlendState),e=c=gB(c=gG(c,h.alphaBlendState),h.channelWriteMask);return e=gB(e,(d=t.blendConstant||gl.gh).r<<24|d.g<<16|d.b<<8|d.a),e=gB(e,t.depthCompare),e=gB(e,t.depthWrite?1:0),e=gB(e,null==(r=t.stencilFront)?void 0:r.compare),e=gB(e,null==(n=t.stencilFront)?void 0:n.passOp),e=gB(e,null==(i=t.stencilFront)?void 0:i.failOp),e=gB(e,null==(o=t.stencilFront)?void 0:o.depthFailOp),e=gB(e,null==(a=t.stencilBack)?void 0:a.compare),e=gB(e,null==(s=t.stencilBack)?void 0:s.passOp),e=gB(e,null==(l=t.stencilBack)?void 0:l.failOp),e=gB(e,null==(u=t.stencilBack)?void 0:u.depthFailOp),e=gB(e,t.stencilWrite?1:0),e=gB(e,t.cullMode),e=gB(e,t.frontFace?1:0),e=gB(e,t.polygonOffset?1:0)}(t,e.megaStateDescriptor);for(let r=0;r<e.colorAttachmentFormats.length;r++)t=gB(t,e.colorAttachmentFormats[r]||0);return gF(t=gB(t,e.depthStencilAttachmentFormat||0))}function gX(e){let t=0;if(e.samplerBindings)for(let r=0;r<e.samplerBindings.length;r++){let n=e.samplerBindings[r];null!==n&&null!==n.texture&&(t=gB(t,n.texture.id))}if(e.uniformBufferBindings)for(let r=0;r<e.uniformBufferBindings.length;r++){let n=e.uniformBufferBindings[r];null!==n&&null!==n.buffer&&(t=gB(t,n.buffer.id),t=gB(t,n.binding),t=gB(t,n.offset),t=gB(t,n.size))}if(e.storageBufferBindings)for(let r=0;r<e.storageBufferBindings.length;r++){let n=e.storageBufferBindings[r];null!==n&&null!==n.buffer&&(t=gB(t,n.buffer.id),t=gB(t,n.binding),t=gB(t,n.offset),t=gB(t,n.size))}if(e.storageTextureBindings)for(let r=0;r<e.storageTextureBindings.length;r++){let n=e.storageTextureBindings[r];null!==n&&null!==n.texture&&(t=gB(t,n.texture.id),t=gB(t,n.binding))}return gF(t)}function g$(e,t){var r,n,i,o;return(null==(r=e.vertex)?void 0:r.glsl)===(null==(n=t.vertex)?void 0:n.glsl)&&(null==(i=e.fragment)?void 0:i.glsl)===(null==(o=t.fragment)?void 0:o.glsl)}var gZ=class{constructor(e){this.device=e,this.bindingsCache=new gH(gl.fe,gX),this.renderPipelinesCache=new gH(gl.JZ,gW),this.inputLayoutsCache=new gH(gl.V,gj),this.programCache=new gH(g$,gj)}createBindings(e){var t;let r=this.bindingsCache.get(e);if(null===r){let n=(0,gl.$u)(e);n.uniformBufferBindings=null==(t=n.uniformBufferBindings)?void 0:t.filter(({size:e})=>e&&e>0),r=this.device.createBindings(n),this.bindingsCache.add(n,r)}return r}createRenderPipeline(e){let t=this.renderPipelinesCache.get(e);if(null===t){let r=(0,gl.nK)(e);r.colorAttachmentFormats=r.colorAttachmentFormats.filter(e=>e),t=this.device.createRenderPipeline(r),this.renderPipelinesCache.add(r,t)}return t}createInputLayout(e){e.vertexBufferDescriptors=e.vertexBufferDescriptors.filter(e=>!!e);let t=this.inputLayoutsCache.get(e);if(null===t){let r=(0,gl.$1)(e);t=this.device.createInputLayout(r),this.inputLayoutsCache.add(r,t)}return t}createProgram(e){let t=this.programCache.get(e);if(null===t){var r,n;let i={vertex:{glsl:null==(r=e.vertex)?void 0:r.glsl},fragment:{glsl:null==(n=e.fragment)?void 0:n.glsl}};t=this.device.createProgram(e),this.programCache.add(i,t)}return t}destroy(){for(let e of this.bindingsCache.values())e.destroy();for(let e of this.renderPipelinesCache.values())e.destroy();for(let e of this.inputLayoutsCache.values())e.destroy();for(let e of this.programCache.values())e.destroy();this.bindingsCache.clear(),this.renderPipelinesCache.clear(),this.inputLayoutsCache.clear(),this.programCache.clear()}},gY=class{constructor(e,t){let r;let{data:n,type:i,count:o=0}=t;r=gU(n)?n:new gT[this.type||ic.UNSIGNED_INT](n),this.type=i,this.count=o,this.indexBuffer=e.createBuffer({viewOrSize:r,usage:gl.Sd.INDEX})}get(){return this.indexBuffer}subData({data:e}){let t;t=gU(e)?e:new gT[this.type||ic.UNSIGNED_INT](e),this.indexBuffer.setSubData(0,new Uint8Array(t.buffer))}destroy(){this.indexBuffer.destroy()}};function gq(e){return!!(e&&e.texture)}var gK=class{constructor(e,t){this.device=e,this.options=t,this.isDestroy=!1;let{wrapS:r=ic.CLAMP_TO_EDGE,wrapT:n=ic.CLAMP_TO_EDGE,aniso:i,mag:o=ic.NEAREST,min:a=ic.NEAREST}=t;this.createTexture(t),this.sampler=e.createSampler({addressModeU:gM[r],addressModeV:gM[n],minFilter:a===ic.NEAREST?gl.U7.POINT:gl.U7.BILINEAR,magFilter:o===ic.NEAREST?gl.U7.POINT:gl.U7.BILINEAR,mipmapFilter:gl.Wy.NO_MIP,maxAnisotropy:i})}createTexture(e){let{type:t=ic.UNSIGNED_BYTE,width:r,height:n,flipY:i=!1,format:o=ic.RGBA,alignment:a=1,usage:s=og.SAMPLED,unorm:l=!1,label:u}=e,{data:c}=e;this.width=r,this.height=n;let h=gl.yL.U8_RGBA_RT;if(t===ic.UNSIGNED_BYTE&&o===ic.RGBA)h=l?gl.yL.U8_RGBA_NORM:gl.yL.U8_RGBA_RT;else if(t===ic.UNSIGNED_BYTE&&o===ic.LUMINANCE)h=gl.yL.U8_LUMINANCE;else if(t===ic.FLOAT&&o===ic.LUMINANCE)h=gl.yL.F32_LUMINANCE;else if(t===ic.FLOAT&&o===ic.RGB)"WebGPU"===this.device.queryVendorInfo().platformString?(c&&(c=function(e,t){let r=e.length,n=Math.ceil(r/3),i=r+n,o=new Float32Array(i);for(let t=0;t<i;t+=4)o[t]=e[t/4*3],o[t+1]=e[t/4*3+1],o[t+2]=e[t/4*3+2],o[t+3]=0;return o}(c,0)),h=gl.yL.F32_RGBA):h=gl.yL.F32_RGB;else if(t===ic.FLOAT&&o===ic.RGBA)h=gl.yL.F32_RGBA;else if(t===ic.FLOAT&&o===ic.RED)h=gl.yL.F32_R;else throw Error(`create texture error, type: ${t}, format: ${o}`);this.texture=this.device.createTexture({format:h,width:r,height:n,usage:s===og.SAMPLED?gl.tT.SAMPLED:gl.tT.RENDER_TARGET,pixelStore:{unpackFlipY:i,packAlignment:a},mipLevelCount:1}),u&&this.device.setResourceName(this.texture,u),c&&this.texture.setImageData([c])}get(){return this.texture}update(e){let{data:t}=e;this.texture.setImageData([t])}bind(){}resize({width:e,height:t}){(this.width!==e||this.height!==t)&&this.destroy(),this.options.width=e,this.options.height=t,this.createTexture(this.options),this.isDestroy=!1}getSize(){return[this.width,this.height]}destroy(){var e;this.isDestroy||this.texture.destroyed||null==(e=this.texture)||e.destroy(),this.isDestroy=!0}},gQ=class{constructor(e,t){this.device=e,this.options=t,this.createColorRenderTarget(),this.createDepthRenderTarget()}createColorRenderTarget(e=!1){let{width:t,height:r,color:n}=this.options;n&&(gq(n)?(e&&n.resize({width:t,height:r}),this.colorTexture=n.get(),this.colorRenderTarget=this.device.createRenderTargetFromTexture(this.colorTexture),this.width=n.width,this.height=n.height):t&&r&&(this.colorTexture=this.device.createTexture({format:gl.yL.U8_RGBA_RT,usage:gl.tT.RENDER_TARGET,width:t,height:r}),this.colorRenderTarget=this.device.createRenderTargetFromTexture(this.colorTexture),this.width=t,this.height=r))}createDepthRenderTarget(e=!1){let{width:t,height:r,depth:n}=this.options;n&&(gq(n)?(e&&n.resize({width:t,height:r}),this.depthTexture=n.get(),this.depthRenderTarget=this.device.createRenderTargetFromTexture(this.depthTexture),this.width=n.width,this.height=n.height):t&&r&&(this.depthTexture=this.device.createTexture({format:gl.yL.D24_S8,usage:gl.tT.RENDER_TARGET,width:t,height:r}),this.depthRenderTarget=this.device.createRenderTargetFromTexture(this.depthTexture),this.width=t,this.height=r))}get(){return this.colorRenderTarget}destroy(){var e,t;null==(e=this.colorRenderTarget)||e.destroy(),null==(t=this.depthRenderTarget)||t.destroy()}resize({width:e,height:t}){(this.width!==e||this.height!==t)&&(this.destroy(),this.colorTexture.destroyed=!0,this.depthTexture.destroyed=!0,this.options.width=e,this.options.height=t,this.createColorRenderTarget(!0),this.createDepthRenderTarget(!0))}},gJ=Object.defineProperty,g0=Object.defineProperties,g1=Object.getOwnPropertyDescriptors,g2=Object.getOwnPropertySymbols,g3=Object.prototype.hasOwnProperty,g4=Object.prototype.propertyIsEnumerable,g5=(e,t,r)=>t in e?gJ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,g6=(e,t)=>{for(var r in t||(t={}))g3.call(t,r)&&g5(e,r,t[r]);if(g2)for(var r of g2(t))g4.call(t,r)&&g5(e,r,t[r]);return e},g7=(e,t)=>g0(e,g1(t)),{isPlainObject:g8,isTypedArray:g9,isNil:me}=th,mt=class{constructor(e,t,r){this.device=e,this.options=t,this.service=r,this.destroyed=!1,this.uniforms={},this.vertexBuffers=[];let{vs:n,fs:i,attributes:o,uniforms:a,count:s,elements:l,diagnosticDerivativeUniformityEnabled:u}=t;this.options=t;let c=u?"":this.service.viewportOrigin===gl.FS.UPPER_LEFT?"diagnostic(off,derivative_uniformity);":"";this.program=r.renderCache.createProgram({vertex:{glsl:n},fragment:{glsl:i,postprocess:e=>c+e}}),a&&(this.uniforms=this.extractUniforms(a));let h=[],d=0;Object.keys(o).forEach(e=>{let t=o[e],r=t.get();this.vertexBuffers.push(r.get());let{offset:n=0,stride:i=0,size:a=1,divisor:s=0,shaderLocation:l=0}=t.attribute;h.push({arrayStride:i||4*a,stepMode:gl.ab.VERTEX,attributes:[{format:gw[a],shaderLocation:l,offset:n,divisor:s}]}),d=r.size/a}),s||(this.options.count=d),l&&(this.indexBuffer=l.get());let p=r.renderCache.createInputLayout({vertexBufferDescriptors:h,indexBufferFormat:l?gl.yL.U32_R:null,program:this.program});this.inputLayout=p,this.pipeline=this.createPipeline(t)}createPipeline(e,t){var r;let{primitive:n=ic.TRIANGLES,depth:i,cull:o,blend:a,stencil:s}=e,l=this.initDepthDrawParams({depth:i}),u=!!(l&&l.enable),c=this.initCullDrawParams({cull:o}),h=!!(c&&c.enable),d=this.getBlendDrawParams({blend:a}),p=!!(d&&d.enable),f=this.getStencilDrawParams({stencil:s}),g=!!(f&&f.enable),m=this.device.createRenderPipeline({inputLayout:this.inputLayout,program:this.program,topology:gC[n],colorAttachmentFormats:[gl.yL.U8_RGBA_RT],depthStencilAttachmentFormat:gl.yL.D24_S8,megaStateDescriptor:{attachmentsState:[t?{channelWriteMask:gl.$G.ALL,rgbBlendState:{blendMode:gl.Nx.ADD,blendSrcFactor:gl.dn.ONE,blendDstFactor:gl.dn.ZERO},alphaBlendState:{blendMode:gl.Nx.ADD,blendSrcFactor:gl.dn.ONE,blendDstFactor:gl.dn.ZERO}}:{channelWriteMask:g&&f.opFront.zpass===gl.Eb.REPLACE?gl.$G.NONE:gl.$G.ALL,rgbBlendState:{blendMode:p&&d.equation.rgb||gl.Nx.ADD,blendSrcFactor:p&&d.func.srcRGB||gl.dn.SRC_ALPHA,blendDstFactor:p&&d.func.dstRGB||gl.dn.ONE_MINUS_SRC_ALPHA},alphaBlendState:{blendMode:p&&d.equation.alpha||gl.Nx.ADD,blendSrcFactor:p&&d.func.srcAlpha||gl.dn.ONE,blendDstFactor:p&&d.func.dstAlpha||gl.dn.ONE}}],blendConstant:p?gl.gh:void 0,depthWrite:u,depthCompare:u&&l.func||gl.MT.LESS,cullMode:h&&c.face||gl.Ac.NONE,stencilWrite:g,stencilFront:{compare:g?f.func.cmp:gl.MT.ALWAYS,passOp:f.opFront.zpass,failOp:f.opFront.fail,depthFailOp:f.opFront.zfail,mask:f.opFront.mask},stencilBack:{compare:g?f.func.cmp:gl.MT.ALWAYS,passOp:f.opBack.zpass,failOp:f.opBack.fail,depthFailOp:f.opBack.zfail,mask:f.opBack.mask}}});return g&&!me(null==(r=null==s?void 0:s.func)?void 0:r.ref)&&(m.stencilFuncReference=s.func.ref),m}updateAttributesAndElements(){}updateAttributes(){}addUniforms(e){this.uniforms=g6(g6({},this.uniforms),this.extractUniforms(e))}draw(e,t){let r=g6(g6({},this.options),e),{count:n=0,instances:i,elements:o,uniforms:a={},uniformBuffers:s,textures:l}=r;this.uniforms=g6(g6({},this.uniforms),this.extractUniforms(a));let{renderPass:u,currentFramebuffer:c,width:h,height:d}=this.service;this.pipeline=this.createPipeline(r,t);let p=this.service.device,f=p.swapChainHeight;if(p.swapChainHeight=(null==c?void 0:c.height)||d,u.setViewport(0,0,(null==c?void 0:c.width)||h,(null==c?void 0:c.height)||d),p.swapChainHeight=f,u.setPipeline(this.pipeline),me(this.pipeline.stencilFuncReference)||u.setStencilReference(this.pipeline.stencilFuncReference),u.setVertexInput(this.inputLayout,this.vertexBuffers.map(e=>({buffer:e})),o?{buffer:this.indexBuffer,offset:0}:null),s&&(this.bindings=p.createBindings({pipeline:this.pipeline,uniformBufferBindings:s.map((e,t)=>({binding:t,buffer:e.get(),size:e.size})),samplerBindings:null==l?void 0:l.map(e=>({texture:e.texture,sampler:e.sampler}))})),this.bindings&&(u.setBindings(this.bindings),Object.keys(this.uniforms).forEach(e=>{let t=this.uniforms[e];t instanceof gK?this.uniforms[e]=t.get():t instanceof gQ&&(this.uniforms[e]=t.get().texture)}),this.program.setUniformsLegacy(this.uniforms)),o){let e=o.count;0===e?u.draw(n,i):u.drawIndexed(e,i)}else u.draw(n,i)}destroy(){var e,t,r;null==(e=this.vertexBuffers)||e.forEach(e=>e.destroy()),null==(t=this.indexBuffer)||t.destroy(),null==(r=this.bindings)||r.destroy(),this.pipeline.destroy(),this.destroyed=!0}initDepthDrawParams({depth:e}){if(e)return{enable:void 0===e.enable||!!e.enable,mask:void 0===e.mask||!!e.mask,func:gO[e.func||ic.LESS],range:e.range||[0,1]}}getBlendDrawParams({blend:e}){let{enable:t,func:r,equation:n,color:i=[0,0,0,0]}=e||{};return{enable:!!t,func:{srcRGB:gR[r&&r.srcRGB||ic.SRC_ALPHA],srcAlpha:gR[r&&r.srcAlpha||ic.SRC_ALPHA],dstRGB:gR[r&&r.dstRGB||ic.ONE_MINUS_SRC_ALPHA],dstAlpha:gR[r&&r.dstAlpha||ic.ONE_MINUS_SRC_ALPHA]},equation:{rgb:gP[n&&n.rgb||ic.FUNC_ADD],alpha:gP[n&&n.alpha||ic.FUNC_ADD]},color:i}}getStencilDrawParams({stencil:e}){let{enable:t,mask:r=0xffffffff,func:n={cmp:ic.ALWAYS,ref:0,mask:0xffffffff},opFront:i={fail:ic.KEEP,zfail:ic.KEEP,zpass:ic.KEEP},opBack:o={fail:ic.KEEP,zfail:ic.KEEP,zpass:ic.KEEP}}=e||{};return{enable:!!t,mask:r,func:g7(g6({},n),{cmp:gN[n.cmp]}),opFront:{fail:gk[i.fail],zfail:gk[i.zfail],zpass:gk[i.zpass],mask:n.mask},opBack:{fail:gk[o.fail],zfail:gk[o.zfail],zpass:gk[o.zpass],mask:n.mask}}}initCullDrawParams({cull:e}){if(e){let{enable:t,face:r=ic.BACK}=e;return{enable:!!t,face:gI[r]}}}extractUniforms(e){let t={};return Object.keys(e).forEach(r=>{this.extractUniformsRecursively(r,e[r],t,"")}),t}extractUniformsRecursively(e,t,r,n){if(null===t||"number"==typeof t||"boolean"==typeof t||Array.isArray(t)&&"number"==typeof t[0]||g9(t)||""===t||"resize"in t){r[`${n&&n+"."}${e}`]=t;return}g8(t)&&Object.keys(t).forEach(i=>{this.extractUniformsRecursively(i,t[i],r,`${n&&n+"."}${e}`)}),Array.isArray(t)&&t.forEach((t,i)=>{Object.keys(t).forEach(o=>{this.extractUniformsRecursively(o,t[o],r,`${n&&n+"."}${e}[${i}]`)})})}},mr=(e,t,r)=>new Promise((n,i)=>{var o=e=>{try{s(r.next(e))}catch(e){i(e)}},a=e=>{try{s(r.throw(e))}catch(e){i(e)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,a);s((r=r.apply(e,t)).next())}),{isUndefined:mn}=th,mi=class{constructor(){this.uniformBuffers=[],this.queryVerdorInfo=()=>this.device.queryVendorInfo().platformString,this.createModel=e=>new mt(this.device,e,this),this.createAttribute=e=>new gE(this.device,e),this.createBuffer=e=>new gz(this.device,e),this.createElements=e=>new gY(this.device,e),this.createTexture2D=e=>new gK(this.device,e),this.createFramebuffer=e=>new gQ(this.device,e),this.useFramebuffer=(e,t)=>{this.currentFramebuffer=e,this.beginFrame(),t(),this.endFrame(),this.currentFramebuffer=null},this.useFramebufferAsync=(e,t)=>mr(this,null,function*(){this.currentFramebuffer=e,this.preRenderPass=this.renderPass,this.beginFrame(),yield t(),this.endFrame(),this.currentFramebuffer=null,this.renderPass=this.preRenderPass}),this.clear=e=>{let{color:t,depth:r,stencil:n,framebuffer:i=null}=e;if(i)i.clearOptions={color:t,depth:r,stencil:n};else{let e=this.queryVerdorInfo();if("WebGL1"===e){let e=this.getGLContext();mn(n)?mn(r)||(e.clearDepth(r),e.clear(e.DEPTH_BUFFER_BIT)):(e.clearStencil(n),e.clear(e.STENCIL_BUFFER_BIT))}else if("WebGL2"===e){let e=this.getGLContext();mn(n)?mn(r)||e.clearBufferfv(e.DEPTH,0,[r]):e.clearBufferiv(e.STENCIL,0,[n])}}},this.viewport=({width:e,height:t})=>{this.swapChain.configureSwapChain(e,t),this.createMainColorDepthRT(e,t),this.width=e,this.height=t},this.readPixels=e=>{let{framebuffer:t,x:r,y:n,width:i,height:o}=e,a=this.device.createReadback(),s=t.colorTexture,l=a.readTextureSync(s,r,this.viewportOrigin===gl.FS.LOWER_LEFT?n:this.height-n,i,o,new Uint8Array(i*o*4));if(this.viewportOrigin!==gl.FS.LOWER_LEFT)for(let e=0;e<l.length;e+=4){let t=l[e];l[e]=l[e+2],l[e+2]=t}return a.destroy(),l},this.readPixelsAsync=e=>mr(this,null,function*(){let{framebuffer:t,x:r,y:n,width:i,height:o}=e,a=this.device.createReadback(),s=t.colorTexture,l=yield a.readTexture(s,r,this.viewportOrigin===gl.FS.LOWER_LEFT?n:this.height-n,i,o,new Uint8Array(i*o*4));if(this.viewportOrigin!==gl.FS.LOWER_LEFT)for(let e=0;e<l.length;e+=4){let t=l[e];l[e]=l[e+2],l[e+2]=t}return a.destroy(),l}),this.getViewportSize=()=>({width:this.width,height:this.height}),this.getContainer=()=>{var e;return null==(e=this.canvas)?void 0:e.parentElement},this.getCanvas=()=>this.canvas,this.getGLContext=()=>this.device.gl,this.destroy=()=>{var e;this.canvas=null,null==(e=this.uniformBuffers)||e.forEach(e=>{e.destroy()}),this.device.destroy(),this.renderCache.destroy()}}init(e,t){return mr(this,null,function*(){let{enableWebGPU:r,shaderCompilerPath:n,antialias:i}=t;this.canvas=e;let o=r?new gl.NG({shaderCompilerPath:n}):new gl.YO({targets:["webgl2","webgl1"],antialias:i,onContextLost(e){console.warn("context lost",e)},onContextCreationError(e){console.warn("context creation error",e)},onContextRestored(e){console.warn("context restored",e)}}),a=yield o.createSwapChain(e);a.configureSwapChain(e.width,e.height),this.device=a.getDevice(),this.swapChain=a,this.renderCache=new gZ(this.device),this.currentFramebuffer=null,this.viewportOrigin=this.device.queryVendorInfo().viewportOrigin;let s=this.device.gl;this.extensionObject={OES_texture_float:!("undefined"!=typeof WebGL2RenderingContext&&s instanceof WebGL2RenderingContext)&&(!s||2!==s._version)&&this.device.OES_texture_float},this.createMainColorDepthRT(e.width,e.height)})}createMainColorDepthRT(e,t){this.mainColorRT&&this.mainColorRT.destroy(),this.mainDepthRT&&this.mainDepthRT.destroy(),this.mainColorRT=this.device.createRenderTargetFromTexture(this.device.createTexture({format:gl.yL.U8_RGBA_RT,width:e,height:t,usage:gl.tT.RENDER_TARGET})),this.mainDepthRT=this.device.createRenderTargetFromTexture(this.device.createTexture({format:gl.yL.D24_S8,width:e,height:t,usage:gl.tT.RENDER_TARGET}))}beginFrame(){this.device.beginFrame();let{currentFramebuffer:e,swapChain:t,mainColorRT:r,mainDepthRT:n}=this,i=e?e.colorRenderTarget:r,o=e?null:t.getOnscreenTexture(),a=e?e.depthRenderTarget:n,{color:s=[0,0,0,0],depth:l=1,stencil:u=0}=(null==e?void 0:e.clearOptions)||{},c=i?(0,gl.gv)(255*s[0],255*s[1],255*s[2],s[3]):gl.gh,h=this.device.createRenderPass({colorAttachment:[i],colorResolveTo:[o],colorClearColor:[c],colorStore:[!0],depthStencilAttachment:a,depthClearValue:a?l:void 0,stencilClearValue:a?u:void 0});this.renderPass=h}endFrame(){this.device.submitPass(this.renderPass),this.device.endFrame()}getPointSizeRange(){let e=this.device.gl;return e.getParameter(e.ALIASED_POINT_SIZE_RANGE)}testExtension(e){return!!this.getGLContext().getExtension(e)}setState(){}setBaseState(){}setCustomLayerDefaults(){}setDirty(e){this.isDirty=e}getDirty(){return this.isDirty}},mo=["selectstart","selecting","selectend"],ma=class extends tG.EventEmitter{constructor(e,t={}){super(),this.isEnable=!1,this.onDragStart=e=>{this.box.style.display="block",this.startEvent=this.endEvent=e,this.syncBoxBound(),this.emit("selectstart",this.getLngLatBox(),this.startEvent,this.endEvent)},this.onDragging=e=>{this.endEvent=e,this.syncBoxBound(),this.emit("selecting",this.getLngLatBox(),this.startEvent,this.endEvent)},this.onDragEnd=e=>{this.endEvent=e,this.box.style.display="none",this.emit("selectend",this.getLngLatBox(),this.startEvent,this.endEvent)},this.scene=e,this.options=t}get container(){return this.scene.getMapService().getMarkerContainer()}enable(){if(this.isEnable)return;let{className:e}=this.options;if(this.scene.setMapStatus({dragEnable:!1}),this.container.style.cursor="crosshair",!this.box){let t=tg("div",void 0,this.container);t.classList.add("l7-select-box"),e&&t.classList.add(e),t.style.display="none",this.box=t}this.scene.on("dragstart",this.onDragStart),this.scene.on("dragging",this.onDragging),this.scene.on("dragend",this.onDragEnd),this.isEnable=!0}disable(){this.isEnable&&(this.scene.setMapStatus({dragEnable:!0}),this.container.style.cursor="auto",this.scene.off("dragstart",this.onDragStart),this.scene.off("dragging",this.onDragging),this.scene.off("dragend",this.onDragEnd),this.isEnable=!1)}syncBoxBound(){let{x:e,y:t}=this.startEvent,{x:r,y:n}=this.endEvent,i=Math.min(e,r),o=Math.min(t,n),a=Math.abs(e-r),s=Math.abs(t-n);this.box.style.top=`${o}px`,this.box.style.left=`${i}px`,this.box.style.width=`${a}px`,this.box.style.height=`${s}px`}getLngLatBox(){var e,t,r;let{lngLat:{lng:n,lat:i}}=this.startEvent,{lngLat:{lng:o,lat:a}}=this.endEvent;return tT((e=[function(e,t,r){if(void 0===r&&(r={}),e.length<2)throw Error("coordinates must be an array of two or more positions");return A({type:"LineString",coordinates:e},void 0,r)}([[n,i],[o,a]])],void 0===t&&(t={}),r={type:"FeatureCollection"},t.id&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.features=e,r))}},ms=Object.defineProperty,ml=Object.defineProperties,mu=Object.getOwnPropertyDescriptors,mc=Object.getOwnPropertySymbols,mh=Object.prototype.hasOwnProperty,md=Object.prototype.propertyIsEnumerable,mp=(e,t,r)=>t in e?ms(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,mf=(e,t)=>{for(var r in t||(t={}))mh.call(t,r)&&mp(e,r,t[r]);if(mc)for(var r of mc(t))md.call(t,r)&&mp(e,r,t[r]);return e},mg=(e,t)=>ml(e,mu(t)),mm=(e,t,r)=>new Promise((n,i)=>{var o=e=>{try{s(r.next(e))}catch(e){i(e)}},a=e=>{try{s(r.throw(e))}catch(e){i(e)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,a);s((r=r.apply(e,t)).next())}),mv=class{constructor(e){let{id:t,map:r,renderer:n="device"}=e,i=function(){let e=new av,t=new ou,r=new i3,n=new ol(r),i=new iV,o=new iW,a=new i6,s=new i7,l=new i5,u={id:`${aU++}`,globalConfigService:aD,shaderModuleService:e,debugService:t,cameraService:r,coordinateSystemService:n,fontService:i,iconService:o,markerService:a,popupService:s,controlService:l,customRenderService:{}},c=new o_(u);u.layerService=c;let h=new as(u);u.sceneService=h;let d=new op(u);u.interactionService=d;let p=new om(u);u.pickingService=p;let f={clear:new a_,pixelPicking:new ax,render:new aA};u.normalPassFactory=e=>f[e];let g={copy:new aI,bloom:new aT,blurH:new aw,blurV:new aM,noise:new ak,sepia:new aN,colorHalftone:new aO,hexagonalPixelate:new aP,ink:new aR};return u.postProcessingPass=g,u.postProcessingPassFactory=e=>g[e],u}();this.container=i,r.setContainer(i,t),"regl"===n?i.rendererService=new gA:i.rendererService=new mi,this.sceneService=i.sceneService,this.mapService=i.mapService,this.iconService=i.iconService,this.fontService=i.fontService,this.controlService=i.controlService,this.layerService=i.layerService,this.debugService=i.debugService,this.debugService.setEnable(e.debug),this.markerService=i.markerService,this.interactionService=i.interactionService,this.popupService=i.popupService,this.boxSelect=new ma(this,{}),this.initComponent(t),this.sceneService.init(e),this.initControl()}get map(){return this.mapService.map}get loaded(){return this.sceneService.loaded}getServiceContainer(){return this.container}getSize(){return this.mapService.getSize()}getMinZoom(){return this.mapService.getMinZoom()}getMaxZoom(){return this.mapService.getMaxZoom()}getType(){return this.mapService.getType()}getMapContainer(){return this.mapService.getMapContainer()}getMapCanvasContainer(){return this.mapService.getMapCanvasContainer()}getMapService(){return this.mapService}getDebugService(){return this.debugService}exportPng(e){return mm(this,null,function*(){return this.sceneService.exportPng(e)})}exportMap(e){return mm(this,null,function*(){return this.sceneService.exportPng(e)})}registerRenderService(e){this.sceneService.loaded?new e(this).init():this.on("loaded",()=>{new e(this).init()})}setBgColor(e){this.mapService.setBgColor(e)}addLayer(e){this.loaded?this.preAddLayer(e):this.once("loaded",()=>{this.preAddLayer(e)})}preAddLayer(e){let t=az(this.container);if(e.setContainer(t),this.sceneService.addLayer(e),e.inited){this.initTileLayer(e);let t=this.initMask(e);this.addMask(t,e.id)}else e.on("inited",()=>{this.initTileLayer(e);let t=this.initMask(e);this.addMask(t,e.id)})}initMask(e){let{mask:t,maskfence:r,maskColor:n="#000",maskOpacity:i=0}=e.getLayerConfig();if(t&&r)return new p8().source(r).shape("fill").style({color:n,opacity:i})}addMask(e,t){if(!e)return;let r=this.getLayer(t);if(r){let t=az(this.container);e.setContainer(t),r.addMaskLayer(e),this.sceneService.addMask(e)}else console.warn("parent layer not find!")}getPickedLayer(){return this.layerService.pickedLayerId}getLayers(){return this.layerService.getLayers()}getLayer(e){return this.layerService.getLayer(e)}getLayerByName(e){return this.layerService.getLayerByName(e)}removeLayer(e,t){return mm(this,null,function*(){yield this.layerService.remove(e,t)})}removeAllLayer(){return mm(this,null,function*(){yield this.layerService.removeAllLayers()})}render(){this.sceneService.render()}setEnableRender(e){this.layerService.setEnableRender(e)}addIconFont(e,t){this.fontService.addIconFont(e,t)}addIconFonts(e){e.forEach(([e,t])=>{this.fontService.addIconFont(e,t)})}addFontFace(e,t){this.fontService.once("fontloaded",e=>{this.emit("fontloaded",e)}),this.fontService.addFontFace(e,t)}addImage(e,t){return mm(this,null,function*(){yield this.iconService.addImage(e,t)})}hasImage(e){return this.iconService.hasImage(e)}removeImage(e){this.iconService.removeImage(e)}addIconFontGlyphs(e,t){this.fontService.addIconGlyphs(t)}addControl(e){this.controlService.addControl(e,this.container)}removeControl(e){this.controlService.removeControl(e)}getControlByName(e){return this.controlService.getControlByName(e)}addMarker(e){this.markerService.addMarker(e)}addMarkerLayer(e){this.markerService.addMarkerLayer(e)}removeMarkerLayer(e){this.markerService.removeMarkerLayer(e)}removeAllMarkers(){this.markerService.removeAllMarkers()}removeAllMakers(){console.warn("removeAllMakers 已废弃，请使用 removeAllMarkers"),this.markerService.removeAllMarkers()}addPopup(e){this.popupService.addPopup(e)}removePopup(e){this.popupService.removePopup(e)}on(e,t){var r;mo.includes(e)?null==(r=this.boxSelect)||r.on(e,t):aB.includes(e)?this.sceneService.on(e,t):this.mapService.on(e,t)}once(e,t){var r;mo.includes(e)?null==(r=this.boxSelect)||r.once(e,t):aB.includes(e)?this.sceneService.once(e,t):this.mapService.once(e,t)}emit(e,t){-1===aB.indexOf(e)?this.mapService.on(e,t):this.sceneService.emit(e,t)}off(e,t){var r;mo.includes(e)?null==(r=this.boxSelect)||r.off(e,t):aB.includes(e)?this.sceneService.off(e,t):this.mapService.off(e,t)}getZoom(){return this.mapService.getZoom()}getCenter(e){return this.mapService.getCenter(e)}setCenter(e,t){return this.mapService.setCenter(e,t)}getPitch(){return this.mapService.getPitch()}setPitch(e){return this.mapService.setPitch(e)}getRotation(){return this.mapService.getRotation()}getBounds(){return this.mapService.getBounds()}setRotation(e){this.mapService.setRotation(e)}zoomIn(){this.mapService.zoomIn()}zoomOut(){this.mapService.zoomOut()}panTo(e){this.mapService.panTo(e)}panBy(e,t){this.mapService.panBy(e,t)}getContainer(){return this.mapService.getContainer()}setZoom(e){this.mapService.setZoom(e)}fitBounds(e,t){let{fitBoundsOptions:r,animate:n}=this.sceneService.getSceneConfig();this.mapService.fitBounds(e,t||mg(mf({},r),{animate:n}))}setZoomAndCenter(e,t){this.mapService.setZoomAndCenter(e,t)}setMapStyle(e){this.mapService.setMapStyle(e)}setMapStatus(e){this.mapService.setMapStatus(e)}pixelToLngLat(e){return this.mapService.pixelToLngLat(e)}lngLatToPixel(e){return this.mapService.lngLatToPixel(e)}containerToLngLat(e){return this.mapService.containerToLngLat(e)}lngLatToContainer(e){return this.mapService.lngLatToContainer(e)}destroy(){this.sceneService.destroy()}registerPostProcessingPass(e){this.container.postProcessingPass.name=new e}enableShaderPick(){this.layerService.enableShaderPick()}diasbleShaderPick(){this.layerService.disableShaderPick()}enableBoxSelect(e=!0){this.boxSelect.enable(),e&&this.boxSelect.once("selectend",()=>{this.disableBoxSelect()})}disableBoxSelect(){this.boxSelect.disable()}static addProtocol(e,t){L.REGISTERED_PROTOCOLS[e]=t}static removeProtocol(e){delete L.REGISTERED_PROTOCOLS[e]}getProtocol(e){return L.REGISTERED_PROTOCOLS[e]}startAnimate(){this.layerService.startAnimate()}stopAnimate(){this.layerService.stopAnimate()}getPointSizeRange(){return this.sceneService.getPointSizeRange()}initComponent(e){let t;this.controlService.init({container:(t=e,"string"==typeof e&&(t=window.document.getElementById(e)),t)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}initControl(){let{logoVisible:e,logoPosition:t}=this.sceneService.getSceneConfig();e&&this.addControl(new lW({position:t}))}initTileLayer(e){e.getSource().isTile&&(e.tileLayer=new fm(e))}}},94539:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=function(e,t,r){return e<t?t:e>r?r:e}},46334:(e,t,r)=>{"use strict";function n(e){return null==e}r.d(t,{A:()=>n})},9410:(e,t,r)=>{"use strict";function n(e){return"number"==typeof e}r.d(t,{A:()=>n})},21293:(e,t,r)=>{"use strict";r.d(t,{A:()=>G});var n=function(){function e(e){var t=this;this._insertTag=function(e){var r;r=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,r),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){if(this.ctr%(this.isSpeedy?65e3:1)==0){var t;this._insertTag(((t=document.createElement("style")).setAttribute("data-emotion",this.key),void 0!==this.nonce&&t.setAttribute("nonce",this.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t))}var r=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(r);try{n.insertRule(e,n.cssRules.length)}catch(e){}}else r.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach(function(e){var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)}),this.tags=[],this.ctr=0},e}(),i=Math.abs,o=String.fromCharCode,a=Object.assign;function s(e,t,r){return e.replace(t,r)}function l(e,t){return e.indexOf(t)}function u(e,t){return 0|e.charCodeAt(t)}function c(e,t,r){return e.slice(t,r)}function h(e){return e.length}function d(e,t){return t.push(e),e}var p=1,f=1,g=0,m=0,v=0,y="";function _(e,t,r,n,i,o,a){return{value:e,root:t,parent:r,type:n,props:i,children:o,line:p,column:f,length:a,return:""}}function b(e,t){return a(_("",null,null,"",null,null,0),e,{length:-e.length},t)}function x(){return v=m<g?u(y,m++):0,f++,10===v&&(f=1,p++),v}function S(){return u(y,m)}function A(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function E(e){return p=f=1,g=h(y=e),m=0,[]}function T(e){var t,r;return(t=m-1,r=function e(t){for(;x();)switch(v){case t:return m;case 34:case 39:34!==t&&39!==t&&e(v);break;case 40:41===t&&e(t);break;case 92:x()}return m}(91===e?e+2:40===e?e+1:e),c(y,t,r)).trim()}var C="-ms-",w="-moz-",L="-webkit-",M="comm",O="rule",I="decl",P="@keyframes";function R(e,t){for(var r="",n=e.length,i=0;i<n;i++)r+=t(e[i],i,e,t)||"";return r}function k(e,t,r,n){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case I:return e.return=e.return||e.value;case M:return"";case P:return e.return=e.value+"{"+R(e.children,n)+"}";case O:e.value=e.props.join(",")}return h(r=R(e.children,n))?e.return=e.value+"{"+r+"}":""}function N(e,t,r,n,o,a,l,u,h,d,p){for(var f=o-1,g=0===o?a:[""],m=g.length,v=0,y=0,b=0;v<n;++v)for(var x=0,S=c(e,f+1,f=i(y=l[v])),A=e;x<m;++x)(A=(y>0?g[x]+" "+S:s(S,/&\f/g,g[x])).trim())&&(h[b++]=A);return _(e,t,r,0===o?O:u,h,d,p)}function D(e,t,r,n){return _(e,t,r,I,c(e,0,n),c(e,n+1,-1),n)}var U=function(e,t,r){for(var n=0,i=0;n=i,i=S(),38===n&&12===i&&(t[r]=1),!A(i);)x();return c(y,e,m)},z=function(e,t){var r=-1,n=44;do switch(A(n)){case 0:38===n&&12===S()&&(t[r]=1),e[r]+=U(m-1,t,r);break;case 2:e[r]+=T(n);break;case 4:if(44===n){e[++r]=58===S()?"&\f":"",t[r]=e[r].length;break}default:e[r]+=o(n)}while(n=x());return e},B=function(e,t){var r;return r=z(E(e),t),y="",r},F=new WeakMap,j=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,r=e.parent,n=e.column===r.column&&e.line===r.line;"rule"!==r.type;)if(!(r=r.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||F.get(r))&&!n){F.set(e,!0);for(var i=[],o=B(t,i),a=r.props,s=0,l=0;s<o.length;s++)for(var u=0;u<a.length;u++,l++)e.props[l]=i[s]?o[s].replace(/&\f/g,a[u]):a[u]+" "+o[s]}}},V=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}},H=[function(e,t,r,n){if(e.length>-1&&!e.return)switch(e.type){case I:e.return=function e(t,r){switch(45^u(t,0)?(((r<<2^u(t,0))<<2^u(t,1))<<2^u(t,2))<<2^u(t,3):0){case 5103:return L+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return L+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return L+t+w+t+C+t+t;case 6828:case 4268:return L+t+C+t+t;case 6165:return L+t+C+"flex-"+t+t;case 5187:return L+t+s(t,/(\w+).+(:[^]+)/,L+"box-$1$2"+C+"flex-$1$2")+t;case 5443:return L+t+C+"flex-item-"+s(t,/flex-|-self/,"")+t;case 4675:return L+t+C+"flex-line-pack"+s(t,/align-content|flex-|-self/,"")+t;case 5548:return L+t+C+s(t,"shrink","negative")+t;case 5292:return L+t+C+s(t,"basis","preferred-size")+t;case 6060:return L+"box-"+s(t,"-grow","")+L+t+C+s(t,"grow","positive")+t;case 4554:return L+s(t,/([^-])(transform)/g,"$1"+L+"$2")+t;case 6187:return s(s(s(t,/(zoom-|grab)/,L+"$1"),/(image-set)/,L+"$1"),t,"")+t;case 5495:case 3959:return s(t,/(image-set\([^]*)/,L+"$1$`$1");case 4968:return s(s(t,/(.+:)(flex-)?(.*)/,L+"box-pack:$3"+C+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+L+t+t;case 4095:case 3583:case 4068:case 2532:return s(t,/(.+)-inline(.+)/,L+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(h(t)-1-r>6)switch(u(t,r+1)){case 109:if(45!==u(t,r+4))break;case 102:return s(t,/(.+:)(.+)-([^]+)/,"$1"+L+"$2-$3$1"+w+(108==u(t,r+3)?"$3":"$2-$3"))+t;case 115:return~l(t,"stretch")?e(s(t,"stretch","fill-available"),r)+t:t}break;case 4949:if(115!==u(t,r+1))break;case 6444:switch(u(t,h(t)-3-(~l(t,"!important")&&10))){case 107:return s(t,":",":"+L)+t;case 101:return s(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+L+(45===u(t,14)?"inline-":"")+"box$3$1"+L+"$2$3$1"+C+"$2box$3")+t}break;case 5936:switch(u(t,r+11)){case 114:return L+t+C+s(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return L+t+C+s(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return L+t+C+s(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return L+t+C+t+t}return t}(e.value,e.length);break;case P:return R([b(e,{value:s(e.value,"@","@"+L)})],n);case O:if(e.length){var i,o;return i=e.props,o=function(t){var r;switch(r=t,(r=/(::plac\w+|:read-\w+)/.exec(r))?r[0]:r){case":read-only":case":read-write":return R([b(e,{props:[s(t,/:(read-\w+)/,":"+w+"$1")]})],n);case"::placeholder":return R([b(e,{props:[s(t,/:(plac\w+)/,":"+L+"input-$1")]}),b(e,{props:[s(t,/:(plac\w+)/,":"+w+"$1")]}),b(e,{props:[s(t,/:(plac\w+)/,C+"input-$1")]})],n)}return""},i.map(o).join("")}}}],G=function(e){var t,r,i,a,g,b,C=e.key;if("css"===C){var w=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(w,function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))})}var L=e.stylisPlugins||H,O={},I=[];a=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+C+' "]'),function(e){for(var t=e.getAttribute("data-emotion").split(" "),r=1;r<t.length;r++)O[t[r]]=!0;I.push(e)});var P=(r=(t=[j,V].concat(L,[k,(i=function(e){b.insert(e)},function(e){!e.root&&(e=e.return)&&i(e)})])).length,function(e,n,i,o){for(var a="",s=0;s<r;s++)a+=t[s](e,n,i,o)||"";return a}),U=function(e){var t,r;return R((r=function e(t,r,n,i,a,g,b,E,C){for(var w,L=0,O=0,I=b,P=0,R=0,k=0,U=1,z=1,B=1,F=0,j="",V=a,H=g,G=i,W=j;z;)switch(k=F,F=x()){case 40:if(108!=k&&58==u(W,I-1)){-1!=l(W+=s(T(F),"&","&\f"),"&\f")&&(B=-1);break}case 34:case 39:case 91:W+=T(F);break;case 9:case 10:case 13:case 32:W+=function(e){for(;v=S();)if(v<33)x();else break;return A(e)>2||A(v)>3?"":" "}(k);break;case 92:W+=function(e,t){for(var r;--t&&x()&&!(v<48)&&!(v>102)&&(!(v>57)||!(v<65))&&(!(v>70)||!(v<97)););return r=m+(t<6&&32==S()&&32==x()),c(y,e,r)}(m-1,7);continue;case 47:switch(S()){case 42:case 47:d(_(w=function(e,t){for(;x();)if(e+v===57)break;else if(e+v===84&&47===S())break;return"/*"+c(y,t,m-1)+"*"+o(47===e?e:x())}(x(),m),r,n,M,o(v),c(w,2,-2),0),C);break;default:W+="/"}break;case 123*U:E[L++]=h(W)*B;case 125*U:case 59:case 0:switch(F){case 0:case 125:z=0;case 59+O:-1==B&&(W=s(W,/\f/g,"")),R>0&&h(W)-I&&d(R>32?D(W+";",i,n,I-1):D(s(W," ","")+";",i,n,I-2),C);break;case 59:W+=";";default:if(d(G=N(W,r,n,L,O,a,E,j,V=[],H=[],I),g),123===F){if(0===O)e(W,r,G,G,V,g,I,E,H);else switch(99===P&&110===u(W,3)?100:P){case 100:case 108:case 109:case 115:e(t,G,G,i&&d(N(t,G,G,0,0,a,E,j,a,V=[],I),H),a,H,I,E,i?V:H);break;default:e(W,G,G,G,[""],H,0,E,H)}}}L=O=R=0,U=B=1,j=W="",I=b;break;case 58:I=1+h(W),R=k;default:if(U<1){if(123==F)--U;else if(125==F&&0==U++&&125==(v=m>0?u(y,--m):0,f--,10===v&&(f=1,p--),v))continue}switch(W+=o(F),F*U){case 38:B=O>0?1:(W+="\f",-1);break;case 44:E[L++]=(h(W)-1)*B,B=1;break;case 64:45===S()&&(W+=T(x())),P=S(),O=I=h(j=W+=function(e){for(;!A(S());)x();return c(y,e,m)}(m)),F++;break;case 45:45===k&&2==h(W)&&(U=0)}}return g}("",null,null,null,[""],t=E(t=e),0,[0],t),y="",r),P)};g=function(e,t,r,n){b=r,U(e?e+"{"+t.styles+"}":t.styles),n&&(z.inserted[t.name]=!0)};var z={key:C,sheet:new n({key:C,container:a,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:O,registered:{},insert:g};return z.sheet.hydrate(I),z}},70430:(e,t,r)=>{"use strict";function n(e){var t=Object.create(null);return function(r){return void 0===t[r]&&(t[r]=e(r)),t[r]}}r.d(t,{A:()=>n})},25478:(e,t,r)=>{"use strict";r.d(t,{E:()=>g,T:()=>c,c:()=>p,h:()=>h,w:()=>u});var n=r(25316),i=r(21293),o=r(69987),a=r(96843),s=r(98469),l=n.createContext("undefined"!=typeof HTMLElement?(0,i.A)({key:"css"}):null);l.Provider;var u=function(e){return(0,n.forwardRef)(function(t,r){return e(t,(0,n.useContext)(l),r)})},c=n.createContext({}),h={}.hasOwnProperty,d="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",p=function(e,t){var r={};for(var n in t)h.call(t,n)&&(r[n]=t[n]);return r[d]=e,r},f=function(e){var t=e.cache,r=e.serialized,n=e.isStringTag;return(0,o.SF)(t,r,n),(0,s.s)(function(){return(0,o.sk)(t,r,n)}),null},g=u(function(e,t,r){var i=e.css;"string"==typeof i&&void 0!==t.registered[i]&&(i=t.registered[i]);var s=e[d],l=[i],u="";"string"==typeof e.className?u=(0,o.Rk)(t.registered,l,e.className):null!=e.className&&(u=e.className+" ");var p=(0,a.J)(l,void 0,n.useContext(c));u+=t.key+"-"+p.name;var g={};for(var m in e)h.call(e,m)&&"css"!==m&&m!==d&&(g[m]=e[m]);return g.className=u,r&&(g.ref=r),n.createElement(n.Fragment,null,n.createElement(f,{cache:t,serialized:p,isStringTag:"string"==typeof s}),n.createElement(s,g))})},96843:(e,t,r)=>{"use strict";r.d(t,{J:()=>f});var n,i={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},o=r(70430),a=/[A-Z]|^ms/g,s=/_EMO_([^_]+?)_([^]*?)_EMO_/g,l=function(e){return 45===e.charCodeAt(1)},u=function(e){return null!=e&&"boolean"!=typeof e},c=(0,o.A)(function(e){return l(e)?e:e.replace(a,"-$&").toLowerCase()}),h=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(s,function(e,t,r){return n={name:t,styles:r,next:n},t})}return 1===i[e]||l(e)||"number"!=typeof t||0===t?t:t+"px"};function d(e,t,r){if(null==r)return"";if(void 0!==r.__emotion_styles)return r;switch(typeof r){case"boolean":return"";case"object":if(1===r.anim)return n={name:r.name,styles:r.styles,next:n},r.name;if(void 0!==r.styles){var i=r.next;if(void 0!==i)for(;void 0!==i;)n={name:i.name,styles:i.styles,next:n},i=i.next;return r.styles+";"}return function(e,t,r){var n="";if(Array.isArray(r))for(var i=0;i<r.length;i++)n+=d(e,t,r[i])+";";else for(var o in r){var a=r[o];if("object"!=typeof a)null!=t&&void 0!==t[a]?n+=o+"{"+t[a]+"}":u(a)&&(n+=c(o)+":"+h(o,a)+";");else if(Array.isArray(a)&&"string"==typeof a[0]&&(null==t||void 0===t[a[0]]))for(var s=0;s<a.length;s++)u(a[s])&&(n+=c(o)+":"+h(o,a[s])+";");else{var l=d(e,t,a);switch(o){case"animation":case"animationName":n+=c(o)+":"+l+";";break;default:n+=o+"{"+l+"}"}}}return n}(e,t,r);case"function":if(void 0!==e){var o=n,a=r(e);return n=o,d(e,t,a)}}if(null==t)return r;var s=t[r];return void 0!==s?s:r}var p=/label:\s*([^\s;{]+)\s*(;|$)/g;function f(e,t,r){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var i,o=!0,a="";n=void 0;var s=e[0];null==s||void 0===s.raw?(o=!1,a+=d(r,t,s)):a+=s[0];for(var l=1;l<e.length;l++)a+=d(r,t,e[l]),o&&(a+=s[l]);p.lastIndex=0;for(var u="";null!==(i=p.exec(a));)u+="-"+i[1];return{name:function(e){for(var t,r=0,n=0,i=e.length;i>=4;++n,i-=4)t=(65535&(t=255&e.charCodeAt(n)|(255&e.charCodeAt(++n))<<8|(255&e.charCodeAt(++n))<<16|(255&e.charCodeAt(++n))<<24))*0x5bd1e995+((t>>>16)*59797<<16),t^=t>>>24,r=(65535&t)*0x5bd1e995+((t>>>16)*59797<<16)^(65535&r)*0x5bd1e995+((r>>>16)*59797<<16);switch(i){case 3:r^=(255&e.charCodeAt(n+2))<<16;case 2:r^=(255&e.charCodeAt(n+1))<<8;case 1:r^=255&e.charCodeAt(n),r=(65535&r)*0x5bd1e995+((r>>>16)*59797<<16)}return r^=r>>>13,(((r=(65535&r)*0x5bd1e995+((r>>>16)*59797<<16))^r>>>15)>>>0).toString(36)}(a)+u,styles:a,next:n}}},98469:(e,t,r)=>{"use strict";r.d(t,{s:()=>a});var n,i=r(25316),o=!!(n||(n=r.t(i,2))).useInsertionEffect&&(n||(n=r.t(i,2))).useInsertionEffect,a=o||function(e){return e()};o||i.useLayoutEffect},69987:(e,t,r)=>{"use strict";function n(e,t,r){var n="";return r.split(" ").forEach(function(r){void 0!==e[r]?t.push(e[r]+";"):r&&(n+=r+" ")}),n}r.d(t,{Rk:()=>n,SF:()=>i,sk:()=>o});var i=function(e,t,r){var n=e.key+"-"+t.name;!1===r&&void 0===e.registered[n]&&(e.registered[n]=t.styles)},o=function(e,t,r){i(e,t,r);var n=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var o=t;do e.insert(t===o?"."+n:"",o,e.sheet,!0),o=o.next;while(void 0!==o)}}},73834:e=>{function t(e,t){if(0!==e.length){r(e[0],t);for(var n=1;n<e.length;n++)r(e[n],!t)}}function r(e,t){for(var r=0,n=0,i=0,o=e.length,a=o-1;i<o;a=i++){var s=(e[i][0]-e[a][0])*(e[a][1]+e[i][1]),l=r+s;n+=Math.abs(r)>=Math.abs(s)?r-l+s:s-l+r,r=l}r+n>=0!=!!t&&e.reverse()}e.exports=function e(r,n){var i,o=r&&r.type;if("FeatureCollection"===o)for(i=0;i<r.features.length;i++)e(r.features[i],n);else if("GeometryCollection"===o)for(i=0;i<r.geometries.length;i++)e(r.geometries[i],n);else if("Feature"===o)e(r.geometry,n);else if("Polygon"===o)t(r.coordinates,n);else if("MultiPolygon"===o)for(i=0;i<r.coordinates.length;i++)t(r.coordinates[i],n);return r}},66576:e=>{"use strict";function t(e,t){this.x=e,this.y=t}e.exports=t,t.prototype={clone:function(){return new t(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[0]*this.x+e[1]*this.y,r=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=r,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),n=t*this.x-r*this.y,i=r*this.x+t*this.y;return this.x=n,this.y=i,this},_rotateAround:function(e,t){var r=Math.cos(e),n=Math.sin(e),i=t.x+r*(this.x-t.x)-n*(this.y-t.y),o=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=i,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},t.convert=function(e){return e instanceof t?e:Array.isArray(e)?new t(e[0],e[1]):e}},57197:e=>{"use strict";function t(e,t,r,n,i,o){this.fontSize=e||24,this.buffer=void 0===t?3:t,this.cutoff=n||.25,this.fontFamily=i||"sans-serif",this.fontWeight=o||"normal",this.radius=r||8;var a=this.size=this.fontSize+2*this.buffer,s=a+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(s*s),this.gridInner=new Float64Array(s*s),this.f=new Float64Array(s),this.z=new Float64Array(s+1),this.v=new Uint16Array(s),this.useMetrics=void 0!==this.ctx.measureText("A").actualBoundingBoxLeft,this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function r(e,t,r,i,o,a){for(var s=0;s<t;s++)n(e,s,t,r,i,o,a);for(var l=0;l<r;l++)n(e,l*t,1,t,i,o,a)}function n(e,t,r,n,i,o,a){var s,l,u,c;for(s=0,o[0]=0,a[0]=-1e20,a[1]=1e20;s<n;s++)i[s]=e[t+s*r];for(s=1,l=0,u=0;s<n;s++){do c=o[l],u=(i[s]-i[c]+s*s-c*c)/(s-c)/2;while(u<=a[l]&&--l>-1);o[++l]=s,a[l]=u,a[l+1]=1e20}for(s=0,l=0;s<n;s++){for(;a[l+1]<s;)l++;c=o[l],e[t+s*r]=i[c]+(s-c)*(s-c)}}e.exports=t,e.exports.default=t,t.prototype._draw=function(e,t){var n,i,o,a,s,l,u,c,h,d=this.ctx.measureText(e),p=d.width,f=2*this.buffer;t&&this.useMetrics?(s=Math.floor(d.actualBoundingBoxAscent),c=this.buffer+Math.ceil(d.actualBoundingBoxAscent),l=this.buffer,u=this.buffer,i=Math.min(this.size,Math.ceil(d.actualBoundingBoxRight-d.actualBoundingBoxLeft)),a=Math.min(this.size-l,Math.ceil(d.actualBoundingBoxAscent+d.actualBoundingBoxDescent)),n=i+f,o=a+f,this.ctx.textBaseline="alphabetic"):(n=i=this.size,o=a=this.size,s=19*this.fontSize/24,l=u=0,c=this.middle,this.ctx.textBaseline="middle"),i&&a&&(this.ctx.clearRect(u,l,i,a),this.ctx.fillText(e,this.buffer,c),h=this.ctx.getImageData(u,l,i,a));var g=new Uint8ClampedArray(n*o);return function(e,t,r,n,i,o,a){o.fill(1e20,0,t*r),a.fill(0,0,t*r);for(var s=(t-n)/2,l=0;l<i;l++)for(var u=0;u<n;u++){var c=(l+s)*t+u+s,h=e.data[4*(l*n+u)+3]/255;if(1===h)o[c]=0,a[c]=1e20;else if(0===h)o[c]=1e20,a[c]=0;else{var d=Math.max(0,.5-h),p=Math.max(0,h-.5);o[c]=d*d,a[c]=p*p}}}(h,n,o,i,a,this.gridOuter,this.gridInner),r(this.gridOuter,n,o,this.f,this.v,this.z),r(this.gridInner,n,o,this.f,this.v,this.z),function(e,t,r,n,i,o,a){for(var s=0;s<t*r;s++){var l=Math.sqrt(n[s])-Math.sqrt(i[s]);e[s]=Math.round(255-255*(l/o+a))}}(g,n,o,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:g,metrics:{width:i,height:a,sdfWidth:n,sdfHeight:o,top:s,left:0,advance:p}}},t.prototype.draw=function(e){return this._draw(e,!1).data},t.prototype.drawWithMetrics=function(e){return this._draw(e,!0)}},72184:(e,t,r)=>{e.exports.VectorTile=r(76743),r(81343),r(71392)},76743:(e,t,r)=>{"use strict";var n=r(71392);function i(e,t,r){if(3===e){var i=new n(r,r.readVarint()+r.pos);i.length&&(t[i.name]=i)}}e.exports=function(e,t){this.layers=e.readFields(i,{},t)}},81343:(e,t,r)=>{"use strict";var n=r(66576);function i(e,t,r,n,i){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=n,this._values=i,e.readFields(o,this,t)}function o(e,t,r){1==e?t.id=r.readVarint():2==e?function(e,t){for(var r=e.readVarint()+e.pos;e.pos<r;){var n=t._keys[e.readVarint()],i=t._values[e.readVarint()];t.properties[n]=i}}(r,t):3==e?t.type=r.readVarint():4==e&&(t._geometry=r.pos)}e.exports=i,i.types=["Unknown","Point","LineString","Polygon"],i.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,i=1,o=0,a=0,s=0,l=[];e.pos<r;){if(o<=0){var u=e.readVarint();i=7&u,o=u>>3}if(o--,1===i||2===i)a+=e.readSVarint(),s+=e.readSVarint(),1===i&&(t&&l.push(t),t=[]),t.push(new n(a,s));else if(7===i)t&&t.push(t[0].clone());else throw Error("unknown command "+i)}return t&&l.push(t),l},i.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,n=0,i=0,o=0,a=1/0,s=-1/0,l=1/0,u=-1/0;e.pos<t;){if(n<=0){var c=e.readVarint();r=7&c,n=c>>3}if(n--,1===r||2===r)i+=e.readSVarint(),o+=e.readSVarint(),i<a&&(a=i),i>s&&(s=i),o<l&&(l=o),o>u&&(u=o);else if(7!==r)throw Error("unknown command "+r)}return[a,l,s,u]},i.prototype.toGeoJSON=function(e,t,r){var n,o,a=this.extent*Math.pow(2,r),s=this.extent*e,l=this.extent*t,u=this.loadGeometry(),c=i.types[this.type];function h(e){for(var t=0;t<e.length;t++){var r=e[t],n=180-(r.y+l)*360/a;e[t]=[(r.x+s)*360/a-180,360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90]}}switch(this.type){case 1:var d=[];for(n=0;n<u.length;n++)d[n]=u[n][0];h(u=d);break;case 2:for(n=0;n<u.length;n++)h(u[n]);break;case 3:for(n=0,u=function(e){var t=e.length;if(t<=1)return[e];for(var r,n,i=[],o=0;o<t;o++){var a=function(e){for(var t,r,n=0,i=0,o=e.length,a=o-1;i<o;a=i++)t=e[i],n+=((r=e[a]).x-t.x)*(t.y+r.y);return n}(e[o]);0!==a&&(void 0===n&&(n=a<0),n===a<0?(r&&i.push(r),r=[e[o]]):r.push(e[o]))}return r&&i.push(r),i}(u);n<u.length;n++)for(o=0;o<u[n].length;o++)h(u[n][o])}1===u.length?u=u[0]:c="Multi"+c;var p={type:"Feature",geometry:{type:c,coordinates:u},properties:this.properties};return"id"in this&&(p.id=this.id),p}},71392:(e,t,r)=>{"use strict";var n=r(81343);function i(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(o,this,t),this.length=this._features.length}function o(e,t,r){15===e?t.version=r.readVarint():1===e?t.name=r.readString():5===e?t.extent=r.readVarint():2===e?t._features.push(r.pos):3===e?t._keys.push(r.readString()):4===e&&t._values.push(function(e){for(var t=null,r=e.readVarint()+e.pos;e.pos<r;){var n=e.readVarint()>>3;t=1===n?e.readString():2===n?e.readFloat():3===n?e.readDouble():4===n?e.readVarint64():5===n?e.readVarint():6===n?e.readSVarint():7===n?e.readBoolean():null}return t}(r))}e.exports=i,i.prototype.feature=function(e){if(e<0||e>=this._features.length)throw Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new n(this._pbf,t,this.extent,this._keys,this._values)}},665:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(96663),i=r(23528);let o=(0,n.A)((0,i.jsx)("path",{fillRule:"evenodd",d:"M3 3v8h8V3zm6 6H5V5h4zm-6 4v8h8v-8zm6 6H5v-4h4zm4-16v8h8V3zm6 6h-4V5h4zm-6 4v8h8v-8zm6 6h-4v-4h4z"}),"GridView")},59316:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(96663),i=r(23528);let o=(0,n.A)((0,i.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8m-1-4h2v2h-2zm1.61-9.96c-2.06-.3-3.88.97-4.43 2.79-.18.58.26 1.17.87 1.17h.2c.41 0 .74-.29.88-.67.32-.89 1.27-1.5 2.3-1.28.95.2 1.65 1.13 1.57 2.1-.1 1.34-1.62 1.63-2.45 2.88 0 .01-.01.01-.01.02-.01.02-.02.03-.03.05-.09.15-.18.32-.25.5-.01.03-.03.05-.04.08-.01.02-.01.04-.02.07-.12.34-.2.75-.2 1.25h2c0-.42.11-.77.28-1.07.02-.03.03-.06.05-.09.08-.14.18-.27.28-.39.01-.01.02-.03.03-.04.1-.12.21-.23.33-.34.96-.91 2.26-1.65 1.99-3.56-.24-1.74-1.61-3.21-3.35-3.47"}),"HelpOutlineRounded")},99296:(e,t,r)=>{"use strict";r.d(t,{A:()=>x});var n=r(25316),i=r(64927),o=r(17605),a=r(6656),s=r(25996),l=r(87193);let u=e=>{let t={systemProps:{},otherProps:{}},r=e?.theme?.unstable_sxConfig??l.A;return Object.keys(e).forEach(n=>{r[n]?t.systemProps[n]=e[n]:t.otherProps[n]=e[n]}),t};var c=r(29452),h=r(25478);let d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=n.useContext(h.T);return t&&0!==Object.keys(t).length?t:e},p=(0,c.A)(),f=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p;return d(e)};var g=r(23528),m=r(48790),v=r(461),y=r(1391);let _=(0,r(95924).A)("MuiBox",["root"]),b=(0,v.A)(),x=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{themeId:t,defaultTheme:r,defaultClassName:l="MuiBox-root",generateClassName:c}=e,h=(0,o.Ay)("div",{shouldForwardProp:e=>"theme"!==e&&"sx"!==e&&"as"!==e})(a.A);return n.forwardRef(function(e,n){let o=f(r),{className:a,component:d="div",...p}=function(e){let t;let{sx:r,...n}=e,{systemProps:i,otherProps:o}=u(n);return t=Array.isArray(r)?[i,...r]:"function"==typeof r?(...e)=>{let t=r(...e);return(0,s.Q)(t)?{...i,...t}:i}:{...i,...r},{...o,sx:t}}(e);return(0,g.jsx)(h,{as:d,ref:n,className:(0,i.A)(a,c?c(l):l),theme:t&&o[t]||o,...p})})}({themeId:y.A,defaultTheme:b,defaultClassName:_.root,generateClassName:m.A.generate})},90691:(e,t,r)=>{"use strict";r.d(t,{A:()=>ed});var n=r(25316),i=r(64927),o=r(4170),a=r(49554),s=r(17467),l=r(85992),u=r(52134),c=r(1157),h=r(14029);function d(e){try{return e.matches(":focus-visible")}catch(e){}return!1}let p=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.useMemo(()=>t.every(e=>null==e)?null:e=>{t.forEach(t=>{"function"==typeof t?t(e):t&&(t.current=e)})},t)},f="undefined"!=typeof window?n.useLayoutEffect:n.useEffect,g=function(e){let t=n.useRef(e);return f(()=>{t.current=e}),n.useRef(function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return(0,t.current)(...r)}).current},m={};function v(e,t){let r=n.useRef(m);return r.current===m&&(r.current=e(t)),r}class y{static create(){return new y}static use(){let e=v(y.create).current,[t,r]=n.useState(!1);return e.shouldMount=t,e.setShouldMount=r,n.useEffect(e.mountEffect,[t]),e}mount(){return this.mounted||(this.mounted=function(){let e,t;let r=new Promise((r,n)=>{e=r,t=n});return r.resolve=e,r.reject=t,r}(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}start(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.mount().then(()=>{var e;return null===(e=this.ref.current)||void 0===e?void 0:e.start(...t)})}stop(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.mount().then(()=>{var e;return null===(e=this.ref.current)||void 0===e?void 0:e.stop(...t)})}pulsate(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.mount().then(()=>{var e;return null===(e=this.ref.current)||void 0===e?void 0:e.pulsate(...t)})}constructor(){this.mountEffect=()=>{this.shouldMount&&!this.didMount&&null!==this.ref.current&&(this.didMount=!0,this.mounted.resolve())},this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}}function _(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var b=r(46364),x=r(20859),S=r(44722),A=r(64365);let E=n.createContext(null);function T(e,t){var r=Object.create(null);return e&&n.Children.map(e,function(e){return e}).forEach(function(e){r[e.key]=t&&(0,n.isValidElement)(e)?t(e):e}),r}function C(e,t,r){return null!=r[t]?r[t]:e.props[t]}var w=Object.values||function(e){return Object.keys(e).map(function(t){return e[t]})},L=function(e){function t(t,r){var n,i=(n=e.call(this,t,r)||this).handleExited.bind((0,S.A)(n));return n.state={contextValue:{isMounting:!0},handleExited:i,firstRender:!0},n}t.prototype=Object.create(e.prototype),t.prototype.constructor=t,(0,A.A)(t,e);var r=t.prototype;return r.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},r.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(e,t){var r,i,o=t.children,a=t.handleExited;return{children:t.firstRender?T(e.children,function(t){return(0,n.cloneElement)(t,{onExited:a.bind(null,t),in:!0,appear:C(t,"appear",e),enter:C(t,"enter",e),exit:C(t,"exit",e)})}):(Object.keys(i=function(e,t){function r(r){return r in t?t[r]:e[r]}e=e||{},t=t||{};var n,i=Object.create(null),o=[];for(var a in e)a in t?o.length&&(i[a]=o,o=[]):o.push(a);var s={};for(var l in t){if(i[l])for(n=0;n<i[l].length;n++){var u=i[l][n];s[i[l][n]]=r(u)}s[l]=r(l)}for(n=0;n<o.length;n++)s[o[n]]=r(o[n]);return s}(o,r=T(e.children))).forEach(function(t){var s=i[t];if((0,n.isValidElement)(s)){var l=t in o,u=t in r,c=o[t],h=(0,n.isValidElement)(c)&&!c.props.in;u&&(!l||h)?i[t]=(0,n.cloneElement)(s,{onExited:a.bind(null,s),in:!0,exit:C(s,"exit",e),enter:C(s,"enter",e)}):u||!l||h?u&&l&&(0,n.isValidElement)(c)&&(i[t]=(0,n.cloneElement)(s,{onExited:a.bind(null,s),in:c.props.in,exit:C(s,"exit",e),enter:C(s,"enter",e)})):i[t]=(0,n.cloneElement)(s,{in:!1})}}),i),firstRender:!1}},r.handleExited=function(e,t){var r=T(this.props.children);e.key in r||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState(function(t){var r=(0,x.A)({},t.children);return delete r[e.key],{children:r}}))},r.render=function(){var e=this.props,t=e.component,r=e.childFactory,i=(0,b.A)(e,["component","childFactory"]),o=this.state.contextValue,a=w(this.state.children).map(r);return(delete i.appear,delete i.enter,delete i.exit,null===t)?n.createElement(E.Provider,{value:o},a):n.createElement(E.Provider,{value:o},n.createElement(t,i,a))},t}(n.Component);L.propTypes={},L.defaultProps={component:"div",childFactory:function(e){return e}};let M=[];class O{static create(){return new O}start(e,t){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,t()},e)}constructor(){this.currentId=null,this.clear=()=>{null!==this.currentId&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}}var I=r(25478);r(98469);var P=r(96843);r(21293),r(79231);var R=function(e,t){var r=arguments;if(null==t||!I.h.call(t,"css"))return n.createElement.apply(void 0,r);var i=r.length,o=Array(i);o[0]=I.E,o[1]=(0,I.c)(e,t);for(var a=2;a<i;a++)o[a]=r[a];return n.createElement.apply(null,o)};function k(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,P.J)(t)}function N(){var e=k.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}!function(e){var t;t||(t=e.JSX||(e.JSX={}))}(R||(R={}));var D=r(23528),U=r(95924);let z=(0,U.A)("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]);function B(){let e=_(["\n  0% {\n    transform: scale(0);\n    opacity: 0.1;\n  }\n\n  100% {\n    transform: scale(1);\n    opacity: 0.3;\n  }\n"]);return B=function(){return e},e}function F(){let e=_(["\n  0% {\n    opacity: 1;\n  }\n\n  100% {\n    opacity: 0;\n  }\n"]);return F=function(){return e},e}function j(){let e=_(["\n  0% {\n    transform: scale(1);\n  }\n\n  50% {\n    transform: scale(0.92);\n  }\n\n  100% {\n    transform: scale(1);\n  }\n"]);return j=function(){return e},e}function V(){let e=_(["\n  opacity: 0;\n  position: absolute;\n\n  &."," {\n    opacity: 0.3;\n    transform: scale(1);\n    animation-name: ",";\n    animation-duration: ","ms;\n    animation-timing-function: ",";\n  }\n\n  &."," {\n    animation-duration: ","ms;\n  }\n\n  & ."," {\n    opacity: 1;\n    display: block;\n    width: 100%;\n    height: 100%;\n    border-radius: 50%;\n    background-color: currentColor;\n  }\n\n  & ."," {\n    opacity: 0;\n    animation-name: ",";\n    animation-duration: ","ms;\n    animation-timing-function: ",";\n  }\n\n  & ."," {\n    position: absolute;\n    /* @noflip */\n    left: 0px;\n    top: 0;\n    animation-name: ",";\n    animation-duration: 2500ms;\n    animation-timing-function: ",";\n    animation-iteration-count: infinite;\n    animation-delay: 200ms;\n  }\n"]);return V=function(){return e},e}let H=N(B()),G=N(F()),W=N(j()),X=(0,u.Ay)("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),$=(0,u.Ay)(function(e){let{className:t,classes:r,pulsate:o=!1,rippleX:a,rippleY:s,rippleSize:l,in:u,onExited:c,timeout:h}=e,[d,p]=n.useState(!1),f=(0,i.A)(t,r.ripple,r.rippleVisible,o&&r.ripplePulsate),g=(0,i.A)(r.child,d&&r.childLeaving,o&&r.childPulsate);return u||d||p(!0),n.useEffect(()=>{if(!u&&null!=c){let e=setTimeout(c,h);return()=>{clearTimeout(e)}}},[c,u,h]),(0,D.jsx)("span",{className:f,style:{width:l,height:l,top:-(l/2)+s,left:-(l/2)+a},children:(0,D.jsx)("span",{className:g})})},{name:"MuiTouchRipple",slot:"Ripple"})(V(),z.rippleVisible,H,550,e=>{let{theme:t}=e;return t.transitions.easing.easeInOut},z.ripplePulsate,e=>{let{theme:t}=e;return t.transitions.duration.shorter},z.child,z.childLeaving,G,550,e=>{let{theme:t}=e;return t.transitions.easing.easeInOut},z.childPulsate,W,e=>{let{theme:t}=e;return t.transitions.easing.easeInOut}),Z=n.forwardRef(function(e,t){let{center:r=!1,classes:o={},className:a,...s}=(0,h.b)({props:e,name:"MuiTouchRipple"}),[l,u]=n.useState([]),c=n.useRef(0),d=n.useRef(null);n.useEffect(()=>{d.current&&(d.current(),d.current=null)},[l]);let p=n.useRef(!1),f=function(){var e;let t=v(O.create).current;return e=t.disposeEffect,n.useEffect(e,M),t}(),g=n.useRef(null),m=n.useRef(null),y=n.useCallback(e=>{let{pulsate:t,rippleX:r,rippleY:n,rippleSize:a,cb:s}=e;u(e=>[...e,(0,D.jsx)($,{classes:{ripple:(0,i.A)(o.ripple,z.ripple),rippleVisible:(0,i.A)(o.rippleVisible,z.rippleVisible),ripplePulsate:(0,i.A)(o.ripplePulsate,z.ripplePulsate),child:(0,i.A)(o.child,z.child),childLeaving:(0,i.A)(o.childLeaving,z.childLeaving),childPulsate:(0,i.A)(o.childPulsate,z.childPulsate)},timeout:550,pulsate:t,rippleX:r,rippleY:n,rippleSize:a},c.current)]),c.current+=1,d.current=s},[o]),_=n.useCallback(function(){let e,t,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{},{pulsate:s=!1,center:l=r||o.pulsate,fakeElement:u=!1}=o;if((null==i?void 0:i.type)==="mousedown"&&p.current){p.current=!1;return}(null==i?void 0:i.type)==="touchstart"&&(p.current=!0);let c=u?null:m.current,h=c?c.getBoundingClientRect():{width:0,height:0,left:0,top:0};if(!l&&void 0!==i&&(0!==i.clientX||0!==i.clientY)&&(i.clientX||i.touches)){let{clientX:r,clientY:n}=i.touches&&i.touches.length>0?i.touches[0]:i;e=Math.round(r-h.left),t=Math.round(n-h.top)}else e=Math.round(h.width/2),t=Math.round(h.height/2);l?(n=Math.sqrt((2*h.width**2+h.height**2)/3))%2==0&&(n+=1):n=Math.sqrt((2*Math.max(Math.abs((c?c.clientWidth:0)-e),e)+2)**2+(2*Math.max(Math.abs((c?c.clientHeight:0)-t),t)+2)**2),(null==i?void 0:i.touches)?null===g.current&&(g.current=()=>{y({pulsate:s,rippleX:e,rippleY:t,rippleSize:n,cb:a})},f.start(80,()=>{g.current&&(g.current(),g.current=null)})):y({pulsate:s,rippleX:e,rippleY:t,rippleSize:n,cb:a})},[r,y,f]),b=n.useCallback(()=>{_({},{pulsate:!0})},[_]),x=n.useCallback((e,t)=>{if(f.clear(),(null==e?void 0:e.type)==="touchend"&&g.current){g.current(),g.current=null,f.start(0,()=>{x(e,t)});return}g.current=null,u(e=>e.length>0?e.slice(1):e),d.current=t},[f]);return n.useImperativeHandle(t,()=>({pulsate:b,start:_,stop:x}),[b,_,x]),(0,D.jsx)(X,{className:(0,i.A)(z.root,o.root,a),ref:m,...s,children:(0,D.jsx)(L,{component:null,exit:!0,children:l})})});var Y=r(95536);function q(e){return(0,Y.Ay)("MuiButtonBase",e)}let K=(0,U.A)("MuiButtonBase",["root","disabled","focusVisible"]),Q=e=>{let{disabled:t,focusVisible:r,focusVisibleClassName:n,classes:i}=e,o=(0,a.A)({root:["root",t&&"disabled",r&&"focusVisible"]},q,i);return r&&n&&(o.root+=" ".concat(n)),o},J=(0,u.Ay)("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},["&.".concat(K.disabled)]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),ee=n.forwardRef(function(e,t){let r=(0,h.b)({props:e,name:"MuiButtonBase"}),{action:o,centerRipple:a=!1,children:s,className:l,component:u="button",disabled:c=!1,disableRipple:f=!1,disableTouchRipple:m=!1,focusRipple:v=!1,focusVisibleClassName:_,LinkComponent:b="a",onBlur:x,onClick:S,onContextMenu:A,onDragLeave:E,onFocus:T,onFocusVisible:C,onKeyDown:w,onKeyUp:L,onMouseDown:M,onMouseLeave:O,onMouseUp:I,onTouchEnd:P,onTouchMove:R,onTouchStart:k,tabIndex:N=0,TouchRippleProps:U,touchRippleRef:z,type:B,...F}=r,j=n.useRef(null),V=y.use(),H=p(V.ref,z),[G,W]=n.useState(!1);c&&G&&W(!1),n.useImperativeHandle(o,()=>({focusVisible:()=>{W(!0),j.current.focus()}}),[]);let X=V.shouldMount&&!f&&!c;n.useEffect(()=>{G&&v&&!f&&V.pulsate()},[f,v,G,V]);let $=et(V,"start",M,m),Y=et(V,"stop",A,m),q=et(V,"stop",E,m),K=et(V,"stop",I,m),ee=et(V,"stop",e=>{G&&e.preventDefault(),O&&O(e)},m),er=et(V,"start",k,m),en=et(V,"stop",P,m),ei=et(V,"stop",R,m),eo=et(V,"stop",e=>{d(e.target)||W(!1),x&&x(e)},!1),ea=g(e=>{j.current||(j.current=e.currentTarget),d(e.target)&&(W(!0),C&&C(e)),T&&T(e)}),es=()=>{let e=j.current;return u&&"button"!==u&&!("A"===e.tagName&&e.href)},el=g(e=>{v&&!e.repeat&&G&&" "===e.key&&V.stop(e,()=>{V.start(e)}),e.target===e.currentTarget&&es()&&" "===e.key&&e.preventDefault(),w&&w(e),e.target===e.currentTarget&&es()&&"Enter"===e.key&&!c&&(e.preventDefault(),S&&S(e))}),eu=g(e=>{v&&" "===e.key&&G&&!e.defaultPrevented&&V.stop(e,()=>{V.pulsate(e)}),L&&L(e),S&&e.target===e.currentTarget&&es()&&" "===e.key&&!e.defaultPrevented&&S(e)}),ec=u;"button"===ec&&(F.href||F.to)&&(ec=b);let eh={};"button"===ec?(eh.type=void 0===B?"button":B,eh.disabled=c):(F.href||F.to||(eh.role="button"),c&&(eh["aria-disabled"]=c));let ed=p(t,j),ep={...r,centerRipple:a,component:u,disabled:c,disableRipple:f,disableTouchRipple:m,focusRipple:v,tabIndex:N,focusVisible:G},ef=Q(ep);return(0,D.jsxs)(J,{as:ec,className:(0,i.A)(ef.root,l),ownerState:ep,onBlur:eo,onClick:S,onContextMenu:Y,onFocus:ea,onKeyDown:el,onKeyUp:eu,onMouseDown:$,onMouseLeave:ee,onMouseUp:K,onDragLeave:q,onTouchEnd:en,onTouchMove:ei,onTouchStart:er,ref:ed,tabIndex:c?-1:N,type:B,...eh,...F,children:[s,X?(0,D.jsx)(Z,{ref:H,center:a,...U}):null]})});function et(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return g(i=>(r&&r(i),n||e[t](i),!0))}var er=r(66301);function en(e){return(0,Y.Ay)("MuiButton",e)}let ei=(0,U.A)("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),eo=n.createContext({}),ea=n.createContext(void 0),es=e=>{let{color:t,disableElevation:r,fullWidth:n,size:i,variant:o,classes:s}=e,l={root:["root",o,"".concat(o).concat((0,er.A)(t)),"size".concat((0,er.A)(i)),"".concat(o,"Size").concat((0,er.A)(i)),"color".concat((0,er.A)(t)),r&&"disableElevation",n&&"fullWidth"],label:["label"],startIcon:["icon","startIcon","iconSize".concat((0,er.A)(i))],endIcon:["icon","endIcon","iconSize".concat((0,er.A)(i))]},u=(0,a.A)(l,en,s);return{...s,...u}},el=[{props:{size:"small"},style:{"& > *:nth-of-type(1)":{fontSize:18}}},{props:{size:"medium"},style:{"& > *:nth-of-type(1)":{fontSize:20}}},{props:{size:"large"},style:{"& > *:nth-of-type(1)":{fontSize:22}}}],eu=(0,u.Ay)(ee,{shouldForwardProp:e=>(0,l.A)(e)||"classes"===e,name:"MuiButton",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.root,t[r.variant],t["".concat(r.variant).concat((0,er.A)(r.color))],t["size".concat((0,er.A)(r.size))],t["".concat(r.variant,"Size").concat((0,er.A)(r.size))],"inherit"===r.color&&t.colorInherit,r.disableElevation&&t.disableElevation,r.fullWidth&&t.fullWidth]}})((0,c.A)(e=>{let{theme:t}=e,r="light"===t.palette.mode?t.palette.grey[300]:t.palette.grey[800],n="light"===t.palette.mode?t.palette.grey.A100:t.palette.grey[700];return{...t.typography.button,minWidth:64,padding:"6px 16px",border:0,borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":{textDecoration:"none"},["&.".concat(ei.disabled)]:{color:(t.vars||t).palette.action.disabled},variants:[{props:{variant:"contained"},style:{color:"var(--variant-containedColor)",backgroundColor:"var(--variant-containedBg)",boxShadow:(t.vars||t).shadows[2],"&:hover":{boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2]}},"&:active":{boxShadow:(t.vars||t).shadows[8]},["&.".concat(ei.focusVisible)]:{boxShadow:(t.vars||t).shadows[6]},["&.".concat(ei.disabled)]:{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground}}},{props:{variant:"outlined"},style:{padding:"5px 15px",border:"1px solid currentColor",borderColor:"var(--variant-outlinedBorder, currentColor)",backgroundColor:"var(--variant-outlinedBg)",color:"var(--variant-outlinedColor)",["&.".concat(ei.disabled)]:{border:"1px solid ".concat((t.vars||t).palette.action.disabledBackground)}}},{props:{variant:"text"},style:{padding:"6px 8px",color:"var(--variant-textColor)",backgroundColor:"var(--variant-textBg)"}},...Object.entries(t.palette).filter(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t=>{let[,r]=t;return r&&function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if("string"!=typeof e.main)return!1;for(let r of t)if(!e.hasOwnProperty(r)||"string"!=typeof e[r])return!1;return!0}(r,e)}}()).map(e=>{let[r]=e;return{props:{color:r},style:{"--variant-textColor":(t.vars||t).palette[r].main,"--variant-outlinedColor":(t.vars||t).palette[r].main,"--variant-outlinedBorder":t.vars?"rgba(".concat(t.vars.palette[r].mainChannel," / 0.5)"):(0,s.X4)(t.palette[r].main,.5),"--variant-containedColor":(t.vars||t).palette[r].contrastText,"--variant-containedBg":(t.vars||t).palette[r].main,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":(t.vars||t).palette[r].dark,"--variant-textBg":t.vars?"rgba(".concat(t.vars.palette[r].mainChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):(0,s.X4)(t.palette[r].main,t.palette.action.hoverOpacity),"--variant-outlinedBorder":(t.vars||t).palette[r].main,"--variant-outlinedBg":t.vars?"rgba(".concat(t.vars.palette[r].mainChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):(0,s.X4)(t.palette[r].main,t.palette.action.hoverOpacity)}}}}}),{props:{color:"inherit"},style:{color:"inherit",borderColor:"currentColor","--variant-containedBg":t.vars?t.vars.palette.Button.inheritContainedBg:r,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":t.vars?t.vars.palette.Button.inheritContainedHoverBg:n,"--variant-textBg":t.vars?"rgba(".concat(t.vars.palette.text.primaryChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):(0,s.X4)(t.palette.text.primary,t.palette.action.hoverOpacity),"--variant-outlinedBg":t.vars?"rgba(".concat(t.vars.palette.text.primaryChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):(0,s.X4)(t.palette.text.primary,t.palette.action.hoverOpacity)}}}},{props:{size:"small",variant:"text"},style:{padding:"4px 5px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"text"},style:{padding:"8px 11px",fontSize:t.typography.pxToRem(15)}},{props:{size:"small",variant:"outlined"},style:{padding:"3px 9px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"outlined"},style:{padding:"7px 21px",fontSize:t.typography.pxToRem(15)}},{props:{size:"small",variant:"contained"},style:{padding:"4px 10px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"contained"},style:{padding:"8px 22px",fontSize:t.typography.pxToRem(15)}},{props:{disableElevation:!0},style:{boxShadow:"none","&:hover":{boxShadow:"none"},["&.".concat(ei.focusVisible)]:{boxShadow:"none"},"&:active":{boxShadow:"none"},["&.".concat(ei.disabled)]:{boxShadow:"none"}}},{props:{fullWidth:!0},style:{width:"100%"}}]}})),ec=(0,u.Ay)("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.startIcon,t["iconSize".concat((0,er.A)(r.size))]]}})({display:"inherit",marginRight:8,marginLeft:-4,variants:[{props:{size:"small"},style:{marginLeft:-2}},...el]}),eh=(0,u.Ay)("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.endIcon,t["iconSize".concat((0,er.A)(r.size))]]}})({display:"inherit",marginRight:-4,marginLeft:8,variants:[{props:{size:"small"},style:{marginRight:-2}},...el]}),ed=n.forwardRef(function(e,t){let r=n.useContext(eo),a=n.useContext(ea),s=(0,o.A)(r,e),l=(0,h.b)({props:s,name:"MuiButton"}),{children:u,color:c="primary",component:d="button",className:p,disabled:f=!1,disableElevation:g=!1,disableFocusRipple:m=!1,endIcon:v,focusVisibleClassName:y,fullWidth:_=!1,size:b="medium",startIcon:x,type:S,variant:A="text",...E}=l,T={...l,color:c,component:d,disabled:f,disableElevation:g,disableFocusRipple:m,fullWidth:_,size:b,type:S,variant:A},C=es(T),w=x&&(0,D.jsx)(ec,{className:C.startIcon,ownerState:T,children:x}),L=v&&(0,D.jsx)(eh,{className:C.endIcon,ownerState:T,children:v});return(0,D.jsxs)(eu,{ownerState:T,className:(0,i.A)(r.className,C.root,p,a||""),component:d,disabled:f,focusRipple:!m,focusVisibleClassName:(0,i.A)(C.focusVisible,y),ref:t,type:S,...E,classes:C,children:[w,u,L]})})},14029:(e,t,r)=>{"use strict";r.d(t,{b:()=>a});var n=r(25316),i=r(4170);r(23528);let o=n.createContext(void 0);function a(e){return function(e){let{props:t,name:r}=e;return function(e){let{theme:t,name:r,props:n}=e;if(!t||!t.components||!t.components[r])return n;let o=t.components[r];return o.defaultProps?(0,i.A)(o.defaultProps,n):o.styleOverrides||o.variants?n:(0,i.A)(o,n)}({props:t,name:r,theme:{components:n.useContext(o)}})}(e)}},461:(e,t,r)=>{"use strict";r.d(t,{A:()=>ee});var n=r(34020),i=r(25996),o=r(17467);let a={black:"#000",white:"#fff"},s={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},l={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},u={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},c={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},h={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},d={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},p={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"};function f(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:a.white,default:a.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}let g=f();function m(){return{text:{primary:a.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:a.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}let v=m();function y(e,t,r,n){let i=n.light||n,a=n.dark||1.5*n;e[t]||(e.hasOwnProperty(r)?e[t]=e[r]:"light"===t?e.light=(0,o.a)(e.main,i):"dark"===t&&(e.dark=(0,o.e$)(e.main,a)))}function _(e){let t;let{mode:r="light",contrastThreshold:_=3,tonalOffset:b=.2,...x}=e,S=e.primary||function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light";return"dark"===e?{main:h[200],light:h[50],dark:h[400]}:{main:h[700],light:h[400],dark:h[800]}}(r),A=e.secondary||function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light";return"dark"===e?{main:l[200],light:l[50],dark:l[400]}:{main:l[500],light:l[300],dark:l[700]}}(r),E=e.error||function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light";return"dark"===e?{main:u[500],light:u[300],dark:u[700]}:{main:u[700],light:u[400],dark:u[800]}}(r),T=e.info||function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light";return"dark"===e?{main:d[400],light:d[300],dark:d[700]}:{main:d[700],light:d[500],dark:d[900]}}(r),C=e.success||function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light";return"dark"===e?{main:p[400],light:p[300],dark:p[700]}:{main:p[800],light:p[500],dark:p[900]}}(r),w=e.warning||function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light";return"dark"===e?{main:c[400],light:c[300],dark:c[700]}:{main:"#ed6c02",light:c[500],dark:c[900]}}(r);function L(e){return(0,o.eM)(e,v.text.primary)>=_?v.text.primary:g.text.primary}let M=e=>{let{color:t,name:r,mainShade:i=500,lightShade:o=300,darkShade:a=700}=e;if(!(t={...t}).main&&t[i]&&(t.main=t[i]),!t.hasOwnProperty("main"))throw Error((0,n.A)(11,r?" (".concat(r,")"):"",i));if("string"!=typeof t.main)throw Error((0,n.A)(12,r?" (".concat(r,")"):"",JSON.stringify(t.main)));return y(t,"light",o,b),y(t,"dark",a,b),t.contrastText||(t.contrastText=L(t.main)),t};return"light"===r?t=f():"dark"===r&&(t=m()),(0,i.A)({common:{...a},mode:r,primary:M({color:S,name:"primary"}),secondary:M({color:A,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:M({color:E,name:"error"}),warning:M({color:w,name:"warning"}),info:M({color:T,name:"info"}),success:M({color:C,name:"success"}),grey:s,contrastThreshold:_,getContrastText:L,augmentColor:M,tonalOffset:b,...t},x)}var b=r(84104),x=r(21675);let S=(e,t,r,n=[])=>{let i=e;t.forEach((e,o)=>{o===t.length-1?Array.isArray(i)?i[Number(e)]=r:i&&"object"==typeof i&&(i[e]=r):i&&"object"==typeof i&&(i[e]||(i[e]=n.includes(e)?[]:{}),i=i[e])})},A=(e,t,r)=>{!function e(n,i=[],o=[]){Object.entries(n).forEach(([n,a])=>{r&&(!r||r([...i,n]))||null==a||("object"==typeof a&&Object.keys(a).length>0?e(a,[...i,n],Array.isArray(a)?[...o,n]:o):t([...i,n],a,o))})}(e)},E=(e,t)=>"number"==typeof t?["lineHeight","fontWeight","opacity","zIndex"].some(t=>e.includes(t))||e[e.length-1].toLowerCase().includes("opacity")?t:`${t}px`:t;function T(e,t){let{prefix:r,shouldSkipGeneratingVar:n}=t||{},i={},o={},a={};return A(e,(e,t,s)=>{if(("string"==typeof t||"number"==typeof t)&&(!n||!n(e,t))){let n=`--${r?`${r}-`:""}${e.join("-")}`,l=E(e,t);Object.assign(i,{[n]:l}),S(o,e,`var(${n})`,s),S(a,e,`var(${n}, ${l})`,s)}},e=>"vars"===e[0]),{css:i,vars:o,varsWithDefaults:a}}let C=function(e,t={}){let{getSelector:r=function(t,r){let n=o;if("class"===o&&(n=".%s"),"data"===o&&(n="[data-%s]"),o?.startsWith("data-")&&!o.includes("%s")&&(n=`[${o}="%s"]`),t){if("media"===n){if(e.defaultColorScheme===t)return":root";let n=a[t]?.palette?.mode||t;return{[`@media (prefers-color-scheme: ${n})`]:{":root":r}}}if(n)return e.defaultColorScheme===t?`:root, ${n.replace("%s",String(t))}`:n.replace("%s",String(t))}return":root"},disableCssColorScheme:n,colorSchemeSelector:o}=t,{colorSchemes:a={},components:s,defaultColorScheme:l="light",...u}=e,{vars:c,css:h,varsWithDefaults:d}=T(u,t),p=d,f={},{[l]:g,...m}=a;if(Object.entries(m||{}).forEach(([e,r])=>{let{vars:n,css:o,varsWithDefaults:a}=T(r,t);p=(0,i.A)(p,a),f[e]={css:o,vars:n}}),g){let{css:e,vars:r,varsWithDefaults:n}=T(g,t);p=(0,i.A)(p,n),f[l]={css:e,vars:r}}return{vars:p,generateThemeVars:()=>{let e={...c};return Object.entries(f).forEach(([,{vars:t}])=>{e=(0,i.A)(e,t)}),e},generateStyleSheets:()=>{let t=[],i=e.defaultColorScheme||"light";function o(e,r){Object.keys(r).length&&t.push("string"==typeof e?{[e]:{...r}}:e)}o(r(void 0,{...h}),h);let{[i]:s,...l}=f;if(s){let{css:e}=s,t=a[i]?.palette?.mode,l=!n&&t?{colorScheme:t,...e}:{...e};o(r(i,{...l}),l)}return Object.entries(l).forEach(([e,{css:t}])=>{let i=a[e]?.palette?.mode,s=!n&&i?{colorScheme:i,...t}:{...t};o(r(e,{...s}),s)}),t}}};var w=r(87193),L=r(6656),M=r(29452);let O={textTransform:"uppercase"},I='"Roboto", "Helvetica", "Arial", sans-serif';function P(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return["".concat(t[0],"px ").concat(t[1],"px ").concat(t[2],"px ").concat(t[3],"px rgba(0,0,0,").concat(.2,")"),"".concat(t[4],"px ").concat(t[5],"px ").concat(t[6],"px ").concat(t[7],"px rgba(0,0,0,").concat(.14,")"),"".concat(t[8],"px ").concat(t[9],"px ").concat(t[10],"px ").concat(t[11],"px rgba(0,0,0,").concat(.12,")")].join(",")}let R=["none",P(0,2,1,-1,0,1,1,0,0,1,3,0),P(0,3,1,-2,0,2,2,0,0,1,5,0),P(0,3,3,-2,0,3,4,0,0,1,8,0),P(0,2,4,-1,0,4,5,0,0,1,10,0),P(0,3,5,-1,0,5,8,0,0,1,14,0),P(0,3,5,-1,0,6,10,0,0,1,18,0),P(0,4,5,-2,0,7,10,1,0,2,16,1),P(0,5,5,-3,0,8,10,1,0,3,14,2),P(0,5,6,-3,0,9,12,1,0,3,16,2),P(0,6,6,-3,0,10,14,1,0,4,18,3),P(0,6,7,-4,0,11,15,1,0,4,20,3),P(0,7,8,-4,0,12,17,2,0,5,22,4),P(0,7,8,-4,0,13,19,2,0,5,24,4),P(0,7,9,-4,0,14,21,2,0,5,26,4),P(0,8,9,-5,0,15,22,2,0,6,28,5),P(0,8,10,-5,0,16,24,2,0,6,30,5),P(0,8,11,-5,0,17,26,2,0,6,32,5),P(0,9,11,-5,0,18,28,2,0,7,34,6),P(0,9,12,-6,0,19,29,2,0,7,36,6),P(0,10,13,-6,0,20,31,3,0,8,38,7),P(0,10,13,-6,0,21,33,3,0,8,40,7),P(0,10,14,-6,0,22,35,3,0,8,42,7),P(0,11,14,-7,0,23,36,3,0,9,44,8),P(0,11,15,-7,0,24,38,3,0,9,46,8)],k={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},N={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function D(e){return"".concat(Math.round(e),"ms")}function U(e){if(!e)return 0;let t=e/36;return Math.min(Math.round((4+15*t**.25+t/5)*10),3e3)}let z={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function B(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={...e};return!function e(t){let r=Object.entries(t);for(let n=0;n<r.length;n++){let[o,a]=r[n];!((0,i.Q)(a)||void 0===a||"string"==typeof a||"boolean"==typeof a||"number"==typeof a||Array.isArray(a))||o.startsWith("unstable_")?delete t[o]:(0,i.Q)(a)&&(t[o]={...a},e(t[o]))}}(t),"import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';\n\nconst theme = ".concat(JSON.stringify(t,null,2),";\n\ntheme.breakpoints = createBreakpoints(theme.breakpoints || {});\ntheme.transitions = createTransitions(theme.transitions || {});\n\nexport default theme;")}function F(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(var t,r=arguments.length,o=Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];let{breakpoints:s,mixins:l={},spacing:u,palette:c={},transitions:h={},typography:d={},shape:p,...f}=e;if(e.vars)throw Error((0,n.A)(20));let g=_(c),m=(0,M.A)(e),v=(0,i.A)(m,{mixins:{toolbar:{minHeight:56,[(t=m.breakpoints).up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}},...l},palette:g,shadows:R.slice(),typography:function(e,t){let{fontFamily:r=I,fontSize:n=14,fontWeightLight:o=300,fontWeightRegular:a=400,fontWeightMedium:s=500,fontWeightBold:l=700,htmlFontSize:u=16,allVariants:c,pxToRem:h,...d}="function"==typeof t?t(e):t,p=n/14,f=h||(e=>"".concat(e/u*p,"rem")),g=(e,t,n,i,o)=>({fontFamily:r,fontWeight:e,fontSize:f(t),lineHeight:n,...r===I?{letterSpacing:"".concat(Math.round(i/t*1e5)/1e5,"em")}:{},...o,...c}),m={h1:g(o,96,1.167,-1.5),h2:g(o,60,1.2,-.5),h3:g(a,48,1.167,0),h4:g(a,34,1.235,.25),h5:g(a,24,1.334,0),h6:g(s,20,1.6,.15),subtitle1:g(a,16,1.75,.15),subtitle2:g(s,14,1.57,.1),body1:g(a,16,1.5,.15),body2:g(a,14,1.43,.15),button:g(s,14,1.75,.4,O),caption:g(a,12,1.66,.4),overline:g(a,12,2.66,1,O),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return(0,i.A)({htmlFontSize:u,pxToRem:f,fontFamily:r,fontSize:n,fontWeightLight:o,fontWeightRegular:a,fontWeightMedium:s,fontWeightBold:l,...m},d,{clone:!1})}(g,d),transitions:function(e){let t={...k,...e.easing},r={...N,...e.duration};return{getAutoHeightDuration:U,create:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{duration:i=r.standard,easing:o=t.easeInOut,delay:a=0,...s}=n;return(Array.isArray(e)?e:[e]).map(e=>"".concat(e," ").concat("string"==typeof i?i:D(i)," ").concat(o," ").concat("string"==typeof a?a:D(a))).join(",")},...e,easing:t,duration:r}}(h),zIndex:{...z}});return v=(0,i.A)(v,f),(v=o.reduce((e,t)=>(0,i.A)(e,t),v)).unstable_sxConfig={...w.A,...null==f?void 0:f.unstable_sxConfig},v.unstable_sx=function(e){return(0,L.A)({sx:e,theme:this})},v.toRuntimeSource=B,v}let j=[...Array(25)].map((e,t)=>{if(0===t)return"none";let r=function(e){return Math.round(10*(e<1?5.11916*e**2:4.5*Math.log(e+1)+2))/1e3}(t);return"linear-gradient(rgba(255 255 255 / ".concat(r,"), rgba(255 255 255 / ").concat(r,"))")});function V(e){return{inputPlaceholder:"dark"===e?.5:.42,inputUnderline:"dark"===e?.7:.42,switchTrackDisabled:"dark"===e?.2:.12,switchTrack:"dark"===e?.3:.38}}function H(e){return"dark"===e?j:[]}function G(e){var t;return!!e[0].match(/(cssVarPrefix|colorSchemeSelector|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!e[0].match(/sxConfig$/)||"palette"===e[0]&&!!(null===(t=e[1])||void 0===t?void 0:t.match(/(mode|contrastThreshold|tonalOffset)/))}let W=e=>[...[...Array(25)].map((t,r)=>"--".concat(e?"".concat(e,"-"):"","overlays-").concat(r)),"--".concat(e?"".concat(e,"-"):"","palette-AppBar-darkBg"),"--".concat(e?"".concat(e,"-"):"","palette-AppBar-darkColor")],X=e=>(t,r)=>{let n=e.rootSelector||":root",i=e.colorSchemeSelector,o=i;if("class"===i&&(o=".%s"),"data"===i&&(o="[data-%s]"),(null==i?void 0:i.startsWith("data-"))&&!i.includes("%s")&&(o="[".concat(i,'="%s"]')),e.defaultColorScheme===t){if("dark"===t){let i={};return(W(e.cssVarPrefix).forEach(e=>{i[e]=r[e],delete r[e]}),"media"===o)?{[n]:r,"@media (prefers-color-scheme: dark)":{[n]:i}}:o?{[o.replace("%s",t)]:i,["".concat(n,", ").concat(o.replace("%s",t))]:r}:{[n]:{...r,...i}}}if(o&&"media"!==o)return"".concat(n,", ").concat(o.replace("%s",String(t)))}else if(t){if("media"===o)return{["@media (prefers-color-scheme: ".concat(String(t),")")]:{[n]:r}};if(o)return o.replace("%s",String(t))}return n};function $(e,t,r){!e[t]&&r&&(e[t]=r)}function Z(e){return"string"==typeof e&&e.startsWith("hsl")?(0,o.YL)(e):e}function Y(e,t){"".concat(t,"Channel")in e||(e["".concat(t,"Channel")]=(0,o.Me)(Z(e[t]),"MUI: Can't create `palette.".concat(t,"Channel` because `palette.").concat(t,"` is not one of these formats: #nnn, #nnnnnn, rgb(), rgba(), hsl(), hsla(), color().")+"\n"+"To suppress this warning, you need to explicitly provide the `palette.".concat(t,'Channel` as a string (in rgb format, for example "12 12 12") or undefined if you want to remove the channel token.')))}let q=e=>{try{return e()}catch(e){}},K=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mui";return function(e=""){return(t,...r)=>`var(--${e?`${e}-`:""}${t}${function t(...r){if(!r.length)return"";let n=r[0];return"string"!=typeof n||n.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, ${n}`:`, var(--${e?`${e}-`:""}${n}${t(...r.slice(1))})`}(...r)})`}(e)};function Q(e,t,r,n){if(!t)return;t=!0===t?{}:t;let i="dark"===n?"dark":"light";if(!r){e[n]=function(e){let{palette:t={mode:"light"},opacity:r,overlays:n,...i}=e,o=_(t);return{palette:o,opacity:{...V(o.mode),...r},overlays:n||H(o.mode),...i}}({...t,palette:{mode:i,...null==t?void 0:t.palette}});return}let{palette:o,...a}=F({...r,palette:{mode:i,...null==t?void 0:t.palette}});return e[n]={...t,palette:o,opacity:{...V(i),...null==t?void 0:t.opacity},overlays:(null==t?void 0:t.overlays)||H(i)},a}function J(e,t,r){e.colorSchemes&&r&&(e.colorSchemes[t]={...!0!==r&&r,palette:_({...!0===r?{}:r.palette,mode:t})})}function ee(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(var t=arguments.length,r=Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];let{palette:s,cssVariables:l=!1,colorSchemes:u=s?void 0:{light:!0},defaultColorScheme:c=null==s?void 0:s.mode,...h}=e,d=c||"light",p=null==u?void 0:u[d],f={...u,...s?{[d]:{..."boolean"!=typeof p&&p,palette:s}}:void 0};if(!1===l){if(!("colorSchemes"in e))return F(e,...r);let t=s;"palette"in e||!f[d]||(!0!==f[d]?t=f[d].palette:"dark"!==d||(t={mode:"dark"}));let n=F({...e,palette:t},...r);return n.defaultColorScheme=d,n.colorSchemes=f,"light"===n.palette.mode&&(n.colorSchemes.light={...!0!==f.light&&f.light,palette:n.palette},J(n,"dark",f.dark)),"dark"===n.palette.mode&&(n.colorSchemes.dark={...!0!==f.dark&&f.dark,palette:n.palette},J(n,"light",f.light)),n}return s||"light"in f||"light"!==d||(f.light=!0),function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(var t,r=arguments.length,a=Array(r>1?r-1:0),s=1;s<r;s++)a[s-1]=arguments[s];let{colorSchemes:l={light:!0},defaultColorScheme:u,disableCssColorScheme:c=!1,cssVarPrefix:h="mui",shouldSkipGeneratingVar:d=G,colorSchemeSelector:p=l.light&&l.dark?"media":void 0,rootSelector:f=":root",...g}=e,m=Object.keys(l)[0],v=u||(l.light&&"light"!==m?"light":m),y=K(h),{[v]:_,light:S,dark:A,...E}=l,T={...E},M=_;if(("dark"!==v||"dark"in l)&&("light"!==v||"light"in l)||(M=!0),!M)throw Error((0,n.A)(21,v));let O=Q(T,M,g,v);S&&!T.light&&Q(T,S,void 0,"light"),A&&!T.dark&&Q(T,A,void 0,"dark");let I={defaultColorScheme:v,...O,cssVarPrefix:h,colorSchemeSelector:p,rootSelector:f,getCssVar:y,colorSchemes:T,font:{...function(e){let t={};return Object.entries(e).forEach(e=>{let[r,n]=e;"object"==typeof n&&(t[r]=`${n.fontStyle?`${n.fontStyle} `:""}${n.fontVariant?`${n.fontVariant} `:""}${n.fontWeight?`${n.fontWeight} `:""}${n.fontStretch?`${n.fontStretch} `:""}${n.fontSize||""}${n.lineHeight?`/${n.lineHeight} `:""}${n.fontFamily||""}`)}),t}(O.typography),...O.font},spacing:"number"==typeof(t=g.spacing)?"".concat(t,"px"):"string"==typeof t||"function"==typeof t||Array.isArray(t)?t:"8px"};Object.keys(I.colorSchemes).forEach(e=>{let t=I.colorSchemes[e].palette,r=e=>{let r=e.split("-"),n=r[1],i=r[2];return y(e,t[n][i])};if("light"===t.mode&&($(t.common,"background","#fff"),$(t.common,"onBackground","#000")),"dark"===t.mode&&($(t.common,"background","#000"),$(t.common,"onBackground","#fff")),function(e,t){t.forEach(t=>{e[t]||(e[t]={})})}(t,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),"light"===t.mode){$(t.Alert,"errorColor",(0,o.Nd)(t.error.light,.6)),$(t.Alert,"infoColor",(0,o.Nd)(t.info.light,.6)),$(t.Alert,"successColor",(0,o.Nd)(t.success.light,.6)),$(t.Alert,"warningColor",(0,o.Nd)(t.warning.light,.6)),$(t.Alert,"errorFilledBg",r("palette-error-main")),$(t.Alert,"infoFilledBg",r("palette-info-main")),$(t.Alert,"successFilledBg",r("palette-success-main")),$(t.Alert,"warningFilledBg",r("palette-warning-main")),$(t.Alert,"errorFilledColor",q(()=>t.getContrastText(t.error.main))),$(t.Alert,"infoFilledColor",q(()=>t.getContrastText(t.info.main))),$(t.Alert,"successFilledColor",q(()=>t.getContrastText(t.success.main))),$(t.Alert,"warningFilledColor",q(()=>t.getContrastText(t.warning.main))),$(t.Alert,"errorStandardBg",(0,o.j4)(t.error.light,.9)),$(t.Alert,"infoStandardBg",(0,o.j4)(t.info.light,.9)),$(t.Alert,"successStandardBg",(0,o.j4)(t.success.light,.9)),$(t.Alert,"warningStandardBg",(0,o.j4)(t.warning.light,.9)),$(t.Alert,"errorIconColor",r("palette-error-main")),$(t.Alert,"infoIconColor",r("palette-info-main")),$(t.Alert,"successIconColor",r("palette-success-main")),$(t.Alert,"warningIconColor",r("palette-warning-main")),$(t.AppBar,"defaultBg",r("palette-grey-100")),$(t.Avatar,"defaultBg",r("palette-grey-400")),$(t.Button,"inheritContainedBg",r("palette-grey-300")),$(t.Button,"inheritContainedHoverBg",r("palette-grey-A100")),$(t.Chip,"defaultBorder",r("palette-grey-400")),$(t.Chip,"defaultAvatarColor",r("palette-grey-700")),$(t.Chip,"defaultIconColor",r("palette-grey-700")),$(t.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),$(t.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),$(t.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),$(t.LinearProgress,"primaryBg",(0,o.j4)(t.primary.main,.62)),$(t.LinearProgress,"secondaryBg",(0,o.j4)(t.secondary.main,.62)),$(t.LinearProgress,"errorBg",(0,o.j4)(t.error.main,.62)),$(t.LinearProgress,"infoBg",(0,o.j4)(t.info.main,.62)),$(t.LinearProgress,"successBg",(0,o.j4)(t.success.main,.62)),$(t.LinearProgress,"warningBg",(0,o.j4)(t.warning.main,.62)),$(t.Skeleton,"bg","rgba(".concat(r("palette-text-primaryChannel")," / 0.11)")),$(t.Slider,"primaryTrack",(0,o.j4)(t.primary.main,.62)),$(t.Slider,"secondaryTrack",(0,o.j4)(t.secondary.main,.62)),$(t.Slider,"errorTrack",(0,o.j4)(t.error.main,.62)),$(t.Slider,"infoTrack",(0,o.j4)(t.info.main,.62)),$(t.Slider,"successTrack",(0,o.j4)(t.success.main,.62)),$(t.Slider,"warningTrack",(0,o.j4)(t.warning.main,.62));let e=(0,o.Y9)(t.background.default,.8);$(t.SnackbarContent,"bg",e),$(t.SnackbarContent,"color",q(()=>t.getContrastText(e))),$(t.SpeedDialAction,"fabHoverBg",(0,o.Y9)(t.background.paper,.15)),$(t.StepConnector,"border",r("palette-grey-400")),$(t.StepContent,"border",r("palette-grey-400")),$(t.Switch,"defaultColor",r("palette-common-white")),$(t.Switch,"defaultDisabledColor",r("palette-grey-100")),$(t.Switch,"primaryDisabledColor",(0,o.j4)(t.primary.main,.62)),$(t.Switch,"secondaryDisabledColor",(0,o.j4)(t.secondary.main,.62)),$(t.Switch,"errorDisabledColor",(0,o.j4)(t.error.main,.62)),$(t.Switch,"infoDisabledColor",(0,o.j4)(t.info.main,.62)),$(t.Switch,"successDisabledColor",(0,o.j4)(t.success.main,.62)),$(t.Switch,"warningDisabledColor",(0,o.j4)(t.warning.main,.62)),$(t.TableCell,"border",(0,o.j4)((0,o.Cg)(t.divider,1),.88)),$(t.Tooltip,"bg",(0,o.Cg)(t.grey[700],.92))}if("dark"===t.mode){$(t.Alert,"errorColor",(0,o.j4)(t.error.light,.6)),$(t.Alert,"infoColor",(0,o.j4)(t.info.light,.6)),$(t.Alert,"successColor",(0,o.j4)(t.success.light,.6)),$(t.Alert,"warningColor",(0,o.j4)(t.warning.light,.6)),$(t.Alert,"errorFilledBg",r("palette-error-dark")),$(t.Alert,"infoFilledBg",r("palette-info-dark")),$(t.Alert,"successFilledBg",r("palette-success-dark")),$(t.Alert,"warningFilledBg",r("palette-warning-dark")),$(t.Alert,"errorFilledColor",q(()=>t.getContrastText(t.error.dark))),$(t.Alert,"infoFilledColor",q(()=>t.getContrastText(t.info.dark))),$(t.Alert,"successFilledColor",q(()=>t.getContrastText(t.success.dark))),$(t.Alert,"warningFilledColor",q(()=>t.getContrastText(t.warning.dark))),$(t.Alert,"errorStandardBg",(0,o.Nd)(t.error.light,.9)),$(t.Alert,"infoStandardBg",(0,o.Nd)(t.info.light,.9)),$(t.Alert,"successStandardBg",(0,o.Nd)(t.success.light,.9)),$(t.Alert,"warningStandardBg",(0,o.Nd)(t.warning.light,.9)),$(t.Alert,"errorIconColor",r("palette-error-main")),$(t.Alert,"infoIconColor",r("palette-info-main")),$(t.Alert,"successIconColor",r("palette-success-main")),$(t.Alert,"warningIconColor",r("palette-warning-main")),$(t.AppBar,"defaultBg",r("palette-grey-900")),$(t.AppBar,"darkBg",r("palette-background-paper")),$(t.AppBar,"darkColor",r("palette-text-primary")),$(t.Avatar,"defaultBg",r("palette-grey-600")),$(t.Button,"inheritContainedBg",r("palette-grey-800")),$(t.Button,"inheritContainedHoverBg",r("palette-grey-700")),$(t.Chip,"defaultBorder",r("palette-grey-700")),$(t.Chip,"defaultAvatarColor",r("palette-grey-300")),$(t.Chip,"defaultIconColor",r("palette-grey-300")),$(t.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),$(t.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),$(t.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),$(t.LinearProgress,"primaryBg",(0,o.Nd)(t.primary.main,.5)),$(t.LinearProgress,"secondaryBg",(0,o.Nd)(t.secondary.main,.5)),$(t.LinearProgress,"errorBg",(0,o.Nd)(t.error.main,.5)),$(t.LinearProgress,"infoBg",(0,o.Nd)(t.info.main,.5)),$(t.LinearProgress,"successBg",(0,o.Nd)(t.success.main,.5)),$(t.LinearProgress,"warningBg",(0,o.Nd)(t.warning.main,.5)),$(t.Skeleton,"bg","rgba(".concat(r("palette-text-primaryChannel")," / 0.13)")),$(t.Slider,"primaryTrack",(0,o.Nd)(t.primary.main,.5)),$(t.Slider,"secondaryTrack",(0,o.Nd)(t.secondary.main,.5)),$(t.Slider,"errorTrack",(0,o.Nd)(t.error.main,.5)),$(t.Slider,"infoTrack",(0,o.Nd)(t.info.main,.5)),$(t.Slider,"successTrack",(0,o.Nd)(t.success.main,.5)),$(t.Slider,"warningTrack",(0,o.Nd)(t.warning.main,.5));let e=(0,o.Y9)(t.background.default,.98);$(t.SnackbarContent,"bg",e),$(t.SnackbarContent,"color",q(()=>t.getContrastText(e))),$(t.SpeedDialAction,"fabHoverBg",(0,o.Y9)(t.background.paper,.15)),$(t.StepConnector,"border",r("palette-grey-600")),$(t.StepContent,"border",r("palette-grey-600")),$(t.Switch,"defaultColor",r("palette-grey-300")),$(t.Switch,"defaultDisabledColor",r("palette-grey-600")),$(t.Switch,"primaryDisabledColor",(0,o.Nd)(t.primary.main,.55)),$(t.Switch,"secondaryDisabledColor",(0,o.Nd)(t.secondary.main,.55)),$(t.Switch,"errorDisabledColor",(0,o.Nd)(t.error.main,.55)),$(t.Switch,"infoDisabledColor",(0,o.Nd)(t.info.main,.55)),$(t.Switch,"successDisabledColor",(0,o.Nd)(t.success.main,.55)),$(t.Switch,"warningDisabledColor",(0,o.Nd)(t.warning.main,.55)),$(t.TableCell,"border",(0,o.Nd)((0,o.Cg)(t.divider,1),.68)),$(t.Tooltip,"bg",(0,o.Cg)(t.grey[700],.92))}Y(t.background,"default"),Y(t.background,"paper"),Y(t.common,"background"),Y(t.common,"onBackground"),Y(t,"divider"),Object.keys(t).forEach(e=>{let r=t[e];"tonalOffset"!==e&&r&&"object"==typeof r&&(r.main&&$(t[e],"mainChannel",(0,o.Me)(Z(r.main))),r.light&&$(t[e],"lightChannel",(0,o.Me)(Z(r.light))),r.dark&&$(t[e],"darkChannel",(0,o.Me)(Z(r.dark))),r.contrastText&&$(t[e],"contrastTextChannel",(0,o.Me)(Z(r.contrastText))),"text"===e&&(Y(t[e],"primary"),Y(t[e],"secondary")),"action"===e&&(r.active&&Y(t[e],"active"),r.selected&&Y(t[e],"selected")))})});let P={prefix:h,disableCssColorScheme:c,shouldSkipGeneratingVar:d,getSelector:X(I=a.reduce((e,t)=>(0,i.A)(e,t),I))},{vars:R,generateThemeVars:k,generateStyleSheets:N}=C(I,P);return I.vars=R,Object.entries(I.colorSchemes[I.defaultColorScheme]).forEach(e=>{let[t,r]=e;I[t]=r}),I.generateThemeVars=k,I.generateStyleSheets=N,I.generateSpacing=function(){return(0,b.A)(g.spacing,(0,x.LX)(this))},I.getColorSchemeSelector=function(e){return"media"===p?`@media (prefers-color-scheme: ${e})`:p?p.startsWith("data-")&&!p.includes("%s")?`[${p}="${e}"] &`:"class"===p?`.${e} &`:"data"===p?`[data-${e}] &`:`${p.replace("%s",e)} &`:"&"},I.spacing=I.generateSpacing(),I.shouldSkipGeneratingVar=d,I.unstable_sxConfig={...w.A,...null==g?void 0:g.unstable_sxConfig},I.unstable_sx=function(e){return(0,L.A)({sx:e,theme:this})},I.toRuntimeSource=B,I}({...h,colorSchemes:f,defaultColorScheme:d,..."boolean"!=typeof l&&l},...r)}},1391:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n="$$material"},85992:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=e=>(function(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e})(e)&&"classes"!==e},52134:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>g});var n=r(17605),i=r(25996),o=r(29452),a=r(6656),s=r(82501);let l=(0,o.A)();function u(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}function c(e,t){let r="function"==typeof t?t(e):t;if(Array.isArray(r))return r.flatMap(t=>c(e,t));if(Array.isArray(r?.variants)){let t;if(r.isProcessed)t=r.style;else{let{variants:e,...n}=r;t=n}return h(e,r.variants,[t])}return r?.isProcessed?r.style:r}function h(e,t,r=[]){let n;t:for(let i=0;i<t.length;i+=1){let o=t[i];if("function"==typeof o.props){if(n??={...e,...e.ownerState,ownerState:e.ownerState},!o.props(n))continue}else for(let t in o.props)if(e[t]!==o.props[t]&&e.ownerState?.[t]!==o.props[t])continue t;"function"==typeof o.style?(n??={...e,...e.ownerState,ownerState:e.ownerState},r.push(o.style(n))):r.push(o.style)}return r}let d=(0,r(461).A)();var p=r(1391),f=r(85992);let g=function(e={}){let{themeId:t,defaultTheme:r=l,rootShouldForwardProp:o=u,slotShouldForwardProp:d=u}=e;function p(e){e.theme=!function(e){for(let t in e)return!1;return!0}(e.theme)?e.theme[t]||e.theme:r}return(e,t={})=>{var r;(0,n.HX)(e,e=>e.filter(e=>e!==a.A));let{name:l,slot:f,skipVariantsResolver:g,skipSx:m,overridesResolver:v=(r=f?f.charAt(0).toLowerCase()+f.slice(1):f)?(e,t)=>t[r]:null,...y}=t,_=void 0!==g?g:f&&"Root"!==f&&"root"!==f||!1,b=m||!1,x=u;"Root"===f||"root"===f?x=o:f?x=d:"string"==typeof e&&e.charCodeAt(0)>96&&(x=void 0);let S=(0,n.Ay)(e,{shouldForwardProp:x,label:void 0,...y}),A=e=>{if("function"==typeof e&&e.__emotion_real!==e)return function(t){return c(t,e)};if((0,i.Q)(e)){let t=(0,s.A)(e);return t.variants?function(e){return c(e,t)}:t.style}return e},E=(...t)=>{let r=[],n=t.map(A),i=[];if(r.push(p),l&&v&&i.push(function(e){let t=e.theme,r=t.components?.[l]?.styleOverrides;if(!r)return null;let n={};for(let t in r)n[t]=c(e,r[t]);return v(e,n)}),l&&!_&&i.push(function(e){let t=e.theme,r=t?.components?.[l]?.variants;return r?h(e,r):null}),b||i.push(a.A),Array.isArray(n[0])){let e;let t=n.shift(),o=Array(r.length).fill(""),a=Array(i.length).fill("");(e=[...o,...t,...a]).raw=[...o,...t.raw,...a],r.unshift(e)}let o=S(...r,...n,...i);return e.muiName&&(o.muiName=e.muiName),o};return S.withConfig&&(E.withConfig=S.withConfig),E}}({themeId:p.A,defaultTheme:d,rootShouldForwardProp:f.A})},66301:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=r(73526).A},96663:(e,t,r)=>{"use strict";r.d(t,{A:()=>v});var n=r(25316),i=r(64927),o=r(49554),a=r(66301),s=r(52134),l=r(1157),u=r(14029),c=r(95924),h=r(95536);function d(e){return(0,h.Ay)("MuiSvgIcon",e)}(0,c.A)("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);var p=r(23528);let f=e=>{let{color:t,fontSize:r,classes:n}=e,i={root:["root","inherit"!==t&&"color".concat((0,a.A)(t)),"fontSize".concat((0,a.A)(r))]};return(0,o.A)(i,d,n)},g=(0,s.Ay)("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.root,"inherit"!==r.color&&t["color".concat((0,a.A)(r.color))],t["fontSize".concat((0,a.A)(r.fontSize))]]}})((0,l.A)(e=>{var t,r,n,i,o,a,s,l,u,c,h,d,p,f,g,m,v,y;let{theme:_}=e;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:null===(i=_.transitions)||void 0===i?void 0:null===(n=i.create)||void 0===n?void 0:n.call(i,"fill",{duration:null===(r=(null!==(g=_.vars)&&void 0!==g?g:_).transitions)||void 0===r?void 0:null===(t=r.duration)||void 0===t?void 0:t.shorter}),variants:[{props:e=>!e.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:(null===(a=_.typography)||void 0===a?void 0:null===(o=a.pxToRem)||void 0===o?void 0:o.call(a,20))||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:(null===(l=_.typography)||void 0===l?void 0:null===(s=l.pxToRem)||void 0===s?void 0:s.call(l,24))||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:(null===(c=_.typography)||void 0===c?void 0:null===(u=c.pxToRem)||void 0===u?void 0:u.call(c,35))||"2.1875rem"}},...Object.entries((null!==(m=_.vars)&&void 0!==m?m:_).palette).filter(e=>{let[,t]=e;return t&&t.main}).map(e=>{var t,r,n;let[i]=e;return{props:{color:i},style:{color:null===(r=(null!==(n=_.vars)&&void 0!==n?n:_).palette)||void 0===r?void 0:null===(t=r[i])||void 0===t?void 0:t.main}}}),{props:{color:"action"},style:{color:null===(d=(null!==(v=_.vars)&&void 0!==v?v:_).palette)||void 0===d?void 0:null===(h=d.action)||void 0===h?void 0:h.active}},{props:{color:"disabled"},style:{color:null===(f=(null!==(y=_.vars)&&void 0!==y?y:_).palette)||void 0===f?void 0:null===(p=f.action)||void 0===p?void 0:p.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}})),m=n.forwardRef(function(e,t){let r=(0,u.b)({props:e,name:"MuiSvgIcon"}),{children:o,className:a,color:s="inherit",component:l="svg",fontSize:c="medium",htmlColor:h,inheritViewBox:d=!1,titleAccess:m,viewBox:v="0 0 24 24",...y}=r,_=n.isValidElement(o)&&"svg"===o.type,b={...r,color:s,component:l,fontSize:c,instanceFontSize:e.fontSize,inheritViewBox:d,viewBox:v,hasSvgAsChild:_},x={};d||(x.viewBox=v);let S=f(b);return(0,p.jsxs)(g,{as:l,className:(0,i.A)(S.root,a),focusable:"false",color:h,"aria-hidden":!m||void 0,role:m?"img":void 0,ref:t,...x,...y,..._&&o.props,ownerState:b,children:[_?o.props.children:o,m?(0,p.jsx)("title",{children:m}):null]})});function v(e,t){function r(r,n){return(0,p.jsx)(m,{"data-testid":"".concat(t,"Icon"),ref:n,...r,children:e})}return r.muiName=m.muiName,n.memo(n.forwardRef(r))}m&&(m.muiName="SvgIcon")},1157:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(82501);let i={theme:void 0},o=function(e){let t,r;return function(o){let a=t;return(void 0===a||o.theme!==r)&&(i.theme=o.theme,t=a=(0,n.A)(e(i)),r=o.theme),a}}},17605:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>v,HX:()=>y,tT:()=>b});var n=r(20859),i=r(25478),o=r(96843),a=r(98469),s=r(69987),l=r(25316),u=r(70430),c=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,h=(0,u.A)(function(e){return c.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&91>e.charCodeAt(2)}),d=function(e){return"theme"!==e},p=function(e){return"string"==typeof e&&e.charCodeAt(0)>96?h:d},f=function(e,t,r){var n;if(t){var i=t.shouldForwardProp;n=e.__emotion_forwardProp&&i?function(t){return e.__emotion_forwardProp(t)&&i(t)}:i}return"function"!=typeof n&&r&&(n=e.__emotion_forwardProp),n},g=function(e){var t=e.cache,r=e.serialized,n=e.isStringTag;return(0,s.SF)(t,r,n),(0,a.s)(function(){return(0,s.sk)(t,r,n)}),null},m=(function e(t,r){var a,u,c=t.__emotion_real===t,h=c&&t.__emotion_base||t;void 0!==r&&(a=r.label,u=r.target);var d=f(t,r,c),m=d||p(h),v=!m("as");return function(){var y=arguments,_=c&&void 0!==t.__emotion_styles?t.__emotion_styles.slice(0):[];if(void 0!==a&&_.push("label:"+a+";"),null==y[0]||void 0===y[0].raw)_.push.apply(_,y);else{var b=y[0];_.push(b[0]);for(var x=y.length,S=1;S<x;S++)_.push(y[S],b[S])}var A=(0,i.w)(function(e,t,r){var n=v&&e.as||h,a="",c=[],f=e;if(null==e.theme){for(var y in f={},e)f[y]=e[y];f.theme=l.useContext(i.T)}"string"==typeof e.className?a=(0,s.Rk)(t.registered,c,e.className):null!=e.className&&(a=e.className+" ");var b=(0,o.J)(_.concat(c),t.registered,f);a+=t.key+"-"+b.name,void 0!==u&&(a+=" "+u);var x=v&&void 0===d?p(n):m,S={};for(var A in e)(!v||"as"!==A)&&x(A)&&(S[A]=e[A]);return S.className=a,r&&(S.ref=r),l.createElement(l.Fragment,null,l.createElement(g,{cache:t,serialized:b,isStringTag:"string"==typeof n}),l.createElement(n,S))});return A.displayName=void 0!==a?a:"Styled("+("string"==typeof h?h:h.displayName||h.name||"Component")+")",A.defaultProps=t.defaultProps,A.__emotion_real=A,A.__emotion_base=h,A.__emotion_styles=_,A.__emotion_forwardProp=d,Object.defineProperty(A,"toString",{value:function(){return"."+u}}),A.withComponent=function(t,i){return e(t,(0,n.A)({},r,i,{shouldForwardProp:f(A,i,!0)})).apply(void 0,_)},A}}).bind(null);function v(e,t){return m(e,t)}function y(e,t){Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))}["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach(function(e){m[e]=m(e)});let _=[];function b(e){return _[0]=e,(0,o.J)(_)}},69160:(e,t,r)=>{"use strict";r.d(t,{EU:()=>l,NI:()=>s,vf:()=>u,zu:()=>i});var n=r(12952);let i={xs:0,sm:600,md:900,lg:1200,xl:1536},o={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${i[e]}px)`},a={containerQueries:e=>({up:t=>{let r="number"==typeof t?t:i[t]||t;return"number"==typeof r&&(r=`${r}px`),e?`@container ${e} (min-width:${r})`:`@container (min-width:${r})`}})};function s(e,t,r){let s=e.theme||{};if(Array.isArray(t)){let e=s.breakpoints||o;return t.reduce((n,i,o)=>(n[e.up(e.keys[o])]=r(t[o]),n),{})}if("object"==typeof t){let e=s.breakpoints||o;return Object.keys(t).reduce((o,l)=>{if((0,n.ob)(e.keys,l)){let e=(0,n.CT)(s.containerQueries?s:a,l);e&&(o[e]=r(t[l],l))}else Object.keys(e.values||i).includes(l)?o[e.up(l)]=r(t[l],l):o[l]=t[l];return o},{})}return r(t)}function l(e={}){return e.keys?.reduce((t,r)=>(t[e.up(r)]={},t),{})||{}}function u(e,t){return e.reduce((e,t)=>{let r=e[t];return r&&0!==Object.keys(r).length||delete e[t],e},t)}},17467:(e,t,r)=>{"use strict";r.d(t,{X4:()=>d,e$:()=>f,eM:()=>h,YL:()=>u,a:()=>m,Cg:()=>p,Me:()=>s,Nd:()=>g,Y9:()=>y,j4:()=>v});var n=r(34020);function i(e,t=0,r=1){return function(e,t=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER){return Math.max(t,Math.min(e,r))}(e,t,r)}function o(e){let t;if(e.type)return e;if("#"===e.charAt(0))return o(function(e){e=e.slice(1);let t=RegExp(`.{1,${e.length>=6?2:1}}`,"g"),r=e.match(t);return r&&1===r[0].length&&(r=r.map(e=>e+e)),r?`rgb${4===r.length?"a":""}(${r.map((e,t)=>t<3?parseInt(e,16):Math.round(parseInt(e,16)/255*1e3)/1e3).join(", ")})`:""}(e));let r=e.indexOf("("),i=e.substring(0,r);if(!["rgb","rgba","hsl","hsla","color"].includes(i))throw Error((0,n.A)(9,e));let a=e.substring(r+1,e.length-1);if("color"===i){if(t=(a=a.split(" ")).shift(),4===a.length&&"/"===a[3].charAt(0)&&(a[3]=a[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(t))throw Error((0,n.A)(10,t))}else a=a.split(",");return{type:i,values:a=a.map(e=>parseFloat(e)),colorSpace:t}}let a=e=>{let t=o(e);return t.values.slice(0,3).map((e,r)=>t.type.includes("hsl")&&0!==r?`${e}%`:e).join(" ")},s=(e,t)=>{try{return a(e)}catch(t){return e}};function l(e){let{type:t,colorSpace:r}=e,{values:n}=e;return t.includes("rgb")?n=n.map((e,t)=>t<3?parseInt(e,10):e):t.includes("hsl")&&(n[1]=`${n[1]}%`,n[2]=`${n[2]}%`),n=t.includes("color")?`${r} ${n.join(" ")}`:`${n.join(", ")}`,`${t}(${n})`}function u(e){let{values:t}=e=o(e),r=t[0],n=t[1]/100,i=t[2]/100,a=n*Math.min(i,1-i),s=(e,t=(e+r/30)%12)=>i-a*Math.max(Math.min(t-3,9-t,1),-1),u="rgb",c=[Math.round(255*s(0)),Math.round(255*s(8)),Math.round(255*s(4))];return"hsla"===e.type&&(u+="a",c.push(t[3])),l({type:u,values:c})}function c(e){let t="hsl"===(e=o(e)).type||"hsla"===e.type?o(u(e)).values:e.values;return Number((.2126*(t=t.map(t=>("color"!==e.type&&(t/=255),t<=.03928?t/12.92:((t+.055)/1.055)**2.4)))[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function h(e,t){let r=c(e),n=c(t);return(Math.max(r,n)+.05)/(Math.min(r,n)+.05)}function d(e,t){return e=o(e),t=i(t),("rgb"===e.type||"hsl"===e.type)&&(e.type+="a"),"color"===e.type?e.values[3]=`/${t}`:e.values[3]=t,l(e)}function p(e,t,r){try{return d(e,t)}catch(t){return e}}function f(e,t){if(e=o(e),t=i(t),e.type.includes("hsl"))e.values[2]*=1-t;else if(e.type.includes("rgb")||e.type.includes("color"))for(let r=0;r<3;r+=1)e.values[r]*=1-t;return l(e)}function g(e,t,r){try{return f(e,t)}catch(t){return e}}function m(e,t){if(e=o(e),t=i(t),e.type.includes("hsl"))e.values[2]+=(100-e.values[2])*t;else if(e.type.includes("rgb"))for(let r=0;r<3;r+=1)e.values[r]+=(255-e.values[r])*t;else if(e.type.includes("color"))for(let r=0;r<3;r+=1)e.values[r]+=(1-e.values[r])*t;return l(e)}function v(e,t,r){try{return m(e,t)}catch(t){return e}}function y(e,t,r){try{return function(e,t=.15){return c(e)>.5?f(e,t):m(e,t)}(e,t)}catch(t){return e}}},84104:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(21675);function i(e=8,t=(0,n.LX)({spacing:e})){if(e.mui)return e;let r=(...e)=>(0===e.length?[1]:e).map(e=>{let r=t(e);return"number"==typeof r?`${r}px`:r}).join(" ");return r.mui=!0,r}},29452:(e,t,r)=>{"use strict";r.d(t,{A:()=>h});var n=r(25996);let i=e=>{let t=Object.keys(e).map(t=>({key:t,val:e[t]}))||[];return t.sort((e,t)=>e.val-t.val),t.reduce((e,t)=>({...e,[t.key]:t.val}),{})};var o=r(12952);let a={borderRadius:4};var s=r(84104),l=r(6656),u=r(87193);function c(e,t){if(this.vars){if(!this.colorSchemes?.[e]||"function"!=typeof this.getColorSchemeSelector)return{};let r=this.getColorSchemeSelector(e);return"&"===r?t:((r.includes("data-")||r.includes("."))&&(r=`*:where(${r.replace(/\s*&$/,"")}) &`),{[r]:t})}return this.palette.mode===e?t:{}}let h=function(e={},...t){let{breakpoints:r={},palette:h={},spacing:d,shape:p={},...f}=e,g=function(e){let{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:r="px",step:n=5,...o}=e,a=i(t),s=Object.keys(a);function l(e){let n="number"==typeof t[e]?t[e]:e;return`@media (min-width:${n}${r})`}function u(e){let i="number"==typeof t[e]?t[e]:e;return`@media (max-width:${i-n/100}${r})`}function c(e,i){let o=s.indexOf(i);return`@media (min-width:${"number"==typeof t[e]?t[e]:e}${r}) and (max-width:${(-1!==o&&"number"==typeof t[s[o]]?t[s[o]]:i)-n/100}${r})`}return{keys:s,values:a,up:l,down:u,between:c,only:function(e){return s.indexOf(e)+1<s.length?c(e,s[s.indexOf(e)+1]):l(e)},not:function(e){let t=s.indexOf(e);return 0===t?l(s[1]):t===s.length-1?u(s[t]):c(e,s[s.indexOf(e)+1]).replace("@media","@media not all and")},unit:r,...o}}(r),m=(0,s.A)(d),v=(0,n.A)({breakpoints:g,direction:"ltr",components:{},palette:{mode:"light",...h},spacing:m,shape:{...a,...p}},f);return(v=(0,o.Ay)(v)).applyStyles=c,(v=t.reduce((e,t)=>(0,n.A)(e,t),v)).unstable_sxConfig={...u.A,...f?.unstable_sxConfig},v.unstable_sx=function(e){return(0,l.A)({sx:e,theme:this})},v}},12952:(e,t,r)=>{"use strict";function n(e,t){if(!e.containerQueries)return t;let r=Object.keys(t).filter(e=>e.startsWith("@container")).sort((e,t)=>{let r=/min-width:\s*([0-9.]+)/;return+(e.match(r)?.[1]||0)-+(t.match(r)?.[1]||0)});return r.length?r.reduce((e,r)=>{let n=t[r];return delete e[r],e[r]=n,e},{...t}):t}function i(e,t){return"@"===t||t.startsWith("@")&&(e.some(e=>t.startsWith(`@${e}`))||!!t.match(/^@\d/))}function o(e,t){let r=t.match(/^@([^/]+)?\/?(.+)?$/);if(!r)return null;let[,n,i]=r,o=Number.isNaN(+n)?n||0:+n;return e.containerQueries(i).up(o)}function a(e){let t=(e,t)=>e.replace("@media",t?`@container ${t}`:"@container");function r(r,n){r.up=(...r)=>t(e.breakpoints.up(...r),n),r.down=(...r)=>t(e.breakpoints.down(...r),n),r.between=(...r)=>t(e.breakpoints.between(...r),n),r.only=(...r)=>t(e.breakpoints.only(...r),n),r.not=(...r)=>{let i=t(e.breakpoints.not(...r),n);return i.includes("not all and")?i.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):i}}let n={},i=e=>(r(n,e),n);return r(i),{...e,containerQueries:i}}r.d(t,{Ay:()=>a,CT:()=>o,_S:()=>n,ob:()=>i})},78688:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(25996);let i=function(e,t){return t?(0,n.A)(e,t,{clone:!1}):e}},82501:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(17605);function i(e){let{variants:t,...r}=e,i={variants:t,style:(0,n.tT)(r),isProcessed:!0};return i.style===r||t&&t.forEach(e=>{"function"!=typeof e.style&&(e.style=(0,n.tT)(e.style))}),i}},21675:(e,t,r)=>{"use strict";r.d(t,{LX:()=>f,MA:()=>p,_W:()=>g,Lc:()=>v,Ms:()=>y});var n=r(69160),i=r(73504),o=r(78688);let a={m:"margin",p:"padding"},s={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},l={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},u=function(e){let t={};return r=>(void 0===t[r]&&(t[r]=e(r)),t[r])}(e=>{if(e.length>2){if(!l[e])return[e];e=l[e]}let[t,r]=e.split(""),n=a[t],i=s[r]||"";return Array.isArray(i)?i.map(e=>n+e):[n+i]}),c=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],h=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],d=[...c,...h];function p(e,t,r,n){let o=(0,i.Yn)(e,t,!0)??r;return"number"==typeof o||"string"==typeof o?e=>"string"==typeof e?e:"string"==typeof o?`calc(${e} * ${o})`:o*e:Array.isArray(o)?e=>{if("string"==typeof e)return e;let t=o[Math.abs(e)];return e>=0?t:"number"==typeof t?-t:`-${t}`}:"function"==typeof o?o:()=>void 0}function f(e){return p(e,"spacing",8,"spacing")}function g(e,t){return"string"==typeof t||null==t?t:e(t)}function m(e,t){let r=f(e.theme);return Object.keys(e).map(i=>(function(e,t,r,i){var o;if(!t.includes(r))return null;let a=(o=u(r),e=>o.reduce((t,r)=>(t[r]=g(i,e),t),{})),s=e[r];return(0,n.NI)(e,s,a)})(e,t,i,r)).reduce(o.A,{})}function v(e){return m(e,c)}function y(e){return m(e,h)}function _(e){return m(e,d)}v.propTypes={},v.filterProps=c,y.propTypes={},y.filterProps=h,_.propTypes={},_.filterProps=d},73504:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>s,BO:()=>a,Yn:()=>o});var n=r(73526),i=r(69160);function o(e,t,r=!0){if(!t||"string"!=typeof t)return null;if(e&&e.vars&&r){let r=`vars.${t}`.split(".").reduce((e,t)=>e&&e[t]?e[t]:null,e);if(null!=r)return r}return t.split(".").reduce((e,t)=>e&&null!=e[t]?e[t]:null,e)}function a(e,t,r,n=r){let i;return i="function"==typeof e?e(r):Array.isArray(e)?e[r]||n:o(e,r)||n,t&&(i=t(i,n,e)),i}let s=function(e){let{prop:t,cssProperty:r=e.prop,themeKey:s,transform:l}=e,u=e=>{if(null==e[t])return null;let u=e[t],c=o(e.theme,s)||{};return(0,i.NI)(e,u,e=>{let i=a(c,l,e);return(e===i&&"string"==typeof e&&(i=a(c,l,`${t}${"default"===e?"":(0,n.A)(e)}`,e)),!1===r)?i:{[r]:i}})};return u.propTypes={},u.filterProps=[t],u}},87193:(e,t,r)=>{"use strict";r.d(t,{A:()=>F});var n=r(21675),i=r(73504),o=r(78688);let a=function(...e){let t=e.reduce((e,t)=>(t.filterProps.forEach(r=>{e[r]=t}),e),{}),r=e=>Object.keys(e).reduce((r,n)=>t[n]?(0,o.A)(r,t[n](e)):r,{});return r.propTypes={},r.filterProps=e.reduce((e,t)=>e.concat(t.filterProps),[]),r};var s=r(69160);function l(e){return"number"!=typeof e?e:`${e}px solid`}function u(e,t){return(0,i.Ay)({prop:e,themeKey:"borders",transform:t})}let c=u("border",l),h=u("borderTop",l),d=u("borderRight",l),p=u("borderBottom",l),f=u("borderLeft",l),g=u("borderColor"),m=u("borderTopColor"),v=u("borderRightColor"),y=u("borderBottomColor"),_=u("borderLeftColor"),b=u("outline",l),x=u("outlineColor"),S=e=>{if(void 0!==e.borderRadius&&null!==e.borderRadius){let t=(0,n.MA)(e.theme,"shape.borderRadius",4,"borderRadius");return(0,s.NI)(e,e.borderRadius,e=>({borderRadius:(0,n._W)(t,e)}))}return null};S.propTypes={},S.filterProps=["borderRadius"],a(c,h,d,p,f,g,m,v,y,_,S,b,x);let A=e=>{if(void 0!==e.gap&&null!==e.gap){let t=(0,n.MA)(e.theme,"spacing",8,"gap");return(0,s.NI)(e,e.gap,e=>({gap:(0,n._W)(t,e)}))}return null};A.propTypes={},A.filterProps=["gap"];let E=e=>{if(void 0!==e.columnGap&&null!==e.columnGap){let t=(0,n.MA)(e.theme,"spacing",8,"columnGap");return(0,s.NI)(e,e.columnGap,e=>({columnGap:(0,n._W)(t,e)}))}return null};E.propTypes={},E.filterProps=["columnGap"];let T=e=>{if(void 0!==e.rowGap&&null!==e.rowGap){let t=(0,n.MA)(e.theme,"spacing",8,"rowGap");return(0,s.NI)(e,e.rowGap,e=>({rowGap:(0,n._W)(t,e)}))}return null};T.propTypes={},T.filterProps=["rowGap"];let C=(0,i.Ay)({prop:"gridColumn"}),w=(0,i.Ay)({prop:"gridRow"}),L=(0,i.Ay)({prop:"gridAutoFlow"}),M=(0,i.Ay)({prop:"gridAutoColumns"}),O=(0,i.Ay)({prop:"gridAutoRows"}),I=(0,i.Ay)({prop:"gridTemplateColumns"});function P(e,t){return"grey"===t?t:e}function R(e){return e<=1&&0!==e?`${100*e}%`:e}a(A,E,T,C,w,L,M,O,I,(0,i.Ay)({prop:"gridTemplateRows"}),(0,i.Ay)({prop:"gridTemplateAreas"}),(0,i.Ay)({prop:"gridArea"})),a((0,i.Ay)({prop:"color",themeKey:"palette",transform:P}),(0,i.Ay)({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:P}),(0,i.Ay)({prop:"backgroundColor",themeKey:"palette",transform:P}));let k=(0,i.Ay)({prop:"width",transform:R}),N=e=>void 0!==e.maxWidth&&null!==e.maxWidth?(0,s.NI)(e,e.maxWidth,t=>{let r=e.theme?.breakpoints?.values?.[t]||s.zu[t];return r?e.theme?.breakpoints?.unit!=="px"?{maxWidth:`${r}${e.theme.breakpoints.unit}`}:{maxWidth:r}:{maxWidth:R(t)}}):null;N.filterProps=["maxWidth"];let D=(0,i.Ay)({prop:"minWidth",transform:R}),U=(0,i.Ay)({prop:"height",transform:R}),z=(0,i.Ay)({prop:"maxHeight",transform:R}),B=(0,i.Ay)({prop:"minHeight",transform:R});(0,i.Ay)({prop:"size",cssProperty:"width",transform:R}),(0,i.Ay)({prop:"size",cssProperty:"height",transform:R}),a(k,N,D,U,z,B,(0,i.Ay)({prop:"boxSizing"}));let F={border:{themeKey:"borders",transform:l},borderTop:{themeKey:"borders",transform:l},borderRight:{themeKey:"borders",transform:l},borderBottom:{themeKey:"borders",transform:l},borderLeft:{themeKey:"borders",transform:l},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:l},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:S},color:{themeKey:"palette",transform:P},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:P},backgroundColor:{themeKey:"palette",transform:P},p:{style:n.Ms},pt:{style:n.Ms},pr:{style:n.Ms},pb:{style:n.Ms},pl:{style:n.Ms},px:{style:n.Ms},py:{style:n.Ms},padding:{style:n.Ms},paddingTop:{style:n.Ms},paddingRight:{style:n.Ms},paddingBottom:{style:n.Ms},paddingLeft:{style:n.Ms},paddingX:{style:n.Ms},paddingY:{style:n.Ms},paddingInline:{style:n.Ms},paddingInlineStart:{style:n.Ms},paddingInlineEnd:{style:n.Ms},paddingBlock:{style:n.Ms},paddingBlockStart:{style:n.Ms},paddingBlockEnd:{style:n.Ms},m:{style:n.Lc},mt:{style:n.Lc},mr:{style:n.Lc},mb:{style:n.Lc},ml:{style:n.Lc},mx:{style:n.Lc},my:{style:n.Lc},margin:{style:n.Lc},marginTop:{style:n.Lc},marginRight:{style:n.Lc},marginBottom:{style:n.Lc},marginLeft:{style:n.Lc},marginX:{style:n.Lc},marginY:{style:n.Lc},marginInline:{style:n.Lc},marginInlineStart:{style:n.Lc},marginInlineEnd:{style:n.Lc},marginBlock:{style:n.Lc},marginBlockStart:{style:n.Lc},marginBlockEnd:{style:n.Lc},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:A},rowGap:{style:T},columnGap:{style:E},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:R},maxWidth:{style:N},minWidth:{transform:R},height:{transform:R},maxHeight:{transform:R},minHeight:{transform:R},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}}},6656:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var n=r(73526),i=r(78688),o=r(73504),a=r(69160),s=r(12952),l=r(87193);let u=function(){function e(e,t,r,i){let s={[e]:t,theme:r},l=i[e];if(!l)return{[e]:t};let{cssProperty:u=e,themeKey:c,transform:h,style:d}=l;if(null==t)return null;if("typography"===c&&"inherit"===t)return{[e]:t};let p=(0,o.Yn)(r,c)||{};return d?d(s):(0,a.NI)(s,t,t=>{let r=(0,o.BO)(p,h,t);return(t===r&&"string"==typeof t&&(r=(0,o.BO)(p,h,`${e}${"default"===t?"":(0,n.A)(t)}`,t)),!1===u)?r:{[u]:r}})}return function t(r){let{sx:n,theme:o={}}=r||{};if(!n)return null;let u=o.unstable_sxConfig??l.A;function c(r){let n=r;if("function"==typeof r)n=r(o);else if("object"!=typeof r)return r;if(!n)return null;let l=(0,a.EU)(o.breakpoints),c=Object.keys(l),h=l;return Object.keys(n).forEach(r=>{var s;let l="function"==typeof(s=n[r])?s(o):s;if(null!=l){if("object"==typeof l){if(u[r])h=(0,i.A)(h,e(r,l,o,u));else{let e=(0,a.NI)({theme:o},l,e=>({[r]:e}));(function(...e){let t=new Set(e.reduce((e,t)=>e.concat(Object.keys(t)),[]));return e.every(e=>t.size===Object.keys(e).length)})(e,l)?h[r]=t({sx:l,theme:o}):h=(0,i.A)(h,e)}}else h=(0,i.A)(h,e(r,l,o,u))}}),(0,s._S)(o,(0,a.vf)(c,h))}return Array.isArray(n)?n.map(c):c(n)}}();u.filterProps=["sx"];let c=u},48790:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});let n=e=>e,i=(()=>{let e=n;return{configure(t){e=t},generate:t=>e(t),reset(){e=n}}})()},73526:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(34020);function i(e){if("string"!=typeof e)throw Error((0,n.A)(7));return e.charAt(0).toUpperCase()+e.slice(1)}},49554:(e,t,r)=>{"use strict";function n(e,t,r){let n={};for(let i in e){let o=e[i],a="",s=!0;for(let e=0;e<o.length;e+=1){let n=o[e];n&&(a+=(!0===s?"":" ")+t(n),s=!1,r&&r[n]&&(a+=" "+r[n]))}n[i]=a}return n}r.d(t,{A:()=>n})},25996:(e,t,r)=>{"use strict";r.d(t,{A:()=>function e(t,r,o={clone:!0}){let a=o.clone?{...t}:t;return i(t)&&i(r)&&Object.keys(r).forEach(s=>{n.isValidElement(r[s])?a[s]=r[s]:i(r[s])&&Object.prototype.hasOwnProperty.call(t,s)&&i(t[s])?a[s]=e(t[s],r[s],o):o.clone?a[s]=i(r[s])?function e(t){if(n.isValidElement(t)||!i(t))return t;let r={};return Object.keys(t).forEach(n=>{r[n]=e(t[n])}),r}(r[s]):r[s]:a[s]=r[s]}),a},Q:()=>i});var n=r(25316);function i(e){if("object"!=typeof e||null===e)return!1;let t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}},34020:(e,t,r)=>{"use strict";function n(e,...t){let r=new URL(`https://mui.com/production-error/?code=${e}`);return t.forEach(e=>r.searchParams.append("args[]",e)),`Minified MUI error #${e}; visit ${r} for the full message.`}r.d(t,{A:()=>n})},95536:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>o});var n=r(48790);let i={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function o(e,t,r="Mui"){let a=i[t];return a?`${r}-${a}`:`${n.A.generate(e)}-${t}`}},95924:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(95536);function i(e,t,r="Mui"){let o={};return t.forEach(t=>{o[t]=(0,n.Ay)(e,t,r)}),o}},4170:(e,t,r)=>{"use strict";r.d(t,{A:()=>function e(t,r){let n={...r};for(let i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if("components"===i||"slots"===i)n[i]={...t[i],...n[i]};else if("componentsProps"===i||"slotProps"===i){let o=t[i],a=r[i];if(a){if(o)for(let t in n[i]={...a},o)Object.prototype.hasOwnProperty.call(o,t)&&(n[i][t]=e(o[t],a[t]));else n[i]=a}else n[i]=o||{}}else void 0===n[i]&&(n[i]=t[i])}return n}})},4576:(e,t,r)=>{"use strict";var n=r(36792);function i(){var e={},t=0,r=0,n=0;return{add:function(i,o){o||(o=i,i=0),i>r?r=i:i<n&&(n=i),e[i]||(e[i]=[]),e[i].push(o),t++},process:function(){for(var t=n;t<=r;t++)for(var i=e[t],o=0;o<i.length;o++)(0,i[o])()},size:function(){return t}}}e.exports=function(e){var t,r=(e=e||{}).reporter,o=n.getOption(e,"async",!0),a=n.getOption(e,"auto",!0);a&&!o&&(r&&r.warn("Invalid options combination. auto=true and async=false is invalid. Setting async=true."),o=!0);var s=i(),l=!1;function u(){for(l=!0;s.size();){var e=s;s=i(),e.process()}l=!1}function c(e){return setTimeout(e,0)}return{add:function(e,r){!l&&a&&o&&0===s.size()&&(t=c(u)),s.add(e,r)},force:function(e){!l&&(void 0===e&&(e=o),t&&(clearTimeout(t),t=null),e?t=c(u):u())}}}},36792:e=>{"use strict";(e.exports={}).getOption=function(e,t,r){var n=e[t];return null==n&&void 0!==r?r:n}},97074:e=>{"use strict";function t(e,t,c){c=c||2;var h,f,m,v,y,_,b,x=t&&t.length,S=x?t[0]*c:e.length,A=r(e,0,S,c,!0),E=[];if(!A||A.next===A.prev)return E;if(x&&(A=function(e,t,o,l){var u,c,h,f,g,m=[];for(u=0,c=t.length;u<c;u++)h=t[u]*l,f=u<c-1?t[u+1]*l:e.length,(g=r(e,h,f,l,!1))===g.next&&(g.steiner=!0),m.push(function(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}(g));for(m.sort(i),u=0;u<m.length;u++)o=function(e,t){var r=function(e,t){var r,n,i,o=t,l=e.x,u=e.y,c=-1/0;do{if(u<=o.y&&u>=o.next.y&&o.next.y!==o.y){var h=o.x+(u-o.y)*(o.next.x-o.x)/(o.next.y-o.y);if(h<=l&&h>c&&(c=h,i=o.x<o.next.x?o:o.next,h===l))return i}o=o.next}while(o!==t);if(!i)return null;var p,f=i,g=i.x,m=i.y,v=1/0;o=i;do l>=o.x&&o.x>=g&&l!==o.x&&a(u<m?l:c,u,g,m,u<m?c:l,u,o.x,o.y)&&(p=Math.abs(u-o.y)/(l-o.x),d(o,e)&&(p<v||p===v&&(o.x>i.x||o.x===i.x&&(r=i,n=o,0>s(r.prev,r,n.prev)&&0>s(n.next,r,r.next))))&&(i=o,v=p)),o=o.next;while(o!==f);return i}(e,t);if(!r)return t;var i=p(r,e);return n(i,i.next),n(r,r.next)}(m[u],o);return o}(e,t,A,c)),e.length>80*c){h=m=e[0],f=v=e[1];for(var T=c;T<S;T+=c)y=e[T],_=e[T+1],y<h&&(h=y),_<f&&(f=_),y>m&&(m=y),_>v&&(v=_);b=0!==(b=Math.max(m-h,v-f))?32767/b:0}return function e(t,r,i,c,h,f,m){if(t){!m&&f&&function(e,t,r,n){var i=e;do 0===i.z&&(i.z=o(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,r,n,i,o,a,s,l,u=1;do{for(r=e,e=null,o=null,a=0;r;){for(a++,n=r,s=0,t=0;t<u&&(s++,n=n.nextZ);t++);for(l=u;s>0||l>0&&n;)0!==s&&(0===l||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,l--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;r=n}o.nextZ=null,u*=2}while(a>1)}(i)}(t,c,h,f);for(var v,y,_=t;t.prev!==t.next;){if(v=t.prev,y=t.next,f?function(e,t,r,n){var i=e.prev,l=e.next;if(s(i,e,l)>=0)return!1;for(var u=i.x,c=e.x,h=l.x,d=i.y,p=e.y,f=l.y,g=u<c?u<h?u:h:c<h?c:h,m=d<p?d<f?d:f:p<f?p:f,v=u>c?u>h?u:h:c>h?c:h,y=d>p?d>f?d:f:p>f?p:f,_=o(g,m,t,r,n),b=o(v,y,t,r,n),x=e.prevZ,S=e.nextZ;x&&x.z>=_&&S&&S.z<=b;){if(x.x>=g&&x.x<=v&&x.y>=m&&x.y<=y&&x!==i&&x!==l&&a(u,d,c,p,h,f,x.x,x.y)&&s(x.prev,x,x.next)>=0||(x=x.prevZ,S.x>=g&&S.x<=v&&S.y>=m&&S.y<=y&&S!==i&&S!==l&&a(u,d,c,p,h,f,S.x,S.y)&&s(S.prev,S,S.next)>=0))return!1;S=S.nextZ}for(;x&&x.z>=_;){if(x.x>=g&&x.x<=v&&x.y>=m&&x.y<=y&&x!==i&&x!==l&&a(u,d,c,p,h,f,x.x,x.y)&&s(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;S&&S.z<=b;){if(S.x>=g&&S.x<=v&&S.y>=m&&S.y<=y&&S!==i&&S!==l&&a(u,d,c,p,h,f,S.x,S.y)&&s(S.prev,S,S.next)>=0)return!1;S=S.nextZ}return!0}(t,c,h,f):function(e){var t=e.prev,r=e.next;if(s(t,e,r)>=0)return!1;for(var n=t.x,i=e.x,o=r.x,l=t.y,u=e.y,c=r.y,h=n<i?n<o?n:o:i<o?i:o,d=l<u?l<c?l:c:u<c?u:c,p=n>i?n>o?n:o:i>o?i:o,f=l>u?l>c?l:c:u>c?u:c,g=r.next;g!==t;){if(g.x>=h&&g.x<=p&&g.y>=d&&g.y<=f&&a(n,l,i,u,o,c,g.x,g.y)&&s(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}(t)){r.push(v.i/i|0),r.push(t.i/i|0),r.push(y.i/i|0),g(t),t=y.next,_=y.next;continue}if((t=y)===_){m?1===m?e(t=function(e,t,r){var i=e;do{var o=i.prev,a=i.next.next;!l(o,a)&&u(o,i,i.next,a)&&d(o,a)&&d(a,o)&&(t.push(o.i/r|0),t.push(i.i/r|0),t.push(a.i/r|0),g(i),g(i.next),i=e=a),i=i.next}while(i!==e);return n(i)}(n(t),r,i),r,i,c,h,f,2):2===m&&function(t,r,i,o,a,c){var h=t;do{for(var f,g,m=h.next.next;m!==h.prev;){if(h.i!==m.i&&(f=h,g=m,f.next.i!==g.i&&f.prev.i!==g.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&u(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(f,g)&&(d(f,g)&&d(g,f)&&function(e,t){var r=e,n=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do r.y>o!=r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;while(r!==e);return n}(f,g)&&(s(f.prev,f,g.prev)||s(f,g.prev,g))||l(f,g)&&s(f.prev,f,f.next)>0&&s(g.prev,g,g.next)>0))){var v=p(h,m);h=n(h,h.next),v=n(v,v.next),e(h,r,i,o,a,c,0),e(v,r,i,o,a,c,0);return}m=m.next}h=h.next}while(h!==t)}(t,r,i,c,h,f):e(n(t),r,i,c,h,f,1);break}}}}(A,E,c,h,f,b,0),E}function r(e,t,r,n,i){var o,a;if(i===v(e,t,r,n)>0)for(o=t;o<r;o+=n)a=f(o,e[o],e[o+1],a);else for(o=r-n;o>=t;o-=n)a=f(o,e[o],e[o+1],a);return a&&l(a,a.next)&&(g(a),a=a.next),a}function n(e,t){if(!e)return e;t||(t=e);var r,n=e;do if(r=!1,!n.steiner&&(l(n,n.next)||0===s(n.prev,n,n.next))){if(g(n),(n=t=n.prev)===n.next)break;r=!0}else n=n.next;while(r||n!==t);return t}function i(e,t){return e.x-t.x}function o(e,t,r,n,i){return(e=((e=((e=((e=((e=(e-r)*i|0)|e<<8)&0xff00ff)|e<<4)&0xf0f0f0f)|e<<2)&0x33333333)|e<<1)&0x55555555)|(t=((t=((t=((t=((t=(t-n)*i|0)|t<<8)&0xff00ff)|t<<4)&0xf0f0f0f)|t<<2)&0x33333333)|t<<1)&0x55555555)<<1}function a(e,t,r,n,i,o,a,s){return(i-a)*(t-s)>=(e-a)*(o-s)&&(e-a)*(n-s)>=(r-a)*(t-s)&&(r-a)*(o-s)>=(i-a)*(n-s)}function s(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function l(e,t){return e.x===t.x&&e.y===t.y}function u(e,t,r,n){var i=h(s(e,t,r)),o=h(s(e,t,n)),a=h(s(r,n,e)),l=h(s(r,n,t));return!!(i!==o&&a!==l||0===i&&c(e,r,t)||0===o&&c(e,n,t)||0===a&&c(r,e,n)||0===l&&c(r,t,n))}function c(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function h(e){return e>0?1:e<0?-1:0}function d(e,t){return 0>s(e.prev,e,e.next)?s(e,t,e.next)>=0&&s(e,e.prev,t)>=0:0>s(e,t,e.prev)||0>s(e,e.next,t)}function p(e,t){var r=new m(e.i,e.x,e.y),n=new m(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function f(e,t,r,n){var i=new m(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function g(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function m(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function v(e,t,r,n){for(var i=0,o=t,a=r-n;o<r;o+=n)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}e.exports=t,e.exports.default=t,t.deviation=function(e,t,r,n){var i=t&&t.length,o=i?t[0]*r:e.length,a=Math.abs(v(e,0,o,r));if(i)for(var s=0,l=t.length;s<l;s++){var u=t[s]*r,c=s<l-1?t[s+1]*r:e.length;a-=Math.abs(v(e,u,c,r))}var h=0;for(s=0;s<n.length;s+=3){var d=n[s]*r,p=n[s+1]*r,f=n[s+2]*r;h+=Math.abs((e[d]-e[f])*(e[p+1]-e[d+1])-(e[d]-e[p])*(e[f+1]-e[d+1]))}return 0===a&&0===h?0:Math.abs((h-a)/a)},t.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,i=0;i<e.length;i++){for(var o=0;o<e[i].length;o++)for(var a=0;a<t;a++)r.vertices.push(e[i][o][a]);i>0&&(n+=e[i-1].length,r.holes.push(n))}return r}},99514:e=>{"use strict";var t=e.exports={};t.isIE=function(e){var t;return(-1!==(t=navigator.userAgent.toLowerCase()).indexOf("msie")||-1!==t.indexOf("trident")||-1!==t.indexOf(" edge/"))&&(!e||e===function(){var e,t=3,r=document.createElement("div"),n=r.getElementsByTagName("i");do r.innerHTML="<!--[if gt IE "+ ++t+"]><i></i><![endif]-->";while(n[0]);return t>4?t:e}())},t.isLegacyOpera=function(){return!!window.opera}},74103:e=>{"use strict";(e.exports={}).forEach=function(e,t){for(var r=0;r<e.length;r++){var n=t(e[r]);if(n)return n}}},24938:(e,t,r)=>{"use strict";var n=r(99514);e.exports=function(e){var t=(e=e||{}).reporter,r=e.batchProcessor,i=e.stateHandler.getState;if(!t)throw Error("Missing required dependency: reporter.");return{makeDetectable:function(o,a,s){s||(s=a,a=o,o=null),(o=o||{}).debug,n.isIE(8)?s(a):function(a,s){var l,u,c=(l=["display: block","position: absolute","top: 0","left: 0","width: 100%","height: 100%","border: none","padding: 0","margin: 0","opacity: 0","z-index: -1000","pointer-events: none"],u=e.important?" !important; ":"; ",(l.join(u)+u).trim()),h=!1,d=window.getComputedStyle(a),p=a.offsetWidth,f=a.offsetHeight;function g(){function e(){if("static"===d.position){a.style.setProperty("position","relative",o.important?"important":"");var e=function(e,t,r,n){var i=r[n];"auto"!==i&&"0"!==i.replace(/[^-\d\.]/g,"")&&(e.warn("An element that is positioned static has style."+n+"="+i+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+n+" will be set to 0. Element: ",t),t.style.setProperty(n,"0",o.important?"important":""))};e(t,a,d,"top"),e(t,a,d,"right"),e(t,a,d,"bottom"),e(t,a,d,"left")}}""!==d.position&&(e(d),h=!0);var r=document.createElement("object");r.style.cssText=c,r.tabIndex=-1,r.type="text/html",r.setAttribute("aria-hidden","true"),r.onload=function(){h||e(),function e(t,r){if(!t.contentDocument){var n=i(t);n.checkForObjectDocumentTimeoutId&&window.clearTimeout(n.checkForObjectDocumentTimeoutId),n.checkForObjectDocumentTimeoutId=setTimeout(function(){n.checkForObjectDocumentTimeoutId=0,e(t,r)},100);return}r(t.contentDocument)}(this,function(e){s(a)})},n.isIE()||(r.data="about:blank"),i(a)&&(a.appendChild(r),i(a).object=r,n.isIE()&&(r.data="about:blank"))}i(a).startSize={width:p,height:f},r?r.add(g):g()}(a,s)},addListener:function(e,t){function r(){t(e)}if(n.isIE(8))i(e).object={proxy:r},e.attachEvent("onresize",r);else{var o=i(e).object;if(!o)throw Error("Element is not detectable by this strategy.");o.contentDocument.defaultView.addEventListener("resize",r)}},uninstall:function(e){if(i(e)){var t=i(e).object;t&&(n.isIE(8)?e.detachEvent("onresize",t.proxy):e.removeChild(t),i(e).checkForObjectDocumentTimeoutId&&window.clearTimeout(i(e).checkForObjectDocumentTimeoutId),delete i(e).object)}}}}},75664:(e,t,r)=>{"use strict";var n=r(74103).forEach;e.exports=function(e){var t,r,i,o,a=(e=e||{}).reporter,s=e.batchProcessor,l=e.stateHandler.getState;e.stateHandler.hasState;var u=e.idHandler;if(!s)throw Error("Missing required dependency: batchProcessor");if(!a)throw Error("Missing required dependency: reporter.");var c=((t=document.createElement("div")).style.cssText=p(["position: absolute","width: 1000px","height: 1000px","visibility: hidden","margin: 0","padding: 0"]),(r=document.createElement("div")).style.cssText=p(["position: absolute","width: 500px","height: 500px","overflow: scroll","visibility: none","top: -1500px","left: -1500px","visibility: hidden","margin: 0","padding: 0"]),r.appendChild(t),document.body.insertBefore(r,document.body.firstChild),i=500-r.clientWidth,o=500-r.clientHeight,document.body.removeChild(r),{width:i,height:o}),h="erd_scroll_detection_container";function d(e){!function(e,t,r){if(!e.getElementById(t)){var n,i,o,a=r+"_animation",s="/* Created by the element-resize-detector library. */\n";s+="."+r+" > div::-webkit-scrollbar { "+p(["display: none"])+" }\n\n"+("."+r+"_animation_active { ")+p(["-webkit-animation-duration: 0.1s","animation-duration: 0.1s","-webkit-animation-name: "+a,"animation-name: "+a])+" }\n@-webkit-keyframes "+a+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }\n@keyframes "+a+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }",n=s,i=i||function(t){e.head.appendChild(t)},(o=e.createElement("style")).innerHTML=n,o.id=t,i(o)}}(e,"erd_scroll_detection_scrollbar_style",h)}function p(t){var r=e.important?" !important; ":"; ";return(t.join(r)+r).trim()}function f(e,t,r){if(e.addEventListener)e.addEventListener(t,r);else{if(!e.attachEvent)return a.error("[scroll] Don't know how to add event listeners.");e.attachEvent("on"+t,r)}}function g(e,t,r){if(e.removeEventListener)e.removeEventListener(t,r);else{if(!e.detachEvent)return a.error("[scroll] Don't know how to remove event listeners.");e.detachEvent("on"+t,r)}}function m(e){return l(e).container.childNodes[0].childNodes[0].childNodes[0]}function v(e){return l(e).container.childNodes[0].childNodes[0].childNodes[1]}return d(window.document),{makeDetectable:function(e,t,r){var i,o,d;function g(){if(e.debug){var r=Array.prototype.slice.call(arguments);if(r.unshift(u.get(t),"Scroll: "),a.log.apply)a.log.apply(null,r);else for(var n=0;n<r.length;n++)a.log(r[n])}}function y(e){var t=l(e).container.childNodes[0],r=window.getComputedStyle(t);return!r.width||-1===r.width.indexOf("px")}function _(){var e=window.getComputedStyle(t),r={};return r.position=e.position,r.width=t.offsetWidth,r.height=t.offsetHeight,r.top=e.top,r.right=e.right,r.bottom=e.bottom,r.left=e.left,r.widthCSS=e.width,r.heightCSS=e.height,r}function b(){if(g("storeStyle invoked."),!l(t)){g("Aborting because element has been uninstalled");return}var e=_();l(t).style=e}function x(e,t,r){l(e).lastWidth=t,l(e).lastHeight=r}function S(){return 2*c.width+1}function A(){return 2*c.height+1}function E(e,t,r){var n=m(e),i=v(e),o=t+10+S(),a=r+10+A(),s=2*t+S(),l=2*r+A();n.scrollLeft=o,n.scrollTop=a,i.scrollLeft=s,i.scrollTop=l}function T(){var e=l(t).container;if(!e){(e=document.createElement("div")).className=h,e.style.cssText=p(["visibility: hidden","display: inline","width: 0px","height: 0px","z-index: -1","overflow: hidden","margin: 0","padding: 0"]),l(t).container=e,r=e,r.className+=" "+h+"_animation_active",t.appendChild(e);var r,n=function(){l(t).onRendered&&l(t).onRendered()};f(e,"animationstart",n),l(t).onAnimationStart=n}return e}function C(){if(g("Injecting elements"),!l(t)){g("Aborting because element has been uninstalled");return}!function(){var r=l(t).style;if("static"===r.position){t.style.setProperty("position","relative",e.important?"important":"");var n=function(e,t,r,n){var i=r[n];"auto"!==i&&"0"!==i.replace(/[^-\d\.]/g,"")&&(e.warn("An element that is positioned static has style."+n+"="+i+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+n+" will be set to 0. Element: ",t),t.style[n]=0)};n(a,t,r,"top"),n(a,t,r,"right"),n(a,t,r,"bottom"),n(a,t,r,"left")}}();var r,n,i,o,s=l(t).container;s||(s=T());var u=c.width,d=c.height,m=p(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden","width: 100%","height: 100%","left: 0px","top: 0px"]),v=p(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden"].concat((r=-(1+u),n=-(1+d),i=-d,["left: "+(r=r?r+"px":"0"),"top: "+(n=n?n+"px":"0"),"right: "+(o=(o=-u)?o+"px":"0"),"bottom: "+(i=i?i+"px":"0")]))),y=p(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),_=p(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),b=p(["position: absolute","left: 0","top: 0"]),x=p(["position: absolute","width: 200%","height: 200%"]),S=document.createElement("div"),A=document.createElement("div"),E=document.createElement("div"),C=document.createElement("div"),w=document.createElement("div"),L=document.createElement("div");function M(){var e=l(t);e&&e.onExpand?e.onExpand():g("Aborting expand scroll handler: element has been uninstalled")}function O(){var e=l(t);e&&e.onShrink?e.onShrink():g("Aborting shrink scroll handler: element has been uninstalled")}S.dir="ltr",S.style.cssText=m,S.className=h,A.className=h,A.style.cssText=v,E.style.cssText=y,C.style.cssText=b,w.style.cssText=_,L.style.cssText=x,E.appendChild(C),w.appendChild(L),A.appendChild(E),A.appendChild(w),S.appendChild(A),s.appendChild(S),f(E,"scroll",M),f(w,"scroll",O),l(t).onExpandScroll=M,l(t).onShrinkScroll=O}function w(){function r(t,r,n){var i=m(t).childNodes[0],o=r+10+S(),a=n+10+A();i.style.setProperty("width",o+"px",e.important?"important":""),i.style.setProperty("height",a+"px",e.important?"important":"")}function i(n){var i=t.offsetWidth,c=t.offsetHeight,h=i!==l(t).lastWidth||c!==l(t).lastHeight;g("Storing current size",i,c),x(t,i,c),s.add(0,function(){if(h){if(!l(t)){g("Aborting because element has been uninstalled");return}if(!o()){g("Aborting because element container has not been initialized");return}if(e.debug){var n=t.offsetWidth,s=t.offsetHeight;(n!==i||s!==c)&&a.warn(u.get(t),"Scroll: Size changed before updating detector elements.")}r(t,i,c)}}),s.add(1,function(){if(!l(t)){g("Aborting because element has been uninstalled");return}if(!o()){g("Aborting because element container has not been initialized");return}E(t,i,c)}),h&&n&&s.add(2,function(){if(!l(t)){g("Aborting because element has been uninstalled");return}if(!o()){g("Aborting because element container has not been initialized");return}n()})}function o(){return!!l(t).container}function c(){g("notifyListenersIfNeeded invoked");var e=l(t);return void 0===l(t).lastNotifiedWidth&&e.lastWidth===e.startSize.width&&e.lastHeight===e.startSize.height?g("Not notifying: Size is the same as the start size, and there has been no notification yet."):e.lastWidth===e.lastNotifiedWidth&&e.lastHeight===e.lastNotifiedHeight?g("Not notifying: Size already notified"):void(g("Current size not notified, notifying..."),e.lastNotifiedWidth=e.lastWidth,e.lastNotifiedHeight=e.lastHeight,n(l(t).listeners,function(e){e(t)}))}function h(){if(g("Scroll detected."),y(t)){g("Scroll event fired while unrendered. Ignoring...");return}i(c)}if(g("registerListenersAndPositionElements invoked."),!l(t)){g("Aborting because element has been uninstalled");return}l(t).onRendered=function(){if(g("startanimation triggered."),y(t)){g("Ignoring since element is still unrendered...");return}g("Element rendered.");var e=m(t),r=v(t);(0===e.scrollLeft||0===e.scrollTop||0===r.scrollLeft||0===r.scrollTop)&&(g("Scrollbars out of sync. Updating detector elements..."),i(c))},l(t).onExpand=h,l(t).onShrink=h;var d=l(t).style;r(t,d.width,d.height)}function L(){if(g("finalizeDomMutation invoked."),!l(t)){g("Aborting because element has been uninstalled");return}var e=l(t).style;x(t,e.width,e.height),E(t,e.width,e.height)}function M(){r(t)}function O(){var e;g("Installing..."),l(t).listeners=[],e=_(),l(t).startSize={width:e.width,height:e.height},g("Element start size",l(t).startSize),s.add(0,b),s.add(1,C),s.add(2,w),s.add(3,L),s.add(4,M)}r||(r=t,t=e,e=null),e=e||{},(g("Making detectable..."),(d=(o=i=t).getRootNode&&o.getRootNode().contains(o),(o===o.ownerDocument.body||o.ownerDocument.body.contains(o)||d)&&null!==window.getComputedStyle(i))?1:0)?O():(g("Element is detached"),T(),g("Waiting until element is attached..."),l(t).onRendered=function(){g("Element is now attached"),O()})},addListener:function(e,t){if(!l(e).listeners.push)throw Error("Cannot add listener to an element that is not detectable.");l(e).listeners.push(t)},uninstall:function(e){var t=l(e);t&&(t.onExpandScroll&&g(m(e),"scroll",t.onExpandScroll),t.onShrinkScroll&&g(v(e),"scroll",t.onShrinkScroll),t.onAnimationStart&&g(t.container,"animationstart",t.onAnimationStart),t.container&&e.removeChild(t.container))},initDocument:d}}},82809:(e,t,r)=>{"use strict";var n=r(74103).forEach,i=r(59589),o=r(24186),a=r(98750),s=r(77263),l=r(14682),u=r(99514),c=r(4576),h=r(49457),d=r(24938),p=r(75664);function f(e){return Array.isArray(e)||void 0!==e.length}function g(e){if(Array.isArray(e))return e;var t=[];return n(e,function(e){t.push(e)}),t}function m(e){return e&&1===e.nodeType}function v(e,t,r){var n=e[t];return null==n&&void 0!==r?r:n}e.exports=function(e){if((e=e||{}).idHandler)t={get:function(t){return e.idHandler.get(t,!0)},set:e.idHandler.set};else{var t,r;t=s({idGenerator:a(),stateHandler:h})}var y=e.reporter;y||(y=l(!1===y));var _=v(e,"batchProcessor",c({reporter:y})),b={};b.callOnAdd=!!v(e,"callOnAdd",!0),b.debug=!!v(e,"debug",!1);var x=o(t),S=i({stateHandler:h}),A=v(e,"strategy","object"),E=v(e,"important",!1),T={reporter:y,batchProcessor:_,stateHandler:h,idHandler:t,important:E};if("scroll"===A&&(u.isLegacyOpera()?(y.warn("Scroll strategy is not supported on legacy Opera. Changing to object strategy."),A="object"):u.isIE(9)&&(y.warn("Scroll strategy is not supported on IE9. Changing to object strategy."),A="object")),"scroll"===A)r=p(T);else if("object"===A)r=d(T);else throw Error("Invalid strategy name: "+A);var C={};return{listenTo:function(e,i,o){function a(e){n(x.get(e),function(t){t(e)})}function s(e,t,r){x.add(t,r),e&&r(t)}if(o||(o=i,i=e,e={}),!i)throw Error("At least one element required.");if(!o)throw Error("Listener required.");if(m(i))i=[i];else{if(!f(i))return y.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");i=g(i)}var l=0,u=v(e,"callOnAdd",b.callOnAdd),c=v(e,"onReady",function(){}),d=v(e,"debug",b.debug);n(i,function(e){h.getState(e)||(h.initState(e),t.set(e));var p=t.get(e);if(d&&y.log("Attaching listener to element",p,e),!S.isDetectable(e)){if(d&&y.log(p,"Not detectable."),S.isBusy(e)){d&&y.log(p,"System busy making it detectable"),s(u,e,o),C[p]=C[p]||[],C[p].push(function(){++l===i.length&&c()});return}return d&&y.log(p,"Making detectable..."),S.markBusy(e,!0),r.makeDetectable({debug:d,important:E},e,function(e){if(d&&y.log(p,"onElementDetectable"),h.getState(e)){S.markAsDetectable(e),S.markBusy(e,!1),r.addListener(e,a),s(u,e,o);var t=h.getState(e);if(t&&t.startSize){var f=e.offsetWidth,g=e.offsetHeight;(t.startSize.width!==f||t.startSize.height!==g)&&a(e)}C[p]&&n(C[p],function(e){e()})}else d&&y.log(p,"Element uninstalled before being detectable.");delete C[p],++l===i.length&&c()})}d&&y.log(p,"Already detecable, adding listener."),s(u,e,o),l++}),l===i.length&&c()},removeListener:x.removeListener,removeAllListeners:x.removeAllListeners,uninstall:function(e){if(!e)return y.error("At least one element is required.");if(m(e))e=[e];else{if(!f(e))return y.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");e=g(e)}n(e,function(e){x.removeAllListeners(e),r.uninstall(e),h.cleanState(e)})},initDocument:function(e){r.initDocument&&r.initDocument(e)}}}},59589:e=>{"use strict";e.exports=function(e){var t=e.stateHandler.getState;return{isDetectable:function(e){var r=t(e);return r&&!!r.isDetectable},markAsDetectable:function(e){t(e).isDetectable=!0},isBusy:function(e){return!!t(e).busy},markBusy:function(e,r){t(e).busy=!!r}}}},98750:e=>{"use strict";e.exports=function(){var e=1;return{generate:function(){return e++}}}},77263:e=>{"use strict";e.exports=function(e){var t=e.idGenerator,r=e.stateHandler.getState;return{get:function(e){var t=r(e);return t&&void 0!==t.id?t.id:null},set:function(e){var n=r(e);if(!n)throw Error("setId required the element to have a resize detection state.");var i=t.generate();return n.id=i,i}}}},24186:e=>{"use strict";e.exports=function(e){var t={};function r(r){var n=e.get(r);return void 0===n?[]:t[n]||[]}return{get:r,add:function(r,n){var i=e.get(r);t[i]||(t[i]=[]),t[i].push(n)},removeListener:function(e,t){for(var n=r(e),i=0,o=n.length;i<o;++i)if(n[i]===t){n.splice(i,1);break}},removeAllListeners:function(e){var t=r(e);t&&(t.length=0)}}}},14682:e=>{"use strict";e.exports=function(e){function t(){}var r={log:t,warn:t,error:t};if(!e&&window.console){var n=function(e,t){e[t]=function(){var e=console[t];if(e.apply)e.apply(console,arguments);else for(var r=0;r<arguments.length;r++)e(arguments[r])}};n(r,"log"),n(r,"warn"),n(r,"error")}return r}},49457:e=>{"use strict";var t="_erd";e.exports={initState:function(e){return e[t]={},e[t]},getState:function(e){return e[t]},cleanState:function(e){delete e[t]}}},53982:e=>{"use strict";var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,n,o,a){if("function"!=typeof n)throw TypeError("The listener must be a function");var s=new i(n,o||e,a),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1)),s.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,a=Array(o);i<o;i++)a[i]=n[i].fn;return a},s.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},s.prototype.emit=function(e,t,n,i,o,a){var s=r?r+e:e;if(!this._events[s])return!1;var l,u,c=this._events[s],h=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),h){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,i),!0;case 5:return c.fn.call(c.context,t,n,i,o),!0;case 6:return c.fn.call(c.context,t,n,i,o,a),!0}for(u=1,l=Array(h-1);u<h;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var d,p=c.length;for(u=0;u<p;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),h){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,n);break;case 4:c[u].fn.call(c[u].context,t,n,i);break;default:if(!l)for(d=1,l=Array(h-1);d<h;d++)l[d-1]=arguments[d];c[u].fn.apply(c[u].context,l)}}return!0},s.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},s.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},s.prototype.removeListener=function(e,t,n,i){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||i&&!s.once||n&&s.context!==n||a(this,o);else{for(var l=0,u=[],c=s.length;l<c;l++)(s[l].fn!==t||i&&!s[l].once||n&&s[l].context!==n)&&u.push(s[l]);u.length?this._events[o]=1===u.length?u[0]:u:a(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&a(this,t)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s},83029:e=>{"use strict";var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,n,o,a){if("function"!=typeof n)throw TypeError("The listener must be a function");var s=new i(n,o||e,a),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1)),s.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,a=Array(o);i<o;i++)a[i]=n[i].fn;return a},s.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},s.prototype.emit=function(e,t,n,i,o,a){var s=r?r+e:e;if(!this._events[s])return!1;var l,u,c=this._events[s],h=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),h){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,i),!0;case 5:return c.fn.call(c.context,t,n,i,o),!0;case 6:return c.fn.call(c.context,t,n,i,o,a),!0}for(u=1,l=Array(h-1);u<h;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var d,p=c.length;for(u=0;u<p;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),h){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,n);break;case 4:c[u].fn.call(c[u].context,t,n,i);break;default:if(!l)for(d=1,l=Array(h-1);d<h;d++)l[d-1]=arguments[d];c[u].fn.apply(c[u].context,l)}}return!0},s.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},s.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},s.prototype.removeListener=function(e,t,n,i){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||i&&!s.once||n&&s.context!==n||a(this,o);else{for(var l=0,u=[],c=s.length;l<c;l++)(s[l].fn!==t||i&&!s[l].once||n&&s[l].context!==n)&&u.push(s[l]);u.length?this._events[o]=1===u.length?u[0]:u:a(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&a(this,t)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s},98385:(e,t,r)=>{var n;!function(i,o,a,s){"use strict";var l,u=["","webkit","Moz","MS","ms","o"],c=o.createElement("div"),h=Math.round,d=Math.abs,p=Date.now;function f(e,t,r){return setTimeout(x(e,r),t)}function g(e,t,r){return!!Array.isArray(e)&&(m(e,r[t],r),!0)}function m(e,t,r){var n;if(e){if(e.forEach)e.forEach(t,r);else if(e.length!==s)for(n=0;n<e.length;)t.call(r,e[n],n,e),n++;else for(n in e)e.hasOwnProperty(n)&&t.call(r,e[n],n,e)}}function v(e,t,r){var n="DEPRECATED METHOD: "+t+"\n"+r+" AT \n";return function(){var t=Error("get-stack-trace"),r=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=i.console&&(i.console.warn||i.console.log);return o&&o.call(i.console,n,r),e.apply(this,arguments)}}l="function"!=typeof Object.assign?function(e){if(null==e)throw TypeError("Cannot convert undefined or null to object");for(var t=Object(e),r=1;r<arguments.length;r++){var n=arguments[r];if(null!=n)for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])}return t}:Object.assign;var y=v(function(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;)(!r||r&&e[n[i]]===s)&&(e[n[i]]=t[n[i]]),i++;return e},"extend","Use `assign`."),_=v(function(e,t){return y(e,t,!0)},"merge","Use `assign`.");function b(e,t,r){var n,i=t.prototype;(n=e.prototype=Object.create(i)).constructor=e,n._super=i,r&&l(n,r)}function x(e,t){return function(){return e.apply(t,arguments)}}function S(e,t){return"function"==typeof e?e.apply(t&&t[0]||s,t):e}function A(e,t,r){m(w(t),function(t){e.addEventListener(t,r,!1)})}function E(e,t,r){m(w(t),function(t){e.removeEventListener(t,r,!1)})}function T(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function C(e,t){return e.indexOf(t)>-1}function w(e){return e.trim().split(/\s+/g)}function L(e,t,r){if(e.indexOf&&!r)return e.indexOf(t);for(var n=0;n<e.length;){if(r&&e[n][r]==t||!r&&e[n]===t)return n;n++}return -1}function M(e){return Array.prototype.slice.call(e,0)}function O(e,t,r){for(var n=[],i=[],o=0;o<e.length;){var a=t?e[o][t]:e[o];0>L(i,a)&&n.push(e[o]),i[o]=a,o++}return r&&(n=t?n.sort(function(e,r){return e[t]>r[t]}):n.sort()),n}function I(e,t){for(var r,n,i=t[0].toUpperCase()+t.slice(1),o=0;o<u.length;){if((n=(r=u[o])?r+i:t)in e)return n;o++}return s}var P=1;function R(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||i}var k="ontouchstart"in i,N=I(i,"PointerEvent")!==s,D=k&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),U="touch",z="mouse",B=["x","y"],F=["clientX","clientY"];function j(e,t){var r=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){S(e.options.enable,[e])&&r.handler(t)},this.init()}function V(e,t,r){var n,i,o,a,l,u,c,h,f,g,m,v,y,_,b,x=r.pointers.length,S=r.changedPointers.length,A=1&t&&x-S==0,E=12&t&&x-S==0;r.isFirst=!!A,r.isFinal=!!E,A&&(e.session={}),r.eventType=t,n=e.session,o=(i=r.pointers).length,n.firstInput||(n.firstInput=H(r)),o>1&&!n.firstMultiple?n.firstMultiple=H(r):1===o&&(n.firstMultiple=!1),a=n.firstInput,u=(l=n.firstMultiple)?l.center:a.center,c=r.center=G(i),r.timeStamp=p(),r.deltaTime=r.timeStamp-a.timeStamp,r.angle=Z(u,c),r.distance=$(u,c),h=r.center,f=n.offsetDelta||{},g=n.prevDelta||{},m=n.prevInput||{},(1===r.eventType||4===m.eventType)&&(g=n.prevDelta={x:m.deltaX||0,y:m.deltaY||0},f=n.offsetDelta={x:h.x,y:h.y}),r.deltaX=g.x+(h.x-f.x),r.deltaY=g.y+(h.y-f.y),r.offsetDirection=X(r.deltaX,r.deltaY),v=W(r.deltaTime,r.deltaX,r.deltaY),r.overallVelocityX=v.x,r.overallVelocityY=v.y,r.overallVelocity=d(v.x)>d(v.y)?v.x:v.y,r.scale=l?(y=l.pointers,$(i[0],i[1],F)/$(y[0],y[1],F)):1,r.rotation=l?(_=l.pointers,Z(i[1],i[0],F)+Z(_[1],_[0],F)):0,r.maxPointers=n.prevInput?r.pointers.length>n.prevInput.maxPointers?r.pointers.length:n.prevInput.maxPointers:r.pointers.length,function(e,t){var r,n,i,o,a=e.lastInterval||t,l=t.timeStamp-a.timeStamp;if(8!=t.eventType&&(l>25||a.velocity===s)){var u=t.deltaX-a.deltaX,c=t.deltaY-a.deltaY,h=W(l,u,c);n=h.x,i=h.y,r=d(h.x)>d(h.y)?h.x:h.y,o=X(u,c),e.lastInterval=t}else r=a.velocity,n=a.velocityX,i=a.velocityY,o=a.direction;t.velocity=r,t.velocityX=n,t.velocityY=i,t.direction=o}(n,r),b=e.element,T(r.srcEvent.target,b)&&(b=r.srcEvent.target),r.target=b,e.emit("hammer.input",r),e.recognize(r),e.session.prevInput=r}function H(e){for(var t=[],r=0;r<e.pointers.length;)t[r]={clientX:h(e.pointers[r].clientX),clientY:h(e.pointers[r].clientY)},r++;return{timeStamp:p(),pointers:t,center:G(t),deltaX:e.deltaX,deltaY:e.deltaY}}function G(e){var t=e.length;if(1===t)return{x:h(e[0].clientX),y:h(e[0].clientY)};for(var r=0,n=0,i=0;i<t;)r+=e[i].clientX,n+=e[i].clientY,i++;return{x:h(r/t),y:h(n/t)}}function W(e,t,r){return{x:t/e||0,y:r/e||0}}function X(e,t){return e===t?1:d(e)>=d(t)?e<0?2:4:t<0?8:16}function $(e,t,r){r||(r=B);var n=t[r[0]]-e[r[0]],i=t[r[1]]-e[r[1]];return Math.sqrt(n*n+i*i)}function Z(e,t,r){r||(r=B);var n=t[r[0]]-e[r[0]];return 180*Math.atan2(t[r[1]]-e[r[1]],n)/Math.PI}j.prototype={handler:function(){},init:function(){this.evEl&&A(this.element,this.evEl,this.domHandler),this.evTarget&&A(this.target,this.evTarget,this.domHandler),this.evWin&&A(R(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&E(this.element,this.evEl,this.domHandler),this.evTarget&&E(this.target,this.evTarget,this.domHandler),this.evWin&&E(R(this.element),this.evWin,this.domHandler)}};var Y={mousedown:1,mousemove:2,mouseup:4};function q(){this.evEl="mousedown",this.evWin="mousemove mouseup",this.pressed=!1,j.apply(this,arguments)}b(q,j,{handler:function(e){var t=Y[e.type];1&t&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:z,srcEvent:e}))}});var K={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},Q={2:U,3:"pen",4:z,5:"kinect"},J="pointerdown",ee="pointermove pointerup pointercancel";function et(){this.evEl=J,this.evWin=ee,j.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&!i.PointerEvent&&(J="MSPointerDown",ee="MSPointerMove MSPointerUp MSPointerCancel"),b(et,j,{handler:function(e){var t=this.store,r=!1,n=K[e.type.toLowerCase().replace("ms","")],i=Q[e.pointerType]||e.pointerType,o=i==U,a=L(t,e.pointerId,"pointerId");1&n&&(0===e.button||o)?a<0&&(t.push(e),a=t.length-1):12&n&&(r=!0),!(a<0)&&(t[a]=e,this.callback(this.manager,n,{pointers:t,changedPointers:[e],pointerType:i,srcEvent:e}),r&&t.splice(a,1))}});var er={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function en(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,j.apply(this,arguments)}function ei(e,t){var r=M(e.touches),n=M(e.changedTouches);return 12&t&&(r=O(r.concat(n),"identifier",!0)),[r,n]}b(en,j,{handler:function(e){var t=er[e.type];if(1===t&&(this.started=!0),this.started){var r=ei.call(this,e,t);12&t&&r[0].length-r[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:r[0],changedPointers:r[1],pointerType:U,srcEvent:e})}}});var eo={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function ea(){this.evTarget="touchstart touchmove touchend touchcancel",this.targetIds={},j.apply(this,arguments)}function es(e,t){var r=M(e.touches),n=this.targetIds;if(3&t&&1===r.length)return n[r[0].identifier]=!0,[r,r];var i,o,a=M(e.changedTouches),s=[],l=this.target;if(o=r.filter(function(e){return T(e.target,l)}),1===t)for(i=0;i<o.length;)n[o[i].identifier]=!0,i++;for(i=0;i<a.length;)n[a[i].identifier]&&s.push(a[i]),12&t&&delete n[a[i].identifier],i++;if(s.length)return[O(o.concat(s),"identifier",!0),s]}function el(){j.apply(this,arguments);var e=x(this.handler,this);this.touch=new ea(this.manager,e),this.mouse=new q(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function eu(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,ec.call(this,t)):12&e&&ec.call(this,t)}function ec(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var r={x:t.clientX,y:t.clientY};this.lastTouches.push(r);var n=this.lastTouches;setTimeout(function(){var e=n.indexOf(r);e>-1&&n.splice(e,1)},2500)}}function eh(e){for(var t=e.srcEvent.clientX,r=e.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var i=this.lastTouches[n],o=Math.abs(t-i.x),a=Math.abs(r-i.y);if(o<=25&&a<=25)return!0}return!1}b(ea,j,{handler:function(e){var t=eo[e.type],r=es.call(this,e,t);r&&this.callback(this.manager,t,{pointers:r[0],changedPointers:r[1],pointerType:U,srcEvent:e})}}),b(el,j,{handler:function(e,t,r){var n=r.pointerType==U,i=r.pointerType==z;if(!i||!r.sourceCapabilities||!r.sourceCapabilities.firesTouchEvents){if(n)eu.call(this,t,r);else if(i&&eh.call(this,r))return;this.callback(e,t,r)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ed=I(c.style,"touchAction"),ep=s!==ed,ef="compute",eg="auto",em="manipulation",ev="none",ey="pan-x",e_="pan-y",eb=function(){if(!ep)return!1;var e={},t=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(r){e[r]=!t||i.CSS.supports("touch-action",r)}),e}();function ex(e,t){this.manager=e,this.set(t)}function eS(e){var t;this.options=l({},this.defaults,e||{}),this.id=P++,this.manager=null,this.options.enable=s===(t=this.options.enable)||t,this.state=1,this.simultaneous={},this.requireFail=[]}function eA(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function eE(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function eT(e,t){var r=t.manager;return r?r.get(e):e}function eC(){eS.apply(this,arguments)}function ew(){eC.apply(this,arguments),this.pX=null,this.pY=null}function eL(){eC.apply(this,arguments)}function eM(){eS.apply(this,arguments),this._timer=null,this._input=null}function eO(){eC.apply(this,arguments)}function eI(){eC.apply(this,arguments)}function eP(){eS.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function eR(e,t){var r,n;return(t=t||{}).recognizers=(r=t.recognizers,n=eR.defaults.preset,s===r?n:r),new ek(e,t)}function ek(e,t){var r;this.options=l({},eR.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new((r=this.options.inputClass)?r:N?et:D?ea:k?el:q)(this,V),this.touchAction=new ex(this,this.options.touchAction),eN(this,!0),m(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function eN(e,t){var r,n=e.element;n.style&&(m(e.options.cssProps,function(i,o){r=I(n.style,o),t?(e.oldCssProps[r]=n.style[r],n.style[r]=i):n.style[r]=e.oldCssProps[r]||""}),t||(e.oldCssProps={}))}ex.prototype={set:function(e){e==ef&&(e=this.compute()),ep&&this.manager.element.style&&eb[e]&&(this.manager.element.style[ed]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return m(this.manager.recognizers,function(t){S(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),function(e){if(C(e,ev))return ev;var t=C(e,ey),r=C(e,e_);return t&&r?ev:t||r?t?ey:e_:C(e,em)?em:eg}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,r=e.offsetDirection;if(this.manager.session.prevented){t.preventDefault();return}var n=this.actions,i=C(n,ev)&&!eb[ev],o=C(n,e_)&&!eb[e_],a=C(n,ey)&&!eb[ey];if(i){var s=1===e.pointers.length,l=e.distance<2,u=e.deltaTime<250;if(s&&l&&u)return}if((!a||!o)&&(i||o&&6&r||a&&24&r))return this.preventSrc(t)},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}},eS.prototype={defaults:{},set:function(e){return l(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(g(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=eT(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return g(e,"dropRecognizeWith",this)||(e=eT(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(g(e,"requireFailure",this))return this;var t=this.requireFail;return -1===L(t,e=eT(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(g(e,"dropRequireFailure",this))return this;e=eT(e,this);var t=L(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,r=this.state;function n(r){t.manager.emit(r,e)}r<8&&n(t.options.event+eA(r)),n(t.options.event),e.additionalEvent&&n(e.additionalEvent),r>=8&&n(t.options.event+eA(r))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=32},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){var t=l({},e);if(!S(this.options.enable,[this,t])){this.reset(),this.state=32;return}56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},b(eC,eS,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,r=e.eventType,n=6&t,i=this.attrTest(e);return n&&(8&r||!i)?16|t:n||i?4&r?8|t:2&t?4|t:2:32}}),b(ew,eC,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var e=this.options.direction,t=[];return 6&e&&t.push(e_),24&e&&t.push(ey),t},directionTest:function(e){var t=this.options,r=!0,n=e.distance,i=e.direction,o=e.deltaX,a=e.deltaY;return i&t.direction||(6&t.direction?(i=0===o?1:o<0?2:4,r=o!=this.pX,n=Math.abs(e.deltaX)):(i=0===a?1:a<0?8:16,r=a!=this.pY,n=Math.abs(e.deltaY))),e.direction=i,r&&n>t.threshold&&i&t.direction},attrTest:function(e){return eC.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=eE(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),b(eL,eC,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ev]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),b(eM,eS,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[eg]},process:function(e){var t=this.options,r=e.pointers.length===t.pointers,n=e.distance<t.threshold,i=e.deltaTime>t.time;if(this._input=e,n&&r&&(!(12&e.eventType)||i)){if(1&e.eventType)this.reset(),this._timer=f(function(){this.state=8,this.tryEmit()},t.time,this);else if(4&e.eventType)return 8}else this.reset();return 32},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&4&e.eventType?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}}),b(eO,eC,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ev]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),b(eI,eC,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return ew.prototype.getTouchAction.call(this)},attrTest:function(e){var t,r=this.options.direction;return 30&r?t=e.overallVelocity:6&r?t=e.overallVelocityX:24&r&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&r&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&d(t)>this.options.velocity&&4&e.eventType},emit:function(e){var t=eE(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),b(eP,eS,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[em]},process:function(e){var t=this.options,r=e.pointers.length===t.pointers,n=e.distance<t.threshold,i=e.deltaTime<t.time;if(this.reset(),1&e.eventType&&0===this.count)return this.failTimeout();if(n&&i&&r){if(4!=e.eventType)return this.failTimeout();var o=!this.pTime||e.timeStamp-this.pTime<t.interval,a=!this.pCenter||$(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,a&&o?this.count+=1:this.count=1,this._input=e,0==this.count%t.taps)return this.hasRequireFailures()?(this._timer=f(function(){this.state=8,this.tryEmit()},t.interval,this),2):8}return 32},failTimeout:function(){return this._timer=f(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),eR.VERSION="2.0.7",eR.defaults={domEvents:!1,touchAction:ef,enable:!0,inputTarget:null,inputClass:null,preset:[[eO,{enable:!1}],[eL,{enable:!1},["rotate"]],[eI,{direction:6}],[ew,{direction:6},["swipe"]],[eP],[eP,{event:"doubletap",taps:2},["tap"]],[eM]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},ek.prototype={set:function(e){return l(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t,r=this.session;if(!r.stopped){this.touchAction.preventDefaults(e);var n=this.recognizers,i=r.curRecognizer;(!i||i&&8&i.state)&&(i=r.curRecognizer=null);for(var o=0;o<n.length;)t=n[o],2!==r.stopped&&(!i||t==i||t.canRecognizeWith(i))?t.recognize(e):t.reset(),!i&&14&t.state&&(i=r.curRecognizer=t),o++}},get:function(e){if(e instanceof eS)return e;for(var t=this.recognizers,r=0;r<t.length;r++)if(t[r].options.event==e)return t[r];return null},add:function(e){if(g(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(g(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,r=L(t,e);-1!==r&&(t.splice(r,1),this.touchAction.update())}return this},on:function(e,t){if(s!==e&&s!==t){var r=this.handlers;return m(w(e),function(e){r[e]=r[e]||[],r[e].push(t)}),this}},off:function(e,t){if(s!==e){var r=this.handlers;return m(w(e),function(e){t?r[e]&&r[e].splice(L(r[e],t),1):delete r[e]}),this}},emit:function(e,t){this.options.domEvents&&((r=o.createEvent("Event")).initEvent(e,!0,!0),r.gesture=t,t.target.dispatchEvent(r));var r,n=this.handlers[e]&&this.handlers[e].slice();if(n&&n.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var i=0;i<n.length;)n[i](t),i++}},destroy:function(){this.element&&eN(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},l(eR,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:ek,Input:j,TouchAction:ex,TouchInput:ea,MouseInput:q,PointerEventInput:et,TouchMouseInput:el,SingleTouchInput:en,Recognizer:eS,AttrRecognizer:eC,Tap:eP,Pan:ew,Swipe:eI,Pinch:eL,Rotate:eO,Press:eM,on:A,off:E,each:m,merge:_,extend:y,assign:l,inherit:b,bindFn:x,prefixed:I}),(void 0!==i?i:"undefined"!=typeof self?self:{}).Hammer=eR,s!==(n=(function(){return eR}).call(t,r,t,e))&&(e.exports=n)}(window,document,0)},79231:(e,t,r)=>{"use strict";var n=r(92281),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function l(e){return n.isMemo(e)?a:s[e.$$typeof]||i}s[n.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[n.Memo]=a;var u=Object.defineProperty,c=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,f=Object.prototype;e.exports=function e(t,r,n){if("string"!=typeof r){if(f){var i=p(r);i&&i!==f&&e(t,i,n)}var a=c(r);h&&(a=a.concat(h(r)));for(var s=l(t),g=l(r),m=0;m<a.length;++m){var v=a[m];if(!o[v]&&!(n&&n[v])&&!(g&&g[v])&&!(s&&s[v])){var y=d(r,v);try{u(t,v,y)}catch(e){}}}}return t}},3677:(e,t)=>{t.read=function(e,t,r,n,i){var o,a,s=8*i-n-1,l=(1<<s)-1,u=l>>1,c=-7,h=r?i-1:0,d=r?-1:1,p=e[t+h];for(h+=d,o=p&(1<<-c)-1,p>>=-c,c+=s;c>0;o=256*o+e[t+h],h+=d,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=n;c>0;a=256*a+e[t+h],h+=d,c-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,n),o-=u}return(p?-1:1)*a*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var a,s,l,u=8*o-i-1,c=(1<<u)-1,h=c>>1,d=23===i?5960464477539062e-23:0,p=n?0:o-1,f=n?1:-1,g=t<0||0===t&&1/t<0?1:0;for(isNaN(t=Math.abs(t))||t===1/0?(s=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+h>=1?t+=d/l:t+=d*Math.pow(2,1-h),t*l>=2&&(a++,l/=2),a+h>=c?(s=0,a=c):a+h>=1?(s=(t*l-1)*Math.pow(2,i),a+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;e[r+p]=255&s,p+=f,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;e[r+p]=255&a,p+=f,a/=256,u-=8);e[r+p-f]|=128*g}},77182:(e,t,r)=>{"use strict";r.d(t,{U:()=>f});var n=r(23528),i=r(25316),o=r(21567),a=r(94779);function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}let l={};function u(e){return"write"in e}let{read:c,write:h}=(0,a.eU)(null);function d(){}let p=(0,i.createContext)({scope:void 0,baseStore:void 0});function f({atoms:e,atomFamilies:t,children:r,debugName:a}){let f=(0,o.Pj)(),{scope:m,baseStore:v=f}=(0,i.useContext)(p);f instanceof d||(m=void 0,v=f);let y=new Set(e),_=new Set(t);function b(){let e=function(e,t,r,n){let i=new WeakMap,o=new WeakMap,a=new WeakMap,s={getAtom:p,cleanup(){},prepareWriteAtom(e,t,r){if(t.read===c&&u(t)&&u(e)&&t.write!==h&&s!==r){let{write:n}=t;return e.write=v(t.write.bind(t),r),()=>{e.write=n}}}};for(let t of e)i.set(t,[m(t,s),s]);let d=new Set;for(let r of t){for(let e of r.getParams()){let t=r(e);i.has(t)||i.set(t,[m(t,s),s])}let t=r.unstable_listen(t=>{"CREATE"!==t.type||i.has(t.atom)?e.has(t.atom)||i.delete(t.atom):i.set(t.atom,[m(t.atom,s),s])});d.add(t)}function p(e,t){var n,u;if(i.has(e))return i.get(e);if(t===s)return o.has(e)||o.set(e,[m(e,t),t]),o.get(e);let c=null!=t?t:l;if(r){if(!(null!=(u=a.get(c))&&u.has(e))){let[n,i]=r.getAtom(e,t);f(g(n,e,i),e,t,i)}return a.get(c).get(e)}return null!=(n=a.get(c))&&n.has(e)||f(g(e,e),e),a.get(c).get(e)}function f(e,t,r,n){let i=null!=r?r:l;a.has(i)||a.set(i,new WeakMap),a.get(i).set(t,[e,n].filter(Boolean))}function g(e,t,r){return t.read!==c?m(t,r):e}function m(e,t){var r;let n=Object.create(Object.getPrototypeOf(e),Object.getOwnPropertyDescriptors(e));return n.read!==c&&(n.read=(r=e.read.bind(e),function(e,n){return r(function(r){let[n]=p(r,t);return e(n)},n)})),u(n)&&u(e)&&n.write!==h&&(n.write=v(e.write.bind(e),t)),n}function v(e,t){return function(r,n,...i){return e(function(e){let[n]=p(e,t);return r(n)},function(e,...r){let[i]=p(e,t);return n(i,...r)},...i)}}return s.cleanup=function(...e){return function(){for(let t of e)t()}}(s.cleanup,...Array.from(d)),s}(y,_,m,0);return{patchedStore:function(e,t){let r=s({},e,{get(r,...n){let[i]=t.getAtom(r);return e.get(i,...n)},set(r,...n){let[i,o]=t.getAtom(r),a=t.prepareWriteAtom(i,r,o);try{return e.set(i,...n)}finally{null==a||a()}},sub(r,...n){let[i]=t.getAtom(r);return e.sub(i,...n)}});return Object.assign(Object.create(d.prototype),r)}(v,e),scopeContext:{scope:e,baseStore:v},hasChanged:e=>m!==e.parentScope||v!==e.baseStore||!g(y,e.atomSet)||!g(_,e.atomFamilySet)}}let[x,S]=(0,i.useState)(b),{hasChanged:A,scopeContext:E,patchedStore:T}=x;if(A({parentScope:m,atomSet:y,atomFamilySet:_,baseStore:v})){var C;null==(C=E.scope)||C.cleanup(),S(b)}let{cleanup:w}=E.scope;return function(e,t){let r=(0,i.useRef)(e);r.current=e,(0,i.useEffect)(()=>r.current(),t)}(()=>w,[]),(0,n.jsx)(p.Provider,{value:E,children:(0,n.jsx)(o.Kq,{store:T,children:r})})}function g(e,t){return e===t||e.size===t.size&&Array.from(e).every(e=>t.has(e))}},32182:(e,t,r)=>{var n=r(61994)(r(51863),"DataView");e.exports=n},27195:(e,t,r)=>{var n=r(58912),i=r(29760),o=r(20617),a=r(39221),s=r(18341);function l(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=i,l.prototype.get=o,l.prototype.has=a,l.prototype.set=s,e.exports=l},5019:(e,t,r)=>{var n=r(78912),i=r(17472),o=r(63913),a=r(68725),s=r(40594);function l(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=i,l.prototype.get=o,l.prototype.has=a,l.prototype.set=s,e.exports=l},40763:(e,t,r)=>{var n=r(61994)(r(51863),"Map");e.exports=n},95691:(e,t,r)=>{var n=r(31824),i=r(53456),o=r(95545),a=r(30853),s=r(4661);function l(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=i,l.prototype.get=o,l.prototype.has=a,l.prototype.set=s,e.exports=l},53236:(e,t,r)=>{var n=r(61994)(r(51863),"Promise");e.exports=n},41129:(e,t,r)=>{var n=r(61994)(r(51863),"Set");e.exports=n},84773:(e,t,r)=>{var n=r(95691),i=r(6964),o=r(35559);function a(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new n;++t<r;)this.add(e[t])}a.prototype.add=a.prototype.push=i,a.prototype.has=o,e.exports=a},64621:(e,t,r)=>{var n=r(5019),i=r(97710),o=r(52546),a=r(27171),s=r(23375),l=r(52151);function u(e){var t=this.__data__=new n(e);this.size=t.size}u.prototype.clear=i,u.prototype.delete=o,u.prototype.get=a,u.prototype.has=s,u.prototype.set=l,e.exports=u},70267:(e,t,r)=>{var n=r(51863).Symbol;e.exports=n},27758:(e,t,r)=>{var n=r(51863).Uint8Array;e.exports=n},31287:(e,t,r)=>{var n=r(61994)(r(51863),"WeakMap");e.exports=n},52641:e=>{e.exports=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}},98849:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}},20350:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var a=e[r];t(a,r,e)&&(o[i++]=a)}return o}},73149:(e,t,r)=>{var n=r(55447);e.exports=function(e,t){return!!(null==e?0:e.length)&&n(e,t,0)>-1}},76421:e=>{e.exports=function(e,t,r){for(var n=-1,i=null==e?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1}},31719:(e,t,r)=>{var n=r(30208),i=r(61290),o=r(94687),a=r(39708),s=r(35585),l=r(78003),u=Object.prototype.hasOwnProperty;e.exports=function(e,t){var r=o(e),c=!r&&i(e),h=!r&&!c&&a(e),d=!r&&!c&&!h&&l(e),p=r||c||h||d,f=p?n(e.length,String):[],g=f.length;for(var m in e)(t||u.call(e,m))&&!(p&&("length"==m||h&&("offset"==m||"parent"==m)||d&&("buffer"==m||"byteLength"==m||"byteOffset"==m)||s(m,g)))&&f.push(m);return f}},72766:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}},66888:e=>{e.exports=function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}},89154:e=>{e.exports=function(e,t,r,n){var i=-1,o=null==e?0:e.length;for(n&&o&&(r=e[++i]);++i<o;)r=t(r,e[i],i,e);return r}},1872:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}},97236:e=>{e.exports=function(e){return e.split("")}},97587:e=>{var t=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;e.exports=function(e){return e.match(t)||[]}},22795:(e,t,r)=>{var n=r(28432),i=r(10324);e.exports=function(e,t,r){(void 0===r||i(e[t],r))&&(void 0!==r||t in e)||n(e,t,r)}},33943:(e,t,r)=>{var n=r(28432),i=r(10324),o=Object.prototype.hasOwnProperty;e.exports=function(e,t,r){var a=e[t];o.call(e,t)&&i(a,r)&&(void 0!==r||t in e)||n(e,t,r)}},4043:(e,t,r)=>{var n=r(10324);e.exports=function(e,t){for(var r=e.length;r--;)if(n(e[r][0],t))return r;return -1}},63315:(e,t,r)=>{var n=r(61433),i=r(83202);e.exports=function(e,t){return e&&n(t,i(t),e)}},66908:(e,t,r)=>{var n=r(61433),i=r(58873);e.exports=function(e,t){return e&&n(t,i(t),e)}},28432:(e,t,r)=>{var n=r(8277);e.exports=function(e,t,r){"__proto__"==t&&n?n(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}},7717:e=>{e.exports=function(e,t,r){return e==e&&(void 0!==r&&(e=e<=r?e:r),void 0!==t&&(e=e>=t?e:t)),e}},92615:(e,t,r)=>{var n=r(64621),i=r(98849),o=r(33943),a=r(63315),s=r(66908),l=r(18866),u=r(37987),c=r(85555),h=r(44220),d=r(85880),p=r(30283),f=r(71695),g=r(53207),m=r(40537),v=r(33741),y=r(94687),_=r(39708),b=r(32288),x=r(35093),S=r(77598),A=r(83202),E=r(58873),T="[object Arguments]",C="[object Function]",w="[object Object]",L={};L[T]=L["[object Array]"]=L["[object ArrayBuffer]"]=L["[object DataView]"]=L["[object Boolean]"]=L["[object Date]"]=L["[object Float32Array]"]=L["[object Float64Array]"]=L["[object Int8Array]"]=L["[object Int16Array]"]=L["[object Int32Array]"]=L["[object Map]"]=L["[object Number]"]=L[w]=L["[object RegExp]"]=L["[object Set]"]=L["[object String]"]=L["[object Symbol]"]=L["[object Uint8Array]"]=L["[object Uint8ClampedArray]"]=L["[object Uint16Array]"]=L["[object Uint32Array]"]=!0,L["[object Error]"]=L[C]=L["[object WeakMap]"]=!1,e.exports=function e(t,r,M,O,I,P){var R,k=1&r,N=2&r,D=4&r;if(M&&(R=I?M(t,O,I,P):M(t)),void 0!==R)return R;if(!x(t))return t;var U=y(t);if(U){if(R=g(t),!k)return u(t,R)}else{var z=f(t),B=z==C||"[object GeneratorFunction]"==z;if(_(t))return l(t,k);if(z==w||z==T||B&&!I){if(R=N||B?{}:v(t),!k)return N?h(t,s(R,t)):c(t,a(R,t))}else{if(!L[z])return I?t:{};R=m(t,z,k)}}P||(P=new n);var F=P.get(t);if(F)return F;P.set(t,R),S(t)?t.forEach(function(n){R.add(e(n,r,M,n,t,P))}):b(t)&&t.forEach(function(n,i){R.set(i,e(n,r,M,i,t,P))});var j=D?N?p:d:N?E:A,V=U?void 0:j(t);return i(V||t,function(n,i){V&&(n=t[i=n]),o(R,i,e(n,r,M,i,t,P))}),R}},12610:(e,t,r)=>{var n=r(35093),i=Object.create,o=function(){function e(){}return function(t){if(!n(t))return{};if(i)return i(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();e.exports=o},65203:e=>{e.exports=function(e,t,r,n){for(var i=e.length,o=r+(n?1:-1);n?o--:++o<i;)if(t(e[o],o,e))return o;return -1}},55125:(e,t,r)=>{var n=r(81933)();e.exports=n},71946:(e,t,r)=>{var n=r(17975),i=r(21417);e.exports=function(e,t){t=n(t,e);for(var r=0,o=t.length;null!=e&&r<o;)e=e[i(t[r++])];return r&&r==o?e:void 0}},95965:(e,t,r)=>{var n=r(66888),i=r(94687);e.exports=function(e,t,r){var o=t(e);return i(e)?o:n(o,r(e))}},21074:(e,t,r)=>{var n=r(70267),i=r(47727),o=r(4156),a=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?i(e):o(e)}},55447:(e,t,r)=>{var n=r(65203),i=r(55983),o=r(21883);e.exports=function(e,t,r){return t==t?o(e,t,r):n(e,i,r)}},65555:e=>{e.exports=function(e,t,r,n){for(var i=r-1,o=e.length;++i<o;)if(n(e[i],t))return i;return -1}},62442:(e,t,r)=>{var n=r(21074),i=r(71322);e.exports=function(e){return i(e)&&"[object Arguments]"==n(e)}},24454:(e,t,r)=>{var n=r(77808),i=r(71322);e.exports=function e(t,r,o,a,s){return t===r||(null!=t&&null!=r&&(i(t)||i(r))?n(t,r,o,a,e,s):t!=t&&r!=r)}},77808:(e,t,r)=>{var n=r(64621),i=r(63775),o=r(90372),a=r(87199),s=r(71695),l=r(94687),u=r(39708),c=r(78003),h="[object Arguments]",d="[object Array]",p="[object Object]",f=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,g,m,v){var y=l(e),_=l(t),b=y?d:s(e),x=_?d:s(t);b=b==h?p:b,x=x==h?p:x;var S=b==p,A=x==p,E=b==x;if(E&&u(e)){if(!u(t))return!1;y=!0,S=!1}if(E&&!S)return v||(v=new n),y||c(e)?i(e,t,r,g,m,v):o(e,t,b,r,g,m,v);if(!(1&r)){var T=S&&f.call(e,"__wrapped__"),C=A&&f.call(t,"__wrapped__");if(T||C){var w=T?e.value():e,L=C?t.value():t;return v||(v=new n),m(w,L,r,g,v)}}return!!E&&(v||(v=new n),a(e,t,r,g,m,v))}},61120:(e,t,r)=>{var n=r(71695),i=r(71322);e.exports=function(e){return i(e)&&"[object Map]"==n(e)}},55983:e=>{e.exports=function(e){return e!=e}},49809:(e,t,r)=>{var n=r(71350),i=r(1678),o=r(35093),a=r(68651),s=/^\[object .+?Constructor\]$/,l=Object.prototype,u=Function.prototype.toString,c=l.hasOwnProperty,h=RegExp("^"+u.call(c).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!o(e)||i(e))&&(n(e)?h:s).test(a(e))}},19966:(e,t,r)=>{var n=r(71695),i=r(71322);e.exports=function(e){return i(e)&&"[object Set]"==n(e)}},883:(e,t,r)=>{var n=r(21074),i=r(52594),o=r(71322),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,e.exports=function(e){return o(e)&&i(e.length)&&!!a[n(e)]}},39810:(e,t,r)=>{var n=r(5811),i=r(97648),o=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return i(e);var t=[];for(var r in Object(e))o.call(e,r)&&"constructor"!=r&&t.push(r);return t}},6937:(e,t,r)=>{var n=r(35093),i=r(5811),o=r(16931),a=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return o(e);var t=i(e),r=[];for(var s in e)"constructor"==s&&(t||!a.call(e,s))||r.push(s);return r}},64474:(e,t,r)=>{var n=r(64621),i=r(22795),o=r(55125),a=r(22076),s=r(35093),l=r(58873),u=r(86314);e.exports=function e(t,r,c,h,d){t!==r&&o(r,function(o,l){if(d||(d=new n),s(o))a(t,r,l,c,e,h,d);else{var p=h?h(u(t,l),o,l+"",t,r,d):void 0;void 0===p&&(p=o),i(t,l,p)}},l)}},22076:(e,t,r)=>{var n=r(22795),i=r(18866),o=r(82025),a=r(37987),s=r(33741),l=r(61290),u=r(94687),c=r(75775),h=r(39708),d=r(71350),p=r(35093),f=r(54969),g=r(78003),m=r(86314),v=r(75694);e.exports=function(e,t,r,y,_,b,x){var S=m(e,r),A=m(t,r),E=x.get(A);if(E){n(e,r,E);return}var T=b?b(S,A,r+"",e,t,x):void 0,C=void 0===T;if(C){var w=u(A),L=!w&&h(A),M=!w&&!L&&g(A);T=A,w||L||M?u(S)?T=S:c(S)?T=a(S):L?(C=!1,T=i(A,!0)):M?(C=!1,T=o(A,!0)):T=[]:f(A)||l(A)?(T=S,l(S)?T=v(S):(!p(S)||d(S))&&(T=s(A))):C=!1}C&&(x.set(A,T),_(T,A,y,b,x),x.delete(A)),n(e,r,T)}},2346:e=>{e.exports=function(e){return function(t){return null==e?void 0:e[t]}}},95556:(e,t,r)=>{var n=r(72766),i=r(55447),o=r(65555),a=r(6405),s=r(37987),l=Array.prototype.splice;e.exports=function(e,t,r,u){var c=u?o:i,h=-1,d=t.length,p=e;for(e===t&&(t=s(t)),r&&(p=n(e,a(r)));++h<d;)for(var f=0,g=t[h],m=r?r(g):g;(f=c(p,m,f,u))>-1;)p!==e&&l.call(p,f,1),l.call(e,f,1);return e}},43808:(e,t,r)=>{var n=r(94572),i=r(58411),o=r(85389);e.exports=function(e,t){return o(i(e,t,n),e+"")}},87314:(e,t,r)=>{var n=r(95586),i=r(8277),o=r(94572),a=i?function(e,t){return i(e,"toString",{configurable:!0,enumerable:!1,value:n(t),writable:!0})}:o;e.exports=a},74236:e=>{e.exports=function(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var o=Array(i);++n<i;)o[n]=e[n+t];return o}},30208:e=>{e.exports=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}},42386:(e,t,r)=>{var n=r(70267),i=r(72766),o=r(94687),a=r(66186),s=1/0,l=n?n.prototype:void 0,u=l?l.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(o(t))return i(t,e)+"";if(a(t))return u?u.call(t):"";var r=t+"";return"0"==r&&1/t==-s?"-0":r}},46938:(e,t,r)=>{var n=r(19312),i=/^\s+/;e.exports=function(e){return e?e.slice(0,n(e)+1).replace(i,""):e}},6405:e=>{e.exports=function(e){return function(t){return e(t)}}},68:(e,t,r)=>{var n=r(84773),i=r(73149),o=r(76421),a=r(55113),s=r(21681),l=r(59109);e.exports=function(e,t,r){var u=-1,c=i,h=e.length,d=!0,p=[],f=p;if(r)d=!1,c=o;else if(h>=200){var g=t?null:s(e);if(g)return l(g);d=!1,c=a,f=new n}else f=t?[]:p;r:for(;++u<h;){var m=e[u],v=t?t(m):m;if(m=r||0!==m?m:0,d&&v==v){for(var y=f.length;y--;)if(f[y]===v)continue r;t&&f.push(v),p.push(m)}else c(f,v,r)||(f!==p&&f.push(v),p.push(m))}return p}},55113:e=>{e.exports=function(e,t){return e.has(t)}},17975:(e,t,r)=>{var n=r(94687),i=r(77474),o=r(59740),a=r(54930);e.exports=function(e,t){return n(e)?e:i(e,t)?[e]:o(a(e))}},41922:(e,t,r)=>{var n=r(74236);e.exports=function(e,t,r){var i=e.length;return r=void 0===r?i:r,!t&&r>=i?e:n(e,t,r)}},7459:(e,t,r)=>{var n=r(27758);e.exports=function(e){var t=new e.constructor(e.byteLength);return new n(t).set(new n(e)),t}},18866:(e,t,r)=>{e=r.nmd(e);var n=r(51863),i=t&&!t.nodeType&&t,o=i&&e&&!e.nodeType&&e,a=o&&o.exports===i?n.Buffer:void 0,s=a?a.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,n=s?s(r):new e.constructor(r);return e.copy(n),n}},60545:(e,t,r)=>{var n=r(7459);e.exports=function(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}},94805:e=>{var t=/\w*$/;e.exports=function(e){var r=new e.constructor(e.source,t.exec(e));return r.lastIndex=e.lastIndex,r}},95428:(e,t,r)=>{var n=r(70267),i=n?n.prototype:void 0,o=i?i.valueOf:void 0;e.exports=function(e){return o?Object(o.call(e)):{}}},82025:(e,t,r)=>{var n=r(7459);e.exports=function(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}},37987:e=>{e.exports=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}},61433:(e,t,r)=>{var n=r(33943),i=r(28432);e.exports=function(e,t,r,o){var a=!r;r||(r={});for(var s=-1,l=t.length;++s<l;){var u=t[s],c=o?o(r[u],e[u],u,r,e):void 0;void 0===c&&(c=e[u]),a?i(r,u,c):n(r,u,c)}return r}},85555:(e,t,r)=>{var n=r(61433),i=r(49722);e.exports=function(e,t){return n(e,i(e),t)}},44220:(e,t,r)=>{var n=r(61433),i=r(27441);e.exports=function(e,t){return n(e,i(e),t)}},99759:(e,t,r)=>{var n=r(51863)["__core-js_shared__"];e.exports=n},54265:(e,t,r)=>{var n=r(43808),i=r(81118);e.exports=function(e){return n(function(t,r){var n=-1,o=r.length,a=o>1?r[o-1]:void 0,s=o>2?r[2]:void 0;for(a=e.length>3&&"function"==typeof a?(o--,a):void 0,s&&i(r[0],r[1],s)&&(a=o<3?void 0:a,o=1),t=Object(t);++n<o;){var l=r[n];l&&e(t,l,n,a)}return t})}},81933:e=>{e.exports=function(e){return function(t,r,n){for(var i=-1,o=Object(t),a=n(t),s=a.length;s--;){var l=a[e?s:++i];if(!1===r(o[l],l,o))break}return t}}},92559:(e,t,r)=>{var n=r(41922),i=r(36592),o=r(67148),a=r(54930);e.exports=function(e){return function(t){var r=i(t=a(t))?o(t):void 0,s=r?r[0]:t.charAt(0),l=r?n(r,1).join(""):t.slice(1);return s[e]()+l}}},99817:(e,t,r)=>{var n=r(89154),i=r(31088),o=r(33819),a=RegExp("['’]","g");e.exports=function(e){return function(t){return n(o(i(t).replace(a,"")),e,"")}}},21681:(e,t,r)=>{var n=r(41129),i=r(44070),o=r(59109),a=n&&1/o(new n([,-0]))[1]==1/0?function(e){return new n(e)}:i;e.exports=a},39409:(e,t,r)=>{var n=r(2346)({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"});e.exports=n},8277:(e,t,r)=>{var n=r(61994),i=function(){try{var e=n(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=i},63775:(e,t,r)=>{var n=r(84773),i=r(1872),o=r(55113);e.exports=function(e,t,r,a,s,l){var u=1&r,c=e.length,h=t.length;if(c!=h&&!(u&&h>c))return!1;var d=l.get(e),p=l.get(t);if(d&&p)return d==t&&p==e;var f=-1,g=!0,m=2&r?new n:void 0;for(l.set(e,t),l.set(t,e);++f<c;){var v=e[f],y=t[f];if(a)var _=u?a(y,v,f,t,e,l):a(v,y,f,e,t,l);if(void 0!==_){if(_)continue;g=!1;break}if(m){if(!i(t,function(e,t){if(!o(m,t)&&(v===e||s(v,e,r,a,l)))return m.push(t)})){g=!1;break}}else if(!(v===y||s(v,y,r,a,l))){g=!1;break}}return l.delete(e),l.delete(t),g}},90372:(e,t,r)=>{var n=r(70267),i=r(27758),o=r(10324),a=r(63775),s=r(69119),l=r(59109),u=n?n.prototype:void 0,c=u?u.valueOf:void 0;e.exports=function(e,t,r,n,u,h,d){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":if(e.byteLength!=t.byteLength||!h(new i(e),new i(t)))break;return!0;case"[object Boolean]":case"[object Date]":case"[object Number]":return o(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var p=s;case"[object Set]":var f=1&n;if(p||(p=l),e.size!=t.size&&!f)break;var g=d.get(e);if(g)return g==t;n|=2,d.set(e,t);var m=a(p(e),p(t),n,u,h,d);return d.delete(e),m;case"[object Symbol]":if(c)return c.call(e)==c.call(t)}return!1}},87199:(e,t,r)=>{var n=r(85880),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,o,a,s){var l=1&r,u=n(e),c=u.length;if(c!=n(t).length&&!l)return!1;for(var h=c;h--;){var d=u[h];if(!(l?d in t:i.call(t,d)))return!1}var p=s.get(e),f=s.get(t);if(p&&f)return p==t&&f==e;var g=!0;s.set(e,t),s.set(t,e);for(var m=l;++h<c;){var v=e[d=u[h]],y=t[d];if(o)var _=l?o(y,v,d,t,e,s):o(v,y,d,e,t,s);if(!(void 0===_?v===y||a(v,y,r,o,s):_)){g=!1;break}m||(m="constructor"==d)}if(g&&!m){var b=e.constructor,x=t.constructor;b!=x&&"constructor"in e&&"constructor"in t&&!("function"==typeof b&&b instanceof b&&"function"==typeof x&&x instanceof x)&&(g=!1)}return s.delete(e),s.delete(t),g}},81342:(e,t,r)=>{var n="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g;e.exports=n},85880:(e,t,r)=>{var n=r(95965),i=r(49722),o=r(83202);e.exports=function(e){return n(e,o,i)}},30283:(e,t,r)=>{var n=r(95965),i=r(27441),o=r(58873);e.exports=function(e){return n(e,o,i)}},90413:(e,t,r)=>{var n=r(68682);e.exports=function(e,t){var r=e.__data__;return n(t)?r["string"==typeof t?"string":"hash"]:r.map}},61994:(e,t,r)=>{var n=r(49809),i=r(49650);e.exports=function(e,t){var r=i(e,t);return n(r)?r:void 0}},82129:(e,t,r)=>{var n=r(46863)(Object.getPrototypeOf,Object);e.exports=n},47727:(e,t,r)=>{var n=r(70267),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,s=n?n.toStringTag:void 0;e.exports=function(e){var t=o.call(e,s),r=e[s];try{e[s]=void 0;var n=!0}catch(e){}var i=a.call(e);return n&&(t?e[s]=r:delete e[s]),i}},49722:(e,t,r)=>{var n=r(20350),i=r(43571),o=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,s=a?function(e){return null==e?[]:n(a(e=Object(e)),function(t){return o.call(e,t)})}:i;e.exports=s},27441:(e,t,r)=>{var n=r(66888),i=r(82129),o=r(49722),a=r(43571),s=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)n(t,o(e)),e=i(e);return t}:a;e.exports=s},71695:(e,t,r)=>{var n=r(32182),i=r(40763),o=r(53236),a=r(41129),s=r(31287),l=r(21074),u=r(68651),c="[object Map]",h="[object Promise]",d="[object Set]",p="[object WeakMap]",f="[object DataView]",g=u(n),m=u(i),v=u(o),y=u(a),_=u(s),b=l;(n&&b(new n(new ArrayBuffer(1)))!=f||i&&b(new i)!=c||o&&b(o.resolve())!=h||a&&b(new a)!=d||s&&b(new s)!=p)&&(b=function(e){var t=l(e),r="[object Object]"==t?e.constructor:void 0,n=r?u(r):"";if(n)switch(n){case g:return f;case m:return c;case v:return h;case y:return d;case _:return p}return t}),e.exports=b},49650:e=>{e.exports=function(e,t){return null==e?void 0:e[t]}},36592:e=>{var t=RegExp("[\\u200d\ud800-\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return t.test(e)}},9492:e=>{var t=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;e.exports=function(e){return t.test(e)}},58912:(e,t,r)=>{var n=r(69816);e.exports=function(){this.__data__=n?n(null):{},this.size=0}},29760:e=>{e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},20617:(e,t,r)=>{var n=r(69816),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(n){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return i.call(t,e)?t[e]:void 0}},39221:(e,t,r)=>{var n=r(69816),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return n?void 0!==t[e]:i.call(t,e)}},18341:(e,t,r)=>{var n=r(69816);e.exports=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=n&&void 0===t?"__lodash_hash_undefined__":t,this}},53207:e=>{var t=Object.prototype.hasOwnProperty;e.exports=function(e){var r=e.length,n=new e.constructor(r);return r&&"string"==typeof e[0]&&t.call(e,"index")&&(n.index=e.index,n.input=e.input),n}},40537:(e,t,r)=>{var n=r(7459),i=r(60545),o=r(94805),a=r(95428),s=r(82025);e.exports=function(e,t,r){var l=e.constructor;switch(t){case"[object ArrayBuffer]":return n(e);case"[object Boolean]":case"[object Date]":return new l(+e);case"[object DataView]":return i(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return s(e,r);case"[object Map]":case"[object Set]":return new l;case"[object Number]":case"[object String]":return new l(e);case"[object RegExp]":return o(e);case"[object Symbol]":return a(e)}}},33741:(e,t,r)=>{var n=r(12610),i=r(82129),o=r(5811);e.exports=function(e){return"function"!=typeof e.constructor||o(e)?{}:n(i(e))}},35585:e=>{var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,r){var n=typeof e;return!!(r=null==r?0x1fffffffffffff:r)&&("number"==n||"symbol"!=n&&t.test(e))&&e>-1&&e%1==0&&e<r}},81118:(e,t,r)=>{var n=r(10324),i=r(77544),o=r(35585),a=r(35093);e.exports=function(e,t,r){if(!a(r))return!1;var s=typeof t;return("number"==s?!!(i(r)&&o(t,r.length)):"string"==s&&t in r)&&n(r[t],e)}},77474:(e,t,r)=>{var n=r(94687),i=r(66186),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;e.exports=function(e,t){if(n(e))return!1;var r=typeof e;return!!("number"==r||"symbol"==r||"boolean"==r||null==e||i(e))||a.test(e)||!o.test(e)||null!=t&&e in Object(t)}},68682:e=>{e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},1678:(e,t,r)=>{var n=r(99759),i=function(){var e=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=function(e){return!!i&&i in e}},5811:e=>{var t=Object.prototype;e.exports=function(e){var r=e&&e.constructor;return e===("function"==typeof r&&r.prototype||t)}},78912:e=>{e.exports=function(){this.__data__=[],this.size=0}},17472:(e,t,r)=>{var n=r(4043),i=Array.prototype.splice;e.exports=function(e){var t=this.__data__,r=n(t,e);return!(r<0)&&(r==t.length-1?t.pop():i.call(t,r,1),--this.size,!0)}},63913:(e,t,r)=>{var n=r(4043);e.exports=function(e){var t=this.__data__,r=n(t,e);return r<0?void 0:t[r][1]}},68725:(e,t,r)=>{var n=r(4043);e.exports=function(e){return n(this.__data__,e)>-1}},40594:(e,t,r)=>{var n=r(4043);e.exports=function(e,t){var r=this.__data__,i=n(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this}},31824:(e,t,r)=>{var n=r(27195),i=r(5019),o=r(40763);e.exports=function(){this.size=0,this.__data__={hash:new n,map:new(o||i),string:new n}}},53456:(e,t,r)=>{var n=r(90413);e.exports=function(e){var t=n(this,e).delete(e);return this.size-=t?1:0,t}},95545:(e,t,r)=>{var n=r(90413);e.exports=function(e){return n(this,e).get(e)}},30853:(e,t,r)=>{var n=r(90413);e.exports=function(e){return n(this,e).has(e)}},4661:(e,t,r)=>{var n=r(90413);e.exports=function(e,t){var r=n(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this}},69119:e=>{e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r}},73796:(e,t,r)=>{var n=r(78450);e.exports=function(e){var t=n(e,function(e){return 500===r.size&&r.clear(),e}),r=t.cache;return t}},69816:(e,t,r)=>{var n=r(61994)(Object,"create");e.exports=n},97648:(e,t,r)=>{var n=r(46863)(Object.keys,Object);e.exports=n},16931:e=>{e.exports=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}},57531:(e,t,r)=>{e=r.nmd(e);var n=r(81342),i=t&&!t.nodeType&&t,o=i&&e&&!e.nodeType&&e,a=o&&o.exports===i&&n.process,s=function(){try{var e=o&&o.require&&o.require("util").types;if(e)return e;return a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=s},4156:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},46863:e=>{e.exports=function(e,t){return function(r){return e(t(r))}}},58411:(e,t,r)=>{var n=r(52641),i=Math.max;e.exports=function(e,t,r){return t=i(void 0===t?e.length-1:t,0),function(){for(var o=arguments,a=-1,s=i(o.length-t,0),l=Array(s);++a<s;)l[a]=o[t+a];a=-1;for(var u=Array(t+1);++a<t;)u[a]=o[a];return u[t]=r(l),n(e,this,u)}}},51863:(e,t,r)=>{var n=r(81342),i="object"==typeof self&&self&&self.Object===Object&&self,o=n||i||Function("return this")();e.exports=o},86314:e=>{e.exports=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}},6964:e=>{e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},35559:e=>{e.exports=function(e){return this.__data__.has(e)}},59109:e=>{e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}},85389:(e,t,r)=>{var n=r(87314),i=r(99805)(n);e.exports=i},99805:e=>{var t=Date.now;e.exports=function(e){var r=0,n=0;return function(){var i=t(),o=16-(i-n);if(n=i,o>0){if(++r>=800)return arguments[0]}else r=0;return e.apply(void 0,arguments)}}},97710:(e,t,r)=>{var n=r(5019);e.exports=function(){this.__data__=new n,this.size=0}},52546:e=>{e.exports=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}},27171:e=>{e.exports=function(e){return this.__data__.get(e)}},23375:e=>{e.exports=function(e){return this.__data__.has(e)}},52151:(e,t,r)=>{var n=r(5019),i=r(40763),o=r(95691);e.exports=function(e,t){var r=this.__data__;if(r instanceof n){var a=r.__data__;if(!i||a.length<199)return a.push([e,t]),this.size=++r.size,this;r=this.__data__=new o(a)}return r.set(e,t),this.size=r.size,this}},21883:e=>{e.exports=function(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return -1}},67148:(e,t,r)=>{var n=r(97236),i=r(36592),o=r(3268);e.exports=function(e){return i(e)?o(e):n(e)}},59740:(e,t,r)=>{var n=r(73796),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,a=n(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(i,function(e,r,n,i){t.push(n?i.replace(o,"$1"):r||e)}),t});e.exports=a},21417:(e,t,r)=>{var n=r(66186),i=1/0;e.exports=function(e){if("string"==typeof e||n(e))return e;var t=e+"";return"0"==t&&1/e==-i?"-0":t}},68651:e=>{var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},19312:e=>{var t=/\s/;e.exports=function(e){for(var r=e.length;r--&&t.test(e.charAt(r)););return r}},3268:e=>{var t="\ud800-\udfff",r="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",n="\ud83c[\udffb-\udfff]",i="[^"+t+"]",o="(?:\ud83c[\udde6-\uddff]){2}",a="[\ud800-\udbff][\udc00-\udfff]",s="(?:"+r+"|"+n+")?",l="[\\ufe0e\\ufe0f]?",u="(?:\\u200d(?:"+[i,o,a].join("|")+")"+l+s+")*",c=RegExp(n+"(?="+n+")|(?:"+[i+r+"?",r,o,a,"["+t+"]"].join("|")+")"+(l+s+u),"g");e.exports=function(e){return e.match(c)||[]}},89251:e=>{var t="\ud800-\udfff",r="\\u2700-\\u27bf",n="a-z\\xdf-\\xf6\\xf8-\\xff",i="A-Z\\xc0-\\xd6\\xd8-\\xde",o="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",a="['’]",s="["+o+"]",l="["+n+"]",u="[^"+t+o+"\\d+"+r+n+i+"]",c="(?:\ud83c[\udde6-\uddff]){2}",h="[\ud800-\udbff][\udc00-\udfff]",d="["+i+"]",p="(?:"+l+"|"+u+")",f="(?:"+d+"|"+u+")",g="(?:"+a+"(?:d|ll|m|re|s|t|ve))?",m="(?:"+a+"(?:D|LL|M|RE|S|T|VE))?",v="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\ud83c[\udffb-\udfff])?",y="[\\ufe0e\\ufe0f]?",_="(?:\\u200d(?:"+["[^"+t+"]",c,h].join("|")+")"+y+v+")*",b="(?:"+["["+r+"]",c,h].join("|")+")"+(y+v+_),x=RegExp([d+"?"+l+"+"+g+"(?="+[s,d,"$"].join("|")+")",f+"+"+m+"(?="+[s,d+p,"$"].join("|")+")",d+"?"+p+"+"+g,d+"+"+m,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])","\\d+",b].join("|"),"g");e.exports=function(e){return e.match(x)||[]}},61252:(e,t,r)=>{var n=r(76476),i=r(99817)(function(e,t,r){return t=t.toLowerCase(),e+(r?n(t):t)});e.exports=i},76476:(e,t,r)=>{var n=r(54930),i=r(61836);e.exports=function(e){return i(n(e).toLowerCase())}},89413:(e,t,r)=>{var n=r(7717),i=r(78498);e.exports=function(e,t,r){return void 0===r&&(r=t,t=void 0),void 0!==r&&(r=(r=i(r))==r?r:0),void 0!==t&&(t=(t=i(t))==t?t:0),n(i(e),t,r)}},32301:(e,t,r)=>{var n=r(92615);e.exports=function(e){return n(e,5)}},95586:e=>{e.exports=function(e){return function(){return e}}},91985:(e,t,r)=>{var n=r(35093),i=r(27550),o=r(78498),a=Math.max,s=Math.min;e.exports=function(e,t,r){var l,u,c,h,d,p,f=0,g=!1,m=!1,v=!0;if("function"!=typeof e)throw TypeError("Expected a function");function y(t){var r=l,n=u;return l=u=void 0,f=t,h=e.apply(n,r)}function _(e){var r=e-p,n=e-f;return void 0===p||r>=t||r<0||m&&n>=c}function b(){var e,r,n,o=i();if(_(o))return x(o);d=setTimeout(b,(e=o-p,r=o-f,n=t-e,m?s(n,c-r):n))}function x(e){return(d=void 0,v&&l)?y(e):(l=u=void 0,h)}function S(){var e,r=i(),n=_(r);if(l=arguments,u=this,p=r,n){if(void 0===d)return f=e=p,d=setTimeout(b,t),g?y(e):h;if(m)return clearTimeout(d),d=setTimeout(b,t),y(p)}return void 0===d&&(d=setTimeout(b,t)),h}return t=o(t)||0,n(r)&&(g=!!r.leading,c=(m="maxWait"in r)?a(o(r.maxWait)||0,t):c,v="trailing"in r?!!r.trailing:v),S.cancel=function(){void 0!==d&&clearTimeout(d),f=0,l=p=u=d=void 0},S.flush=function(){return void 0===d?h:x(i())},S}},31088:(e,t,r)=>{var n=r(39409),i=r(54930),o=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,a=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");e.exports=function(e){return(e=i(e))&&e.replace(o,n).replace(a,"")}},10324:e=>{e.exports=function(e,t){return e===t||e!=e&&t!=t}},91946:(e,t,r)=>{var n=r(71946);e.exports=function(e,t,r){var i=null==e?void 0:n(e,t);return void 0===i?r:i}},94572:e=>{e.exports=function(e){return e}},61290:(e,t,r)=>{var n=r(62442),i=r(71322),o=Object.prototype,a=o.hasOwnProperty,s=o.propertyIsEnumerable,l=n(function(){return arguments}())?n:function(e){return i(e)&&a.call(e,"callee")&&!s.call(e,"callee")};e.exports=l},94687:e=>{var t=Array.isArray;e.exports=t},77544:(e,t,r)=>{var n=r(71350),i=r(52594);e.exports=function(e){return null!=e&&i(e.length)&&!n(e)}},75775:(e,t,r)=>{var n=r(77544),i=r(71322);e.exports=function(e){return i(e)&&n(e)}},35186:(e,t,r)=>{var n=r(21074),i=r(71322);e.exports=function(e){return!0===e||!1===e||i(e)&&"[object Boolean]"==n(e)}},39708:(e,t,r)=>{e=r.nmd(e);var n=r(51863),i=r(25845),o=t&&!t.nodeType&&t,a=o&&e&&!e.nodeType&&e,s=a&&a.exports===o?n.Buffer:void 0,l=s?s.isBuffer:void 0;e.exports=l||i},97894:(e,t,r)=>{var n=r(24454);e.exports=function(e,t){return n(e,t)}},71350:(e,t,r)=>{var n=r(21074),i=r(35093);e.exports=function(e){if(!i(e))return!1;var t=n(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},52594:e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=0x1fffffffffffff}},32288:(e,t,r)=>{var n=r(61120),i=r(6405),o=r(57531),a=o&&o.isMap,s=a?i(a):n;e.exports=s},1293:e=>{e.exports=function(e){return null==e}},39403:(e,t,r)=>{var n=r(21074),i=r(71322);e.exports=function(e){return"number"==typeof e||i(e)&&"[object Number]"==n(e)}},35093:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},71322:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},54969:(e,t,r)=>{var n=r(21074),i=r(82129),o=r(71322),a=Object.prototype,s=Function.prototype.toString,l=a.hasOwnProperty,u=s.call(Object);e.exports=function(e){if(!o(e)||"[object Object]"!=n(e))return!1;var t=i(e);if(null===t)return!0;var r=l.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&s.call(r)==u}},77598:(e,t,r)=>{var n=r(19966),i=r(6405),o=r(57531),a=o&&o.isSet,s=a?i(a):n;e.exports=s},36707:(e,t,r)=>{var n=r(21074),i=r(94687),o=r(71322);e.exports=function(e){return"string"==typeof e||!i(e)&&o(e)&&"[object String]"==n(e)}},66186:(e,t,r)=>{var n=r(21074),i=r(71322);e.exports=function(e){return"symbol"==typeof e||i(e)&&"[object Symbol]"==n(e)}},78003:(e,t,r)=>{var n=r(883),i=r(6405),o=r(57531),a=o&&o.isTypedArray,s=a?i(a):n;e.exports=s},63370:e=>{e.exports=function(e){return void 0===e}},83202:(e,t,r)=>{var n=r(31719),i=r(39810),o=r(77544);e.exports=function(e){return o(e)?n(e):i(e)}},58873:(e,t,r)=>{var n=r(31719),i=r(6937),o=r(77544);e.exports=function(e){return o(e)?n(e,!0):i(e)}},78450:(e,t,r)=>{var n=r(95691);function i(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw TypeError("Expected a function");var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var a=e.apply(this,n);return r.cache=o.set(i,a)||o,a};return r.cache=new(i.Cache||n),r}i.Cache=n,e.exports=i},87066:(e,t,r)=>{var n=r(64474),i=r(54265)(function(e,t,r){n(e,t,r)});e.exports=i},17362:(e,t,r)=>{var n=r(64474),i=r(54265)(function(e,t,r,i){n(e,t,r,i)});e.exports=i},44070:e=>{e.exports=function(){}},27550:(e,t,r)=>{var n=r(51863);e.exports=function(){return n.Date.now()}},34469:(e,t,r)=>{var n=r(43808)(r(96676));e.exports=n},96676:(e,t,r)=>{var n=r(95556);e.exports=function(e,t){return e&&e.length&&t&&t.length?n(e,t):e}},43571:e=>{e.exports=function(){return[]}},25845:e=>{e.exports=function(){return!1}},55570:(e,t,r)=>{var n=r(91985),i=r(35093);e.exports=function(e,t,r){var o=!0,a=!0;if("function"!=typeof e)throw TypeError("Expected a function");return i(r)&&(o="leading"in r?!!r.leading:o,a="trailing"in r?!!r.trailing:a),n(e,t,{leading:o,maxWait:t,trailing:a})}},78498:(e,t,r)=>{var n=r(46938),i=r(35093),o=r(66186),a=0/0,s=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,u=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(o(e))return a;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=n(e);var r=l.test(e);return r||u.test(e)?c(e.slice(2),r?2:8):s.test(e)?a:+e}},75694:(e,t,r)=>{var n=r(61433),i=r(58873);e.exports=function(e){return n(e,i(e))}},54930:(e,t,r)=>{var n=r(42386);e.exports=function(e){return null==e?"":n(e)}},91255:(e,t,r)=>{var n=r(68);e.exports=function(e){return e&&e.length?n(e):[]}},33876:(e,t,r)=>{var n=r(54930),i=0;e.exports=function(e){var t=++i;return n(e)+t}},61836:(e,t,r)=>{var n=r(92559)("toUpperCase");e.exports=n},33819:(e,t,r)=>{var n=r(97587),i=r(9492),o=r(54930),a=r(89251);e.exports=function(e,t,r){return(e=o(e),void 0===(t=r?void 0:t))?i(e)?a(e):n(e):e.match(t)||[]}},70551:(e,t,r)=>{"use strict";e.exports=i;var n=r(3677);function i(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;var o="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8");function a(e){return e.type===i.Bytes?e.readVarint()+e.pos:e.pos+1}function s(e,t,r){var n=t<=16383?1:t<=2097151?2:t<=0xfffffff?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(n);for(var i=r.pos-1;i>=e;i--)r.buf[i+n]=r.buf[i]}function l(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function u(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function c(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function h(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function d(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function p(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function f(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function g(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function m(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function v(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+0x1000000*e[t+3]}function y(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function _(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}i.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,o=this.pos;this.type=7&n,e(i,t,this),this.pos===o&&this.skip(n)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=v(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=_(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=v(this.buf,this.pos)+0x100000000*v(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=v(this.buf,this.pos)+0x100000000*_(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=n.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=n.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,r,n=this.buf;return(t=127&(r=n[this.pos++]),r<128)?t:(t|=(127&(r=n[this.pos++]))<<7,r<128)?t:(t|=(127&(r=n[this.pos++]))<<14,r<128)?t:(t|=(127&(r=n[this.pos++]))<<21,r<128)?t:function(e,t,r){var n,i,o,a,s=r.buf;if(o=(112&(a=s[r.pos++]))>>4,a<128||(o|=(127&(a=s[r.pos++]))<<3,a<128)||(o|=(127&(a=s[r.pos++]))<<10,a<128)||(o|=(127&(a=s[r.pos++]))<<17,a<128)||(o|=(127&(a=s[r.pos++]))<<24,a<128)||(o|=(1&(a=s[r.pos++]))<<31,a<128)){return n=e,i=o,t?0x100000000*i+(n>>>0):(i>>>0)*0x100000000+(n>>>0)}throw Error("Expected varint not more than 10 bytes")}(t|=(15&(r=n[this.pos]))<<28,e,this)},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?-((e+1)/2):e/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var e,t=this.readVarint()+this.pos,r=this.pos;return(this.pos=t,t-r>=12&&o)?(e=this.buf,o.decode(e.subarray(r,t))):function(e,t,r){for(var n="",i=t;i<r;){var o,a,s,l=e[i],u=null,c=l>239?4:l>223?3:l>191?2:1;if(i+c>r)break;1===c?l<128&&(u=l):2===c?(192&(o=e[i+1]))==128&&(u=(31&l)<<6|63&o)<=127&&(u=null):3===c?(o=e[i+1],a=e[i+2],(192&o)==128&&(192&a)==128&&((u=(15&l)<<12|(63&o)<<6|63&a)<=2047||u>=55296&&u<=57343)&&(u=null)):4===c&&(o=e[i+1],a=e[i+2],s=e[i+3],(192&o)==128&&(192&a)==128&&(192&s)==128&&((u=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,c=1):u>65535&&(u-=65536,n+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),n+=String.fromCharCode(u),i+=c}return n}(this.buf,r,t)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==i.Bytes)return e.push(this.readVarint(t));var r=a(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==i.Bytes)return e.push(this.readSVarint());var t=a(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==i.Bytes)return e.push(this.readBoolean());var t=a(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==i.Bytes)return e.push(this.readFloat());var t=a(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==i.Bytes)return e.push(this.readDouble());var t=a(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==i.Bytes)return e.push(this.readFixed32());var t=a(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==i.Bytes)return e.push(this.readSFixed32());var t=a(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==i.Bytes)return e.push(this.readFixed64());var t=a(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==i.Bytes)return e.push(this.readSFixed64());var t=a(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===i.Varint)for(;this.buf[this.pos++]>127;);else if(t===i.Bytes)this.pos=this.readVarint()+this.pos;else if(t===i.Fixed32)this.pos+=4;else if(t===i.Fixed64)this.pos+=8;else throw Error("Unimplemented type: "+t)},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),y(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),y(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),y(this.buf,-1&e,this.pos),y(this.buf,Math.floor(23283064365386963e-26*e),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),y(this.buf,-1&e,this.pos),y(this.buf,Math.floor(23283064365386963e-26*e),this.pos+4),this.pos+=8},writeVarint:function(e){if((e=+e||0)>0xfffffff||e<0){!function(e,t){var r,n,i,o,a,s;if(e>=0?(r=e%0x100000000|0,n=e/0x100000000|0):(r=~(-e%0x100000000),n=~(-e/0x100000000),0xffffffff^r?r=r+1|0:(r=0,n=n+1|0)),e>=0xffffffffffffffff||e<-0xffffffffffffffff)throw Error("Given varint doesn't fit into 10 bytes");t.realloc(10),i=r,t.buf[t.pos++]=127&i|128,i>>>=7,t.buf[t.pos++]=127&i|128,i>>>=7,t.buf[t.pos++]=127&i|128,i>>>=7,t.buf[t.pos++]=127&i|128,i>>>=7,t.buf[t.pos]=127&i,o=n,a=t,s=(7&o)<<4,a.buf[a.pos++]|=s|((o>>>=3)?128:0),!o||(a.buf[a.pos++]=127&o|((o>>>=7)?128:0),!o)||(a.buf[a.pos++]=127&o|((o>>>=7)?128:0),!o)||(a.buf[a.pos++]=127&o|((o>>>=7)?128:0),o&&(a.buf[a.pos++]=127&o|((o>>>=7)?128:0),o&&(a.buf[a.pos++]=127&o)))}(e,this);return}this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127)))},writeSVarint:function(e){this.writeVarint(e<0?-(2*e)-1:2*e)},writeBoolean:function(e){this.writeVarint(!!e)},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(e,t,r){for(var n,i,o=0;o<t.length;o++){if((n=t.charCodeAt(o))>55295&&n<57344){if(i){if(n<56320){e[r++]=239,e[r++]=191,e[r++]=189,i=n;continue}n=i-55296<<10|n-56320|65536,i=null}else{n>56319||o+1===t.length?(e[r++]=239,e[r++]=191,e[r++]=189):i=n;continue}}else i&&(e[r++]=239,e[r++]=191,e[r++]=189,i=null);n<128?e[r++]=n:(n<2048?e[r++]=n>>6|192:(n<65536?e[r++]=n>>12|224:(e[r++]=n>>18|240,e[r++]=n>>12&63|128),e[r++]=n>>6&63|128),e[r++]=63&n|128)}return r}(this.buf,e,this.pos);var r=this.pos-t;r>=128&&s(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),n.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),n.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var n=this.pos-r;n>=128&&s(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(e,t,r){this.writeTag(e,i.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,l,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,u,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,d,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,c,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,h,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,p,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,f,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,g,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,m,t)},writeBytesField:function(e,t){this.writeTag(e,i.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,i.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,i.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,i.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,i.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,i.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,i.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,i.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,i.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,i.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,!!t)}}},48704:function(e,t,r){var n,i=r(23953);n=function(){"use strict";var e=function(e,t){this.next=null,this.key=e,this.data=t,this.left=null,this.right=null};function t(e,t){return e>t?1:e<t?-1:0}function r(t,r,n){for(var i=new e(null,null),o=i,a=i;;){var s=n(t,r.key);if(s<0){if(null===r.left)break;if(0>n(t,r.left.key)){var l=r.left;if(r.left=l.right,l.right=r,null===(r=l).left)break}a.left=r,a=r,r=r.left}else if(s>0){if(null===r.right)break;if(n(t,r.right.key)>0){var l=r.right;if(r.right=l.left,l.left=r,null===(r=l).right)break}o.right=r,o=r,r=r.right}else break}return o.right=r.left,a.left=r.right,r.left=i.right,r.right=i.left,r}function n(t,n,i,o){var a=new e(t,n);if(null===i)return a.left=a.right=null,a;i=r(t,i,o);var s=o(t,i.key);return s<0?(a.left=i.left,a.right=i,i.left=null):s>=0&&(a.right=i.right,a.left=i,i.right=null),a}function o(e,t,n){var i=null,o=null;if(t){t=r(e,t,n);var a=n(t.key,e);0===a?(i=t.left,o=t.right):a<0?(o=t.right,t.right=null,i=t):(i=t.left,t.left=null,o=t)}return{left:i,right:o}}var a=function(){function i(e){void 0===e&&(e=t),this._root=null,this._size=0,this._comparator=e}return i.prototype.insert=function(e,t){return this._size++,this._root=n(e,t,this._root,this._comparator)},i.prototype.add=function(t,n){var i=new e(t,n);null===this._root&&(i.left=i.right=null,this._size++,this._root=i);var o=this._comparator,a=r(t,this._root,o),s=o(t,a.key);return 0===s?this._root=a:(s<0?(i.left=a.left,i.right=a,a.left=null):s>0&&(i.right=a.right,i.left=a,a.right=null),this._size++,this._root=i),this._root},i.prototype.remove=function(e){this._root=this._remove(e,this._root,this._comparator)},i.prototype._remove=function(e,t,n){var i;return null===t?null:(t=r(e,t,n),0===n(e,t.key))?(null===t.left?i=t.right:(i=r(e,t.left,n)).right=t.right,this._size--,i):t},i.prototype.pop=function(){var e=this._root;if(e){for(;e.left;)e=e.left;return this._root=r(e.key,this._root,this._comparator),this._root=this._remove(e.key,this._root,this._comparator),{key:e.key,data:e.data}}return null},i.prototype.findStatic=function(e){for(var t=this._root,r=this._comparator;t;){var n=r(e,t.key);if(0===n)return t;t=n<0?t.left:t.right}return null},i.prototype.find=function(e){return this._root&&(this._root=r(e,this._root,this._comparator),0!==this._comparator(e,this._root.key))?null:this._root},i.prototype.contains=function(e){for(var t=this._root,r=this._comparator;t;){var n=r(e,t.key);if(0===n)return!0;t=n<0?t.left:t.right}return!1},i.prototype.forEach=function(e,t){for(var r=this._root,n=[],i=!1;!i;)null!==r?(n.push(r),r=r.left):0!==n.length?(r=n.pop(),e.call(t,r),r=r.right):i=!0;return this},i.prototype.range=function(e,t,r,n){for(var i=[],o=this._comparator,a=this._root;0!==i.length||a;)if(a)i.push(a),a=a.left;else{if(o((a=i.pop()).key,t)>0)break;if(o(a.key,e)>=0&&r.call(n,a))return this;a=a.right}return this},i.prototype.keys=function(){var e=[];return this.forEach(function(t){var r=t.key;return e.push(r)}),e},i.prototype.values=function(){var e=[];return this.forEach(function(t){var r=t.data;return e.push(r)}),e},i.prototype.min=function(){return this._root?this.minNode(this._root).key:null},i.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},i.prototype.minNode=function(e){if(void 0===e&&(e=this._root),e)for(;e.left;)e=e.left;return e},i.prototype.maxNode=function(e){if(void 0===e&&(e=this._root),e)for(;e.right;)e=e.right;return e},i.prototype.at=function(e){for(var t=this._root,r=!1,n=0,i=[];!r;)if(t)i.push(t),t=t.left;else if(i.length>0){if(t=i.pop(),n===e)return t;n++,t=t.right}else r=!0;return null},i.prototype.next=function(e){var t=this._root,r=null;if(e.right){for(r=e.right;r.left;)r=r.left;return r}for(var n=this._comparator;t;){var i=n(e.key,t.key);if(0===i)break;i<0?(r=t,t=t.left):t=t.right}return r},i.prototype.prev=function(e){var t=this._root,r=null;if(null!==e.left){for(r=e.left;r.right;)r=r.right;return r}for(var n=this._comparator;t;){var i=n(e.key,t.key);if(0===i)break;i<0?t=t.left:(r=t,t=t.right)}return r},i.prototype.clear=function(){return this._root=null,this._size=0,this},i.prototype.toList=function(){return function(t){for(var r=t,n=[],i=!1,o=new e(null,null),a=o;!i;)r?(n.push(r),r=r.left):n.length>0?r=(r=a=a.next=n.pop()).right:i=!0;return a.next=null,o.next}(this._root)},i.prototype.load=function(t,r,n){void 0===r&&(r=[]),void 0===n&&(n=!1);var i=t.length,o=this._comparator;if(n&&function e(t,r,n,i,o){if(!(n>=i)){for(var a=t[n+i>>1],s=n-1,l=i+1;;){do s++;while(0>o(t[s],a));do l--;while(o(t[l],a)>0);if(s>=l)break;var u=t[s];t[s]=t[l],t[l]=u,u=r[s],r[s]=r[l],r[l]=u}e(t,r,n,l,o),e(t,r,l+1,i,o)}}(t,r,0,i-1,o),null===this._root)this._root=function t(r,n,i,o){var a=o-i;if(a>0){var s=i+Math.floor(a/2),l=new e(r[s],n[s]);return l.left=t(r,n,i,s),l.right=t(r,n,s+1,o),l}return null}(t,r,0,i),this._size=i;else{var a=function(t,r,n){for(var i=new e(null,null),o=i,a=t,s=r;null!==a&&null!==s;)0>n(a.key,s.key)?(o.next=a,a=a.next):(o.next=s,s=s.next),o=o.next;return null!==a?o.next=a:null!==s&&(o.next=s),i.next}(this.toList(),function(t,r){for(var n=new e(null,null),i=n,o=0;o<t.length;o++)i=i.next=new e(t[o],r[o]);return i.next=null,n.next}(t,r),o);i=this._size+i,this._root=function e(t,r,n){var i=n-r;if(i>0){var o=r+Math.floor(i/2),a=e(t,r,o),s=t.head;return s.left=a,t.head=t.head.next,s.right=e(t,o+1,n),s}return null}({head:a},0,i)}return this},i.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(i.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),i.prototype.toString=function(e){void 0===e&&(e=function(e){return String(e.key)});var t=[];return function e(t,r,n,i,o){if(t){i(""+r+(n?"└── ":"├── ")+o(t)+"\n");var a=r+(n?"    ":"│   ");t.left&&e(t.left,a,!1,i,o),t.right&&e(t.right,a,!0,i,o)}}(this._root,"",!0,function(e){return t.push(e)},e),t.join("")},i.prototype.update=function(e,t,i){var a,s,l=this._comparator,u=o(e,this._root,l),c=u.left,h=u.right;0>l(e,t)?h=n(t,i,h,l):c=n(t,i,c,l),this._root=(a=c,null===(s=h)?a:(null===a||((s=r(a.key,s,l)).left=a),s))},i.prototype.split=function(e){return o(e,this._root,this._comparator)},i.prototype[Symbol.iterator]=function(){var e,t,r;return function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,function(n){switch(n.label){case 0:e=this._root,t=[],r=!1,n.label=1;case 1:if(r)return[3,6];if(!(null!==e))return[3,2];return t.push(e),e=e.left,[3,5];case 2:if(!(0!==t.length))return[3,4];return[4,e=t.pop()];case 3:return n.sent(),e=e.right,[3,5];case 4:r=!0,n.label=5;case 5:return[3,1];case 6:return[2]}})},i}();let s=(e,t)=>e.ll.x<=t.x&&t.x<=e.ur.x&&e.ll.y<=t.y&&t.y<=e.ur.y,l=(e,t)=>{if(t.ur.x<e.ll.x||e.ur.x<t.ll.x||t.ur.y<e.ll.y||e.ur.y<t.ll.y)return null;let r=e.ll.x<t.ll.x?t.ll.x:e.ll.x,n=e.ur.x<t.ur.x?e.ur.x:t.ur.x;return{ll:{x:r,y:e.ll.y<t.ll.y?t.ll.y:e.ll.y},ur:{x:n,y:e.ur.y<t.ur.y?e.ur.y:t.ur.y}}},u=Number.EPSILON;void 0===u&&(u=2220446049250313e-31);let c=u*u,h=(e,t)=>{if(-u<e&&e<u&&-u<t&&t<u)return 0;let r=e-t;return r*r<c*e*t?0:e<t?-1:1};class d{constructor(){this.reset()}reset(){this.xRounder=new p,this.yRounder=new p}round(e,t){return{x:this.xRounder.round(e),y:this.yRounder.round(t)}}}class p{constructor(){this.tree=new a,this.round(0)}round(e){let t=this.tree.add(e),r=this.tree.prev(t);if(null!==r&&0===h(t.key,r.key))return this.tree.remove(e),r.key;let n=this.tree.next(t);return null!==n&&0===h(t.key,n.key)?(this.tree.remove(e),n.key):e}}let f=new d,g=(3+8881784197001252e-31)*11102230246251565e-32;function m(e,t,r,n,i){let o,a,s,l;let u=t[0],c=n[0],h=0,d=0;c>u==c>-u?(o=u,u=t[++h]):(o=c,c=n[++d]);let p=0;if(h<e&&d<r)for(c>u==c>-u?(a=u+o,s=o-(a-u),u=t[++h]):(a=c+o,s=o-(a-c),c=n[++d]),o=a,0!==s&&(i[p++]=s);h<e&&d<r;)c>u==c>-u?(l=(a=o+u)-o,s=o-(a-l)+(u-l),u=t[++h]):(l=(a=o+c)-o,s=o-(a-l)+(c-l),c=n[++d]),o=a,0!==s&&(i[p++]=s);for(;h<e;)l=(a=o+u)-o,s=o-(a-l)+(u-l),u=t[++h],o=a,0!==s&&(i[p++]=s);for(;d<r;)l=(a=o+c)-o,s=o-(a-l)+(c-l),c=n[++d],o=a,0!==s&&(i[p++]=s);return(0!==o||0===p)&&(i[p++]=o),p}function v(e){return new Float64Array(e)}let y=(3+17763568394002505e-31)*11102230246251565e-32,_=(2+13322676295501878e-31)*11102230246251565e-32,b=(9+7105427357601002e-30)*11102230246251565e-32*11102230246251565e-32,x=v(4),S=v(8),A=v(12),E=v(16),T=v(4),C=(e,t)=>e.x*t.y-e.y*t.x,w=(e,t)=>e.x*t.x+e.y*t.y,L=(e,t,r)=>{let n=function(e,t,r,n,i,o){let a=(t-o)*(r-i),s=(e-i)*(n-o),l=a-s,u=Math.abs(a+s);return Math.abs(l)>=y*u?l:-function(e,t,r,n,i,o,a){let s,l,u,c,h,d,p,f,v,y,C,w,L,M,O,I,P,R;let k=e-i,N=r-i,D=t-o,U=n-o;M=k*U,p=(d=0x8000001*k)-(d-k),f=k-p,v=(d=0x8000001*U)-(d-U),O=f*(y=U-v)-(M-p*v-f*v-p*y),I=D*N,p=(d=0x8000001*D)-(d-D),f=D-p,v=(d=0x8000001*N)-(d-N),C=O-(P=f*(y=N-v)-(I-p*v-f*v-p*y)),h=O-C,x[0]=O-(C+h)+(h-P),h=(w=M+C)-M,C=(L=M-(w-h)+(C-h))-I,h=L-C,x[1]=L-(C+h)+(h-I),h=(R=w+C)-w,x[2]=w-(R-h)+(C-h),x[3]=R;let z=function(e,t){let r=t[0];for(let e=1;e<4;e++)r+=t[e];return r}(0,x),B=_*a;if(z>=B||-z>=B||(h=e-k,s=e-(k+h)+(h-i),h=r-N,u=r-(N+h)+(h-i),h=t-D,l=t-(D+h)+(h-o),h=n-U,c=n-(U+h)+(h-o),0===s&&0===l&&0===u&&0===c)||(B=b*a+g*Math.abs(z),(z+=k*c+U*s-(D*u+N*l))>=B||-z>=B))return z;M=s*U,p=(d=0x8000001*s)-(d-s),f=s-p,v=(d=0x8000001*U)-(d-U),O=f*(y=U-v)-(M-p*v-f*v-p*y),I=l*N,p=(d=0x8000001*l)-(d-l),f=l-p,v=(d=0x8000001*N)-(d-N),C=O-(P=f*(y=N-v)-(I-p*v-f*v-p*y)),h=O-C,T[0]=O-(C+h)+(h-P),h=(w=M+C)-M,C=(L=M-(w-h)+(C-h))-I,h=L-C,T[1]=L-(C+h)+(h-I),h=(R=w+C)-w,T[2]=w-(R-h)+(C-h),T[3]=R;let F=m(4,x,4,T,S);M=k*c,p=(d=0x8000001*k)-(d-k),f=k-p,v=(d=0x8000001*c)-(d-c),O=f*(y=c-v)-(M-p*v-f*v-p*y),I=D*u,p=(d=0x8000001*D)-(d-D),f=D-p,v=(d=0x8000001*u)-(d-u),C=O-(P=f*(y=u-v)-(I-p*v-f*v-p*y)),h=O-C,T[0]=O-(C+h)+(h-P),h=(w=M+C)-M,C=(L=M-(w-h)+(C-h))-I,h=L-C,T[1]=L-(C+h)+(h-I),h=(R=w+C)-w,T[2]=w-(R-h)+(C-h),T[3]=R;let j=m(F,S,4,T,A);M=s*c,p=(d=0x8000001*s)-(d-s),f=s-p,v=(d=0x8000001*c)-(d-c),O=f*(y=c-v)-(M-p*v-f*v-p*y),I=l*u,p=(d=0x8000001*l)-(d-l),f=l-p,v=(d=0x8000001*u)-(d-u),C=O-(P=f*(y=u-v)-(I-p*v-f*v-p*y)),h=O-C,T[0]=O-(C+h)+(h-P),h=(w=M+C)-M,C=(L=M-(w-h)+(C-h))-I,h=L-C,T[1]=L-(C+h)+(h-I),h=(R=w+C)-w,T[2]=w-(R-h)+(C-h),T[3]=R;let V=m(j,A,4,T,E);return E[V-1]}(e,t,r,n,i,o,u)}(e.x,e.y,t.x,t.y,r.x,r.y);return n>0?-1:n<0?1:0},M=e=>Math.sqrt(w(e,e)),O=(e,t,r)=>{let n={x:t.x-e.x,y:t.y-e.y},i={x:r.x-e.x,y:r.y-e.y};return C(i,n)/M(i)/M(n)},I=(e,t,r)=>{let n={x:t.x-e.x,y:t.y-e.y},i={x:r.x-e.x,y:r.y-e.y};return w(i,n)/M(i)/M(n)},P=(e,t,r)=>0===t.y?null:{x:e.x+t.x/t.y*(r-e.y),y:r},R=(e,t,r)=>0===t.x?null:{x:r,y:e.y+t.y/t.x*(r-e.x)},k=(e,t,r,n)=>{if(0===t.x)return R(r,n,e.x);if(0===n.x)return R(e,t,r.x);if(0===t.y)return P(r,n,e.y);if(0===n.y)return P(e,t,r.y);let i=C(t,n);if(0==i)return null;let o={x:r.x-e.x,y:r.y-e.y},a=C(o,t)/i,s=C(o,n)/i,l=e.x+s*t.x,u=r.x+a*n.x;return{x:(l+u)/2,y:(e.y+s*t.y+(r.y+a*n.y))/2}};class N{static compare(e,t){let r=N.comparePoints(e.point,t.point);return 0!==r?r:(e.point!==t.point&&e.link(t),e.isLeft!==t.isLeft)?e.isLeft?1:-1:U.compare(e.segment,t.segment)}static comparePoints(e,t){return e.x<t.x?-1:e.x>t.x?1:e.y<t.y?-1:e.y>t.y?1:0}constructor(e,t){void 0===e.events?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=t}link(e){if(e.point===this.point)throw Error("Tried to link already linked events");let t=e.point.events;for(let e=0,r=t.length;e<r;e++){let r=t[e];this.point.events.push(r),r.point=this.point}this.checkForConsuming()}checkForConsuming(){let e=this.point.events.length;for(let t=0;t<e;t++){let r=this.point.events[t];if(void 0===r.segment.consumedBy)for(let n=t+1;n<e;n++){let e=this.point.events[n];void 0===e.consumedBy&&r.otherSE.point.events===e.otherSE.point.events&&r.segment.consume(e.segment)}}}getAvailableLinkedEvents(){let e=[];for(let t=0,r=this.point.events.length;t<r;t++){let r=this.point.events[t];r!==this&&!r.segment.ringOut&&r.segment.isInResult()&&e.push(r)}return e}getLeftmostComparator(e){let t=new Map,r=r=>{let n=r.otherSE;t.set(r,{sine:O(this.point,e.point,n.point),cosine:I(this.point,e.point,n.point)})};return(e,n)=>{t.has(e)||r(e),t.has(n)||r(n);let{sine:i,cosine:o}=t.get(e),{sine:a,cosine:s}=t.get(n);return i>=0&&a>=0?o<s?1:o>s?-1:0:i<0&&a<0?o<s?-1:o>s?1:0:a<i?-1:a>i?1:0}}}let D=0;class U{static compare(e,t){let r=e.leftSE.point.x,n=t.leftSE.point.x,i=e.rightSE.point.x,o=t.rightSE.point.x;if(o<r)return 1;if(i<n)return -1;let a=e.leftSE.point.y,s=t.leftSE.point.y,l=e.rightSE.point.y,u=t.rightSE.point.y;if(r<n){if(s<a&&s<l)return 1;if(s>a&&s>l)return -1;let r=e.comparePoint(t.leftSE.point);if(r<0)return 1;if(r>0)return -1;let n=t.comparePoint(e.rightSE.point);return 0!==n?n:-1}if(r>n){if(a<s&&a<u)return -1;if(a>s&&a>u)return 1;let r=t.comparePoint(e.leftSE.point);if(0!==r)return r;let n=e.comparePoint(t.rightSE.point);return n<0?1:n>0?-1:1}if(a<s)return -1;if(a>s)return 1;if(i<o){let r=t.comparePoint(e.rightSE.point);if(0!==r)return r}if(i>o){let r=e.comparePoint(t.rightSE.point);if(r<0)return 1;if(r>0)return -1}if(i!==o){let e=l-a,t=i-r,c=u-s,h=o-n;if(e>t&&c<h)return 1;if(e<t&&c>h)return -1}return i>o?1:i<o||l<u?-1:l>u?1:e.id<t.id?-1:e.id>t.id?1:0}constructor(e,t,r,n){this.id=++D,this.leftSE=e,e.segment=this,e.otherSE=t,this.rightSE=t,t.segment=this,t.otherSE=e,this.rings=r,this.windings=n}static fromRing(e,t,r){let n,i,o;let a=N.comparePoints(e,t);if(a<0)n=e,i=t,o=1;else if(a>0)n=t,i=e,o=-1;else throw Error(`Tried to create degenerate segment at [${e.x}, ${e.y}]`);return new U(new N(n,!0),new N(i,!1),[r],[o])}replaceRightSE(e){this.rightSE=e,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){let e=this.leftSE.point.y,t=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:e<t?e:t},ur:{x:this.rightSE.point.x,y:e>t?e:t}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(e){return e.x===this.leftSE.point.x&&e.y===this.leftSE.point.y||e.x===this.rightSE.point.x&&e.y===this.rightSE.point.y}comparePoint(e){if(this.isAnEndpoint(e))return 0;let t=this.leftSE.point,r=this.rightSE.point,n=this.vector();if(t.x===r.x)return e.x===t.x?0:e.x<t.x?1:-1;let i=(e.y-t.y)/n.y,o=t.x+i*n.x;if(e.x===o)return 0;let a=(e.x-t.x)/n.x,s=t.y+a*n.y;return e.y===s?0:e.y<s?-1:1}getIntersection(e){let t=this.bbox(),r=e.bbox(),n=l(t,r);if(null===n)return null;let i=this.leftSE.point,o=this.rightSE.point,a=e.leftSE.point,u=e.rightSE.point,c=s(t,a)&&0===this.comparePoint(a),h=s(r,i)&&0===e.comparePoint(i),d=s(t,u)&&0===this.comparePoint(u),p=s(r,o)&&0===e.comparePoint(o);if(h&&c)return p&&!d?o:!p&&d?u:null;if(h)return d&&i.x===u.x&&i.y===u.y?null:i;if(c)return p&&o.x===a.x&&o.y===a.y?null:a;if(p&&d)return null;if(p)return o;if(d)return u;let g=k(i,this.vector(),a,e.vector());return null!==g&&s(n,g)?f.round(g.x,g.y):null}split(e){let t=[],r=void 0!==e.events,n=new N(e,!0),i=new N(e,!1),o=this.rightSE;this.replaceRightSE(i),t.push(i),t.push(n);let a=new U(n,o,this.rings.slice(),this.windings.slice());return N.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),N.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),r&&(n.checkForConsuming(),i.checkForConsuming()),t}swapEvents(){let e=this.rightSE;this.rightSE=this.leftSE,this.leftSE=e,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let e=0,t=this.windings.length;e<t;e++)this.windings[e]*=-1}consume(e){let t=this,r=e;for(;t.consumedBy;)t=t.consumedBy;for(;r.consumedBy;)r=r.consumedBy;let n=U.compare(t,r);if(0!==n){if(n>0||t.prev===r){let e=t;t=r,r=e}for(let e=0,n=r.rings.length;e<n;e++){let n=r.rings[e],i=r.windings[e],o=t.rings.indexOf(n);-1===o?(t.rings.push(n),t.windings.push(i)):t.windings[o]+=i}r.rings=null,r.windings=null,r.consumedBy=t,r.leftSE.consumedBy=t.leftSE,r.rightSE.consumedBy=t.rightSE}}prevInResult(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}beforeState(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){let e=this.prev.consumedBy||this.prev;this._beforeState=e.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}afterState(){if(void 0!==this._afterState)return this._afterState;let e=this.beforeState();this._afterState={rings:e.rings.slice(0),windings:e.windings.slice(0),multiPolys:[]};let t=this._afterState.rings,r=this._afterState.windings,n=this._afterState.multiPolys;for(let e=0,n=this.rings.length;e<n;e++){let n=this.rings[e],i=this.windings[e],o=t.indexOf(n);-1===o?(t.push(n),r.push(i)):r[o]+=i}let i=[],o=[];for(let e=0,n=t.length;e<n;e++){if(0===r[e])continue;let n=t[e],a=n.poly;if(-1===o.indexOf(a)){if(n.isExterior)i.push(a);else{-1===o.indexOf(a)&&o.push(a);let e=i.indexOf(n.poly);-1!==e&&i.splice(e,1)}}}for(let e=0,t=i.length;e<t;e++){let t=i[e].multiPoly;-1===n.indexOf(t)&&n.push(t)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;let e=this.beforeState().multiPolys,t=this.afterState().multiPolys;switch(Z.type){case"union":{let r=0===e.length,n=0===t.length;this._isInResult=r!==n;break}case"intersection":{let r,n;e.length<t.length?(r=e.length,n=t.length):(r=t.length,n=e.length),this._isInResult=n===Z.numMultiPolys&&r<n;break}case"xor":{let r=Math.abs(e.length-t.length);this._isInResult=r%2==1;break}case"difference":this._isInResult=(1===e.length&&e[0].isSubject)!==(1===t.length&&t[0].isSubject);break;default:throw Error(`Unrecognized operation type found ${Z.type}`)}return this._isInResult}}class z{constructor(e,t,r){if(!Array.isArray(e)||0===e.length||(this.poly=t,this.isExterior=r,this.segments=[],"number"!=typeof e[0][0]||"number"!=typeof e[0][1]))throw Error("Input geometry is not a valid Polygon or MultiPolygon");let n=f.round(e[0][0],e[0][1]);this.bbox={ll:{x:n.x,y:n.y},ur:{x:n.x,y:n.y}};let i=n;for(let t=1,r=e.length;t<r;t++){if("number"!=typeof e[t][0]||"number"!=typeof e[t][1])throw Error("Input geometry is not a valid Polygon or MultiPolygon");let r=f.round(e[t][0],e[t][1]);(r.x!==i.x||r.y!==i.y)&&(this.segments.push(U.fromRing(i,r,this)),r.x<this.bbox.ll.x&&(this.bbox.ll.x=r.x),r.y<this.bbox.ll.y&&(this.bbox.ll.y=r.y),r.x>this.bbox.ur.x&&(this.bbox.ur.x=r.x),r.y>this.bbox.ur.y&&(this.bbox.ur.y=r.y),i=r)}(n.x!==i.x||n.y!==i.y)&&this.segments.push(U.fromRing(i,n,this))}getSweepEvents(){let e=[];for(let t=0,r=this.segments.length;t<r;t++){let r=this.segments[t];e.push(r.leftSE),e.push(r.rightSE)}return e}}class B{constructor(e,t){if(!Array.isArray(e))throw Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new z(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let t=1,r=e.length;t<r;t++){let r=new z(e[t],this,!1);r.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=r.bbox.ll.x),r.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=r.bbox.ll.y),r.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=r.bbox.ur.x),r.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=r.bbox.ur.y),this.interiorRings.push(r)}this.multiPoly=t}getSweepEvents(){let e=this.exteriorRing.getSweepEvents();for(let t=0,r=this.interiorRings.length;t<r;t++){let r=this.interiorRings[t].getSweepEvents();for(let t=0,n=r.length;t<n;t++)e.push(r[t])}return e}}class F{constructor(e,t){if(!Array.isArray(e))throw Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof e[0][0][0]&&(e=[e])}catch(e){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let t=0,r=e.length;t<r;t++){let r=new B(e[t],this);r.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=r.bbox.ll.x),r.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=r.bbox.ll.y),r.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=r.bbox.ur.x),r.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=r.bbox.ur.y),this.polys.push(r)}this.isSubject=t}getSweepEvents(){let e=[];for(let t=0,r=this.polys.length;t<r;t++){let r=this.polys[t].getSweepEvents();for(let t=0,n=r.length;t<n;t++)e.push(r[t])}return e}}class j{static factory(e){let t=[];for(let r=0,n=e.length;r<n;r++){let n=e[r];if(!n.isInResult()||n.ringOut)continue;let i=null,o=n.leftSE,a=n.rightSE,s=[o],l=o.point,u=[];for(;i=o,o=a,s.push(o),o.point!==l;)for(;;){let e=o.getAvailableLinkedEvents();if(0===e.length){let e=s[0].point,t=s[s.length-1].point;throw Error(`Unable to complete output ring starting at [${e.x}, ${e.y}]. Last matching segment found ends at [${t.x}, ${t.y}].`)}if(1===e.length){a=e[0].otherSE;break}let r=null;for(let e=0,t=u.length;e<t;e++)if(u[e].point===o.point){r=e;break}if(null!==r){let e=u.splice(r)[0],n=s.splice(e.index);n.unshift(n[0].otherSE),t.push(new j(n.reverse()));continue}u.push({index:s.length,point:o.point});let n=o.getLeftmostComparator(i);a=e.sort(n)[0].otherSE;break}t.push(new j(s))}return t}constructor(e){this.events=e;for(let t=0,r=e.length;t<r;t++)e[t].segment.ringOut=this;this.poly=null}getGeom(){let e=this.events[0].point,t=[e];for(let r=1,n=this.events.length-1;r<n;r++){let n=this.events[r].point;0!==L(n,e,this.events[r+1].point)&&(t.push(n),e=n)}if(1===t.length)return null;0===L(t[0],e,t[1])&&t.shift(),t.push(t[0]);let r=this.isExteriorRing()?1:-1,n=this.isExteriorRing()?0:t.length-1,i=this.isExteriorRing()?t.length:-1,o=[];for(let e=n;e!=i;e+=r)o.push([t[e].x,t[e].y]);return o}isExteriorRing(){if(void 0===this._isExteriorRing){let e=this.enclosingRing();this._isExteriorRing=!e||!e.isExteriorRing()}return this._isExteriorRing}enclosingRing(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let e=this.events[0];for(let t=1,r=this.events.length;t<r;t++){let r=this.events[t];N.compare(e,r)>0&&(e=r)}let t=e.segment.prevInResult(),r=t?t.prevInResult():null;for(;;){if(!t)return null;if(!r)return t.ringOut;if(r.ringOut!==t.ringOut){if(r.ringOut.enclosingRing()!==t.ringOut)return t.ringOut;return t.ringOut.enclosingRing()}r=(t=r.prevInResult())?t.prevInResult():null}}}class V{constructor(e){this.exteriorRing=e,e.poly=this,this.interiorRings=[]}addInterior(e){this.interiorRings.push(e),e.poly=this}getGeom(){let e=[this.exteriorRing.getGeom()];if(null===e[0])return null;for(let t=0,r=this.interiorRings.length;t<r;t++){let r=this.interiorRings[t].getGeom();null!==r&&e.push(r)}return e}}class H{constructor(e){this.rings=e,this.polys=this._composePolys(e)}getGeom(){let e=[];for(let t=0,r=this.polys.length;t<r;t++){let r=this.polys[t].getGeom();null!==r&&e.push(r)}return e}_composePolys(e){let t=[];for(let r=0,n=e.length;r<n;r++){let n=e[r];if(!n.poly){if(n.isExteriorRing())t.push(new V(n));else{let e=n.enclosingRing();e.poly||t.push(new V(e)),e.poly.addInterior(n)}}}return t}}class G{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:U.compare;this.queue=e,this.tree=new a(t),this.segments=[]}process(e){let t,r;let n=e.segment,i=[];if(e.consumedBy)return e.isLeft?this.queue.remove(e.otherSE):this.tree.remove(n),i;let o=e.isLeft?this.tree.add(n):this.tree.find(n);if(!o)throw Error(`Unable to find segment #${n.id} [${n.leftSE.point.x}, ${n.leftSE.point.y}] -> [${n.rightSE.point.x}, ${n.rightSE.point.y}] in SweepLine tree.`);let a=o,s=o;for(;void 0===t;)null===(a=this.tree.prev(a))?t=null:void 0===a.key.consumedBy&&(t=a.key);for(;void 0===r;)null===(s=this.tree.next(s))?r=null:void 0===s.key.consumedBy&&(r=s.key);if(e.isLeft){let o=null;if(t){let e=t.getIntersection(n);if(null!==e&&(n.isAnEndpoint(e)||(o=e),!t.isAnEndpoint(e))){let r=this._splitSafely(t,e);for(let e=0,t=r.length;e<t;e++)i.push(r[e])}}let a=null;if(r){let e=r.getIntersection(n);if(null!==e&&(n.isAnEndpoint(e)||(a=e),!r.isAnEndpoint(e))){let t=this._splitSafely(r,e);for(let e=0,r=t.length;e<r;e++)i.push(t[e])}}if(null!==o||null!==a){let e=null;e=null===o?a:null===a?o:0>=N.comparePoints(o,a)?o:a,this.queue.remove(n.rightSE),i.push(n.rightSE);let t=n.split(e);for(let e=0,r=t.length;e<r;e++)i.push(t[e])}i.length>0?(this.tree.remove(n),i.push(e)):(this.segments.push(n),n.prev=t)}else{if(t&&r){let e=t.getIntersection(r);if(null!==e){if(!t.isAnEndpoint(e)){let r=this._splitSafely(t,e);for(let e=0,t=r.length;e<t;e++)i.push(r[e])}if(!r.isAnEndpoint(e)){let t=this._splitSafely(r,e);for(let e=0,r=t.length;e<r;e++)i.push(t[e])}}}this.tree.remove(n)}return i}_splitSafely(e,t){this.tree.remove(e);let r=e.rightSE;this.queue.remove(r);let n=e.split(t);return n.push(r),void 0===e.consumedBy&&this.tree.add(e),n}}let W=void 0!==i&&i.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,X=void 0!==i&&i.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6;class ${run(e,t,r){Z.type=e,f.reset();let n=[new F(t,!0)];for(let e=0,t=r.length;e<t;e++)n.push(new F(r[e],!1));if(Z.numMultiPolys=n.length,"difference"===Z.type){let e=n[0],t=1;for(;t<n.length;)null!==l(n[t].bbox,e.bbox)?t++:n.splice(t,1)}if("intersection"===Z.type)for(let e=0,t=n.length;e<t;e++){let t=n[e];for(let r=e+1,i=n.length;r<i;r++)if(null===l(t.bbox,n[r].bbox))return[]}let i=new a(N.compare);for(let e=0,t=n.length;e<t;e++){let t=n[e].getSweepEvents();for(let e=0,r=t.length;e<r;e++)if(i.insert(t[e]),i.size>W)throw Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}let o=new G(i),s=i.size,u=i.pop();for(;u;){let e=u.key;if(i.size===s){let t=e.segment;throw Error(`Unable to pop() ${e.isLeft?"left":"right"} SweepEvent [${e.point.x}, ${e.point.y}] from segment #${t.id} [${t.leftSE.point.x}, ${t.leftSE.point.y}] -> [${t.rightSE.point.x}, ${t.rightSE.point.y}] from queue.`)}if(i.size>W)throw Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(o.segments.length>X)throw Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");let t=o.process(e);for(let e=0,r=t.length;e<r;e++){let r=t[e];void 0===r.consumedBy&&i.insert(r)}s=i.size,u=i.pop()}return f.reset(),new H(j.factory(o.segments)).getGeom()}}let Z=new $;return{union:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Z.run("union",e,r)},intersection:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Z.run("intersection",e,r)},xor:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Z.run("xor",e,r)},difference:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Z.run("difference",e,r)}}},e.exports=n()},30333:(e,t)=>{"use strict";var r="function"==typeof Symbol&&Symbol.for,n=r?Symbol.for("react.element"):60103,i=r?Symbol.for("react.portal"):60106,o=r?Symbol.for("react.fragment"):60107,a=r?Symbol.for("react.strict_mode"):60108,s=r?Symbol.for("react.profiler"):60114,l=r?Symbol.for("react.provider"):60109,u=r?Symbol.for("react.context"):60110,c=r?Symbol.for("react.async_mode"):60111,h=r?Symbol.for("react.concurrent_mode"):60111,d=r?Symbol.for("react.forward_ref"):60112,p=r?Symbol.for("react.suspense"):60113,f=r?Symbol.for("react.suspense_list"):60120,g=r?Symbol.for("react.memo"):60115,m=r?Symbol.for("react.lazy"):60116,v=r?Symbol.for("react.block"):60121,y=r?Symbol.for("react.fundamental"):60117,_=r?Symbol.for("react.responder"):60118,b=r?Symbol.for("react.scope"):60119;function x(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case c:case h:case o:case s:case a:case p:return e;default:switch(e=e&&e.$$typeof){case u:case d:case m:case g:case l:return e;default:return t}}case i:return t}}}function S(e){return x(e)===h}t.AsyncMode=c,t.ConcurrentMode=h,t.ContextConsumer=u,t.ContextProvider=l,t.Element=n,t.ForwardRef=d,t.Fragment=o,t.Lazy=m,t.Memo=g,t.Portal=i,t.Profiler=s,t.StrictMode=a,t.Suspense=p,t.isAsyncMode=function(e){return S(e)||x(e)===c},t.isConcurrentMode=S,t.isContextConsumer=function(e){return x(e)===u},t.isContextProvider=function(e){return x(e)===l},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n},t.isForwardRef=function(e){return x(e)===d},t.isFragment=function(e){return x(e)===o},t.isLazy=function(e){return x(e)===m},t.isMemo=function(e){return x(e)===g},t.isPortal=function(e){return x(e)===i},t.isProfiler=function(e){return x(e)===s},t.isStrictMode=function(e){return x(e)===a},t.isSuspense=function(e){return x(e)===p},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===o||e===h||e===s||e===a||e===p||e===f||"object"==typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===g||e.$$typeof===l||e.$$typeof===u||e.$$typeof===d||e.$$typeof===y||e.$$typeof===_||e.$$typeof===b||e.$$typeof===v)},t.typeOf=x},92281:(e,t,r)=>{"use strict";e.exports=r(30333)},43464:function(e){var t;t=function(){"use strict";function e(e,r,n,i){t(e,n,i),t(r,2*n,2*i),t(r,2*n+1,2*i+1)}function t(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function r(e,t,r,n){var i=e-r,o=t-n;return i*i+o*o}var n,i=function(e){return e[0]},o=function(e){return e[1]},a=function(t,r,n,a,s){void 0===r&&(r=i),void 0===n&&(n=o),void 0===a&&(a=64),void 0===s&&(s=Float64Array),this.nodeSize=a,this.points=t;for(var l=t.length<65536?Uint16Array:Uint32Array,u=this.ids=new l(t.length),c=this.coords=new s(2*t.length),h=0;h<t.length;h++)u[h]=h,c[2*h]=r(t[h]),c[2*h+1]=n(t[h]);!function t(r,n,i,o,a,s){if(!(a-o<=i)){var l=o+a>>1;(function t(r,n,i,o,a,s){for(;a>o;){if(a-o>600){var l=a-o+1,u=i-o+1,c=Math.log(l),h=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*h*(l-h)/l)*(u-l/2<0?-1:1),p=Math.max(o,Math.floor(i-u*h/l+d)),f=Math.min(a,Math.floor(i+(l-u)*h/l+d));t(r,n,i,p,f,s)}var g=n[2*i+s],m=o,v=a;for(e(r,n,o,i),n[2*a+s]>g&&e(r,n,o,a);m<v;){for(e(r,n,m,v),m++,v--;n[2*m+s]<g;)m++;for(;n[2*v+s]>g;)v--}n[2*o+s]===g?e(r,n,o,v):e(r,n,++v,a),v<=i&&(o=v+1),i<=v&&(a=v-1)}})(r,n,l,o,a,s%2),t(r,n,i,o,l-1,s+1),t(r,n,i,l+1,a,s+1)}}(u,c,a,0,u.length-1,0)};a.prototype.range=function(e,t,r,n){return function(e,t,r,n,i,o,a){for(var s,l,u=[0,e.length-1,0],c=[];u.length;){var h=u.pop(),d=u.pop(),p=u.pop();if(d-p<=a){for(var f=p;f<=d;f++)s=t[2*f],l=t[2*f+1],s>=r&&s<=i&&l>=n&&l<=o&&c.push(e[f]);continue}var g=Math.floor((p+d)/2);s=t[2*g],l=t[2*g+1],s>=r&&s<=i&&l>=n&&l<=o&&c.push(e[g]);var m=(h+1)%2;(0===h?r<=s:n<=l)&&(u.push(p),u.push(g-1),u.push(m)),(0===h?i>=s:o>=l)&&(u.push(g+1),u.push(d),u.push(m))}return c}(this.ids,this.coords,e,t,r,n,this.nodeSize)},a.prototype.within=function(e,t,n){return function(e,t,n,i,o,a){for(var s=[0,e.length-1,0],l=[],u=o*o;s.length;){var c=s.pop(),h=s.pop(),d=s.pop();if(h-d<=a){for(var p=d;p<=h;p++)r(t[2*p],t[2*p+1],n,i)<=u&&l.push(e[p]);continue}var f=Math.floor((d+h)/2),g=t[2*f],m=t[2*f+1];r(g,m,n,i)<=u&&l.push(e[f]);var v=(c+1)%2;(0===c?n-o<=g:i-o<=m)&&(s.push(d),s.push(f-1),s.push(v)),(0===c?n+o>=g:i+o>=m)&&(s.push(f+1),s.push(h),s.push(v))}return l}(this.ids,this.coords,e,t,n,this.nodeSize)};var s={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(e){return e}},l=Math.fround||(n=new Float32Array(1),function(e){return n[0]=+e,n[0]}),u=function(e){this.options=f(Object.create(s),e),this.trees=Array(this.options.maxZoom+1)};function c(e){return{type:"Feature",id:e.id,properties:h(e),geometry:{type:"Point",coordinates:[(e.x-.5)*360,360*Math.atan(Math.exp((180-360*e.y)*Math.PI/180))/Math.PI-90]}}}function h(e){var t=e.numPoints,r=t>=1e4?Math.round(t/1e3)+"k":t>=1e3?Math.round(t/100)/10+"k":t;return f(f({},e.properties),{cluster:!0,cluster_id:e.id,point_count:t,point_count_abbreviated:r})}function d(e){return e/360+.5}function p(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function f(e,t){for(var r in t)e[r]=t[r];return e}function g(e){return e.x}function m(e){return e.y}return u.prototype.load=function(e){var t=this.options,r=t.log,n=t.minZoom,i=t.maxZoom,o=t.nodeSize;r&&console.time("total time");var s="prepare "+e.length+" points";r&&console.time(s),this.points=e;for(var u=[],c=0;c<e.length;c++)e[c].geometry&&u.push(function(e,t){var r=e.geometry.coordinates,n=r[0],i=r[1];return{x:l(d(n)),y:l(p(i)),zoom:1/0,index:t,parentId:-1}}(e[c],c));this.trees[i+1]=new a(u,g,m,o,Float32Array),r&&console.timeEnd(s);for(var h=i;h>=n;h--){var f=+Date.now();u=this._cluster(u,h),this.trees[h]=new a(u,g,m,o,Float32Array),r&&console.log("z%d: %d clusters in %dms",h,u.length,+Date.now()-f)}return r&&console.timeEnd("total time"),this},u.prototype.getClusters=function(e,t){var r=((e[0]+180)%360+360)%360-180,n=Math.max(-90,Math.min(90,e[1])),i=180===e[2]?180:((e[2]+180)%360+360)%360-180,o=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)r=-180,i=180;else if(r>i){var a=this.getClusters([r,n,180,o],t),s=this.getClusters([-180,n,i,o],t);return a.concat(s)}for(var l=this.trees[this._limitZoom(t)],u=l.range(d(r),p(o),d(i),p(n)),h=[],f=0;f<u.length;f+=1){var g=u[f],m=l.points[g];h.push(m.numPoints?c(m):this.points[m.index])}return h},u.prototype.getChildren=function(e){var t=this._getOriginId(e),r=this._getOriginZoom(e),n="No cluster with the specified id.",i=this.trees[r];if(!i)throw Error(n);var o=i.points[t];if(!o)throw Error(n);for(var a=this.options.radius/(this.options.extent*Math.pow(2,r-1)),s=i.within(o.x,o.y,a),l=[],u=0;u<s.length;u+=1){var h=s[u],d=i.points[h];d.parentId===e&&l.push(d.numPoints?c(d):this.points[d.index])}if(0===l.length)throw Error(n);return l},u.prototype.getLeaves=function(e,t,r){t=t||10,r=r||0;var n=[];return this._appendLeaves(n,e,t,r,0),n},u.prototype.getTile=function(e,t,r){var n=this.trees[this._limitZoom(e)],i=Math.pow(2,e),o=this.options,a=o.extent,s=o.radius/a,l=(r-s)/i,u=(r+1+s)/i,c={features:[]};return this._addTileFeatures(n.range((t-s)/i,l,(t+1+s)/i,u),n.points,t,r,i,c),0===t&&this._addTileFeatures(n.range(1-s/i,l,1,u),n.points,i,r,i,c),t===i-1&&this._addTileFeatures(n.range(0,l,s/i,u),n.points,-1,r,i,c),c.features.length?c:null},u.prototype.getClusterExpansionZoom=function(e){for(var t=this._getOriginZoom(e)-1;t<=this.options.maxZoom;){var r=this.getChildren(e);if(t++,1!==r.length)break;e=r[0].properties.cluster_id}return t},u.prototype._appendLeaves=function(e,t,r,n,i){for(var o=this.getChildren(t),a=0;a<o.length;a+=1){var s=o[a],l=s.properties;if(l&&l.cluster?i+l.point_count<=n?i+=l.point_count:i=this._appendLeaves(e,l.cluster_id,r,n,i):i<n?i++:e.push(s),e.length===r)break}return i},u.prototype._addTileFeatures=function(e,t,r,n,i,o){for(var a=0;a<e.length;a+=1){var s=t[e[a]],l=s.numPoints,u=void 0,c=void 0,f=void 0;if(l)u=h(s),c=s.x,f=s.y;else{var g=this.points[s.index];u=g.properties,c=d(g.geometry.coordinates[0]),f=p(g.geometry.coordinates[1])}var m={type:1,geometry:[[Math.round(this.options.extent*(c*i-r)),Math.round(this.options.extent*(f*i-n))]],tags:u},v=void 0;l?v=s.id:this.options.generateId?v=s.index:this.points[s.index].id&&(v=this.points[s.index].id),void 0!==v&&(m.id=v),o.features.push(m)}},u.prototype._limitZoom=function(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))},u.prototype._cluster=function(e,t){for(var r=[],n=this.options,i=n.radius,o=n.extent,a=n.reduce,s=n.minPoints,u=i/(o*Math.pow(2,t)),c=0;c<e.length;c++){var h=e[c];if(!(h.zoom<=t)){h.zoom=t;for(var d=this.trees[t+1],p=d.within(h.x,h.y,u),f=h.numPoints||1,g=f,m=0;m<p.length;m+=1){var v=p[m],y=d.points[v];y.zoom>t&&(g+=y.numPoints||1)}if(g>f&&g>=s){for(var _,b,x,S,A=h.x*f,E=h.y*f,T=a&&f>1?this._map(h,!0):null,C=(c<<5)+(t+1)+this.points.length,w=0;w<p.length;w+=1){var L=p[w],M=d.points[L];if(!(M.zoom<=t)){M.zoom=t;var O=M.numPoints||1;A+=M.x*O,E+=M.y*O,M.parentId=C,a&&(T||(T=this._map(h,!0)),a(T,this._map(M)))}}h.parentId=C,r.push((_=A/g,b=E/g,x=g,S=T,{x:l(_),y:l(b),zoom:1/0,id:C,parentId:-1,numPoints:x,properties:S}))}else if(r.push(h),g>1)for(var I=0;I<p.length;I+=1){var P=p[I],R=d.points[P];R.zoom<=t||(R.zoom=t,r.push(R))}}}return r},u.prototype._getOriginId=function(e){return e-this.points.length>>5},u.prototype._getOriginZoom=function(e){return(e-this.points.length)%32},u.prototype._map=function(e,t){if(e.numPoints)return t?f({},e.properties):e.properties;var r=this.points[e.index].properties,n=this.options.map(r);return t&&n===r?f({},n):n},u},e.exports=t()},44722:(e,t,r)=>{"use strict";function n(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}r.d(t,{A:()=>n})},20859:(e,t,r)=>{"use strict";function n(){return(n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(null,arguments)}r.d(t,{A:()=>n})},46364:(e,t,r)=>{"use strict";function n(e,t){if(null==e)return{};var r={};for(var n in e)if(({}).hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}r.d(t,{A:()=>n})},64365:(e,t,r)=>{"use strict";function n(e,t){return(n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}r.d(t,{A:()=>n})},64927:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=function(){for(var e,t,r=0,n="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=function e(t){var r,n,i="";if("string"==typeof t||"number"==typeof t)i+=t;else if("object"==typeof t){if(Array.isArray(t)){var o=t.length;for(r=0;r<o;r++)t[r]&&(n=e(t[r]))&&(i&&(i+=" "),i+=n)}else for(n in t)t[n]&&(i&&(i+=" "),i+=n)}return i}(e))&&(n&&(n+=" "),n+=t);return n}},98388:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=r(83029)},21567:(e,t,r)=>{"use strict";r.d(t,{Kq:()=>s,Pj:()=>a,Xr:()=>f,fp:()=>g,md:()=>p});var n=r(25316),i=r(94779);let o=(0,n.createContext)(void 0),a=e=>{let t=(0,n.useContext)(o);return(null==e?void 0:e.store)||t||(0,i.zp)()},s=e=>{let{children:t,store:r}=e,a=(0,n.useRef)();return r||a.current||(a.current=(0,i.y$)()),(0,n.createElement)(o.Provider,{value:r||a.current},t)},l=e=>"function"==typeof(null==e?void 0:e.then),u=e=>{e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t})},c=n.use||(e=>{if("pending"===e.status)throw e;if("fulfilled"===e.status)return e.value;if("rejected"===e.status)throw e.reason;throw u(e),e}),h=new WeakMap,d=e=>{let t=h.get(e);return t||(t=new Promise((r,n)=>{let i=e,o=e=>t=>{i===e&&r(t)},a=e=>t=>{i===e&&n(t)},s=e=>{"onCancel"in e&&"function"==typeof e.onCancel&&e.onCancel(n=>{if(n===e)throw Error("[Bug] p is not updated even after cancelation");l(n)?(h.set(n,t),i=n,n.then(o(n),a(n)),s(n)):r(n)})};e.then(o(e),a(e)),s(e)}),h.set(e,t)),t};function p(e,t){let r=a(t),[[i,o,s],h]=(0,n.useReducer)(t=>{let n=r.get(e);return Object.is(t[0],n)&&t[1]===r&&t[2]===e?t:[n,r,e]},void 0,()=>[r.get(e),r,e]),p=i;(o!==r||s!==e)&&(h(),p=r.get(e));let f=null==t?void 0:t.delay;return((0,n.useEffect)(()=>{let t=r.sub(e,()=>{if("number"==typeof f){let t=r.get(e);l(t)&&u(d(t)),setTimeout(h,f);return}h()});return h(),t},[r,e,f]),(0,n.useDebugValue)(p),l(p))?c(d(p)):p}function f(e,t){let r=a(t);return(0,n.useCallback)(function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];if(!("write"in e))throw Error("not writable atom");return r.set(e,...n)},[r,e])}function g(e,t){return[p(e,t),f(e,t)]}},94779:(e,t,r)=>{"use strict";let n;r.d(t,{eU:()=>o,y$:()=>w,zp:()=>L});let i=0;function o(e,t){let r=`atom${++i}`,n={toString(){return this.debugLabel?r+":"+this.debugLabel:r}};return"function"==typeof e?n.read=e:(n.init=e,n.read=a,n.write=s),t&&(n.write=t),n}function a(e){return e(this)}function s(e,t,r){return t(this,"function"==typeof r?r(e(this)):r)}let l=(e,t)=>e.unstable_is?e.unstable_is(t):t===e,u=e=>"init"in e,c=e=>!!e.write,h=new WeakMap,d=e=>{var t;return g(e)&&!(null==(t=h.get(e))?void 0:t[1])},p=(e,t)=>{let r=h.get(e);if(r)r[1]=!0,r[0].forEach(e=>e(t));else throw Error("[Bug] cancelable promise not found")},f=e=>{if(h.has(e))return;let t=[new Set,!1];h.set(e,t);let r=()=>{t[1]=!0};e.then(r,r),e.onCancel=e=>{t[0].add(e)}},g=e=>"function"==typeof(null==e?void 0:e.then),m=e=>"v"in e||"e"in e,v=e=>{if("e"in e)throw e.e;if(!("v"in e))throw Error("[Bug] atom state is not initialized");return e.v},y=(e,t,r)=>{r.p.has(e)||(r.p.add(e),t.then(()=>{r.p.delete(e)},()=>{r.p.delete(e)}))},_=(e,t,r,n,i)=>{var o;if(n===t)throw Error("[Bug] atom cannot depend on itself");r.d.set(n,i.n),d(r.v)&&y(t,r.v,i),null==(o=i.m)||o.t.add(t),e&&S(e,n,t)},b=()=>[new Map,new Map,new Set],x=(e,t,r)=>{e[0].has(t)||e[0].set(t,new Set),e[1].set(t,r)},S=(e,t,r)=>{let n=e[0].get(t);n&&n.add(r)},A=(e,t)=>e[0].get(t),E=(e,t)=>{e[2].add(t)},T=e=>{for(;e[1].size||e[2].size;){e[0].clear();let t=new Set(e[1].values());e[1].clear();let r=new Set(e[2]);e[2].clear(),t.forEach(e=>{var t;return null==(t=e.m)?void 0:t.l.forEach(e=>e())}),r.forEach(e=>e())}},C=e=>{let t;t=new Set;let r=(t,r,n)=>{let i="v"in r,o=r.v,a=d(r.v)?r.v:null;if(g(n)){for(let i of(f(n),r.d.keys()))y(t,n,e(i,r));r.v=n,delete r.e}else r.v=n,delete r.e;i&&Object.is(o,r.v)||(++r.n,a&&p(a,n))},n=(t,i,o,a)=>{var d;let p,f;if(m(o)&&(o.m&&!(null==a?void 0:a.has(i))||Array.from(o.d).every(([r,i])=>n(t,r,e(r,o),a).n===i)))return o;o.d.clear();let y=!0;try{let x=i.read(s=>{if(l(i,s)){let t=e(s,o);if(!m(t)){if(u(s))r(s,t,s.init);else throw Error("no atom init")}return v(t)}let c=n(t,s,e(s,o),a);if(y)_(t,i,o,s,c);else{let e=b();_(e,i,o,s,c),h(e,i,o),T(e)}return v(c)},{get signal(){return p||(p=new AbortController),p.signal},get setSelf(){return c(i)||console.warn("setSelf function cannot be used with read-only atom"),!f&&c(i)&&(f=(...e)=>{if(y&&console.warn("setSelf function cannot be called in sync"),!y)return s(i,...e)}),f}});if(r(i,o,x),g(x)){null==(d=x.onCancel)||d.call(x,()=>null==p?void 0:p.abort());let e=()=>{if(o.m){let e=b();h(e,i,o),T(e)}};x.then(e,e)}return o}catch(e){return delete o.v,o.e=e,++o.n,o}finally{y=!1}},i=(t,r,n)=>{var i,o;let a=new Map;for(let t of(null==(i=n.m)?void 0:i.t)||[])a.set(t,e(t,n));for(let t of n.p)a.set(t,e(t,n));return null==(o=A(t,r))||o.forEach(t=>{a.set(t,e(t,n))}),a},o=(e,t,r)=>{let o=[],a=new Set,s=(t,r)=>{if(!a.has(t)){for(let[n,o]of(a.add(t),i(e,t,r)))t!==n&&s(n,o);o.push([t,r,r.n])}};s(t,r);let l=new Set([t]);for(let t=o.length-1;t>=0;--t){let[r,i,s]=o[t],u=!1;for(let e of i.d.keys())if(e!==r&&l.has(e)){u=!0;break}u&&(n(e,r,i,a),h(e,r,i),s!==i.n&&(x(e,r,i),l.add(r))),a.delete(r)}},a=(t,i,s,...c)=>i.write(r=>v(n(t,r,e(r,s))),(n,...c)=>{let d;let p=e(n,s);if(l(i,n)){if(!u(n))throw Error("atom not writable");let e="v"in p,i=p.v;r(n,p,c[0]),h(t,n,p),e&&Object.is(i,p.v)||(x(t,n,p),o(t,n,p))}else d=a(t,n,p,...c);return T(t),d},...c),s=(t,...r)=>{let n=b(),i=a(n,t,e(t),...r);return T(n),i},h=(t,r,n)=>{if(n.m&&!d(n.v)){for(let i of n.d.keys())n.m.d.has(i)||(S(t,i,e(i,n)).t.add(r),n.m.d.add(i));for(let i of n.m.d||[])if(!n.d.has(i)){n.m.d.delete(i);let o=w(t,i,e(i,n));null==o||o.t.delete(r)}}},S=(r,i,o)=>{if(!o.m){for(let t of(n(r,i,o),o.d.keys()))S(r,t,e(t,o)).t.add(i);if(o.m={l:new Set,d:new Set(o.d.keys()),t:new Set},t.add(i),c(i)&&i.onMount){let e=o.m,{onMount:t}=i;E(r,()=>{let n=t((...e)=>a(r,i,o,...e));n&&(e.u=n)})}}return o.m},w=(r,n,i)=>{if(i.m&&!i.m.l.size&&!Array.from(i.m.t).some(t=>{var r;return null==(r=e(t,i).m)?void 0:r.d.has(n)})){let o=i.m.u;for(let a of(o&&E(r,o),delete i.m,t.delete(n),i.d.keys())){let t=w(r,a,e(a,i));null==t||t.t.delete(n)}return}return i.m},L={get:t=>v(n(void 0,t,e(t))),set:s,sub:(t,r)=>{let n=b(),i=e(t),o=S(n,t,i);T(n);let a=o.l;return a.add(r),()=>{a.delete(r);let e=b();w(e,t,i),T(e)}},unstable_derive:t=>C(...t(e))};return Object.assign(L,{dev4_get_internal_weak_map:()=>({get:t=>{let r=e(t);if(0!==r.n)return r}}),dev4_get_mounted_atoms:()=>t,dev4_restore_atoms:t=>{let n=b();for(let[i,a]of t)if(u(i)){let t=e(i),s="v"in t,l=t.v;r(i,t,a),h(n,i,t),s&&Object.is(l,t.v)||(x(n,i,t),o(n,i,t))}T(n)}}),L},w=()=>{let e=new WeakMap;return C(t=>{let r=e.get(t);return r||(r={d:new Map,p:new Set,n:0},e.set(t,r)),r})},L=()=>(n||(n=w(),globalThis.__JOTAI_DEFAULT_STORE__||(globalThis.__JOTAI_DEFAULT_STORE__=n),globalThis.__JOTAI_DEFAULT_STORE__!==n&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044")),n)},23657:(e,t,r)=>{"use strict";function n(e,t){let r=null,n=new Map,i=new Set,o=i=>{let s;if(void 0===t)s=n.get(i);else for(let[e,r]of n)if(t(e,i)){s=r;break}if(void 0!==s){if(null==r||!r(s[1],i))return s[0];o.remove(i)}let l=e(i);return n.set(i,[l,Date.now()]),a("CREATE",i,l),l};function a(e,t,r){for(let n of i)n({type:e,param:t,atom:r})}return o.unstable_listen=e=>(i.add(e),()=>{i.delete(e)}),o.getParams=()=>n.keys(),o.remove=e=>{if(void 0===t){if(!n.has(e))return;let[t]=n.get(e);n.delete(e),a("REMOVE",e,t)}else for(let[r,[i]]of n)if(t(r,e)){n.delete(r),a("REMOVE",r,i);break}},o.setShouldRemove=e=>{if(r=e)for(let[e,[t,i]]of n)r(i,e)&&(n.delete(e),a("REMOVE",e,t))},o}r.d(t,{Iz:()=>n}),Symbol("RESET");let i=e=>"function"==typeof(null==e?void 0:e.then);(function(e=()=>{try{return window.localStorage}catch(e){"undefined"!=typeof window&&console.warn(e);return}}){var t;let r,n,i;try{i=null==(t=e())?void 0:t.subscribe}catch(e){}if(!i&&"undefined"!=typeof window&&"function"==typeof window.addEventListener&&window.Storage&&(i=(t,r)=>{if(!(e()instanceof window.Storage))return()=>{};let n=n=>{n.storageArea===e()&&n.key===t&&r(n.newValue)};return window.addEventListener("storage",n),()=>{window.removeEventListener("storage",n)}}),i){let e;e=i,(t,r,n)=>e(t,e=>{let t;try{t=JSON.parse(e||"")}catch(e){t=n}r(t)})}})()},26075:(e,t,r)=>{"use strict";r.d(t,{C6:()=>i,Cl:()=>o,Ju:()=>u,Tt:()=>a,YH:()=>l,fX:()=>h,sH:()=>s,zs:()=>c});var n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return(o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)0>t.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function s(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})}function l(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(r)throw TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}function u(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a}function h(e,t,r){if(r||2==arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError}}]);